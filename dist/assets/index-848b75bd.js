function Ow(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(i,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var So=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ap(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Tp={exports:{}},wc={},bp={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ba=Symbol.for("react.element"),kw=Symbol.for("react.portal"),Pw=Symbol.for("react.fragment"),Lw=Symbol.for("react.strict_mode"),Bw=Symbol.for("react.profiler"),jw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),Uw=Symbol.for("react.forward_ref"),Vw=Symbol.for("react.suspense"),zw=Symbol.for("react.memo"),Ww=Symbol.for("react.lazy"),N0=Symbol.iterator;function Hw(e){return e===null||typeof e!="object"?null:(e=N0&&e[N0]||e["@@iterator"],typeof e=="function"?e:null)}var Ip={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Np=Object.assign,Rp={};function io(e,t,n){this.props=e,this.context=t,this.refs=Rp,this.updater=n||Ip}io.prototype.isReactComponent={};io.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};io.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Mp(){}Mp.prototype=io.prototype;function Sf(e,t,n){this.props=e,this.context=t,this.refs=Rp,this.updater=n||Ip}var Af=Sf.prototype=new Mp;Af.constructor=Sf;Np(Af,io.prototype);Af.isPureReactComponent=!0;var R0=Array.isArray,Dp=Object.prototype.hasOwnProperty,Tf={current:null},_p={key:!0,ref:!0,__self:!0,__source:!0};function Op(e,t,n){var i,a={},l=null,f=null;if(t!=null)for(i in t.ref!==void 0&&(f=t.ref),t.key!==void 0&&(l=""+t.key),t)Dp.call(t,i)&&!_p.hasOwnProperty(i)&&(a[i]=t[i]);var g=arguments.length-2;if(g===1)a.children=n;else if(1<g){for(var p=Array(g),m=0;m<g;m++)p[m]=arguments[m+2];a.children=p}if(e&&e.defaultProps)for(i in g=e.defaultProps,g)a[i]===void 0&&(a[i]=g[i]);return{$$typeof:ba,type:e,key:l,ref:f,props:a,_owner:Tf.current}}function Gw(e,t){return{$$typeof:ba,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bf(e){return typeof e=="object"&&e!==null&&e.$$typeof===ba}function Yw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var M0=/\/+/g;function uu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Yw(""+e.key):t.toString(36)}function yl(e,t,n,i,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var f=!1;if(e===null)f=!0;else switch(l){case"string":case"number":f=!0;break;case"object":switch(e.$$typeof){case ba:case kw:f=!0}}if(f)return f=e,a=a(f),e=i===""?"."+uu(f,0):i,R0(a)?(n="",e!=null&&(n=e.replace(M0,"$&/")+"/"),yl(a,t,n,"",function(m){return m})):a!=null&&(bf(a)&&(a=Gw(a,n+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(M0,"$&/")+"/")+e)),t.push(a)),1;if(f=0,i=i===""?".":i+":",R0(e))for(var g=0;g<e.length;g++){l=e[g];var p=i+uu(l,g);f+=yl(l,t,n,p,a)}else if(p=Hw(e),typeof p=="function")for(e=p.call(e),g=0;!(l=e.next()).done;)l=l.value,p=i+uu(l,g++),f+=yl(l,t,n,p,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return f}function Xa(e,t,n){if(e==null)return e;var i=[],a=0;return yl(e,i,"","",function(l){return t.call(n,l,a++)}),i}function Xw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var mn={current:null},wl={transition:null},Qw={ReactCurrentDispatcher:mn,ReactCurrentBatchConfig:wl,ReactCurrentOwner:Tf};function kp(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:Xa,forEach:function(e,t,n){Xa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Xa(e,function(){t++}),t},toArray:function(e){return Xa(e,function(t){return t})||[]},only:function(e){if(!bf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=io;Xe.Fragment=Pw;Xe.Profiler=Bw;Xe.PureComponent=Sf;Xe.StrictMode=Lw;Xe.Suspense=Vw;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qw;Xe.act=kp;Xe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Np({},e.props),a=e.key,l=e.ref,f=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,f=Tf.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(p in t)Dp.call(t,p)&&!_p.hasOwnProperty(p)&&(i[p]=t[p]===void 0&&g!==void 0?g[p]:t[p])}var p=arguments.length-2;if(p===1)i.children=n;else if(1<p){g=Array(p);for(var m=0;m<p;m++)g[m]=arguments[m+2];i.children=g}return{$$typeof:ba,type:e.type,key:a,ref:l,props:i,_owner:f}};Xe.createContext=function(e){return e={$$typeof:Fw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jw,_context:e},e.Consumer=e};Xe.createElement=Op;Xe.createFactory=function(e){var t=Op.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:Uw,render:e}};Xe.isValidElement=bf;Xe.lazy=function(e){return{$$typeof:Ww,_payload:{_status:-1,_result:e},_init:Xw}};Xe.memo=function(e,t){return{$$typeof:zw,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=wl.transition;wl.transition={};try{e()}finally{wl.transition=t}};Xe.unstable_act=kp;Xe.useCallback=function(e,t){return mn.current.useCallback(e,t)};Xe.useContext=function(e){return mn.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return mn.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return mn.current.useEffect(e,t)};Xe.useId=function(){return mn.current.useId()};Xe.useImperativeHandle=function(e,t,n){return mn.current.useImperativeHandle(e,t,n)};Xe.useInsertionEffect=function(e,t){return mn.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return mn.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return mn.current.useMemo(e,t)};Xe.useReducer=function(e,t,n){return mn.current.useReducer(e,t,n)};Xe.useRef=function(e){return mn.current.useRef(e)};Xe.useState=function(e){return mn.current.useState(e)};Xe.useSyncExternalStore=function(e,t,n){return mn.current.useSyncExternalStore(e,t,n)};Xe.useTransition=function(){return mn.current.useTransition()};Xe.version="18.3.1";bp.exports=Xe;var R=bp.exports;const mi=Ap(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kw=R,Zw=Symbol.for("react.element"),$w=Symbol.for("react.fragment"),qw=Object.prototype.hasOwnProperty,Jw=Kw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eC={key:!0,ref:!0,__self:!0,__source:!0};function Pp(e,t,n){var i,a={},l=null,f=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(f=t.ref);for(i in t)qw.call(t,i)&&!eC.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)a[i]===void 0&&(a[i]=t[i]);return{$$typeof:Zw,type:e,key:l,ref:f,props:a,_owner:Jw.current}}wc.Fragment=$w;wc.jsx=Pp;wc.jsxs=Pp;Tp.exports=wc;var y=Tp.exports,Lp={exports:{}},Un={},Bp={exports:{}},jp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,fe){var oe=X.length;X.push(fe);e:for(;0<oe;){var ve=oe-1>>>1,Te=X[ve];if(0<a(Te,fe))X[ve]=fe,X[oe]=Te,oe=ve;else break e}}function n(X){return X.length===0?null:X[0]}function i(X){if(X.length===0)return null;var fe=X[0],oe=X.pop();if(oe!==fe){X[0]=oe;e:for(var ve=0,Te=X.length,st=Te>>>1;ve<st;){var Ze=2*(ve+1)-1,Ft=X[Ze],ge=Ze+1,Re=X[ge];if(0>a(Ft,oe))ge<Te&&0>a(Re,Ft)?(X[ve]=Re,X[ge]=oe,ve=ge):(X[ve]=Ft,X[Ze]=oe,ve=Ze);else if(ge<Te&&0>a(Re,oe))X[ve]=Re,X[ge]=oe,ve=ge;else break e}}return fe}function a(X,fe){var oe=X.sortIndex-fe.sortIndex;return oe!==0?oe:X.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var f=Date,g=f.now();e.unstable_now=function(){return f.now()-g}}var p=[],m=[],C=1,E=null,A=3,M=!1,_=!1,k=!1,V=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(X){for(var fe=n(m);fe!==null;){if(fe.callback===null)i(m);else if(fe.startTime<=X)i(m),fe.sortIndex=fe.expirationTime,t(p,fe);else break;fe=n(m)}}function O(X){if(k=!1,S(X),!_)if(n(p)!==null)_=!0,q(F);else{var fe=n(m);fe!==null&&re(O,fe.startTime-X)}}function F(X,fe){_=!1,k&&(k=!1,N(B),B=-1),M=!0;var oe=A;try{for(S(fe),E=n(p);E!==null&&(!(E.expirationTime>fe)||X&&!me());){var ve=E.callback;if(typeof ve=="function"){E.callback=null,A=E.priorityLevel;var Te=ve(E.expirationTime<=fe);fe=e.unstable_now(),typeof Te=="function"?E.callback=Te:E===n(p)&&i(p),S(fe)}else i(p);E=n(p)}if(E!==null)var st=!0;else{var Ze=n(m);Ze!==null&&re(O,Ze.startTime-fe),st=!1}return st}finally{E=null,A=oe,M=!1}}var W=!1,U=null,B=-1,G=5,te=-1;function me(){return!(e.unstable_now()-te<G)}function he(){if(U!==null){var X=e.unstable_now();te=X;var fe=!0;try{fe=U(!0,X)}finally{fe?de():(W=!1,U=null)}}else W=!1}var de;if(typeof b=="function")de=function(){b(he)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,j=pe.port2;pe.port1.onmessage=he,de=function(){j.postMessage(null)}}else de=function(){V(he,0)};function q(X){U=X,W||(W=!0,de())}function re(X,fe){B=V(function(){X(e.unstable_now())},fe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){_||M||(_=!0,q(F))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return A},e.unstable_getFirstCallbackNode=function(){return n(p)},e.unstable_next=function(X){switch(A){case 1:case 2:case 3:var fe=3;break;default:fe=A}var oe=A;A=fe;try{return X()}finally{A=oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,fe){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=A;A=X;try{return fe()}finally{A=oe}},e.unstable_scheduleCallback=function(X,fe,oe){var ve=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?ve+oe:ve):oe=ve,X){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=oe+Te,X={id:C++,callback:fe,priorityLevel:X,startTime:oe,expirationTime:Te,sortIndex:-1},oe>ve?(X.sortIndex=oe,t(m,X),n(p)===null&&X===n(m)&&(k?(N(B),B=-1):k=!0,re(O,oe-ve))):(X.sortIndex=Te,t(p,X),_||M||(_=!0,q(F))),X},e.unstable_shouldYield=me,e.unstable_wrapCallback=function(X){var fe=A;return function(){var oe=A;A=fe;try{return X.apply(this,arguments)}finally{A=oe}}}})(jp);Bp.exports=jp;var tC=Bp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nC=R,Fn=tC;function le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fp=new Set,ea={};function as(e,t){Ws(e,t),Ws(e+"Capture",t)}function Ws(e,t){for(ea[e]=t,e=0;e<t.length;e++)Fp.add(t[e])}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nd=Object.prototype.hasOwnProperty,rC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D0={},_0={};function iC(e){return nd.call(_0,e)?!0:nd.call(D0,e)?!1:rC.test(e)?_0[e]=!0:(D0[e]=!0,!1)}function sC(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oC(e,t,n,i){if(t===null||typeof t>"u"||sC(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xn(e,t,n,i,a,l,f){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=f}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rn[e]=new xn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rn[t]=new xn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rn[e]=new xn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rn[e]=new xn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rn[e]=new xn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rn[e]=new xn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rn[e]=new xn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rn[e]=new xn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rn[e]=new xn(e,5,!1,e.toLowerCase(),null,!1,!1)});var If=/[\-:]([a-z])/g;function Nf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(If,Nf);rn[t]=new xn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(If,Nf);rn[t]=new xn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(If,Nf);rn[t]=new xn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rn[e]=new xn(e,1,!1,e.toLowerCase(),null,!1,!1)});rn.xlinkHref=new xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rn[e]=new xn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Rf(e,t,n,i){var a=rn.hasOwnProperty(t)?rn[t]:null;(a!==null?a.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(oC(t,n,a,i)&&(n=null),i||a===null?iC(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,i=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Kr=nC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qa=Symbol.for("react.element"),ws=Symbol.for("react.portal"),Cs=Symbol.for("react.fragment"),Mf=Symbol.for("react.strict_mode"),rd=Symbol.for("react.profiler"),Up=Symbol.for("react.provider"),Vp=Symbol.for("react.context"),Df=Symbol.for("react.forward_ref"),id=Symbol.for("react.suspense"),sd=Symbol.for("react.suspense_list"),_f=Symbol.for("react.memo"),ci=Symbol.for("react.lazy"),zp=Symbol.for("react.offscreen"),O0=Symbol.iterator;function Ao(e){return e===null||typeof e!="object"?null:(e=O0&&e[O0]||e["@@iterator"],typeof e=="function"?e:null)}var It=Object.assign,du;function ko(e){if(du===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);du=t&&t[1]||""}return`
`+du+e}var fu=!1;function hu(e,t){if(!e||fu)return"";fu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(m){var i=m}Reflect.construct(e,[],t)}else{try{t.call()}catch(m){i=m}e.call(t.prototype)}else{try{throw Error()}catch(m){i=m}e()}}catch(m){if(m&&i&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),l=i.stack.split(`
`),f=a.length-1,g=l.length-1;1<=f&&0<=g&&a[f]!==l[g];)g--;for(;1<=f&&0<=g;f--,g--)if(a[f]!==l[g]){if(f!==1||g!==1)do if(f--,g--,0>g||a[f]!==l[g]){var p=`
`+a[f].replace(" at new "," at ");return e.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",e.displayName)),p}while(1<=f&&0<=g);break}}}finally{fu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ko(e):""}function aC(e){switch(e.tag){case 5:return ko(e.type);case 16:return ko("Lazy");case 13:return ko("Suspense");case 19:return ko("SuspenseList");case 0:case 2:case 15:return e=hu(e.type,!1),e;case 11:return e=hu(e.type.render,!1),e;case 1:return e=hu(e.type,!0),e;default:return""}}function od(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Cs:return"Fragment";case ws:return"Portal";case rd:return"Profiler";case Mf:return"StrictMode";case id:return"Suspense";case sd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Vp:return(e.displayName||"Context")+".Consumer";case Up:return(e._context.displayName||"Context")+".Provider";case Df:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _f:return t=e.displayName||null,t!==null?t:od(e.type)||"Memo";case ci:t=e._payload,e=e._init;try{return od(e(t))}catch{}}return null}function lC(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return od(t);case 8:return t===Mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ti(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Wp(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cC(e){var t=Wp(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(f){i=""+f,l.call(this,f)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(f){i=""+f},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ka(e){e._valueTracker||(e._valueTracker=cC(e))}function Hp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Wp(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Ll(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ad(e,t){var n=t.checked;return It({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function k0(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=Ti(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Gp(e,t){t=t.checked,t!=null&&Rf(e,"checked",t,!1)}function ld(e,t){Gp(e,t);var n=Ti(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cd(e,t.type,n):t.hasOwnProperty("defaultValue")&&cd(e,t.type,Ti(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function P0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function cd(e,t,n){(t!=="number"||Ll(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Po=Array.isArray;function Bs(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Ti(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,i&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function ud(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(le(91));return It({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function L0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(le(92));if(Po(n)){if(1<n.length)throw Error(le(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ti(n)}}function Yp(e,t){var n=Ti(t.value),i=Ti(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function B0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Za,Qp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Za=Za||document.createElement("div"),Za.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Za.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ta(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uC=["Webkit","ms","Moz","O"];Object.keys(Fo).forEach(function(e){uC.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fo[t]=Fo[e]})});function Kp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Fo.hasOwnProperty(e)&&Fo[e]?(""+t).trim():t+"px"}function Zp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,a=Kp(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,a):e[n]=a}}var dC=It({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fd(e,t){if(t){if(dC[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(le(62))}}function hd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gd=null;function Of(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pd=null,js=null,Fs=null;function j0(e){if(e=Ra(e)){if(typeof pd!="function")throw Error(le(280));var t=e.stateNode;t&&(t=Ac(t),pd(e.stateNode,e.type,t))}}function $p(e){js?Fs?Fs.push(e):Fs=[e]:js=e}function qp(){if(js){var e=js,t=Fs;if(Fs=js=null,j0(e),t)for(e=0;e<t.length;e++)j0(t[e])}}function Jp(e,t){return e(t)}function em(){}var gu=!1;function tm(e,t,n){if(gu)return e(t,n);gu=!0;try{return Jp(e,t,n)}finally{gu=!1,(js!==null||Fs!==null)&&(em(),qp())}}function na(e,t){var n=e.stateNode;if(n===null)return null;var i=Ac(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(le(231,t,typeof n));return n}var md=!1;if(Vr)try{var To={};Object.defineProperty(To,"passive",{get:function(){md=!0}}),window.addEventListener("test",To,To),window.removeEventListener("test",To,To)}catch{md=!1}function fC(e,t,n,i,a,l,f,g,p){var m=Array.prototype.slice.call(arguments,3);try{t.apply(n,m)}catch(C){this.onError(C)}}var Uo=!1,Bl=null,jl=!1,xd=null,hC={onError:function(e){Uo=!0,Bl=e}};function gC(e,t,n,i,a,l,f,g,p){Uo=!1,Bl=null,fC.apply(hC,arguments)}function pC(e,t,n,i,a,l,f,g,p){if(gC.apply(this,arguments),Uo){if(Uo){var m=Bl;Uo=!1,Bl=null}else throw Error(le(198));jl||(jl=!0,xd=m)}}function ls(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function nm(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function F0(e){if(ls(e)!==e)throw Error(le(188))}function mC(e){var t=e.alternate;if(!t){if(t=ls(e),t===null)throw Error(le(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(i=a.return,i!==null){n=i;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return F0(a),e;if(l===i)return F0(a),t;l=l.sibling}throw Error(le(188))}if(n.return!==i.return)n=a,i=l;else{for(var f=!1,g=a.child;g;){if(g===n){f=!0,n=a,i=l;break}if(g===i){f=!0,i=a,n=l;break}g=g.sibling}if(!f){for(g=l.child;g;){if(g===n){f=!0,n=l,i=a;break}if(g===i){f=!0,i=l,n=a;break}g=g.sibling}if(!f)throw Error(le(189))}}if(n.alternate!==i)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?e:t}function rm(e){return e=mC(e),e!==null?im(e):null}function im(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=im(e);if(t!==null)return t;e=e.sibling}return null}var sm=Fn.unstable_scheduleCallback,U0=Fn.unstable_cancelCallback,xC=Fn.unstable_shouldYield,yC=Fn.unstable_requestPaint,Bt=Fn.unstable_now,wC=Fn.unstable_getCurrentPriorityLevel,kf=Fn.unstable_ImmediatePriority,om=Fn.unstable_UserBlockingPriority,Fl=Fn.unstable_NormalPriority,CC=Fn.unstable_LowPriority,am=Fn.unstable_IdlePriority,Cc=null,br=null;function EC(e){if(br&&typeof br.onCommitFiberRoot=="function")try{br.onCommitFiberRoot(Cc,e,void 0,(e.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:AC,vC=Math.log,SC=Math.LN2;function AC(e){return e>>>=0,e===0?32:31-(vC(e)/SC|0)|0}var $a=64,qa=4194304;function Lo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ul(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,a=e.suspendedLanes,l=e.pingedLanes,f=n&268435455;if(f!==0){var g=f&~a;g!==0?i=Lo(g):(l&=f,l!==0&&(i=Lo(l)))}else f=n&~a,f!==0?i=Lo(f):l!==0&&(i=Lo(l));if(i===0)return 0;if(t!==0&&t!==i&&!(t&a)&&(a=i&-i,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-ur(t),a=1<<n,i|=e[n],t&=~a;return i}function TC(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bC(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var f=31-ur(l),g=1<<f,p=a[f];p===-1?(!(g&n)||g&i)&&(a[f]=TC(g,t)):p<=t&&(e.expiredLanes|=g),l&=~g}}function yd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function lm(){var e=$a;return $a<<=1,!($a&4194240)&&($a=64),e}function pu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ia(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ur(t),e[t]=n}function IC(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ur(n),l=1<<a;t[a]=0,i[a]=-1,e[a]=-1,n&=~l}}function Pf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ur(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}var lt=0;function cm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var um,Lf,dm,fm,hm,wd=!1,Ja=[],xi=null,yi=null,wi=null,ra=new Map,ia=new Map,di=[],NC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function V0(e,t){switch(e){case"focusin":case"focusout":xi=null;break;case"dragenter":case"dragleave":yi=null;break;case"mouseover":case"mouseout":wi=null;break;case"pointerover":case"pointerout":ra.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(t.pointerId)}}function bo(e,t,n,i,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:l,targetContainers:[a]},t!==null&&(t=Ra(t),t!==null&&Lf(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function RC(e,t,n,i,a){switch(t){case"focusin":return xi=bo(xi,e,t,n,i,a),!0;case"dragenter":return yi=bo(yi,e,t,n,i,a),!0;case"mouseover":return wi=bo(wi,e,t,n,i,a),!0;case"pointerover":var l=a.pointerId;return ra.set(l,bo(ra.get(l)||null,e,t,n,i,a)),!0;case"gotpointercapture":return l=a.pointerId,ia.set(l,bo(ia.get(l)||null,e,t,n,i,a)),!0}return!1}function gm(e){var t=Yi(e.target);if(t!==null){var n=ls(t);if(n!==null){if(t=n.tag,t===13){if(t=nm(n),t!==null){e.blockedOn=t,hm(e.priority,function(){dm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Cd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);gd=i,n.target.dispatchEvent(i),gd=null}else return t=Ra(n),t!==null&&Lf(t),e.blockedOn=n,!1;t.shift()}return!0}function z0(e,t,n){Cl(e)&&n.delete(t)}function MC(){wd=!1,xi!==null&&Cl(xi)&&(xi=null),yi!==null&&Cl(yi)&&(yi=null),wi!==null&&Cl(wi)&&(wi=null),ra.forEach(z0),ia.forEach(z0)}function Io(e,t){e.blockedOn===t&&(e.blockedOn=null,wd||(wd=!0,Fn.unstable_scheduleCallback(Fn.unstable_NormalPriority,MC)))}function sa(e){function t(a){return Io(a,e)}if(0<Ja.length){Io(Ja[0],e);for(var n=1;n<Ja.length;n++){var i=Ja[n];i.blockedOn===e&&(i.blockedOn=null)}}for(xi!==null&&Io(xi,e),yi!==null&&Io(yi,e),wi!==null&&Io(wi,e),ra.forEach(t),ia.forEach(t),n=0;n<di.length;n++)i=di[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<di.length&&(n=di[0],n.blockedOn===null);)gm(n),n.blockedOn===null&&di.shift()}var Us=Kr.ReactCurrentBatchConfig,Vl=!0;function DC(e,t,n,i){var a=lt,l=Us.transition;Us.transition=null;try{lt=1,Bf(e,t,n,i)}finally{lt=a,Us.transition=l}}function _C(e,t,n,i){var a=lt,l=Us.transition;Us.transition=null;try{lt=4,Bf(e,t,n,i)}finally{lt=a,Us.transition=l}}function Bf(e,t,n,i){if(Vl){var a=Cd(e,t,n,i);if(a===null)Tu(e,t,i,zl,n),V0(e,i);else if(RC(a,e,t,n,i))i.stopPropagation();else if(V0(e,i),t&4&&-1<NC.indexOf(e)){for(;a!==null;){var l=Ra(a);if(l!==null&&um(l),l=Cd(e,t,n,i),l===null&&Tu(e,t,i,zl,n),l===a)break;a=l}a!==null&&i.stopPropagation()}else Tu(e,t,i,null,n)}}var zl=null;function Cd(e,t,n,i){if(zl=null,e=Of(i),e=Yi(e),e!==null)if(t=ls(e),t===null)e=null;else if(n=t.tag,n===13){if(e=nm(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return zl=e,null}function pm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wC()){case kf:return 1;case om:return 4;case Fl:case CC:return 16;case am:return 536870912;default:return 16}default:return 16}}var hi=null,jf=null,El=null;function mm(){if(El)return El;var e,t=jf,n=t.length,i,a="value"in hi?hi.value:hi.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var f=n-e;for(i=1;i<=f&&t[n-i]===a[l-i];i++);return El=a.slice(e,1<i?1-i:void 0)}function vl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function el(){return!0}function W0(){return!1}function Vn(e){function t(n,i,a,l,f){this._reactName=n,this._targetInst=a,this.type=i,this.nativeEvent=l,this.target=f,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(l):l[g]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?el:W0,this.isPropagationStopped=W0,this}return It(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=el)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=el)},persist:function(){},isPersistent:el}),t}var so={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ff=Vn(so),Na=It({},so,{view:0,detail:0}),OC=Vn(Na),mu,xu,No,Ec=It({},Na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==No&&(No&&e.type==="mousemove"?(mu=e.screenX-No.screenX,xu=e.screenY-No.screenY):xu=mu=0,No=e),mu)},movementY:function(e){return"movementY"in e?e.movementY:xu}}),H0=Vn(Ec),kC=It({},Ec,{dataTransfer:0}),PC=Vn(kC),LC=It({},Na,{relatedTarget:0}),yu=Vn(LC),BC=It({},so,{animationName:0,elapsedTime:0,pseudoElement:0}),jC=Vn(BC),FC=It({},so,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),UC=Vn(FC),VC=It({},so,{data:0}),G0=Vn(VC),zC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},WC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function GC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=HC[e])?!!t[e]:!1}function Uf(){return GC}var YC=It({},Na,{key:function(e){if(e.key){var t=zC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?WC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uf,charCode:function(e){return e.type==="keypress"?vl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),XC=Vn(YC),QC=It({},Ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Y0=Vn(QC),KC=It({},Na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uf}),ZC=Vn(KC),$C=It({},so,{propertyName:0,elapsedTime:0,pseudoElement:0}),qC=Vn($C),JC=It({},Ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),e3=Vn(JC),t3=[9,13,27,32],Vf=Vr&&"CompositionEvent"in window,Vo=null;Vr&&"documentMode"in document&&(Vo=document.documentMode);var n3=Vr&&"TextEvent"in window&&!Vo,xm=Vr&&(!Vf||Vo&&8<Vo&&11>=Vo),X0=String.fromCharCode(32),Q0=!1;function ym(e,t){switch(e){case"keyup":return t3.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Es=!1;function r3(e,t){switch(e){case"compositionend":return wm(t);case"keypress":return t.which!==32?null:(Q0=!0,X0);case"textInput":return e=t.data,e===X0&&Q0?null:e;default:return null}}function i3(e,t){if(Es)return e==="compositionend"||!Vf&&ym(e,t)?(e=mm(),El=jf=hi=null,Es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xm&&t.locale!=="ko"?null:t.data;default:return null}}var s3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function K0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!s3[e.type]:t==="textarea"}function Cm(e,t,n,i){$p(i),t=Wl(t,"onChange"),0<t.length&&(n=new Ff("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var zo=null,oa=null;function o3(e){Dm(e,0)}function vc(e){var t=As(e);if(Hp(t))return e}function a3(e,t){if(e==="change")return t}var Em=!1;if(Vr){var wu;if(Vr){var Cu="oninput"in document;if(!Cu){var Z0=document.createElement("div");Z0.setAttribute("oninput","return;"),Cu=typeof Z0.oninput=="function"}wu=Cu}else wu=!1;Em=wu&&(!document.documentMode||9<document.documentMode)}function $0(){zo&&(zo.detachEvent("onpropertychange",vm),oa=zo=null)}function vm(e){if(e.propertyName==="value"&&vc(oa)){var t=[];Cm(t,oa,e,Of(e)),tm(o3,t)}}function l3(e,t,n){e==="focusin"?($0(),zo=t,oa=n,zo.attachEvent("onpropertychange",vm)):e==="focusout"&&$0()}function c3(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vc(oa)}function u3(e,t){if(e==="click")return vc(t)}function d3(e,t){if(e==="input"||e==="change")return vc(t)}function f3(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fr=typeof Object.is=="function"?Object.is:f3;function aa(e,t){if(fr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!nd.call(t,a)||!fr(e[a],t[a]))return!1}return!0}function q0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function J0(e,t){var n=q0(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=q0(n)}}function Sm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Sm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Am(){for(var e=window,t=Ll();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ll(e.document)}return t}function zf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function h3(e){var t=Am(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Sm(n.ownerDocument.documentElement,n)){if(i!==null&&zf(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(i.start,a);i=i.end===void 0?l:Math.min(i.end,a),!e.extend&&l>i&&(a=i,i=l,l=a),a=J0(n,l);var f=J0(n,i);a&&f&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==f.node||e.focusOffset!==f.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>i?(e.addRange(t),e.extend(f.node,f.offset)):(t.setEnd(f.node,f.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var g3=Vr&&"documentMode"in document&&11>=document.documentMode,vs=null,Ed=null,Wo=null,vd=!1;function e1(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vd||vs==null||vs!==Ll(i)||(i=vs,"selectionStart"in i&&zf(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Wo&&aa(Wo,i)||(Wo=i,i=Wl(Ed,"onSelect"),0<i.length&&(t=new Ff("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=vs)))}function tl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ss={animationend:tl("Animation","AnimationEnd"),animationiteration:tl("Animation","AnimationIteration"),animationstart:tl("Animation","AnimationStart"),transitionend:tl("Transition","TransitionEnd")},Eu={},Tm={};Vr&&(Tm=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function Sc(e){if(Eu[e])return Eu[e];if(!Ss[e])return e;var t=Ss[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Tm)return Eu[e]=t[n];return e}var bm=Sc("animationend"),Im=Sc("animationiteration"),Nm=Sc("animationstart"),Rm=Sc("transitionend"),Mm=new Map,t1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(e,t){Mm.set(e,t),as(t,[e])}for(var vu=0;vu<t1.length;vu++){var Su=t1[vu],p3=Su.toLowerCase(),m3=Su[0].toUpperCase()+Su.slice(1);Ri(p3,"on"+m3)}Ri(bm,"onAnimationEnd");Ri(Im,"onAnimationIteration");Ri(Nm,"onAnimationStart");Ri("dblclick","onDoubleClick");Ri("focusin","onFocus");Ri("focusout","onBlur");Ri(Rm,"onTransitionEnd");Ws("onMouseEnter",["mouseout","mouseover"]);Ws("onMouseLeave",["mouseout","mouseover"]);Ws("onPointerEnter",["pointerout","pointerover"]);Ws("onPointerLeave",["pointerout","pointerover"]);as("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));as("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));as("onBeforeInput",["compositionend","keypress","textInput","paste"]);as("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));as("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));as("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),x3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bo));function n1(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,pC(i,t,void 0,e),e.currentTarget=null}function Dm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var l=void 0;if(t)for(var f=i.length-1;0<=f;f--){var g=i[f],p=g.instance,m=g.currentTarget;if(g=g.listener,p!==l&&a.isPropagationStopped())break e;n1(a,g,m),l=p}else for(f=0;f<i.length;f++){if(g=i[f],p=g.instance,m=g.currentTarget,g=g.listener,p!==l&&a.isPropagationStopped())break e;n1(a,g,m),l=p}}}if(jl)throw e=xd,jl=!1,xd=null,e}function mt(e,t){var n=t[Id];n===void 0&&(n=t[Id]=new Set);var i=e+"__bubble";n.has(i)||(_m(t,e,2,!1),n.add(i))}function Au(e,t,n){var i=0;t&&(i|=4),_m(n,e,i,t)}var nl="_reactListening"+Math.random().toString(36).slice(2);function la(e){if(!e[nl]){e[nl]=!0,Fp.forEach(function(n){n!=="selectionchange"&&(x3.has(n)||Au(n,!1,e),Au(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nl]||(t[nl]=!0,Au("selectionchange",!1,t))}}function _m(e,t,n,i){switch(pm(t)){case 1:var a=DC;break;case 4:a=_C;break;default:a=Bf}n=a.bind(null,t,n,e),a=void 0,!md||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),i?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Tu(e,t,n,i,a){var l=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var f=i.tag;if(f===3||f===4){var g=i.stateNode.containerInfo;if(g===a||g.nodeType===8&&g.parentNode===a)break;if(f===4)for(f=i.return;f!==null;){var p=f.tag;if((p===3||p===4)&&(p=f.stateNode.containerInfo,p===a||p.nodeType===8&&p.parentNode===a))return;f=f.return}for(;g!==null;){if(f=Yi(g),f===null)return;if(p=f.tag,p===5||p===6){i=l=f;continue e}g=g.parentNode}}i=i.return}tm(function(){var m=l,C=Of(n),E=[];e:{var A=Mm.get(e);if(A!==void 0){var M=Ff,_=e;switch(e){case"keypress":if(vl(n)===0)break e;case"keydown":case"keyup":M=XC;break;case"focusin":_="focus",M=yu;break;case"focusout":_="blur",M=yu;break;case"beforeblur":case"afterblur":M=yu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=H0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=PC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=ZC;break;case bm:case Im:case Nm:M=jC;break;case Rm:M=qC;break;case"scroll":M=OC;break;case"wheel":M=e3;break;case"copy":case"cut":case"paste":M=UC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Y0}var k=(t&4)!==0,V=!k&&e==="scroll",N=k?A!==null?A+"Capture":null:A;k=[];for(var b=m,S;b!==null;){S=b;var O=S.stateNode;if(S.tag===5&&O!==null&&(S=O,N!==null&&(O=na(b,N),O!=null&&k.push(ca(b,O,S)))),V)break;b=b.return}0<k.length&&(A=new M(A,_,null,n,C),E.push({event:A,listeners:k}))}}if(!(t&7)){e:{if(A=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",A&&n!==gd&&(_=n.relatedTarget||n.fromElement)&&(Yi(_)||_[zr]))break e;if((M||A)&&(A=C.window===C?C:(A=C.ownerDocument)?A.defaultView||A.parentWindow:window,M?(_=n.relatedTarget||n.toElement,M=m,_=_?Yi(_):null,_!==null&&(V=ls(_),_!==V||_.tag!==5&&_.tag!==6)&&(_=null)):(M=null,_=m),M!==_)){if(k=H0,O="onMouseLeave",N="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(k=Y0,O="onPointerLeave",N="onPointerEnter",b="pointer"),V=M==null?A:As(M),S=_==null?A:As(_),A=new k(O,b+"leave",M,n,C),A.target=V,A.relatedTarget=S,O=null,Yi(C)===m&&(k=new k(N,b+"enter",_,n,C),k.target=S,k.relatedTarget=V,O=k),V=O,M&&_)t:{for(k=M,N=_,b=0,S=k;S;S=xs(S))b++;for(S=0,O=N;O;O=xs(O))S++;for(;0<b-S;)k=xs(k),b--;for(;0<S-b;)N=xs(N),S--;for(;b--;){if(k===N||N!==null&&k===N.alternate)break t;k=xs(k),N=xs(N)}k=null}else k=null;M!==null&&r1(E,A,M,k,!1),_!==null&&V!==null&&r1(E,V,_,k,!0)}}e:{if(A=m?As(m):window,M=A.nodeName&&A.nodeName.toLowerCase(),M==="select"||M==="input"&&A.type==="file")var F=a3;else if(K0(A))if(Em)F=d3;else{F=c3;var W=l3}else(M=A.nodeName)&&M.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(F=u3);if(F&&(F=F(e,m))){Cm(E,F,n,C);break e}W&&W(e,A,m),e==="focusout"&&(W=A._wrapperState)&&W.controlled&&A.type==="number"&&cd(A,"number",A.value)}switch(W=m?As(m):window,e){case"focusin":(K0(W)||W.contentEditable==="true")&&(vs=W,Ed=m,Wo=null);break;case"focusout":Wo=Ed=vs=null;break;case"mousedown":vd=!0;break;case"contextmenu":case"mouseup":case"dragend":vd=!1,e1(E,n,C);break;case"selectionchange":if(g3)break;case"keydown":case"keyup":e1(E,n,C)}var U;if(Vf)e:{switch(e){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else Es?ym(e,n)&&(B="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(B="onCompositionStart");B&&(xm&&n.locale!=="ko"&&(Es||B!=="onCompositionStart"?B==="onCompositionEnd"&&Es&&(U=mm()):(hi=C,jf="value"in hi?hi.value:hi.textContent,Es=!0)),W=Wl(m,B),0<W.length&&(B=new G0(B,e,null,n,C),E.push({event:B,listeners:W}),U?B.data=U:(U=wm(n),U!==null&&(B.data=U)))),(U=n3?r3(e,n):i3(e,n))&&(m=Wl(m,"onBeforeInput"),0<m.length&&(C=new G0("onBeforeInput","beforeinput",null,n,C),E.push({event:C,listeners:m}),C.data=U))}Dm(E,t)})}function ca(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wl(e,t){for(var n=t+"Capture",i=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=na(e,n),l!=null&&i.unshift(ca(e,l,a)),l=na(e,t),l!=null&&i.push(ca(e,l,a))),e=e.return}return i}function xs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function r1(e,t,n,i,a){for(var l=t._reactName,f=[];n!==null&&n!==i;){var g=n,p=g.alternate,m=g.stateNode;if(p!==null&&p===i)break;g.tag===5&&m!==null&&(g=m,a?(p=na(n,l),p!=null&&f.unshift(ca(n,p,g))):a||(p=na(n,l),p!=null&&f.push(ca(n,p,g)))),n=n.return}f.length!==0&&e.push({event:t,listeners:f})}var y3=/\r\n?/g,w3=/\u0000|\uFFFD/g;function i1(e){return(typeof e=="string"?e:""+e).replace(y3,`
`).replace(w3,"")}function rl(e,t,n){if(t=i1(t),i1(e)!==t&&n)throw Error(le(425))}function Hl(){}var Sd=null,Ad=null;function Td(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var bd=typeof setTimeout=="function"?setTimeout:void 0,C3=typeof clearTimeout=="function"?clearTimeout:void 0,s1=typeof Promise=="function"?Promise:void 0,E3=typeof queueMicrotask=="function"?queueMicrotask:typeof s1<"u"?function(e){return s1.resolve(null).then(e).catch(v3)}:bd;function v3(e){setTimeout(function(){throw e})}function bu(e,t){var n=t,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(i===0){e.removeChild(a),sa(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=a}while(n);sa(t)}function Ci(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function o1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var oo=Math.random().toString(36).slice(2),Tr="__reactFiber$"+oo,ua="__reactProps$"+oo,zr="__reactContainer$"+oo,Id="__reactEvents$"+oo,S3="__reactListeners$"+oo,A3="__reactHandles$"+oo;function Yi(e){var t=e[Tr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[zr]||n[Tr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=o1(e);e!==null;){if(n=e[Tr])return n;e=o1(e)}return t}e=n,n=e.parentNode}return null}function Ra(e){return e=e[Tr]||e[zr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function As(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(le(33))}function Ac(e){return e[ua]||null}var Nd=[],Ts=-1;function Mi(e){return{current:e}}function yt(e){0>Ts||(e.current=Nd[Ts],Nd[Ts]=null,Ts--)}function gt(e,t){Ts++,Nd[Ts]=e.current,e.current=t}var bi={},dn=Mi(bi),Rn=Mi(!1),ns=bi;function Hs(e,t){var n=e.type.contextTypes;if(!n)return bi;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Mn(e){return e=e.childContextTypes,e!=null}function Gl(){yt(Rn),yt(dn)}function a1(e,t,n){if(dn.current!==bi)throw Error(le(168));gt(dn,t),gt(Rn,n)}function Om(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var a in i)if(!(a in t))throw Error(le(108,lC(e)||"Unknown",a));return It({},n,i)}function Yl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||bi,ns=dn.current,gt(dn,e),gt(Rn,Rn.current),!0}function l1(e,t,n){var i=e.stateNode;if(!i)throw Error(le(169));n?(e=Om(e,t,ns),i.__reactInternalMemoizedMergedChildContext=e,yt(Rn),yt(dn),gt(dn,e)):yt(Rn),gt(Rn,n)}var Pr=null,Tc=!1,Iu=!1;function km(e){Pr===null?Pr=[e]:Pr.push(e)}function T3(e){Tc=!0,km(e)}function Di(){if(!Iu&&Pr!==null){Iu=!0;var e=0,t=lt;try{var n=Pr;for(lt=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}Pr=null,Tc=!1}catch(a){throw Pr!==null&&(Pr=Pr.slice(e+1)),sm(kf,Di),a}finally{lt=t,Iu=!1}}return null}var bs=[],Is=0,Xl=null,Ql=0,Kn=[],Zn=0,rs=null,Lr=1,Br="";function Wi(e,t){bs[Is++]=Ql,bs[Is++]=Xl,Xl=e,Ql=t}function Pm(e,t,n){Kn[Zn++]=Lr,Kn[Zn++]=Br,Kn[Zn++]=rs,rs=e;var i=Lr;e=Br;var a=32-ur(i)-1;i&=~(1<<a),n+=1;var l=32-ur(t)+a;if(30<l){var f=a-a%5;l=(i&(1<<f)-1).toString(32),i>>=f,a-=f,Lr=1<<32-ur(t)+a|n<<a|i,Br=l+e}else Lr=1<<l|n<<a|i,Br=e}function Wf(e){e.return!==null&&(Wi(e,1),Pm(e,1,0))}function Hf(e){for(;e===Xl;)Xl=bs[--Is],bs[Is]=null,Ql=bs[--Is],bs[Is]=null;for(;e===rs;)rs=Kn[--Zn],Kn[Zn]=null,Br=Kn[--Zn],Kn[Zn]=null,Lr=Kn[--Zn],Kn[Zn]=null}var jn=null,Bn=null,Ct=!1,cr=null;function Lm(e,t){var n=$n(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function c1(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jn=e,Bn=Ci(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jn=e,Bn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=rs!==null?{id:Lr,overflow:Br}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=$n(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,jn=e,Bn=null,!0):!1;default:return!1}}function Rd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Md(e){if(Ct){var t=Bn;if(t){var n=t;if(!c1(e,t)){if(Rd(e))throw Error(le(418));t=Ci(n.nextSibling);var i=jn;t&&c1(e,t)?Lm(i,n):(e.flags=e.flags&-4097|2,Ct=!1,jn=e)}}else{if(Rd(e))throw Error(le(418));e.flags=e.flags&-4097|2,Ct=!1,jn=e}}}function u1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jn=e}function il(e){if(e!==jn)return!1;if(!Ct)return u1(e),Ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Td(e.type,e.memoizedProps)),t&&(t=Bn)){if(Rd(e))throw Bm(),Error(le(418));for(;t;)Lm(e,t),t=Ci(t.nextSibling)}if(u1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Bn=Ci(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Bn=null}}else Bn=jn?Ci(e.stateNode.nextSibling):null;return!0}function Bm(){for(var e=Bn;e;)e=Ci(e.nextSibling)}function Gs(){Bn=jn=null,Ct=!1}function Gf(e){cr===null?cr=[e]:cr.push(e)}var b3=Kr.ReactCurrentBatchConfig;function Ro(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var i=n.stateNode}if(!i)throw Error(le(147,e));var a=i,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(f){var g=a.refs;f===null?delete g[l]:g[l]=f},t._stringRef=l,t)}if(typeof e!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,e))}return e}function sl(e,t){throw e=Object.prototype.toString.call(t),Error(le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function d1(e){var t=e._init;return t(e._payload)}function jm(e){function t(N,b){if(e){var S=N.deletions;S===null?(N.deletions=[b],N.flags|=16):S.push(b)}}function n(N,b){if(!e)return null;for(;b!==null;)t(N,b),b=b.sibling;return null}function i(N,b){for(N=new Map;b!==null;)b.key!==null?N.set(b.key,b):N.set(b.index,b),b=b.sibling;return N}function a(N,b){return N=Ai(N,b),N.index=0,N.sibling=null,N}function l(N,b,S){return N.index=S,e?(S=N.alternate,S!==null?(S=S.index,S<b?(N.flags|=2,b):S):(N.flags|=2,b)):(N.flags|=1048576,b)}function f(N){return e&&N.alternate===null&&(N.flags|=2),N}function g(N,b,S,O){return b===null||b.tag!==6?(b=ku(S,N.mode,O),b.return=N,b):(b=a(b,S),b.return=N,b)}function p(N,b,S,O){var F=S.type;return F===Cs?C(N,b,S.props.children,O,S.key):b!==null&&(b.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ci&&d1(F)===b.type)?(O=a(b,S.props),O.ref=Ro(N,b,S),O.return=N,O):(O=Rl(S.type,S.key,S.props,null,N.mode,O),O.ref=Ro(N,b,S),O.return=N,O)}function m(N,b,S,O){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=Pu(S,N.mode,O),b.return=N,b):(b=a(b,S.children||[]),b.return=N,b)}function C(N,b,S,O,F){return b===null||b.tag!==7?(b=qi(S,N.mode,O,F),b.return=N,b):(b=a(b,S),b.return=N,b)}function E(N,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=ku(""+b,N.mode,S),b.return=N,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Qa:return S=Rl(b.type,b.key,b.props,null,N.mode,S),S.ref=Ro(N,null,b),S.return=N,S;case ws:return b=Pu(b,N.mode,S),b.return=N,b;case ci:var O=b._init;return E(N,O(b._payload),S)}if(Po(b)||Ao(b))return b=qi(b,N.mode,S,null),b.return=N,b;sl(N,b)}return null}function A(N,b,S,O){var F=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return F!==null?null:g(N,b,""+S,O);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Qa:return S.key===F?p(N,b,S,O):null;case ws:return S.key===F?m(N,b,S,O):null;case ci:return F=S._init,A(N,b,F(S._payload),O)}if(Po(S)||Ao(S))return F!==null?null:C(N,b,S,O,null);sl(N,S)}return null}function M(N,b,S,O,F){if(typeof O=="string"&&O!==""||typeof O=="number")return N=N.get(S)||null,g(b,N,""+O,F);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Qa:return N=N.get(O.key===null?S:O.key)||null,p(b,N,O,F);case ws:return N=N.get(O.key===null?S:O.key)||null,m(b,N,O,F);case ci:var W=O._init;return M(N,b,S,W(O._payload),F)}if(Po(O)||Ao(O))return N=N.get(S)||null,C(b,N,O,F,null);sl(b,O)}return null}function _(N,b,S,O){for(var F=null,W=null,U=b,B=b=0,G=null;U!==null&&B<S.length;B++){U.index>B?(G=U,U=null):G=U.sibling;var te=A(N,U,S[B],O);if(te===null){U===null&&(U=G);break}e&&U&&te.alternate===null&&t(N,U),b=l(te,b,B),W===null?F=te:W.sibling=te,W=te,U=G}if(B===S.length)return n(N,U),Ct&&Wi(N,B),F;if(U===null){for(;B<S.length;B++)U=E(N,S[B],O),U!==null&&(b=l(U,b,B),W===null?F=U:W.sibling=U,W=U);return Ct&&Wi(N,B),F}for(U=i(N,U);B<S.length;B++)G=M(U,N,B,S[B],O),G!==null&&(e&&G.alternate!==null&&U.delete(G.key===null?B:G.key),b=l(G,b,B),W===null?F=G:W.sibling=G,W=G);return e&&U.forEach(function(me){return t(N,me)}),Ct&&Wi(N,B),F}function k(N,b,S,O){var F=Ao(S);if(typeof F!="function")throw Error(le(150));if(S=F.call(S),S==null)throw Error(le(151));for(var W=F=null,U=b,B=b=0,G=null,te=S.next();U!==null&&!te.done;B++,te=S.next()){U.index>B?(G=U,U=null):G=U.sibling;var me=A(N,U,te.value,O);if(me===null){U===null&&(U=G);break}e&&U&&me.alternate===null&&t(N,U),b=l(me,b,B),W===null?F=me:W.sibling=me,W=me,U=G}if(te.done)return n(N,U),Ct&&Wi(N,B),F;if(U===null){for(;!te.done;B++,te=S.next())te=E(N,te.value,O),te!==null&&(b=l(te,b,B),W===null?F=te:W.sibling=te,W=te);return Ct&&Wi(N,B),F}for(U=i(N,U);!te.done;B++,te=S.next())te=M(U,N,B,te.value,O),te!==null&&(e&&te.alternate!==null&&U.delete(te.key===null?B:te.key),b=l(te,b,B),W===null?F=te:W.sibling=te,W=te);return e&&U.forEach(function(he){return t(N,he)}),Ct&&Wi(N,B),F}function V(N,b,S,O){if(typeof S=="object"&&S!==null&&S.type===Cs&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Qa:e:{for(var F=S.key,W=b;W!==null;){if(W.key===F){if(F=S.type,F===Cs){if(W.tag===7){n(N,W.sibling),b=a(W,S.props.children),b.return=N,N=b;break e}}else if(W.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===ci&&d1(F)===W.type){n(N,W.sibling),b=a(W,S.props),b.ref=Ro(N,W,S),b.return=N,N=b;break e}n(N,W);break}else t(N,W);W=W.sibling}S.type===Cs?(b=qi(S.props.children,N.mode,O,S.key),b.return=N,N=b):(O=Rl(S.type,S.key,S.props,null,N.mode,O),O.ref=Ro(N,b,S),O.return=N,N=O)}return f(N);case ws:e:{for(W=S.key;b!==null;){if(b.key===W)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){n(N,b.sibling),b=a(b,S.children||[]),b.return=N,N=b;break e}else{n(N,b);break}else t(N,b);b=b.sibling}b=Pu(S,N.mode,O),b.return=N,N=b}return f(N);case ci:return W=S._init,V(N,b,W(S._payload),O)}if(Po(S))return _(N,b,S,O);if(Ao(S))return k(N,b,S,O);sl(N,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(n(N,b.sibling),b=a(b,S),b.return=N,N=b):(n(N,b),b=ku(S,N.mode,O),b.return=N,N=b),f(N)):n(N,b)}return V}var Ys=jm(!0),Fm=jm(!1),Kl=Mi(null),Zl=null,Ns=null,Yf=null;function Xf(){Yf=Ns=Zl=null}function Qf(e){var t=Kl.current;yt(Kl),e._currentValue=t}function Dd(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Vs(e,t){Zl=e,Yf=Ns=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(bn=!0),e.firstContext=null)}function er(e){var t=e._currentValue;if(Yf!==e)if(e={context:e,memoizedValue:t,next:null},Ns===null){if(Zl===null)throw Error(le(308));Ns=e,Zl.dependencies={lanes:0,firstContext:e}}else Ns=Ns.next=e;return t}var Xi=null;function Kf(e){Xi===null?Xi=[e]:Xi.push(e)}function Um(e,t,n,i){var a=t.interleaved;return a===null?(n.next=n,Kf(t)):(n.next=a.next,a.next=n),t.interleaved=n,Wr(e,i)}function Wr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ui=!1;function Zf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ei(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Je&2){var a=i.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),i.pending=t,Wr(e,n)}return a=i.interleaved,a===null?(t.next=t,Kf(i)):(t.next=a.next,a.next=t),i.interleaved=t,Wr(e,n)}function Sl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Pf(e,n)}}function f1(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=f:l=l.next=f,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function $l(e,t,n,i){var a=e.updateQueue;ui=!1;var l=a.firstBaseUpdate,f=a.lastBaseUpdate,g=a.shared.pending;if(g!==null){a.shared.pending=null;var p=g,m=p.next;p.next=null,f===null?l=m:f.next=m,f=p;var C=e.alternate;C!==null&&(C=C.updateQueue,g=C.lastBaseUpdate,g!==f&&(g===null?C.firstBaseUpdate=m:g.next=m,C.lastBaseUpdate=p))}if(l!==null){var E=a.baseState;f=0,C=m=p=null,g=l;do{var A=g.lane,M=g.eventTime;if((i&A)===A){C!==null&&(C=C.next={eventTime:M,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var _=e,k=g;switch(A=t,M=n,k.tag){case 1:if(_=k.payload,typeof _=="function"){E=_.call(M,E,A);break e}E=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=k.payload,A=typeof _=="function"?_.call(M,E,A):_,A==null)break e;E=It({},E,A);break e;case 2:ui=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,A=a.effects,A===null?a.effects=[g]:A.push(g))}else M={eventTime:M,lane:A,tag:g.tag,payload:g.payload,callback:g.callback,next:null},C===null?(m=C=M,p=E):C=C.next=M,f|=A;if(g=g.next,g===null){if(g=a.shared.pending,g===null)break;A=g,g=A.next,A.next=null,a.lastBaseUpdate=A,a.shared.pending=null}}while(1);if(C===null&&(p=E),a.baseState=p,a.firstBaseUpdate=m,a.lastBaseUpdate=C,t=a.shared.interleaved,t!==null){a=t;do f|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);ss|=f,e.lanes=f,e.memoizedState=E}}function h1(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(a!==null){if(i.callback=null,i=n,typeof a!="function")throw Error(le(191,a));a.call(i)}}}var Ma={},Ir=Mi(Ma),da=Mi(Ma),fa=Mi(Ma);function Qi(e){if(e===Ma)throw Error(le(174));return e}function $f(e,t){switch(gt(fa,t),gt(da,e),gt(Ir,Ma),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dd(t,e)}yt(Ir),gt(Ir,t)}function Xs(){yt(Ir),yt(da),yt(fa)}function zm(e){Qi(fa.current);var t=Qi(Ir.current),n=dd(t,e.type);t!==n&&(gt(da,e),gt(Ir,n))}function qf(e){da.current===e&&(yt(Ir),yt(da))}var St=Mi(0);function ql(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Nu=[];function Jf(){for(var e=0;e<Nu.length;e++)Nu[e]._workInProgressVersionPrimary=null;Nu.length=0}var Al=Kr.ReactCurrentDispatcher,Ru=Kr.ReactCurrentBatchConfig,is=0,Tt=null,Wt=null,Qt=null,Jl=!1,Ho=!1,ha=0,I3=0;function on(){throw Error(le(321))}function eh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!fr(e[n],t[n]))return!1;return!0}function th(e,t,n,i,a,l){if(is=l,Tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Al.current=e===null||e.memoizedState===null?D3:_3,e=n(i,a),Ho){l=0;do{if(Ho=!1,ha=0,25<=l)throw Error(le(301));l+=1,Qt=Wt=null,t.updateQueue=null,Al.current=O3,e=n(i,a)}while(Ho)}if(Al.current=ec,t=Wt!==null&&Wt.next!==null,is=0,Qt=Wt=Tt=null,Jl=!1,t)throw Error(le(300));return e}function nh(){var e=ha!==0;return ha=0,e}function Sr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qt===null?Tt.memoizedState=Qt=e:Qt=Qt.next=e,Qt}function tr(){if(Wt===null){var e=Tt.alternate;e=e!==null?e.memoizedState:null}else e=Wt.next;var t=Qt===null?Tt.memoizedState:Qt.next;if(t!==null)Qt=t,Wt=e;else{if(e===null)throw Error(le(310));Wt=e,e={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Qt===null?Tt.memoizedState=Qt=e:Qt=Qt.next=e}return Qt}function ga(e,t){return typeof t=="function"?t(e):t}function Mu(e){var t=tr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var i=Wt,a=i.baseQueue,l=n.pending;if(l!==null){if(a!==null){var f=a.next;a.next=l.next,l.next=f}i.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,i=i.baseState;var g=f=null,p=null,m=l;do{var C=m.lane;if((is&C)===C)p!==null&&(p=p.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),i=m.hasEagerState?m.eagerState:e(i,m.action);else{var E={lane:C,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};p===null?(g=p=E,f=i):p=p.next=E,Tt.lanes|=C,ss|=C}m=m.next}while(m!==null&&m!==l);p===null?f=i:p.next=g,fr(i,t.memoizedState)||(bn=!0),t.memoizedState=i,t.baseState=f,t.baseQueue=p,n.lastRenderedState=i}if(e=n.interleaved,e!==null){a=e;do l=a.lane,Tt.lanes|=l,ss|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Du(e){var t=tr(),n=t.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var f=a=a.next;do l=e(l,f.action),f=f.next;while(f!==a);fr(l,t.memoizedState)||(bn=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,i]}function Wm(){}function Hm(e,t){var n=Tt,i=tr(),a=t(),l=!fr(i.memoizedState,a);if(l&&(i.memoizedState=a,bn=!0),i=i.queue,rh(Xm.bind(null,n,i,e),[e]),i.getSnapshot!==t||l||Qt!==null&&Qt.memoizedState.tag&1){if(n.flags|=2048,pa(9,Ym.bind(null,n,i,a,t),void 0,null),Kt===null)throw Error(le(349));is&30||Gm(n,t,a)}return a}function Gm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Ym(e,t,n,i){t.value=n,t.getSnapshot=i,Qm(t)&&Km(e)}function Xm(e,t,n){return n(function(){Qm(t)&&Km(e)})}function Qm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!fr(e,n)}catch{return!0}}function Km(e){var t=Wr(e,1);t!==null&&dr(t,e,1,-1)}function g1(e){var t=Sr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:e},t.queue=e,e=e.dispatch=M3.bind(null,Tt,e),[t.memoizedState,e]}function pa(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Zm(){return tr().memoizedState}function Tl(e,t,n,i){var a=Sr();Tt.flags|=e,a.memoizedState=pa(1|t,n,void 0,i===void 0?null:i)}function bc(e,t,n,i){var a=tr();i=i===void 0?null:i;var l=void 0;if(Wt!==null){var f=Wt.memoizedState;if(l=f.destroy,i!==null&&eh(i,f.deps)){a.memoizedState=pa(t,n,l,i);return}}Tt.flags|=e,a.memoizedState=pa(1|t,n,l,i)}function p1(e,t){return Tl(8390656,8,e,t)}function rh(e,t){return bc(2048,8,e,t)}function $m(e,t){return bc(4,2,e,t)}function qm(e,t){return bc(4,4,e,t)}function Jm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ex(e,t,n){return n=n!=null?n.concat([e]):null,bc(4,4,Jm.bind(null,t,e),n)}function ih(){}function tx(e,t){var n=tr();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&eh(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function nx(e,t){var n=tr();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&eh(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function rx(e,t,n){return is&21?(fr(n,t)||(n=lm(),Tt.lanes|=n,ss|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,bn=!0),e.memoizedState=n)}function N3(e,t){var n=lt;lt=n!==0&&4>n?n:4,e(!0);var i=Ru.transition;Ru.transition={};try{e(!1),t()}finally{lt=n,Ru.transition=i}}function ix(){return tr().memoizedState}function R3(e,t,n){var i=Si(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},sx(e))ox(t,n);else if(n=Um(e,t,n,i),n!==null){var a=pn();dr(n,e,i,a),ax(n,t,i)}}function M3(e,t,n){var i=Si(e),a={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(sx(e))ox(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var f=t.lastRenderedState,g=l(f,n);if(a.hasEagerState=!0,a.eagerState=g,fr(g,f)){var p=t.interleaved;p===null?(a.next=a,Kf(t)):(a.next=p.next,p.next=a),t.interleaved=a;return}}catch{}finally{}n=Um(e,t,a,i),n!==null&&(a=pn(),dr(n,e,i,a),ax(n,t,i))}}function sx(e){var t=e.alternate;return e===Tt||t!==null&&t===Tt}function ox(e,t){Ho=Jl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ax(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Pf(e,n)}}var ec={readContext:er,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useInsertionEffect:on,useLayoutEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useMutableSource:on,useSyncExternalStore:on,useId:on,unstable_isNewReconciler:!1},D3={readContext:er,useCallback:function(e,t){return Sr().memoizedState=[e,t===void 0?null:t],e},useContext:er,useEffect:p1,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Tl(4194308,4,Jm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Tl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Tl(4,2,e,t)},useMemo:function(e,t){var n=Sr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Sr();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=R3.bind(null,Tt,e),[i.memoizedState,e]},useRef:function(e){var t=Sr();return e={current:e},t.memoizedState=e},useState:g1,useDebugValue:ih,useDeferredValue:function(e){return Sr().memoizedState=e},useTransition:function(){var e=g1(!1),t=e[0];return e=N3.bind(null,e[1]),Sr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Tt,a=Sr();if(Ct){if(n===void 0)throw Error(le(407));n=n()}else{if(n=t(),Kt===null)throw Error(le(349));is&30||Gm(i,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,p1(Xm.bind(null,i,l,e),[e]),i.flags|=2048,pa(9,Ym.bind(null,i,l,n,t),void 0,null),n},useId:function(){var e=Sr(),t=Kt.identifierPrefix;if(Ct){var n=Br,i=Lr;n=(i&~(1<<32-ur(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=ha++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=I3++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},_3={readContext:er,useCallback:tx,useContext:er,useEffect:rh,useImperativeHandle:ex,useInsertionEffect:$m,useLayoutEffect:qm,useMemo:nx,useReducer:Mu,useRef:Zm,useState:function(){return Mu(ga)},useDebugValue:ih,useDeferredValue:function(e){var t=tr();return rx(t,Wt.memoizedState,e)},useTransition:function(){var e=Mu(ga)[0],t=tr().memoizedState;return[e,t]},useMutableSource:Wm,useSyncExternalStore:Hm,useId:ix,unstable_isNewReconciler:!1},O3={readContext:er,useCallback:tx,useContext:er,useEffect:rh,useImperativeHandle:ex,useInsertionEffect:$m,useLayoutEffect:qm,useMemo:nx,useReducer:Du,useRef:Zm,useState:function(){return Du(ga)},useDebugValue:ih,useDeferredValue:function(e){var t=tr();return Wt===null?t.memoizedState=e:rx(t,Wt.memoizedState,e)},useTransition:function(){var e=Du(ga)[0],t=tr().memoizedState;return[e,t]},useMutableSource:Wm,useSyncExternalStore:Hm,useId:ix,unstable_isNewReconciler:!1};function or(e,t){if(e&&e.defaultProps){t=It({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function _d(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:It({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ic={isMounted:function(e){return(e=e._reactInternals)?ls(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=pn(),a=Si(e),l=Fr(i,a);l.payload=t,n!=null&&(l.callback=n),t=Ei(e,l,a),t!==null&&(dr(t,e,a,i),Sl(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=pn(),a=Si(e),l=Fr(i,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=Ei(e,l,a),t!==null&&(dr(t,e,a,i),Sl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pn(),i=Si(e),a=Fr(n,i);a.tag=2,t!=null&&(a.callback=t),t=Ei(e,a,i),t!==null&&(dr(t,e,i,n),Sl(t,e,i))}};function m1(e,t,n,i,a,l,f){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,l,f):t.prototype&&t.prototype.isPureReactComponent?!aa(n,i)||!aa(a,l):!0}function lx(e,t,n){var i=!1,a=bi,l=t.contextType;return typeof l=="object"&&l!==null?l=er(l):(a=Mn(t)?ns:dn.current,i=t.contextTypes,l=(i=i!=null)?Hs(e,a):bi),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ic,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function x1(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Ic.enqueueReplaceState(t,t.state,null)}function Od(e,t,n,i){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Zf(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=er(l):(l=Mn(t)?ns:dn.current,a.context=Hs(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(_d(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Ic.enqueueReplaceState(a,a.state,null),$l(e,n,a,i),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Qs(e,t){try{var n="",i=t;do n+=aC(i),i=i.return;while(i);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function _u(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function kd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var k3=typeof WeakMap=="function"?WeakMap:Map;function cx(e,t,n){n=Fr(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){nc||(nc=!0,Hd=i),kd(e,t)},n}function ux(e,t,n){n=Fr(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var a=t.value;n.payload=function(){return i(a)},n.callback=function(){kd(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){kd(e,t),typeof i!="function"&&(vi===null?vi=new Set([this]):vi.add(this));var f=t.stack;this.componentDidCatch(t.value,{componentStack:f!==null?f:""})}),n}function y1(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new k3;var a=new Set;i.set(t,a)}else a=i.get(t),a===void 0&&(a=new Set,i.set(t,a));a.has(n)||(a.add(n),e=Q3.bind(null,e,t,n),t.then(e,e))}function w1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function C1(e,t,n,i,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Fr(-1,1),t.tag=2,Ei(n,t,1))),n.lanes|=1),e)}var P3=Kr.ReactCurrentOwner,bn=!1;function hn(e,t,n,i){t.child=e===null?Fm(t,null,n,i):Ys(t,e.child,n,i)}function E1(e,t,n,i,a){n=n.render;var l=t.ref;return Vs(t,a),i=th(e,t,n,i,l,a),n=nh(),e!==null&&!bn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hr(e,t,a)):(Ct&&n&&Wf(t),t.flags|=1,hn(e,t,i,a),t.child)}function v1(e,t,n,i,a){if(e===null){var l=n.type;return typeof l=="function"&&!fh(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,dx(e,t,l,i,a)):(e=Rl(n.type,null,i,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var f=l.memoizedProps;if(n=n.compare,n=n!==null?n:aa,n(f,i)&&e.ref===t.ref)return Hr(e,t,a)}return t.flags|=1,e=Ai(l,i),e.ref=t.ref,e.return=t,t.child=e}function dx(e,t,n,i,a){if(e!==null){var l=e.memoizedProps;if(aa(l,i)&&e.ref===t.ref)if(bn=!1,t.pendingProps=i=l,(e.lanes&a)!==0)e.flags&131072&&(bn=!0);else return t.lanes=e.lanes,Hr(e,t,a)}return Pd(e,t,n,i,a)}function fx(e,t,n){var i=t.pendingProps,a=i.children,l=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(Ms,Pn),Pn|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gt(Ms,Pn),Pn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=l!==null?l.baseLanes:n,gt(Ms,Pn),Pn|=i}else l!==null?(i=l.baseLanes|n,t.memoizedState=null):i=n,gt(Ms,Pn),Pn|=i;return hn(e,t,a,n),t.child}function hx(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Pd(e,t,n,i,a){var l=Mn(n)?ns:dn.current;return l=Hs(t,l),Vs(t,a),n=th(e,t,n,i,l,a),i=nh(),e!==null&&!bn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hr(e,t,a)):(Ct&&i&&Wf(t),t.flags|=1,hn(e,t,n,a),t.child)}function S1(e,t,n,i,a){if(Mn(n)){var l=!0;Yl(t)}else l=!1;if(Vs(t,a),t.stateNode===null)bl(e,t),lx(t,n,i),Od(t,n,i,a),i=!0;else if(e===null){var f=t.stateNode,g=t.memoizedProps;f.props=g;var p=f.context,m=n.contextType;typeof m=="object"&&m!==null?m=er(m):(m=Mn(n)?ns:dn.current,m=Hs(t,m));var C=n.getDerivedStateFromProps,E=typeof C=="function"||typeof f.getSnapshotBeforeUpdate=="function";E||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==i||p!==m)&&x1(t,f,i,m),ui=!1;var A=t.memoizedState;f.state=A,$l(t,i,f,a),p=t.memoizedState,g!==i||A!==p||Rn.current||ui?(typeof C=="function"&&(_d(t,n,C,i),p=t.memoizedState),(g=ui||m1(t,n,g,i,A,p,m))?(E||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=p),f.props=i,f.state=p,f.context=m,i=g):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{f=t.stateNode,Vm(e,t),g=t.memoizedProps,m=t.type===t.elementType?g:or(t.type,g),f.props=m,E=t.pendingProps,A=f.context,p=n.contextType,typeof p=="object"&&p!==null?p=er(p):(p=Mn(n)?ns:dn.current,p=Hs(t,p));var M=n.getDerivedStateFromProps;(C=typeof M=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(g!==E||A!==p)&&x1(t,f,i,p),ui=!1,A=t.memoizedState,f.state=A,$l(t,i,f,a);var _=t.memoizedState;g!==E||A!==_||Rn.current||ui?(typeof M=="function"&&(_d(t,n,M,i),_=t.memoizedState),(m=ui||m1(t,n,m,i,A,_,p)||!1)?(C||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(i,_,p),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(i,_,p)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=_),f.props=i,f.state=_,f.context=p,i=m):(typeof f.componentDidUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&A===e.memoizedState||(t.flags|=1024),i=!1)}return Ld(e,t,n,i,l,a)}function Ld(e,t,n,i,a,l){hx(e,t);var f=(t.flags&128)!==0;if(!i&&!f)return a&&l1(t,n,!1),Hr(e,t,l);i=t.stateNode,P3.current=t;var g=f&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&f?(t.child=Ys(t,e.child,null,l),t.child=Ys(t,null,g,l)):hn(e,t,g,l),t.memoizedState=i.state,a&&l1(t,n,!0),t.child}function gx(e){var t=e.stateNode;t.pendingContext?a1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&a1(e,t.context,!1),$f(e,t.containerInfo)}function A1(e,t,n,i,a){return Gs(),Gf(a),t.flags|=256,hn(e,t,n,i),t.child}var Bd={dehydrated:null,treeContext:null,retryLane:0};function jd(e){return{baseLanes:e,cachePool:null,transitions:null}}function px(e,t,n){var i=t.pendingProps,a=St.current,l=!1,f=(t.flags&128)!==0,g;if((g=f)||(g=e!==null&&e.memoizedState===null?!1:(a&2)!==0),g?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),gt(St,a&1),e===null)return Md(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(f=i.children,e=i.fallback,l?(i=t.mode,l=t.child,f={mode:"hidden",children:f},!(i&1)&&l!==null?(l.childLanes=0,l.pendingProps=f):l=Mc(f,i,0,null),e=qi(e,i,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=jd(n),t.memoizedState=Bd,e):sh(t,f));if(a=e.memoizedState,a!==null&&(g=a.dehydrated,g!==null))return L3(e,t,f,i,g,a,n);if(l){l=i.fallback,f=t.mode,a=e.child,g=a.sibling;var p={mode:"hidden",children:i.children};return!(f&1)&&t.child!==a?(i=t.child,i.childLanes=0,i.pendingProps=p,t.deletions=null):(i=Ai(a,p),i.subtreeFlags=a.subtreeFlags&14680064),g!==null?l=Ai(g,l):(l=qi(l,f,n,null),l.flags|=2),l.return=t,i.return=t,i.sibling=l,t.child=i,i=l,l=t.child,f=e.child.memoizedState,f=f===null?jd(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},l.memoizedState=f,l.childLanes=e.childLanes&~n,t.memoizedState=Bd,i}return l=e.child,e=l.sibling,i=Ai(l,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function sh(e,t){return t=Mc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ol(e,t,n,i){return i!==null&&Gf(i),Ys(t,e.child,null,n),e=sh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function L3(e,t,n,i,a,l,f){if(n)return t.flags&256?(t.flags&=-257,i=_u(Error(le(422))),ol(e,t,f,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=i.fallback,a=t.mode,i=Mc({mode:"visible",children:i.children},a,0,null),l=qi(l,a,f,null),l.flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,t.mode&1&&Ys(t,e.child,null,f),t.child.memoizedState=jd(f),t.memoizedState=Bd,l);if(!(t.mode&1))return ol(e,t,f,null);if(a.data==="$!"){if(i=a.nextSibling&&a.nextSibling.dataset,i)var g=i.dgst;return i=g,l=Error(le(419)),i=_u(l,i,void 0),ol(e,t,f,i)}if(g=(f&e.childLanes)!==0,bn||g){if(i=Kt,i!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(i.suspendedLanes|f)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Wr(e,a),dr(i,e,a,-1))}return dh(),i=_u(Error(le(421))),ol(e,t,f,i)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=K3.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,Bn=Ci(a.nextSibling),jn=t,Ct=!0,cr=null,e!==null&&(Kn[Zn++]=Lr,Kn[Zn++]=Br,Kn[Zn++]=rs,Lr=e.id,Br=e.overflow,rs=t),t=sh(t,i.children),t.flags|=4096,t)}function T1(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),Dd(e.return,t,n)}function Ou(e,t,n,i,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=i,l.tail=n,l.tailMode=a)}function mx(e,t,n){var i=t.pendingProps,a=i.revealOrder,l=i.tail;if(hn(e,t,i.children,n),i=St.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&T1(e,n,t);else if(e.tag===19)T1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(gt(St,i),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&ql(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ou(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&ql(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ou(t,!0,n,null,l);break;case"together":Ou(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function bl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ss|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(le(153));if(t.child!==null){for(e=t.child,n=Ai(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ai(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function B3(e,t,n){switch(t.tag){case 3:gx(t),Gs();break;case 5:zm(t);break;case 1:Mn(t.type)&&Yl(t);break;case 4:$f(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;gt(Kl,i._currentValue),i._currentValue=a;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(gt(St,St.current&1),t.flags|=128,null):n&t.child.childLanes?px(e,t,n):(gt(St,St.current&1),e=Hr(e,t,n),e!==null?e.sibling:null);gt(St,St.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return mx(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),gt(St,St.current),i)break;return null;case 22:case 23:return t.lanes=0,fx(e,t,n)}return Hr(e,t,n)}var xx,Fd,yx,wx;xx=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Fd=function(){};yx=function(e,t,n,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,Qi(Ir.current);var l=null;switch(n){case"input":a=ad(e,a),i=ad(e,i),l=[];break;case"select":a=It({},a,{value:void 0}),i=It({},i,{value:void 0}),l=[];break;case"textarea":a=ud(e,a),i=ud(e,i),l=[];break;default:typeof a.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=Hl)}fd(n,i);var f;n=null;for(m in a)if(!i.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var g=a[m];for(f in g)g.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(ea.hasOwnProperty(m)?l||(l=[]):(l=l||[]).push(m,null));for(m in i){var p=i[m];if(g=a!=null?a[m]:void 0,i.hasOwnProperty(m)&&p!==g&&(p!=null||g!=null))if(m==="style")if(g){for(f in g)!g.hasOwnProperty(f)||p&&p.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in p)p.hasOwnProperty(f)&&g[f]!==p[f]&&(n||(n={}),n[f]=p[f])}else n||(l||(l=[]),l.push(m,n)),n=p;else m==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,g=g?g.__html:void 0,p!=null&&g!==p&&(l=l||[]).push(m,p)):m==="children"?typeof p!="string"&&typeof p!="number"||(l=l||[]).push(m,""+p):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(ea.hasOwnProperty(m)?(p!=null&&m==="onScroll"&&mt("scroll",e),l||g===p||(l=[])):(l=l||[]).push(m,p))}n&&(l=l||[]).push("style",n);var m=l;(t.updateQueue=m)&&(t.flags|=4)}};wx=function(e,t,n,i){n!==i&&(t.flags|=4)};function Mo(e,t){if(!Ct)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function an(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags&14680064,i|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function j3(e,t,n){var i=t.pendingProps;switch(Hf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(t),null;case 1:return Mn(t.type)&&Gl(),an(t),null;case 3:return i=t.stateNode,Xs(),yt(Rn),yt(dn),Jf(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(il(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,cr!==null&&(Xd(cr),cr=null))),Fd(e,t),an(t),null;case 5:qf(t);var a=Qi(fa.current);if(n=t.type,e!==null&&t.stateNode!=null)yx(e,t,n,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(le(166));return an(t),null}if(e=Qi(Ir.current),il(t)){i=t.stateNode,n=t.type;var l=t.memoizedProps;switch(i[Tr]=t,i[ua]=l,e=(t.mode&1)!==0,n){case"dialog":mt("cancel",i),mt("close",i);break;case"iframe":case"object":case"embed":mt("load",i);break;case"video":case"audio":for(a=0;a<Bo.length;a++)mt(Bo[a],i);break;case"source":mt("error",i);break;case"img":case"image":case"link":mt("error",i),mt("load",i);break;case"details":mt("toggle",i);break;case"input":k0(i,l),mt("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!l.multiple},mt("invalid",i);break;case"textarea":L0(i,l),mt("invalid",i)}fd(n,l),a=null;for(var f in l)if(l.hasOwnProperty(f)){var g=l[f];f==="children"?typeof g=="string"?i.textContent!==g&&(l.suppressHydrationWarning!==!0&&rl(i.textContent,g,e),a=["children",g]):typeof g=="number"&&i.textContent!==""+g&&(l.suppressHydrationWarning!==!0&&rl(i.textContent,g,e),a=["children",""+g]):ea.hasOwnProperty(f)&&g!=null&&f==="onScroll"&&mt("scroll",i)}switch(n){case"input":Ka(i),P0(i,l,!0);break;case"textarea":Ka(i),B0(i);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(i.onclick=Hl)}i=a,t.updateQueue=i,i!==null&&(t.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=f.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=f.createElement(n,{is:i.is}):(e=f.createElement(n),n==="select"&&(f=e,i.multiple?f.multiple=!0:i.size&&(f.size=i.size))):e=f.createElementNS(e,n),e[Tr]=t,e[ua]=i,xx(e,t,!1,!1),t.stateNode=e;e:{switch(f=hd(n,i),n){case"dialog":mt("cancel",e),mt("close",e),a=i;break;case"iframe":case"object":case"embed":mt("load",e),a=i;break;case"video":case"audio":for(a=0;a<Bo.length;a++)mt(Bo[a],e);a=i;break;case"source":mt("error",e),a=i;break;case"img":case"image":case"link":mt("error",e),mt("load",e),a=i;break;case"details":mt("toggle",e),a=i;break;case"input":k0(e,i),a=ad(e,i),mt("invalid",e);break;case"option":a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=It({},i,{value:void 0}),mt("invalid",e);break;case"textarea":L0(e,i),a=ud(e,i),mt("invalid",e);break;default:a=i}fd(n,a),g=a;for(l in g)if(g.hasOwnProperty(l)){var p=g[l];l==="style"?Zp(e,p):l==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&Qp(e,p)):l==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&ta(e,p):typeof p=="number"&&ta(e,""+p):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ea.hasOwnProperty(l)?p!=null&&l==="onScroll"&&mt("scroll",e):p!=null&&Rf(e,l,p,f))}switch(n){case"input":Ka(e),P0(e,i,!1);break;case"textarea":Ka(e),B0(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Ti(i.value));break;case"select":e.multiple=!!i.multiple,l=i.value,l!=null?Bs(e,!!i.multiple,l,!1):i.defaultValue!=null&&Bs(e,!!i.multiple,i.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Hl)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return an(t),null;case 6:if(e&&t.stateNode!=null)wx(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(le(166));if(n=Qi(fa.current),Qi(Ir.current),il(t)){if(i=t.stateNode,n=t.memoizedProps,i[Tr]=t,(l=i.nodeValue!==n)&&(e=jn,e!==null))switch(e.tag){case 3:rl(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&rl(i.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Tr]=t,t.stateNode=i}return an(t),null;case 13:if(yt(St),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ct&&Bn!==null&&t.mode&1&&!(t.flags&128))Bm(),Gs(),t.flags|=98560,l=!1;else if(l=il(t),i!==null&&i.dehydrated!==null){if(e===null){if(!l)throw Error(le(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(le(317));l[Tr]=t}else Gs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;an(t),l=!1}else cr!==null&&(Xd(cr),cr=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||St.current&1?Ht===0&&(Ht=3):dh())),t.updateQueue!==null&&(t.flags|=4),an(t),null);case 4:return Xs(),Fd(e,t),e===null&&la(t.stateNode.containerInfo),an(t),null;case 10:return Qf(t.type._context),an(t),null;case 17:return Mn(t.type)&&Gl(),an(t),null;case 19:if(yt(St),l=t.memoizedState,l===null)return an(t),null;if(i=(t.flags&128)!==0,f=l.rendering,f===null)if(i)Mo(l,!1);else{if(Ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(f=ql(e),f!==null){for(t.flags|=128,Mo(l,!1),i=f.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)l=n,e=i,l.flags&=14680066,f=l.alternate,f===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,e=f.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return gt(St,St.current&1|2),t.child}e=e.sibling}l.tail!==null&&Bt()>Ks&&(t.flags|=128,i=!0,Mo(l,!1),t.lanes=4194304)}else{if(!i)if(e=ql(f),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Mo(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!Ct)return an(t),null}else 2*Bt()-l.renderingStartTime>Ks&&n!==1073741824&&(t.flags|=128,i=!0,Mo(l,!1),t.lanes=4194304);l.isBackwards?(f.sibling=t.child,t.child=f):(n=l.last,n!==null?n.sibling=f:t.child=f,l.last=f)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Bt(),t.sibling=null,n=St.current,gt(St,i?n&1|2:n&1),t):(an(t),null);case 22:case 23:return uh(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Pn&1073741824&&(an(t),t.subtreeFlags&6&&(t.flags|=8192)):an(t),null;case 24:return null;case 25:return null}throw Error(le(156,t.tag))}function F3(e,t){switch(Hf(t),t.tag){case 1:return Mn(t.type)&&Gl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xs(),yt(Rn),yt(dn),Jf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return qf(t),null;case 13:if(yt(St),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(le(340));Gs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yt(St),null;case 4:return Xs(),null;case 10:return Qf(t.type._context),null;case 22:case 23:return uh(),null;case 24:return null;default:return null}}var al=!1,cn=!1,U3=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Rs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ot(e,t,i)}else n.current=null}function Ud(e,t,n){try{n()}catch(i){Ot(e,t,i)}}var b1=!1;function V3(e,t){if(Sd=Vl,e=Am(),zf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var a=i.anchorOffset,l=i.focusNode;i=i.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var f=0,g=-1,p=-1,m=0,C=0,E=e,A=null;t:for(;;){for(var M;E!==n||a!==0&&E.nodeType!==3||(g=f+a),E!==l||i!==0&&E.nodeType!==3||(p=f+i),E.nodeType===3&&(f+=E.nodeValue.length),(M=E.firstChild)!==null;)A=E,E=M;for(;;){if(E===e)break t;if(A===n&&++m===a&&(g=f),A===l&&++C===i&&(p=f),(M=E.nextSibling)!==null)break;E=A,A=E.parentNode}E=M}n=g===-1||p===-1?null:{start:g,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ad={focusedElem:e,selectionRange:n},Vl=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var _=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var k=_.memoizedProps,V=_.memoizedState,N=t.stateNode,b=N.getSnapshotBeforeUpdate(t.elementType===t.type?k:or(t.type,k),V);N.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=t.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(O){Ot(t,t.return,O)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return _=b1,b1=!1,_}function Go(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&Ud(t,n,l)}a=a.next}while(a!==i)}}function Nc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function Vd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Cx(e){var t=e.alternate;t!==null&&(e.alternate=null,Cx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Tr],delete t[ua],delete t[Id],delete t[S3],delete t[A3])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ex(e){return e.tag===5||e.tag===3||e.tag===4}function I1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ex(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function zd(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Hl));else if(i!==4&&(e=e.child,e!==null))for(zd(e,t,n),e=e.sibling;e!==null;)zd(e,t,n),e=e.sibling}function Wd(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(Wd(e,t,n),e=e.sibling;e!==null;)Wd(e,t,n),e=e.sibling}var en=null,ar=!1;function oi(e,t,n){for(n=n.child;n!==null;)vx(e,t,n),n=n.sibling}function vx(e,t,n){if(br&&typeof br.onCommitFiberUnmount=="function")try{br.onCommitFiberUnmount(Cc,n)}catch{}switch(n.tag){case 5:cn||Rs(n,t);case 6:var i=en,a=ar;en=null,oi(e,t,n),en=i,ar=a,en!==null&&(ar?(e=en,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):en.removeChild(n.stateNode));break;case 18:en!==null&&(ar?(e=en,n=n.stateNode,e.nodeType===8?bu(e.parentNode,n):e.nodeType===1&&bu(e,n),sa(e)):bu(en,n.stateNode));break;case 4:i=en,a=ar,en=n.stateNode.containerInfo,ar=!0,oi(e,t,n),en=i,ar=a;break;case 0:case 11:case 14:case 15:if(!cn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){a=i=i.next;do{var l=a,f=l.destroy;l=l.tag,f!==void 0&&(l&2||l&4)&&Ud(n,t,f),a=a.next}while(a!==i)}oi(e,t,n);break;case 1:if(!cn&&(Rs(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(g){Ot(n,t,g)}oi(e,t,n);break;case 21:oi(e,t,n);break;case 22:n.mode&1?(cn=(i=cn)||n.memoizedState!==null,oi(e,t,n),cn=i):oi(e,t,n);break;default:oi(e,t,n)}}function N1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new U3),t.forEach(function(i){var a=Z3.bind(null,e,i);n.has(i)||(n.add(i),i.then(a,a))})}}function ir(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var a=n[i];try{var l=e,f=t,g=f;e:for(;g!==null;){switch(g.tag){case 5:en=g.stateNode,ar=!1;break e;case 3:en=g.stateNode.containerInfo,ar=!0;break e;case 4:en=g.stateNode.containerInfo,ar=!0;break e}g=g.return}if(en===null)throw Error(le(160));vx(l,f,a),en=null,ar=!1;var p=a.alternate;p!==null&&(p.return=null),a.return=null}catch(m){Ot(a,t,m)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Sx(t,e),t=t.sibling}function Sx(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ir(t,e),vr(e),i&4){try{Go(3,e,e.return),Nc(3,e)}catch(k){Ot(e,e.return,k)}try{Go(5,e,e.return)}catch(k){Ot(e,e.return,k)}}break;case 1:ir(t,e),vr(e),i&512&&n!==null&&Rs(n,n.return);break;case 5:if(ir(t,e),vr(e),i&512&&n!==null&&Rs(n,n.return),e.flags&32){var a=e.stateNode;try{ta(a,"")}catch(k){Ot(e,e.return,k)}}if(i&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,f=n!==null?n.memoizedProps:l,g=e.type,p=e.updateQueue;if(e.updateQueue=null,p!==null)try{g==="input"&&l.type==="radio"&&l.name!=null&&Gp(a,l),hd(g,f);var m=hd(g,l);for(f=0;f<p.length;f+=2){var C=p[f],E=p[f+1];C==="style"?Zp(a,E):C==="dangerouslySetInnerHTML"?Qp(a,E):C==="children"?ta(a,E):Rf(a,C,E,m)}switch(g){case"input":ld(a,l);break;case"textarea":Yp(a,l);break;case"select":var A=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var M=l.value;M!=null?Bs(a,!!l.multiple,M,!1):A!==!!l.multiple&&(l.defaultValue!=null?Bs(a,!!l.multiple,l.defaultValue,!0):Bs(a,!!l.multiple,l.multiple?[]:"",!1))}a[ua]=l}catch(k){Ot(e,e.return,k)}}break;case 6:if(ir(t,e),vr(e),i&4){if(e.stateNode===null)throw Error(le(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(k){Ot(e,e.return,k)}}break;case 3:if(ir(t,e),vr(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{sa(t.containerInfo)}catch(k){Ot(e,e.return,k)}break;case 4:ir(t,e),vr(e);break;case 13:ir(t,e),vr(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(lh=Bt())),i&4&&N1(e);break;case 22:if(C=n!==null&&n.memoizedState!==null,e.mode&1?(cn=(m=cn)||C,ir(t,e),cn=m):ir(t,e),vr(e),i&8192){if(m=e.memoizedState!==null,(e.stateNode.isHidden=m)&&!C&&e.mode&1)for(Ee=e,C=e.child;C!==null;){for(E=Ee=C;Ee!==null;){switch(A=Ee,M=A.child,A.tag){case 0:case 11:case 14:case 15:Go(4,A,A.return);break;case 1:Rs(A,A.return);var _=A.stateNode;if(typeof _.componentWillUnmount=="function"){i=A,n=A.return;try{t=i,_.props=t.memoizedProps,_.state=t.memoizedState,_.componentWillUnmount()}catch(k){Ot(i,n,k)}}break;case 5:Rs(A,A.return);break;case 22:if(A.memoizedState!==null){M1(E);continue}}M!==null?(M.return=A,Ee=M):M1(E)}C=C.sibling}e:for(C=null,E=e;;){if(E.tag===5){if(C===null){C=E;try{a=E.stateNode,m?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(g=E.stateNode,p=E.memoizedProps.style,f=p!=null&&p.hasOwnProperty("display")?p.display:null,g.style.display=Kp("display",f))}catch(k){Ot(e,e.return,k)}}}else if(E.tag===6){if(C===null)try{E.stateNode.nodeValue=m?"":E.memoizedProps}catch(k){Ot(e,e.return,k)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===e)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===e)break e;for(;E.sibling===null;){if(E.return===null||E.return===e)break e;C===E&&(C=null),E=E.return}C===E&&(C=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:ir(t,e),vr(e),i&4&&N1(e);break;case 21:break;default:ir(t,e),vr(e)}}function vr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ex(n)){var i=n;break e}n=n.return}throw Error(le(160))}switch(i.tag){case 5:var a=i.stateNode;i.flags&32&&(ta(a,""),i.flags&=-33);var l=I1(e);Wd(e,l,a);break;case 3:case 4:var f=i.stateNode.containerInfo,g=I1(e);zd(e,g,f);break;default:throw Error(le(161))}}catch(p){Ot(e,e.return,p)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function z3(e,t,n){Ee=e,Ax(e)}function Ax(e,t,n){for(var i=(e.mode&1)!==0;Ee!==null;){var a=Ee,l=a.child;if(a.tag===22&&i){var f=a.memoizedState!==null||al;if(!f){var g=a.alternate,p=g!==null&&g.memoizedState!==null||cn;g=al;var m=cn;if(al=f,(cn=p)&&!m)for(Ee=a;Ee!==null;)f=Ee,p=f.child,f.tag===22&&f.memoizedState!==null?D1(a):p!==null?(p.return=f,Ee=p):D1(a);for(;l!==null;)Ee=l,Ax(l),l=l.sibling;Ee=a,al=g,cn=m}R1(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,Ee=l):R1(e)}}function R1(e){for(;Ee!==null;){var t=Ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:cn||Nc(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!cn)if(n===null)i.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:or(t.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&h1(t,l,i);break;case 3:var f=t.updateQueue;if(f!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}h1(t,f,n)}break;case 5:var g=t.stateNode;if(n===null&&t.flags&4){n=g;var p=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var m=t.alternate;if(m!==null){var C=m.memoizedState;if(C!==null){var E=C.dehydrated;E!==null&&sa(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}cn||t.flags&512&&Vd(t)}catch(A){Ot(t,t.return,A)}}if(t===e){Ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,Ee=n;break}Ee=t.return}}function M1(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Ee=n;break}Ee=t.return}}function D1(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Nc(4,t)}catch(p){Ot(t,n,p)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var a=t.return;try{i.componentDidMount()}catch(p){Ot(t,a,p)}}var l=t.return;try{Vd(t)}catch(p){Ot(t,l,p)}break;case 5:var f=t.return;try{Vd(t)}catch(p){Ot(t,f,p)}}}catch(p){Ot(t,t.return,p)}if(t===e){Ee=null;break}var g=t.sibling;if(g!==null){g.return=t.return,Ee=g;break}Ee=t.return}}var W3=Math.ceil,tc=Kr.ReactCurrentDispatcher,oh=Kr.ReactCurrentOwner,qn=Kr.ReactCurrentBatchConfig,Je=0,Kt=null,jt=null,nn=0,Pn=0,Ms=Mi(0),Ht=0,ma=null,ss=0,Rc=0,ah=0,Yo=null,Tn=null,lh=0,Ks=1/0,kr=null,nc=!1,Hd=null,vi=null,ll=!1,gi=null,rc=0,Xo=0,Gd=null,Il=-1,Nl=0;function pn(){return Je&6?Bt():Il!==-1?Il:Il=Bt()}function Si(e){return e.mode&1?Je&2&&nn!==0?nn&-nn:b3.transition!==null?(Nl===0&&(Nl=lm()),Nl):(e=lt,e!==0||(e=window.event,e=e===void 0?16:pm(e.type)),e):1}function dr(e,t,n,i){if(50<Xo)throw Xo=0,Gd=null,Error(le(185));Ia(e,n,i),(!(Je&2)||e!==Kt)&&(e===Kt&&(!(Je&2)&&(Rc|=n),Ht===4&&fi(e,nn)),Dn(e,i),n===1&&Je===0&&!(t.mode&1)&&(Ks=Bt()+500,Tc&&Di()))}function Dn(e,t){var n=e.callbackNode;bC(e,t);var i=Ul(e,e===Kt?nn:0);if(i===0)n!==null&&U0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&U0(n),t===1)e.tag===0?T3(_1.bind(null,e)):km(_1.bind(null,e)),E3(function(){!(Je&6)&&Di()}),n=null;else{switch(cm(i)){case 1:n=kf;break;case 4:n=om;break;case 16:n=Fl;break;case 536870912:n=am;break;default:n=Fl}n=_x(n,Tx.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Tx(e,t){if(Il=-1,Nl=0,Je&6)throw Error(le(327));var n=e.callbackNode;if(zs()&&e.callbackNode!==n)return null;var i=Ul(e,e===Kt?nn:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=ic(e,i);else{t=i;var a=Je;Je|=2;var l=Ix();(Kt!==e||nn!==t)&&(kr=null,Ks=Bt()+500,$i(e,t));do try{Y3();break}catch(g){bx(e,g)}while(1);Xf(),tc.current=l,Je=a,jt!==null?t=0:(Kt=null,nn=0,t=Ht)}if(t!==0){if(t===2&&(a=yd(e),a!==0&&(i=a,t=Yd(e,a))),t===1)throw n=ma,$i(e,0),fi(e,i),Dn(e,Bt()),n;if(t===6)fi(e,i);else{if(a=e.current.alternate,!(i&30)&&!H3(a)&&(t=ic(e,i),t===2&&(l=yd(e),l!==0&&(i=l,t=Yd(e,l))),t===1))throw n=ma,$i(e,0),fi(e,i),Dn(e,Bt()),n;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(le(345));case 2:Hi(e,Tn,kr);break;case 3:if(fi(e,i),(i&130023424)===i&&(t=lh+500-Bt(),10<t)){if(Ul(e,0)!==0)break;if(a=e.suspendedLanes,(a&i)!==i){pn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=bd(Hi.bind(null,e,Tn,kr),t);break}Hi(e,Tn,kr);break;case 4:if(fi(e,i),(i&4194240)===i)break;for(t=e.eventTimes,a=-1;0<i;){var f=31-ur(i);l=1<<f,f=t[f],f>a&&(a=f),i&=~l}if(i=a,i=Bt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*W3(i/1960))-i,10<i){e.timeoutHandle=bd(Hi.bind(null,e,Tn,kr),i);break}Hi(e,Tn,kr);break;case 5:Hi(e,Tn,kr);break;default:throw Error(le(329))}}}return Dn(e,Bt()),e.callbackNode===n?Tx.bind(null,e):null}function Yd(e,t){var n=Yo;return e.current.memoizedState.isDehydrated&&($i(e,t).flags|=256),e=ic(e,t),e!==2&&(t=Tn,Tn=n,t!==null&&Xd(t)),e}function Xd(e){Tn===null?Tn=e:Tn.push.apply(Tn,e)}function H3(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var a=n[i],l=a.getSnapshot;a=a.value;try{if(!fr(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fi(e,t){for(t&=~ah,t&=~Rc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ur(t),i=1<<n;e[n]=-1,t&=~i}}function _1(e){if(Je&6)throw Error(le(327));zs();var t=Ul(e,0);if(!(t&1))return Dn(e,Bt()),null;var n=ic(e,t);if(e.tag!==0&&n===2){var i=yd(e);i!==0&&(t=i,n=Yd(e,i))}if(n===1)throw n=ma,$i(e,0),fi(e,t),Dn(e,Bt()),n;if(n===6)throw Error(le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Hi(e,Tn,kr),Dn(e,Bt()),null}function ch(e,t){var n=Je;Je|=1;try{return e(t)}finally{Je=n,Je===0&&(Ks=Bt()+500,Tc&&Di())}}function os(e){gi!==null&&gi.tag===0&&!(Je&6)&&zs();var t=Je;Je|=1;var n=qn.transition,i=lt;try{if(qn.transition=null,lt=1,e)return e()}finally{lt=i,qn.transition=n,Je=t,!(Je&6)&&Di()}}function uh(){Pn=Ms.current,yt(Ms)}function $i(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,C3(n)),jt!==null)for(n=jt.return;n!==null;){var i=n;switch(Hf(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Gl();break;case 3:Xs(),yt(Rn),yt(dn),Jf();break;case 5:qf(i);break;case 4:Xs();break;case 13:yt(St);break;case 19:yt(St);break;case 10:Qf(i.type._context);break;case 22:case 23:uh()}n=n.return}if(Kt=e,jt=e=Ai(e.current,null),nn=Pn=t,Ht=0,ma=null,ah=Rc=ss=0,Tn=Yo=null,Xi!==null){for(t=0;t<Xi.length;t++)if(n=Xi[t],i=n.interleaved,i!==null){n.interleaved=null;var a=i.next,l=n.pending;if(l!==null){var f=l.next;l.next=a,i.next=f}n.pending=i}Xi=null}return e}function bx(e,t){do{var n=jt;try{if(Xf(),Al.current=ec,Jl){for(var i=Tt.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}Jl=!1}if(is=0,Qt=Wt=Tt=null,Ho=!1,ha=0,oh.current=null,n===null||n.return===null){Ht=1,ma=t,jt=null;break}e:{var l=e,f=n.return,g=n,p=t;if(t=nn,g.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var m=p,C=g,E=C.tag;if(!(C.mode&1)&&(E===0||E===11||E===15)){var A=C.alternate;A?(C.updateQueue=A.updateQueue,C.memoizedState=A.memoizedState,C.lanes=A.lanes):(C.updateQueue=null,C.memoizedState=null)}var M=w1(f);if(M!==null){M.flags&=-257,C1(M,f,g,l,t),M.mode&1&&y1(l,m,t),t=M,p=m;var _=t.updateQueue;if(_===null){var k=new Set;k.add(p),t.updateQueue=k}else _.add(p);break e}else{if(!(t&1)){y1(l,m,t),dh();break e}p=Error(le(426))}}else if(Ct&&g.mode&1){var V=w1(f);if(V!==null){!(V.flags&65536)&&(V.flags|=256),C1(V,f,g,l,t),Gf(Qs(p,g));break e}}l=p=Qs(p,g),Ht!==4&&(Ht=2),Yo===null?Yo=[l]:Yo.push(l),l=f;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var N=cx(l,p,t);f1(l,N);break e;case 1:g=p;var b=l.type,S=l.stateNode;if(!(l.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(vi===null||!vi.has(S)))){l.flags|=65536,t&=-t,l.lanes|=t;var O=ux(l,g,t);f1(l,O);break e}}l=l.return}while(l!==null)}Rx(n)}catch(F){t=F,jt===n&&n!==null&&(jt=n=n.return);continue}break}while(1)}function Ix(){var e=tc.current;return tc.current=ec,e===null?ec:e}function dh(){(Ht===0||Ht===3||Ht===2)&&(Ht=4),Kt===null||!(ss&268435455)&&!(Rc&268435455)||fi(Kt,nn)}function ic(e,t){var n=Je;Je|=2;var i=Ix();(Kt!==e||nn!==t)&&(kr=null,$i(e,t));do try{G3();break}catch(a){bx(e,a)}while(1);if(Xf(),Je=n,tc.current=i,jt!==null)throw Error(le(261));return Kt=null,nn=0,Ht}function G3(){for(;jt!==null;)Nx(jt)}function Y3(){for(;jt!==null&&!xC();)Nx(jt)}function Nx(e){var t=Dx(e.alternate,e,Pn);e.memoizedProps=e.pendingProps,t===null?Rx(e):jt=t,oh.current=null}function Rx(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=F3(n,t),n!==null){n.flags&=32767,jt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ht=6,jt=null;return}}else if(n=j3(n,t,Pn),n!==null){jt=n;return}if(t=t.sibling,t!==null){jt=t;return}jt=t=e}while(t!==null);Ht===0&&(Ht=5)}function Hi(e,t,n){var i=lt,a=qn.transition;try{qn.transition=null,lt=1,X3(e,t,n,i)}finally{qn.transition=a,lt=i}return null}function X3(e,t,n,i){do zs();while(gi!==null);if(Je&6)throw Error(le(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(le(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(IC(e,l),e===Kt&&(jt=Kt=null,nn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ll||(ll=!0,_x(Fl,function(){return zs(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=qn.transition,qn.transition=null;var f=lt;lt=1;var g=Je;Je|=4,oh.current=null,V3(e,n),Sx(n,e),h3(Ad),Vl=!!Sd,Ad=Sd=null,e.current=n,z3(n),yC(),Je=g,lt=f,qn.transition=l}else e.current=n;if(ll&&(ll=!1,gi=e,rc=a),l=e.pendingLanes,l===0&&(vi=null),EC(n.stateNode),Dn(e,Bt()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],i(a.value,{componentStack:a.stack,digest:a.digest});if(nc)throw nc=!1,e=Hd,Hd=null,e;return rc&1&&e.tag!==0&&zs(),l=e.pendingLanes,l&1?e===Gd?Xo++:(Xo=0,Gd=e):Xo=0,Di(),null}function zs(){if(gi!==null){var e=cm(rc),t=qn.transition,n=lt;try{if(qn.transition=null,lt=16>e?16:e,gi===null)var i=!1;else{if(e=gi,gi=null,rc=0,Je&6)throw Error(le(331));var a=Je;for(Je|=4,Ee=e.current;Ee!==null;){var l=Ee,f=l.child;if(Ee.flags&16){var g=l.deletions;if(g!==null){for(var p=0;p<g.length;p++){var m=g[p];for(Ee=m;Ee!==null;){var C=Ee;switch(C.tag){case 0:case 11:case 15:Go(8,C,l)}var E=C.child;if(E!==null)E.return=C,Ee=E;else for(;Ee!==null;){C=Ee;var A=C.sibling,M=C.return;if(Cx(C),C===m){Ee=null;break}if(A!==null){A.return=M,Ee=A;break}Ee=M}}}var _=l.alternate;if(_!==null){var k=_.child;if(k!==null){_.child=null;do{var V=k.sibling;k.sibling=null,k=V}while(k!==null)}}Ee=l}}if(l.subtreeFlags&2064&&f!==null)f.return=l,Ee=f;else e:for(;Ee!==null;){if(l=Ee,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Go(9,l,l.return)}var N=l.sibling;if(N!==null){N.return=l.return,Ee=N;break e}Ee=l.return}}var b=e.current;for(Ee=b;Ee!==null;){f=Ee;var S=f.child;if(f.subtreeFlags&2064&&S!==null)S.return=f,Ee=S;else e:for(f=b;Ee!==null;){if(g=Ee,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Nc(9,g)}}catch(F){Ot(g,g.return,F)}if(g===f){Ee=null;break e}var O=g.sibling;if(O!==null){O.return=g.return,Ee=O;break e}Ee=g.return}}if(Je=a,Di(),br&&typeof br.onPostCommitFiberRoot=="function")try{br.onPostCommitFiberRoot(Cc,e)}catch{}i=!0}return i}finally{lt=n,qn.transition=t}}return!1}function O1(e,t,n){t=Qs(n,t),t=cx(e,t,1),e=Ei(e,t,1),t=pn(),e!==null&&(Ia(e,1,t),Dn(e,t))}function Ot(e,t,n){if(e.tag===3)O1(e,e,n);else for(;t!==null;){if(t.tag===3){O1(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(vi===null||!vi.has(i))){e=Qs(n,e),e=ux(t,e,1),t=Ei(t,e,1),e=pn(),t!==null&&(Ia(t,1,e),Dn(t,e));break}}t=t.return}}function Q3(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=pn(),e.pingedLanes|=e.suspendedLanes&n,Kt===e&&(nn&n)===n&&(Ht===4||Ht===3&&(nn&130023424)===nn&&500>Bt()-lh?$i(e,0):ah|=n),Dn(e,t)}function Mx(e,t){t===0&&(e.mode&1?(t=qa,qa<<=1,!(qa&130023424)&&(qa=4194304)):t=1);var n=pn();e=Wr(e,t),e!==null&&(Ia(e,t,n),Dn(e,n))}function K3(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Mx(e,n)}function Z3(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(le(314))}i!==null&&i.delete(t),Mx(e,n)}var Dx;Dx=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Rn.current)bn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return bn=!1,B3(e,t,n);bn=!!(e.flags&131072)}else bn=!1,Ct&&t.flags&1048576&&Pm(t,Ql,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;bl(e,t),e=t.pendingProps;var a=Hs(t,dn.current);Vs(t,n),a=th(null,t,i,e,a,n);var l=nh();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mn(i)?(l=!0,Yl(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Zf(t),a.updater=Ic,t.stateNode=a,a._reactInternals=t,Od(t,i,e,n),t=Ld(null,t,i,!0,l,n)):(t.tag=0,Ct&&l&&Wf(t),hn(null,t,a,n),t=t.child),t;case 16:i=t.elementType;e:{switch(bl(e,t),e=t.pendingProps,a=i._init,i=a(i._payload),t.type=i,a=t.tag=q3(i),e=or(i,e),a){case 0:t=Pd(null,t,i,e,n);break e;case 1:t=S1(null,t,i,e,n);break e;case 11:t=E1(null,t,i,e,n);break e;case 14:t=v1(null,t,i,or(i.type,e),n);break e}throw Error(le(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:or(i,a),Pd(e,t,i,a,n);case 1:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:or(i,a),S1(e,t,i,a,n);case 3:e:{if(gx(t),e===null)throw Error(le(387));i=t.pendingProps,l=t.memoizedState,a=l.element,Vm(e,t),$l(t,i,null,n);var f=t.memoizedState;if(i=f.element,l.isDehydrated)if(l={element:i,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=Qs(Error(le(423)),t),t=A1(e,t,i,n,a);break e}else if(i!==a){a=Qs(Error(le(424)),t),t=A1(e,t,i,n,a);break e}else for(Bn=Ci(t.stateNode.containerInfo.firstChild),jn=t,Ct=!0,cr=null,n=Fm(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gs(),i===a){t=Hr(e,t,n);break e}hn(e,t,i,n)}t=t.child}return t;case 5:return zm(t),e===null&&Md(t),i=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,f=a.children,Td(i,a)?f=null:l!==null&&Td(i,l)&&(t.flags|=32),hx(e,t),hn(e,t,f,n),t.child;case 6:return e===null&&Md(t),null;case 13:return px(e,t,n);case 4:return $f(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Ys(t,null,i,n):hn(e,t,i,n),t.child;case 11:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:or(i,a),E1(e,t,i,a,n);case 7:return hn(e,t,t.pendingProps,n),t.child;case 8:return hn(e,t,t.pendingProps.children,n),t.child;case 12:return hn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,l=t.memoizedProps,f=a.value,gt(Kl,i._currentValue),i._currentValue=f,l!==null)if(fr(l.value,f)){if(l.children===a.children&&!Rn.current){t=Hr(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var g=l.dependencies;if(g!==null){f=l.child;for(var p=g.firstContext;p!==null;){if(p.context===i){if(l.tag===1){p=Fr(-1,n&-n),p.tag=2;var m=l.updateQueue;if(m!==null){m=m.shared;var C=m.pending;C===null?p.next=p:(p.next=C.next,C.next=p),m.pending=p}}l.lanes|=n,p=l.alternate,p!==null&&(p.lanes|=n),Dd(l.return,n,t),g.lanes|=n;break}p=p.next}}else if(l.tag===10)f=l.type===t.type?null:l.child;else if(l.tag===18){if(f=l.return,f===null)throw Error(le(341));f.lanes|=n,g=f.alternate,g!==null&&(g.lanes|=n),Dd(f,n,t),f=l.sibling}else f=l.child;if(f!==null)f.return=l;else for(f=l;f!==null;){if(f===t){f=null;break}if(l=f.sibling,l!==null){l.return=f.return,f=l;break}f=f.return}l=f}hn(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,Vs(t,n),a=er(a),i=i(a),t.flags|=1,hn(e,t,i,n),t.child;case 14:return i=t.type,a=or(i,t.pendingProps),a=or(i.type,a),v1(e,t,i,a,n);case 15:return dx(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:or(i,a),bl(e,t),t.tag=1,Mn(i)?(e=!0,Yl(t)):e=!1,Vs(t,n),lx(t,i,a),Od(t,i,a,n),Ld(null,t,i,!0,e,n);case 19:return mx(e,t,n);case 22:return fx(e,t,n)}throw Error(le(156,t.tag))};function _x(e,t){return sm(e,t)}function $3(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(e,t,n,i){return new $3(e,t,n,i)}function fh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function q3(e){if(typeof e=="function")return fh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Df)return 11;if(e===_f)return 14}return 2}function Ai(e,t){var n=e.alternate;return n===null?(n=$n(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,i,a,l){var f=2;if(i=e,typeof e=="function")fh(e)&&(f=1);else if(typeof e=="string")f=5;else e:switch(e){case Cs:return qi(n.children,a,l,t);case Mf:f=8,a|=8;break;case rd:return e=$n(12,n,t,a|2),e.elementType=rd,e.lanes=l,e;case id:return e=$n(13,n,t,a),e.elementType=id,e.lanes=l,e;case sd:return e=$n(19,n,t,a),e.elementType=sd,e.lanes=l,e;case zp:return Mc(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Up:f=10;break e;case Vp:f=9;break e;case Df:f=11;break e;case _f:f=14;break e;case ci:f=16,i=null;break e}throw Error(le(130,e==null?e:typeof e,""))}return t=$n(f,n,t,a),t.elementType=e,t.type=i,t.lanes=l,t}function qi(e,t,n,i){return e=$n(7,e,i,t),e.lanes=n,e}function Mc(e,t,n,i){return e=$n(22,e,i,t),e.elementType=zp,e.lanes=n,e.stateNode={isHidden:!1},e}function ku(e,t,n){return e=$n(6,e,null,t),e.lanes=n,e}function Pu(e,t,n){return t=$n(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function J3(e,t,n,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pu(0),this.expirationTimes=pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pu(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function hh(e,t,n,i,a,l,f,g,p){return e=new J3(e,t,n,g,p),t===1?(t=1,l===!0&&(t|=8)):t=0,l=$n(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zf(l),e}function eE(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ws,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Ox(e){if(!e)return bi;e=e._reactInternals;e:{if(ls(e)!==e||e.tag!==1)throw Error(le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(le(171))}if(e.tag===1){var n=e.type;if(Mn(n))return Om(e,n,t)}return t}function kx(e,t,n,i,a,l,f,g,p){return e=hh(n,i,!0,e,a,l,f,g,p),e.context=Ox(null),n=e.current,i=pn(),a=Si(n),l=Fr(i,a),l.callback=t??null,Ei(n,l,a),e.current.lanes=a,Ia(e,a,i),Dn(e,i),e}function Dc(e,t,n,i){var a=t.current,l=pn(),f=Si(a);return n=Ox(n),t.context===null?t.context=n:t.pendingContext=n,t=Fr(l,f),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Ei(a,t,f),e!==null&&(dr(e,a,f,l),Sl(e,a,f)),f}function sc(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function k1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function gh(e,t){k1(e,t),(e=e.alternate)&&k1(e,t)}function tE(){return null}var Px=typeof reportError=="function"?reportError:function(e){console.error(e)};function ph(e){this._internalRoot=e}_c.prototype.render=ph.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(le(409));Dc(e,t,null,null)};_c.prototype.unmount=ph.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;os(function(){Dc(null,e,null,null)}),t[zr]=null}};function _c(e){this._internalRoot=e}_c.prototype.unstable_scheduleHydration=function(e){if(e){var t=fm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<di.length&&t!==0&&t<di[n].priority;n++);di.splice(n,0,e),n===0&&gm(e)}};function mh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function P1(){}function nE(e,t,n,i,a){if(a){if(typeof i=="function"){var l=i;i=function(){var m=sc(f);l.call(m)}}var f=kx(t,i,e,0,null,!1,!1,"",P1);return e._reactRootContainer=f,e[zr]=f.current,la(e.nodeType===8?e.parentNode:e),os(),f}for(;a=e.lastChild;)e.removeChild(a);if(typeof i=="function"){var g=i;i=function(){var m=sc(p);g.call(m)}}var p=hh(e,0,!1,null,null,!1,!1,"",P1);return e._reactRootContainer=p,e[zr]=p.current,la(e.nodeType===8?e.parentNode:e),os(function(){Dc(t,p,n,i)}),p}function kc(e,t,n,i,a){var l=n._reactRootContainer;if(l){var f=l;if(typeof a=="function"){var g=a;a=function(){var p=sc(f);g.call(p)}}Dc(t,f,e,a)}else f=nE(n,t,e,a,i);return sc(f)}um=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Lo(t.pendingLanes);n!==0&&(Pf(t,n|1),Dn(t,Bt()),!(Je&6)&&(Ks=Bt()+500,Di()))}break;case 13:os(function(){var i=Wr(e,1);if(i!==null){var a=pn();dr(i,e,1,a)}}),gh(e,1)}};Lf=function(e){if(e.tag===13){var t=Wr(e,134217728);if(t!==null){var n=pn();dr(t,e,134217728,n)}gh(e,134217728)}};dm=function(e){if(e.tag===13){var t=Si(e),n=Wr(e,t);if(n!==null){var i=pn();dr(n,e,t,i)}gh(e,t)}};fm=function(){return lt};hm=function(e,t){var n=lt;try{return lt=e,t()}finally{lt=n}};pd=function(e,t,n){switch(t){case"input":if(ld(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=Ac(i);if(!a)throw Error(le(90));Hp(i),ld(i,a)}}}break;case"textarea":Yp(e,n);break;case"select":t=n.value,t!=null&&Bs(e,!!n.multiple,t,!1)}};Jp=ch;em=os;var rE={usingClientEntryPoint:!1,Events:[Ra,As,Ac,$p,qp,ch]},Do={findFiberByHostInstance:Yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iE={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Kr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=rm(e),e===null?null:e.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||tE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cl.isDisabled&&cl.supportsFiber)try{Cc=cl.inject(iE),br=cl}catch{}}Un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rE;Un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mh(t))throw Error(le(200));return eE(e,t,null,n)};Un.createRoot=function(e,t){if(!mh(e))throw Error(le(299));var n=!1,i="",a=Px;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=hh(e,1,!1,null,null,n,!1,i,a),e[zr]=t.current,la(e.nodeType===8?e.parentNode:e),new ph(t)};Un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(le(188)):(e=Object.keys(e).join(","),Error(le(268,e)));return e=rm(t),e=e===null?null:e.stateNode,e};Un.flushSync=function(e){return os(e)};Un.hydrate=function(e,t,n){if(!Oc(t))throw Error(le(200));return kc(null,e,t,!0,n)};Un.hydrateRoot=function(e,t,n){if(!mh(e))throw Error(le(405));var i=n!=null&&n.hydratedSources||null,a=!1,l="",f=Px;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),t=kx(t,null,e,1,n??null,a,!1,l,f),e[zr]=t.current,la(e),i)for(e=0;e<i.length;e++)n=i[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new _c(t)};Un.render=function(e,t,n){if(!Oc(t))throw Error(le(200));return kc(null,e,t,!1,n)};Un.unmountComponentAtNode=function(e){if(!Oc(e))throw Error(le(40));return e._reactRootContainer?(os(function(){kc(null,null,e,!1,function(){e._reactRootContainer=null,e[zr]=null})}),!0):!1};Un.unstable_batchedUpdates=ch;Un.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Oc(n))throw Error(le(200));if(e==null||e._reactInternals===void 0)throw Error(le(38));return kc(e,t,n,!1,i)};Un.version="18.3.1-next-f1338f8080-20240426";function Lx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Lx)}catch(e){console.error(e)}}Lx(),Lp.exports=Un;var sE=Lp.exports,Bx,L1=sE;Bx=L1.createRoot,L1.hydrateRoot;const oE="modulepreload",aE=function(e){return"/"+e},B1={},lE=function(t,n,i){if(!n||n.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(n.map(l=>{if(l=aE(l),l in B1)return;B1[l]=!0;const f=l.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(!!i)for(let C=a.length-1;C>=0;C--){const E=a[C];if(E.href===l&&(!f||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${g}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":oE,f||(m.as="script",m.crossOrigin=""),m.href=l,document.head.appendChild(m),f)return new Promise((C,E)=>{m.addEventListener("load",C),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t()).catch(l=>{const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=l,window.dispatchEvent(f),!f.defaultPrevented)throw l})};var xh={};Object.defineProperty(xh,"__esModule",{value:!0});xh.parse=pE;xh.serialize=mE;const cE=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,uE=/^[\u0021-\u003A\u003C-\u007E]*$/,dE=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,fE=/^[\u0020-\u003A\u003D-\u007E]*$/,hE=Object.prototype.toString,gE=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function pE(e,t){const n=new gE,i=e.length;if(i<2)return n;const a=(t==null?void 0:t.decode)||xE;let l=0;do{const f=e.indexOf("=",l);if(f===-1)break;const g=e.indexOf(";",l),p=g===-1?i:g;if(f>p){l=e.lastIndexOf(";",f-1)+1;continue}const m=j1(e,l,f),C=F1(e,f,m),E=e.slice(m,C);if(n[E]===void 0){let A=j1(e,f+1,p),M=F1(e,p,A);const _=a(e.slice(A,M));n[E]=_}l=p+1}while(l<i);return n}function j1(e,t,n){do{const i=e.charCodeAt(t);if(i!==32&&i!==9)return t}while(++t<n);return n}function F1(e,t,n){for(;t>n;){const i=e.charCodeAt(--t);if(i!==32&&i!==9)return t+1}return n}function mE(e,t,n){const i=(n==null?void 0:n.encode)||encodeURIComponent;if(!cE.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=i(t);if(!uE.test(a))throw new TypeError(`argument val is invalid: ${t}`);let l=e+"="+a;if(!n)return l;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);l+="; Max-Age="+n.maxAge}if(n.domain){if(!dE.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);l+="; Domain="+n.domain}if(n.path){if(!fE.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);l+="; Path="+n.path}if(n.expires){if(!yE(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);l+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(l+="; HttpOnly"),n.secure&&(l+="; Secure"),n.partitioned&&(l+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":l+="; Priority=Low";break;case"medium":l+="; Priority=Medium";break;case"high":l+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":l+="; SameSite=Strict";break;case"lax":l+="; SameSite=Lax";break;case"none":l+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return l}function xE(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function yE(e){return hE.call(e)==="[object Date]"}var U1="popstate";function wE(e={}){function t(i,a){let{pathname:l,search:f,hash:g}=i.location;return Qd("",{pathname:l,search:f,hash:g},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:xa(a)}return EE(t,n,null,e)}function Et(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hr(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function CE(){return Math.random().toString(36).substring(2,10)}function V1(e,t){return{usr:e.state,key:e.key,idx:t}}function Qd(e,t,n=null,i){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ao(t):t,state:n,key:t&&t.key||i||CE()}}function xa({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ao(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function EE(e,t,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,f=a.history,g="POP",p=null,m=C();m==null&&(m=0,f.replaceState({...f.state,idx:m},""));function C(){return(f.state||{idx:null}).idx}function E(){g="POP";let V=C(),N=V==null?null:V-m;m=V,p&&p({action:g,location:k.location,delta:N})}function A(V,N){g="PUSH";let b=Qd(k.location,V,N);n&&n(b,V),m=C()+1;let S=V1(b,m),O=k.createHref(b);try{f.pushState(S,"",O)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(O)}l&&p&&p({action:g,location:k.location,delta:1})}function M(V,N){g="REPLACE";let b=Qd(k.location,V,N);n&&n(b,V),m=C();let S=V1(b,m),O=k.createHref(b);f.replaceState(S,"",O),l&&p&&p({action:g,location:k.location,delta:0})}function _(V){return vE(V)}let k={get action(){return g},get location(){return e(a,f)},listen(V){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(U1,E),p=V,()=>{a.removeEventListener(U1,E),p=null}},createHref(V){return t(a,V)},createURL:_,encodeLocation(V){let N=_(V);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:A,replace:M,go(V){return f.go(V)}};return k}function vE(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Et(n,"No window.location.(origin|href) available to create URL");let i=typeof e=="string"?e:xa(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function jx(e,t,n="/"){return SE(e,t,n,!1)}function SE(e,t,n,i){let a=typeof t=="string"?ao(t):t,l=Gr(a.pathname||"/",n);if(l==null)return null;let f=Fx(e);AE(f);let g=null;for(let p=0;g==null&&p<f.length;++p){let m=PE(l);g=OE(f[p],m,i)}return g}function Fx(e,t=[],n=[],i=""){let a=(l,f,g)=>{let p={relativePath:g===void 0?l.path||"":g,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};p.relativePath.startsWith("/")&&(Et(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length));let m=Ur([i,p.relativePath]),C=n.concat(p);l.children&&l.children.length>0&&(Et(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),Fx(l.children,t,C,m)),!(l.path==null&&!l.index)&&t.push({path:m,score:DE(m,l.index),routesMeta:C})};return e.forEach((l,f)=>{var g;if(l.path===""||!((g=l.path)!=null&&g.includes("?")))a(l,f);else for(let p of Ux(l.path))a(l,f,p)}),t}function Ux(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let f=Ux(i.join("/")),g=[];return g.push(...f.map(p=>p===""?l:[l,p].join("/"))),a&&g.push(...f),g.map(p=>e.startsWith("/")&&p===""?"/":p)}function AE(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:_E(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var TE=/^:[\w-]+$/,bE=3,IE=2,NE=1,RE=10,ME=-2,z1=e=>e==="*";function DE(e,t){let n=e.split("/"),i=n.length;return n.some(z1)&&(i+=ME),t&&(i+=IE),n.filter(a=>!z1(a)).reduce((a,l)=>a+(TE.test(l)?bE:l===""?NE:RE),i)}function _E(e,t){return e.length===t.length&&e.slice(0,-1).every((i,a)=>i===t[a])?e[e.length-1]-t[t.length-1]:0}function OE(e,t,n=!1){let{routesMeta:i}=e,a={},l="/",f=[];for(let g=0;g<i.length;++g){let p=i[g],m=g===i.length-1,C=l==="/"?t:t.slice(l.length)||"/",E=oc({path:p.relativePath,caseSensitive:p.caseSensitive,end:m},C),A=p.route;if(!E&&m&&n&&!i[i.length-1].route.index&&(E=oc({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},C)),!E)return null;Object.assign(a,E.params),f.push({params:a,pathname:Ur([l,E.pathname]),pathnameBase:FE(Ur([l,E.pathnameBase])),route:A}),E.pathnameBase!=="/"&&(l=Ur([l,E.pathnameBase]))}return f}function oc(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=kE(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let l=a[0],f=l.replace(/(.)\/+$/,"$1"),g=a.slice(1);return{params:i.reduce((m,{paramName:C,isOptional:E},A)=>{if(C==="*"){let _=g[A]||"";f=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const M=g[A];return E&&!M?m[C]=void 0:m[C]=(M||"").replace(/%2F/g,"/"),m},{}),pathname:l,pathnameBase:f,pattern:e}}function kE(e,t=!1,n=!0){hr(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,g,p)=>(i.push({paramName:g,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function PE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hr(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Gr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function LE(e,t="/"){let{pathname:n,search:i="",hash:a=""}=typeof e=="string"?ao(e):e;return{pathname:n?n.startsWith("/")?n:BE(n,t):t,search:UE(i),hash:VE(a)}}function BE(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Lu(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function jE(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function yh(e){let t=jE(e);return t.map((n,i)=>i===t.length-1?n.pathname:n.pathnameBase)}function wh(e,t,n,i=!1){let a;typeof e=="string"?a=ao(e):(a={...e},Et(!a.pathname||!a.pathname.includes("?"),Lu("?","pathname","search",a)),Et(!a.pathname||!a.pathname.includes("#"),Lu("#","pathname","hash",a)),Et(!a.search||!a.search.includes("#"),Lu("#","search","hash",a)));let l=e===""||a.pathname==="",f=l?"/":a.pathname,g;if(f==null)g=n;else{let E=t.length-1;if(!i&&f.startsWith("..")){let A=f.split("/");for(;A[0]==="..";)A.shift(),E-=1;a.pathname=A.join("/")}g=E>=0?t[E]:"/"}let p=LE(a,g),m=f&&f!=="/"&&f.endsWith("/"),C=(l||f===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(m||C)&&(p.pathname+="/"),p}var Ur=e=>e.join("/").replace(/\/\/+/g,"/"),FE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),UE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function zE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Vx=["POST","PUT","PATCH","DELETE"];new Set(Vx);var WE=["GET",...Vx];new Set(WE);var lo=R.createContext(null);lo.displayName="DataRouter";var Pc=R.createContext(null);Pc.displayName="DataRouterState";var zx=R.createContext({isTransitioning:!1});zx.displayName="ViewTransition";var HE=R.createContext(new Map);HE.displayName="Fetchers";var GE=R.createContext(null);GE.displayName="Await";var gr=R.createContext(null);gr.displayName="Navigation";var Da=R.createContext(null);Da.displayName="Location";var Dr=R.createContext({outlet:null,matches:[],isDataRoute:!1});Dr.displayName="Route";var Ch=R.createContext(null);Ch.displayName="RouteError";function YE(e,{relative:t}={}){Et(co(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=R.useContext(gr),{hash:a,pathname:l,search:f}=_a(e,{relative:t}),g=l;return n!=="/"&&(g=l==="/"?n:Ur([n,l])),i.createHref({pathname:g,search:f,hash:a})}function co(){return R.useContext(Da)!=null}function _r(){return Et(co(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(Da).location}var Wx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Hx(e){R.useContext(gr).static||R.useLayoutEffect(e)}function Zr(){let{isDataRoute:e}=R.useContext(Dr);return e?sv():XE()}function XE(){Et(co(),"useNavigate() may be used only in the context of a <Router> component.");let e=R.useContext(lo),{basename:t,navigator:n}=R.useContext(gr),{matches:i}=R.useContext(Dr),{pathname:a}=_r(),l=JSON.stringify(yh(i)),f=R.useRef(!1);return Hx(()=>{f.current=!0}),R.useCallback((p,m={})=>{if(hr(f.current,Wx),!f.current)return;if(typeof p=="number"){n.go(p);return}let C=wh(p,JSON.parse(l),a,m.relative==="path");e==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:Ur([t,C.pathname])),(m.replace?n.replace:n.push)(C,m.state,m)},[t,n,l,a,e])}R.createContext(null);function _a(e,{relative:t}={}){let{matches:n}=R.useContext(Dr),{pathname:i}=_r(),a=JSON.stringify(yh(n));return R.useMemo(()=>wh(e,JSON.parse(a),i,t==="path"),[e,a,i,t])}function QE(e,t){return Gx(e,t)}function Gx(e,t,n,i){var N;Et(co(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=R.useContext(gr),{matches:l}=R.useContext(Dr),f=l[l.length-1],g=f?f.params:{},p=f?f.pathname:"/",m=f?f.pathnameBase:"/",C=f&&f.route;{let b=C&&C.path||"";Yx(p,!C||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let E=_r(),A;if(t){let b=typeof t=="string"?ao(t):t;Et(m==="/"||((N=b.pathname)==null?void 0:N.startsWith(m)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${b.pathname}" was given in the \`location\` prop.`),A=b}else A=E;let M=A.pathname||"/",_=M;if(m!=="/"){let b=m.replace(/^\//,"").split("/");_="/"+M.replace(/^\//,"").split("/").slice(b.length).join("/")}let k=jx(e,{pathname:_});hr(C||k!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),hr(k==null||k[k.length-1].route.element!==void 0||k[k.length-1].route.Component!==void 0||k[k.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let V=JE(k&&k.map(b=>Object.assign({},b,{params:Object.assign({},g,b.params),pathname:Ur([m,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?m:Ur([m,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,n,i);return t&&V?R.createElement(Da.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},V):V}function KE(){let e=iv(),t=zE(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},f=null;return console.error("Error handled by React Router default ErrorBoundary:",e),f=R.createElement(R.Fragment,null,R.createElement("p",null,"💿 Hey developer 👋"),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:l},"ErrorBoundary")," or"," ",R.createElement("code",{style:l},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},t),n?R.createElement("pre",{style:a},n):null,f)}var ZE=R.createElement(KE,null),$E=class extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?R.createElement(Dr.Provider,{value:this.props.routeContext},R.createElement(Ch.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function qE({routeContext:e,match:t,children:n}){let i=R.useContext(lo);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),R.createElement(Dr.Provider,{value:e},n)}function JE(e,t=[],n=null,i=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,l=n==null?void 0:n.errors;if(l!=null){let p=a.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);Et(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,p+1))}let f=!1,g=-1;if(n)for(let p=0;p<a.length;p++){let m=a[p];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(g=p),m.route.id){let{loaderData:C,errors:E}=n,A=m.route.loader&&!C.hasOwnProperty(m.route.id)&&(!E||E[m.route.id]===void 0);if(m.route.lazy||A){f=!0,g>=0?a=a.slice(0,g+1):a=[a[0]];break}}}return a.reduceRight((p,m,C)=>{let E,A=!1,M=null,_=null;n&&(E=l&&m.route.id?l[m.route.id]:void 0,M=m.route.errorElement||ZE,f&&(g<0&&C===0?(Yx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,_=null):g===C&&(A=!0,_=m.route.hydrateFallbackElement||null)));let k=t.concat(a.slice(0,C+1)),V=()=>{let N;return E?N=M:A?N=_:m.route.Component?N=R.createElement(m.route.Component,null):m.route.element?N=m.route.element:N=p,R.createElement(qE,{match:m,routeContext:{outlet:p,matches:k,isDataRoute:n!=null},children:N})};return n&&(m.route.ErrorBoundary||m.route.errorElement||C===0)?R.createElement($E,{location:n.location,revalidation:n.revalidation,component:M,error:E,children:V(),routeContext:{outlet:null,matches:k,isDataRoute:!0}}):V()},null)}function Eh(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ev(e){let t=R.useContext(lo);return Et(t,Eh(e)),t}function tv(e){let t=R.useContext(Pc);return Et(t,Eh(e)),t}function nv(e){let t=R.useContext(Dr);return Et(t,Eh(e)),t}function vh(e){let t=nv(e),n=t.matches[t.matches.length-1];return Et(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function rv(){return vh("useRouteId")}function iv(){var i;let e=R.useContext(Ch),t=tv("useRouteError"),n=vh("useRouteError");return e!==void 0?e:(i=t.errors)==null?void 0:i[n]}function sv(){let{router:e}=ev("useNavigate"),t=vh("useNavigate"),n=R.useRef(!1);return Hx(()=>{n.current=!0}),R.useCallback(async(a,l={})=>{hr(n.current,Wx),n.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...l}))},[e,t])}var W1={};function Yx(e,t,n){!t&&!W1[e]&&(W1[e]=!0,hr(!1,n))}R.memo(ov);function ov({routes:e,future:t,state:n}){return Gx(e,void 0,n,t)}function ac({to:e,replace:t,state:n,relative:i}){Et(co(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=R.useContext(gr);hr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=R.useContext(Dr),{pathname:f}=_r(),g=Zr(),p=wh(e,yh(l),f,i==="path"),m=JSON.stringify(p);return R.useEffect(()=>{g(JSON.parse(m),{replace:t,state:n,relative:i})},[g,m,i,t,n]),null}function An(e){Et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function av({basename:e="/",children:t=null,location:n,navigationType:i="POP",navigator:a,static:l=!1}){Et(!co(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=e.replace(/^\/*/,"/"),g=R.useMemo(()=>({basename:f,navigator:a,static:l,future:{}}),[f,a,l]);typeof n=="string"&&(n=ao(n));let{pathname:p="/",search:m="",hash:C="",state:E=null,key:A="default"}=n,M=R.useMemo(()=>{let _=Gr(p,f);return _==null?null:{location:{pathname:_,search:m,hash:C,state:E,key:A},navigationType:i}},[f,p,m,C,E,A,i]);return hr(M!=null,`<Router basename="${f}"> is not able to match the URL "${p}${m}${C}" because it does not start with the basename, so the <Router> won't render anything.`),M==null?null:R.createElement(gr.Provider,{value:g},R.createElement(Da.Provider,{children:t,value:M}))}function lv({children:e,location:t}){return QE(Kd(e),t)}function Kd(e,t=[]){let n=[];return R.Children.forEach(e,(i,a)=>{if(!R.isValidElement(i))return;let l=[...t,a];if(i.type===R.Fragment){n.push.apply(n,Kd(i.props.children,l));return}Et(i.type===An,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Et(!i.props.index||!i.props.children,"An index route cannot have child routes.");let f={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(f.children=Kd(i.props.children,l)),n.push(f)}),n}var Ml="get",Dl="application/x-www-form-urlencoded";function Lc(e){return e!=null&&typeof e.tagName=="string"}function cv(e){return Lc(e)&&e.tagName.toLowerCase()==="button"}function uv(e){return Lc(e)&&e.tagName.toLowerCase()==="form"}function dv(e){return Lc(e)&&e.tagName.toLowerCase()==="input"}function fv(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function hv(e,t){return e.button===0&&(!t||t==="_self")&&!fv(e)}var ul=null;function gv(){if(ul===null)try{new FormData(document.createElement("form"),0),ul=!1}catch{ul=!0}return ul}var pv=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Bu(e){return e!=null&&!pv.has(e)?(hr(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dl}"`),null):e}function mv(e,t){let n,i,a,l,f;if(uv(e)){let g=e.getAttribute("action");i=g?Gr(g,t):null,n=e.getAttribute("method")||Ml,a=Bu(e.getAttribute("enctype"))||Dl,l=new FormData(e)}else if(cv(e)||dv(e)&&(e.type==="submit"||e.type==="image")){let g=e.form;if(g==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=e.getAttribute("formaction")||g.getAttribute("action");if(i=p?Gr(p,t):null,n=e.getAttribute("formmethod")||g.getAttribute("method")||Ml,a=Bu(e.getAttribute("formenctype"))||Bu(g.getAttribute("enctype"))||Dl,l=new FormData(g,e),!gv()){let{name:m,type:C,value:E}=e;if(C==="image"){let A=m?`${m}.`:"";l.append(`${A}x`,"0"),l.append(`${A}y`,"0")}else m&&l.append(m,E)}}else{if(Lc(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ml,i=null,a=Dl,f=e}return l&&a==="text/plain"&&(f=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:f}}function Sh(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function xv(e,t){if(e.id in t)return t[e.id];try{let n=await lE(()=>import(e.module),[]);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yv(e){return e!=null&&typeof e.page=="string"}function wv(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Cv(e,t,n){let i=await Promise.all(e.map(async a=>{let l=t.routes[a.route.id];if(l){let f=await xv(l,n);return f.links?f.links():[]}return[]}));return Av(i.flat(1).filter(wv).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function H1(e,t,n,i,a,l){let f=(p,m)=>n[m]?p.route.id!==n[m].route.id:!0,g=(p,m)=>{var C;return n[m].pathname!==p.pathname||((C=n[m].route.path)==null?void 0:C.endsWith("*"))&&n[m].params["*"]!==p.params["*"]};return l==="assets"?t.filter((p,m)=>f(p,m)||g(p,m)):l==="data"?t.filter((p,m)=>{var E;let C=i.routes[p.route.id];if(!C||!C.hasLoader)return!1;if(f(p,m)||g(p,m))return!0;if(p.route.shouldRevalidate){let A=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((E=n[0])==null?void 0:E.params)||{},nextUrl:new URL(e,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function Ev(e,t,{includeHydrateFallback:n}={}){return vv(e.map(i=>{let a=t.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function vv(e){return[...new Set(e)]}function Sv(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}function Av(e,t){let n=new Set,i=new Set(t);return e.reduce((a,l)=>{if(t&&!yv(l)&&l.as==="script"&&l.href&&i.has(l.href))return a;let g=JSON.stringify(Sv(l));return n.has(g)||(n.add(g),a.push({key:g,link:l})),a},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Tv=new Set([100,101,204,205]);function bv(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Gr(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function Xx(){let e=R.useContext(lo);return Sh(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Iv(){let e=R.useContext(Pc);return Sh(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Ah=R.createContext(void 0);Ah.displayName="FrameworkContext";function Qx(){let e=R.useContext(Ah);return Sh(e,"You must render this element inside a <HydratedRouter> element"),e}function Nv(e,t){let n=R.useContext(Ah),[i,a]=R.useState(!1),[l,f]=R.useState(!1),{onFocus:g,onBlur:p,onMouseEnter:m,onMouseLeave:C,onTouchStart:E}=t,A=R.useRef(null);R.useEffect(()=>{if(e==="render"&&f(!0),e==="viewport"){let k=N=>{N.forEach(b=>{f(b.isIntersecting)})},V=new IntersectionObserver(k,{threshold:.5});return A.current&&V.observe(A.current),()=>{V.disconnect()}}},[e]),R.useEffect(()=>{if(i){let k=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(k)}}},[i]);let M=()=>{a(!0)},_=()=>{a(!1),f(!1)};return n?e!=="intent"?[l,A,{}]:[l,A,{onFocus:_o(g,M),onBlur:_o(p,_),onMouseEnter:_o(m,M),onMouseLeave:_o(C,_),onTouchStart:_o(E,M)}]:[!1,A,{}]}function _o(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Rv({page:e,...t}){let{router:n}=Xx(),i=R.useMemo(()=>jx(n.routes,e,n.basename),[n.routes,e,n.basename]);return i?R.createElement(Dv,{page:e,matches:i,...t}):null}function Mv(e){let{manifest:t,routeModules:n}=Qx(),[i,a]=R.useState([]);return R.useEffect(()=>{let l=!1;return Cv(e,t,n).then(f=>{l||a(f)}),()=>{l=!0}},[e,t,n]),i}function Dv({page:e,matches:t,...n}){let i=_r(),{manifest:a,routeModules:l}=Qx(),{basename:f}=Xx(),{loaderData:g,matches:p}=Iv(),m=R.useMemo(()=>H1(e,t,p,a,i,"data"),[e,t,p,a,i]),C=R.useMemo(()=>H1(e,t,p,a,i,"assets"),[e,t,p,a,i]),E=R.useMemo(()=>{if(e===i.pathname+i.search+i.hash)return[];let _=new Set,k=!1;if(t.forEach(N=>{var S;let b=a.routes[N.route.id];!b||!b.hasLoader||(!m.some(O=>O.route.id===N.route.id)&&N.route.id in g&&((S=l[N.route.id])!=null&&S.shouldRevalidate)||b.hasClientLoader?k=!0:_.add(N.route.id))}),_.size===0)return[];let V=bv(e,f);return k&&_.size>0&&V.searchParams.set("_routes",t.filter(N=>_.has(N.route.id)).map(N=>N.route.id).join(",")),[V.pathname+V.search]},[f,g,i,a,m,t,e,l]),A=R.useMemo(()=>Ev(C,a),[C,a]),M=Mv(C);return R.createElement(R.Fragment,null,E.map(_=>R.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),A.map(_=>R.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),M.map(({key:_,link:k})=>R.createElement("link",{key:_,...k})))}function _v(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var Kx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Kx&&(window.__reactRouterVersion="7.6.2")}catch{}function Ov({basename:e,children:t,window:n}){let i=R.useRef();i.current==null&&(i.current=wE({window:n,v5Compat:!0}));let a=i.current,[l,f]=R.useState({action:a.action,location:a.location}),g=R.useCallback(p=>{R.startTransition(()=>f(p))},[f]);return R.useLayoutEffect(()=>a.listen(g),[a,g]),R.createElement(av,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:a})}var Zx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Th=R.forwardRef(function({onClick:t,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:f,state:g,target:p,to:m,preventScrollReset:C,viewTransition:E,...A},M){let{basename:_}=R.useContext(gr),k=typeof m=="string"&&Zx.test(m),V,N=!1;if(typeof m=="string"&&k&&(V=m,Kx))try{let G=new URL(window.location.href),te=m.startsWith("//")?new URL(G.protocol+m):new URL(m),me=Gr(te.pathname,_);te.origin===G.origin&&me!=null?m=me+te.search+te.hash:N=!0}catch{hr(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=YE(m,{relative:a}),[S,O,F]=Nv(i,A),W=Bv(m,{replace:f,state:g,target:p,preventScrollReset:C,relative:a,viewTransition:E});function U(G){t&&t(G),G.defaultPrevented||W(G)}let B=R.createElement("a",{...A,...F,href:V||b,onClick:N||l?t:U,ref:_v(M,O),target:p,"data-discover":!k&&n==="render"?"true":void 0});return S&&!k?R.createElement(R.Fragment,null,B,R.createElement(Rv,{page:b})):B});Th.displayName="Link";var kv=R.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:f,viewTransition:g,children:p,...m},C){let E=_a(f,{relative:m.relative}),A=_r(),M=R.useContext(Pc),{navigator:_,basename:k}=R.useContext(gr),V=M!=null&&zv(E)&&g===!0,N=_.encodeLocation?_.encodeLocation(E).pathname:E.pathname,b=A.pathname,S=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;n||(b=b.toLowerCase(),S=S?S.toLowerCase():null,N=N.toLowerCase()),S&&k&&(S=Gr(S,k)||S);const O=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let F=b===N||!a&&b.startsWith(N)&&b.charAt(O)==="/",W=S!=null&&(S===N||!a&&S.startsWith(N)&&S.charAt(N.length)==="/"),U={isActive:F,isPending:W,isTransitioning:V},B=F?t:void 0,G;typeof i=="function"?G=i(U):G=[i,F?"active":null,W?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let te=typeof l=="function"?l(U):l;return R.createElement(Th,{...m,"aria-current":B,className:G,ref:C,style:te,to:f,viewTransition:g},typeof p=="function"?p(U):p)});kv.displayName="NavLink";var Pv=R.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:i,replace:a,state:l,method:f=Ml,action:g,onSubmit:p,relative:m,preventScrollReset:C,viewTransition:E,...A},M)=>{let _=Uv(),k=Vv(g,{relative:m}),V=f.toLowerCase()==="get"?"get":"post",N=typeof g=="string"&&Zx.test(g),b=S=>{if(p&&p(S),S.defaultPrevented)return;S.preventDefault();let O=S.nativeEvent.submitter,F=(O==null?void 0:O.getAttribute("formmethod"))||f;_(O||S.currentTarget,{fetcherKey:t,method:F,navigate:n,replace:a,state:l,relative:m,preventScrollReset:C,viewTransition:E})};return R.createElement("form",{ref:M,method:V,action:k,onSubmit:i?p:b,...A,"data-discover":!N&&e==="render"?"true":void 0})});Pv.displayName="Form";function Lv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $x(e){let t=R.useContext(lo);return Et(t,Lv(e)),t}function Bv(e,{target:t,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:f}={}){let g=Zr(),p=_r(),m=_a(e,{relative:l});return R.useCallback(C=>{if(hv(C,t)){C.preventDefault();let E=n!==void 0?n:xa(p)===xa(m);g(e,{replace:E,state:i,preventScrollReset:a,relative:l,viewTransition:f})}},[p,g,m,n,i,t,e,a,l,f])}var jv=0,Fv=()=>`__${String(++jv)}__`;function Uv(){let{router:e}=$x("useSubmit"),{basename:t}=R.useContext(gr),n=rv();return R.useCallback(async(i,a={})=>{let{action:l,method:f,encType:g,formData:p,body:m}=mv(i,t);if(a.navigate===!1){let C=a.fetcherKey||Fv();await e.fetch(C,n,a.action||l,{preventScrollReset:a.preventScrollReset,formData:p,body:m,formMethod:a.method||f,formEncType:a.encType||g,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:p,body:m,formMethod:a.method||f,formEncType:a.encType||g,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,n])}function Vv(e,{relative:t}={}){let{basename:n}=R.useContext(gr),i=R.useContext(Dr);Et(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={..._a(e||".",{relative:t})},f=_r();if(e==null){l.search=f.search;let g=new URLSearchParams(l.search),p=g.getAll("index");if(p.some(C=>C==="")){g.delete("index"),p.filter(E=>E).forEach(E=>g.append("index",E));let C=g.toString();l.search=C?`?${C}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Ur([n,l.pathname])),xa(l)}function zv(e,t={}){let n=R.useContext(zx);Et(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=$x("useViewTransitionState"),a=_a(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=Gr(n.currentLocation.pathname,i)||n.currentLocation.pathname,f=Gr(n.nextLocation.pathname,i)||n.nextLocation.pathname;return oc(a.pathname,f)!=null||oc(a.pathname,l)!=null}[...Tv];const bh=R.createContext({});function Ih(e){const t=R.useRef(null);return t.current===null&&(t.current=e()),t.current}const Nh=typeof window<"u",qx=Nh?R.useLayoutEffect:R.useEffect,Bc=R.createContext(null);function Rh(e,t){e.indexOf(t)===-1&&e.push(t)}function Mh(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const Yr=(e,t,n)=>n>t?t:n<e?e:n;let Dh=()=>{};const Xr={},Jx=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function e2(e){return typeof e=="object"&&e!==null}const t2=e=>/^0[^.\s]+$/u.test(e);function _h(e){let t;return()=>(t===void 0&&(t=e()),t)}const Jn=e=>e,Wv=(e,t)=>n=>t(e(n)),Oa=(...e)=>e.reduce(Wv),ya=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i};class Oh{constructor(){this.subscriptions=[]}add(t){return Rh(this.subscriptions,t),()=>Mh(this.subscriptions,t)}notify(t,n,i){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,n,i);else for(let l=0;l<a;l++){const f=this.subscriptions[l];f&&f(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Nr=e=>e*1e3,Rr=e=>e/1e3;function n2(e,t){return t?e*(1e3/t):0}const r2=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,Hv=1e-7,Gv=12;function Yv(e,t,n,i,a){let l,f,g=0;do f=t+(n-t)/2,l=r2(f,i,a)-e,l>0?n=f:t=f;while(Math.abs(l)>Hv&&++g<Gv);return f}function ka(e,t,n,i){if(e===t&&n===i)return Jn;const a=l=>Yv(l,0,1,e,n);return l=>l===0||l===1?l:r2(a(l),t,i)}const i2=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,s2=e=>t=>1-e(1-t),o2=ka(.33,1.53,.69,.99),kh=s2(o2),a2=i2(kh),l2=e=>(e*=2)<1?.5*kh(e):.5*(2-Math.pow(2,-10*(e-1))),Ph=e=>1-Math.sin(Math.acos(e)),c2=s2(Ph),u2=i2(Ph),Xv=ka(.42,0,1,1),Qv=ka(0,0,.58,1),d2=ka(.42,0,.58,1),Kv=e=>Array.isArray(e)&&typeof e[0]!="number",f2=e=>Array.isArray(e)&&typeof e[0]=="number",Zv={linear:Jn,easeIn:Xv,easeInOut:d2,easeOut:Qv,circIn:Ph,circInOut:u2,circOut:c2,backIn:kh,backInOut:a2,backOut:o2,anticipate:l2},$v=e=>typeof e=="string",G1=e=>{if(f2(e)){Dh(e.length===4);const[t,n,i,a]=e;return ka(t,n,i,a)}else if($v(e))return Zv[e];return e},dl=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Y1={value:null,addProjectionMetrics:null};function qv(e,t){let n=new Set,i=new Set,a=!1,l=!1;const f=new WeakSet;let g={delta:0,timestamp:0,isProcessing:!1},p=0;function m(E){f.has(E)&&(C.schedule(E),e()),p++,E(g)}const C={schedule:(E,A=!1,M=!1)=>{const k=M&&a?n:i;return A&&f.add(E),k.has(E)||k.add(E),E},cancel:E=>{i.delete(E),f.delete(E)},process:E=>{if(g=E,a){l=!0;return}a=!0,[n,i]=[i,n],n.forEach(m),t&&Y1.value&&Y1.value.frameloop[t].push(p),p=0,n.clear(),a=!1,l&&(l=!1,C.process(E))}};return C}const Jv=40;function h2(e,t){let n=!1,i=!0;const a={delta:0,timestamp:0,isProcessing:!1},l=()=>n=!0,f=dl.reduce((S,O)=>(S[O]=qv(l,t?O:void 0),S),{}),{setup:g,read:p,resolveKeyframes:m,preUpdate:C,update:E,preRender:A,render:M,postRender:_}=f,k=()=>{const S=Xr.useManualTiming?a.timestamp:performance.now();n=!1,Xr.useManualTiming||(a.delta=i?1e3/60:Math.max(Math.min(S-a.timestamp,Jv),1)),a.timestamp=S,a.isProcessing=!0,g.process(a),p.process(a),m.process(a),C.process(a),E.process(a),A.process(a),M.process(a),_.process(a),a.isProcessing=!1,n&&t&&(i=!1,e(k))},V=()=>{n=!0,i=!0,a.isProcessing||e(k)};return{schedule:dl.reduce((S,O)=>{const F=f[O];return S[O]=(W,U=!1,B=!1)=>(n||V(),F.schedule(W,U,B)),S},{}),cancel:S=>{for(let O=0;O<dl.length;O++)f[dl[O]].cancel(S)},state:a,steps:f}}const{schedule:bt,cancel:Ii,state:tn,steps:ju}=h2(typeof requestAnimationFrame<"u"?requestAnimationFrame:Jn,!0);let _l;function eS(){_l=void 0}const In={now:()=>(_l===void 0&&In.set(tn.isProcessing||Xr.useManualTiming?tn.timestamp:performance.now()),_l),set:e=>{_l=e,queueMicrotask(eS)}},g2=e=>t=>typeof t=="string"&&t.startsWith(e),Lh=g2("--"),tS=g2("var(--"),Bh=e=>tS(e)?nS.test(e.split("/*")[0].trim()):!1,nS=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,uo={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},wa={...uo,transform:e=>Yr(0,1,e)},fl={...uo,default:1},Qo=e=>Math.round(e*1e5)/1e5,jh=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function rS(e){return e==null}const iS=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Fh=(e,t)=>n=>!!(typeof n=="string"&&iS.test(n)&&n.startsWith(e)||t&&!rS(n)&&Object.prototype.hasOwnProperty.call(n,t)),p2=(e,t,n)=>i=>{if(typeof i!="string")return i;const[a,l,f,g]=i.match(jh);return{[e]:parseFloat(a),[t]:parseFloat(l),[n]:parseFloat(f),alpha:g!==void 0?parseFloat(g):1}},sS=e=>Yr(0,255,e),Fu={...uo,transform:e=>Math.round(sS(e))},Ki={test:Fh("rgb","red"),parse:p2("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+Fu.transform(e)+", "+Fu.transform(t)+", "+Fu.transform(n)+", "+Qo(wa.transform(i))+")"};function oS(e){let t="",n="",i="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,i+=i,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:a?parseInt(a,16)/255:1}}const Zd={test:Fh("#"),parse:oS,transform:Ki.transform},Pa=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),li=Pa("deg"),Mr=Pa("%"),Pe=Pa("px"),aS=Pa("vh"),lS=Pa("vw"),X1=(()=>({...Mr,parse:e=>Mr.parse(e)/100,transform:e=>Mr.transform(e*100)}))(),Ds={test:Fh("hsl","hue"),parse:p2("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+Mr.transform(Qo(t))+", "+Mr.transform(Qo(n))+", "+Qo(wa.transform(i))+")"},ln={test:e=>Ki.test(e)||Zd.test(e)||Ds.test(e),parse:e=>Ki.test(e)?Ki.parse(e):Ds.test(e)?Ds.parse(e):Zd.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ki.transform(e):Ds.transform(e)},cS=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function uS(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(jh))==null?void 0:t.length)||0)+(((n=e.match(cS))==null?void 0:n.length)||0)>0}const m2="number",x2="color",dS="var",fS="var(",Q1="${}",hS=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ca(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},a=[];let l=0;const g=t.replace(hS,p=>(ln.test(p)?(i.color.push(l),a.push(x2),n.push(ln.parse(p))):p.startsWith(fS)?(i.var.push(l),a.push(dS),n.push(p)):(i.number.push(l),a.push(m2),n.push(parseFloat(p))),++l,Q1)).split(Q1);return{values:n,split:g,indexes:i,types:a}}function y2(e){return Ca(e).values}function w2(e){const{split:t,types:n}=Ca(e),i=t.length;return a=>{let l="";for(let f=0;f<i;f++)if(l+=t[f],a[f]!==void 0){const g=n[f];g===m2?l+=Qo(a[f]):g===x2?l+=ln.transform(a[f]):l+=a[f]}return l}}const gS=e=>typeof e=="number"?0:e;function pS(e){const t=y2(e);return w2(e)(t.map(gS))}const Ni={test:uS,parse:y2,createTransformer:w2,getAnimatableNone:pS};function Uu(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function mS({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let a=0,l=0,f=0;if(!t)a=l=f=n;else{const g=n<.5?n*(1+t):n+t-n*t,p=2*n-g;a=Uu(p,g,e+1/3),l=Uu(p,g,e),f=Uu(p,g,e-1/3)}return{red:Math.round(a*255),green:Math.round(l*255),blue:Math.round(f*255),alpha:i}}function lc(e,t){return n=>n>0?t:e}const At=(e,t,n)=>e+(t-e)*n,Vu=(e,t,n)=>{const i=e*e,a=n*(t*t-i)+i;return a<0?0:Math.sqrt(a)},xS=[Zd,Ki,Ds],yS=e=>xS.find(t=>t.test(e));function K1(e){const t=yS(e);if(!t)return!1;let n=t.parse(e);return t===Ds&&(n=mS(n)),n}const Z1=(e,t)=>{const n=K1(e),i=K1(t);if(!n||!i)return lc(e,t);const a={...n};return l=>(a.red=Vu(n.red,i.red,l),a.green=Vu(n.green,i.green,l),a.blue=Vu(n.blue,i.blue,l),a.alpha=At(n.alpha,i.alpha,l),Ki.transform(a))},$d=new Set(["none","hidden"]);function wS(e,t){return $d.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function CS(e,t){return n=>At(e,t,n)}function Uh(e){return typeof e=="number"?CS:typeof e=="string"?Bh(e)?lc:ln.test(e)?Z1:SS:Array.isArray(e)?C2:typeof e=="object"?ln.test(e)?Z1:ES:lc}function C2(e,t){const n=[...e],i=n.length,a=e.map((l,f)=>Uh(l)(l,t[f]));return l=>{for(let f=0;f<i;f++)n[f]=a[f](l);return n}}function ES(e,t){const n={...e,...t},i={};for(const a in n)e[a]!==void 0&&t[a]!==void 0&&(i[a]=Uh(e[a])(e[a],t[a]));return a=>{for(const l in i)n[l]=i[l](a);return n}}function vS(e,t){const n=[],i={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const l=t.types[a],f=e.indexes[l][i[l]],g=e.values[f]??0;n[a]=g,i[l]++}return n}const SS=(e,t)=>{const n=Ni.createTransformer(t),i=Ca(e),a=Ca(t);return i.indexes.var.length===a.indexes.var.length&&i.indexes.color.length===a.indexes.color.length&&i.indexes.number.length>=a.indexes.number.length?$d.has(e)&&!a.values.length||$d.has(t)&&!i.values.length?wS(e,t):Oa(C2(vS(i,a),a.values),n):lc(e,t)};function E2(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?At(e,t,n):Uh(e)(e,t)}const AS=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>bt.update(t,n),stop:()=>Ii(t),now:()=>tn.isProcessing?tn.timestamp:In.now()}},v2=(e,t,n=10)=>{let i="";const a=Math.max(Math.round(t/n),2);for(let l=0;l<a;l++)i+=e(l/(a-1))+", ";return`linear(${i.substring(0,i.length-2)})`},cc=2e4;function Vh(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<cc;)t+=n,i=e.next(t);return t>=cc?1/0:t}function TS(e,t=100,n){const i=n({...e,keyframes:[0,t]}),a=Math.min(Vh(i),cc);return{type:"keyframes",ease:l=>i.next(a*l).value/t,duration:Rr(a)}}const bS=5;function S2(e,t,n){const i=Math.max(t-bS,0);return n2(n-e(i),t-i)}const _t={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},zu=.001;function IS({duration:e=_t.duration,bounce:t=_t.bounce,velocity:n=_t.velocity,mass:i=_t.mass}){let a,l,f=1-t;f=Yr(_t.minDamping,_t.maxDamping,f),e=Yr(_t.minDuration,_t.maxDuration,Rr(e)),f<1?(a=m=>{const C=m*f,E=C*e,A=C-n,M=qd(m,f),_=Math.exp(-E);return zu-A/M*_},l=m=>{const E=m*f*e,A=E*n+n,M=Math.pow(f,2)*Math.pow(m,2)*e,_=Math.exp(-E),k=qd(Math.pow(m,2),f);return(-a(m)+zu>0?-1:1)*((A-M)*_)/k}):(a=m=>{const C=Math.exp(-m*e),E=(m-n)*e+1;return-zu+C*E},l=m=>{const C=Math.exp(-m*e),E=(n-m)*(e*e);return C*E});const g=5/e,p=RS(a,l,g);if(e=Nr(e),isNaN(p))return{stiffness:_t.stiffness,damping:_t.damping,duration:e};{const m=Math.pow(p,2)*i;return{stiffness:m,damping:f*2*Math.sqrt(i*m),duration:e}}}const NS=12;function RS(e,t,n){let i=n;for(let a=1;a<NS;a++)i=i-e(i)/t(i);return i}function qd(e,t){return e*Math.sqrt(1-t*t)}const MS=["duration","bounce"],DS=["stiffness","damping","mass"];function $1(e,t){return t.some(n=>e[n]!==void 0)}function _S(e){let t={velocity:_t.velocity,stiffness:_t.stiffness,damping:_t.damping,mass:_t.mass,isResolvedFromDuration:!1,...e};if(!$1(e,DS)&&$1(e,MS))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),a=i*i,l=2*Yr(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:_t.mass,stiffness:a,damping:l}}else{const n=IS(e);t={...t,...n,mass:_t.mass},t.isResolvedFromDuration=!0}return t}function uc(e=_t.visualDuration,t=_t.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:a}=n;const l=n.keyframes[0],f=n.keyframes[n.keyframes.length-1],g={done:!1,value:l},{stiffness:p,damping:m,mass:C,duration:E,velocity:A,isResolvedFromDuration:M}=_S({...n,velocity:-Rr(n.velocity||0)}),_=A||0,k=m/(2*Math.sqrt(p*C)),V=f-l,N=Rr(Math.sqrt(p/C)),b=Math.abs(V)<5;i||(i=b?_t.restSpeed.granular:_t.restSpeed.default),a||(a=b?_t.restDelta.granular:_t.restDelta.default);let S;if(k<1){const F=qd(N,k);S=W=>{const U=Math.exp(-k*N*W);return f-U*((_+k*N*V)/F*Math.sin(F*W)+V*Math.cos(F*W))}}else if(k===1)S=F=>f-Math.exp(-N*F)*(V+(_+N*V)*F);else{const F=N*Math.sqrt(k*k-1);S=W=>{const U=Math.exp(-k*N*W),B=Math.min(F*W,300);return f-U*((_+k*N*V)*Math.sinh(B)+F*V*Math.cosh(B))/F}}const O={calculatedDuration:M&&E||null,next:F=>{const W=S(F);if(M)g.done=F>=E;else{let U=F===0?_:0;k<1&&(U=F===0?Nr(_):S2(S,F,W));const B=Math.abs(U)<=i,G=Math.abs(f-W)<=a;g.done=B&&G}return g.value=g.done?f:W,g},toString:()=>{const F=Math.min(Vh(O),cc),W=v2(U=>O.next(F*U).value,F,30);return F+"ms "+W},toTransition:()=>{}};return O}uc.applyToOptions=e=>{const t=TS(e,100,uc);return e.ease=t.ease,e.duration=Nr(t.duration),e.type="keyframes",e};function Jd({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:a=10,bounceStiffness:l=500,modifyTarget:f,min:g,max:p,restDelta:m=.5,restSpeed:C}){const E=e[0],A={done:!1,value:E},M=B=>g!==void 0&&B<g||p!==void 0&&B>p,_=B=>g===void 0?p:p===void 0||Math.abs(g-B)<Math.abs(p-B)?g:p;let k=n*t;const V=E+k,N=f===void 0?V:f(V);N!==V&&(k=N-E);const b=B=>-k*Math.exp(-B/i),S=B=>N+b(B),O=B=>{const G=b(B),te=S(B);A.done=Math.abs(G)<=m,A.value=A.done?N:te};let F,W;const U=B=>{M(A.value)&&(F=B,W=uc({keyframes:[A.value,_(A.value)],velocity:S2(S,B,A.value),damping:a,stiffness:l,restDelta:m,restSpeed:C}))};return U(0),{calculatedDuration:null,next:B=>{let G=!1;return!W&&F===void 0&&(G=!0,O(B),U(B)),F!==void 0&&B>=F?W.next(B-F):(!G&&O(B),A)}}}function OS(e,t,n){const i=[],a=n||Xr.mix||E2,l=e.length-1;for(let f=0;f<l;f++){let g=a(e[f],e[f+1]);if(t){const p=Array.isArray(t)?t[f]||Jn:t;g=Oa(p,g)}i.push(g)}return i}function kS(e,t,{clamp:n=!0,ease:i,mixer:a}={}){const l=e.length;if(Dh(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const f=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const g=OS(t,i,a),p=g.length,m=C=>{if(f&&C<e[0])return t[0];let E=0;if(p>1)for(;E<e.length-2&&!(C<e[E+1]);E++);const A=ya(e[E],e[E+1],C);return g[E](A)};return n?C=>m(Yr(e[0],e[l-1],C)):m}function PS(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const a=ya(0,t,i);e.push(At(n,1,a))}}function LS(e){const t=[0];return PS(t,e.length-1),t}function BS(e,t){return e.map(n=>n*t)}function jS(e,t){return e.map(()=>t||d2).splice(0,e.length-1)}function Ko({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const a=Kv(i)?i.map(G1):G1(i),l={done:!1,value:t[0]},f=BS(n&&n.length===t.length?n:LS(t),e),g=kS(f,t,{ease:Array.isArray(a)?a:jS(t,a)});return{calculatedDuration:e,next:p=>(l.value=g(p),l.done=p>=e,l)}}const FS=e=>e!==null;function zh(e,{repeat:t,repeatType:n="loop"},i,a=1){const l=e.filter(FS),g=a<0||t&&n!=="loop"&&t%2===1?0:l.length-1;return!g||i===void 0?l[g]:i}const US={decay:Jd,inertia:Jd,tween:Ko,keyframes:Ko,spring:uc};function A2(e){typeof e.type=="string"&&(e.type=US[e.type])}class Wh{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const VS=e=>e/100;class Hh extends Wh{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var i,a;const{motionValue:n}=this.options;n&&n.updatedAt!==In.now()&&this.tick(In.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(i=this.options).onStop)==null||a.call(i))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;A2(t);const{type:n=Ko,repeat:i=0,repeatDelay:a=0,repeatType:l,velocity:f=0}=t;let{keyframes:g}=t;const p=n||Ko;p!==Ko&&typeof g[0]!="number"&&(this.mixKeyframes=Oa(VS,E2(g[0],g[1])),g=[0,100]);const m=p({...t,keyframes:g});l==="mirror"&&(this.mirroredGenerator=p({...t,keyframes:[...g].reverse(),velocity:-f})),m.calculatedDuration===null&&(m.calculatedDuration=Vh(m));const{calculatedDuration:C}=m;this.calculatedDuration=C,this.resolvedDuration=C+a,this.totalDuration=this.resolvedDuration*(i+1)-a,this.generator=m}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:i,totalDuration:a,mixKeyframes:l,mirroredGenerator:f,resolvedDuration:g,calculatedDuration:p}=this;if(this.startTime===null)return i.next(0);const{delay:m=0,keyframes:C,repeat:E,repeatType:A,repeatDelay:M,type:_,onUpdate:k,finalKeyframe:V}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-a/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const N=this.currentTime-m*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?N<0:N>a;this.currentTime=Math.max(N,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let S=this.currentTime,O=i;if(E){const B=Math.min(this.currentTime,a)/g;let G=Math.floor(B),te=B%1;!te&&B>=1&&(te=1),te===1&&G--,G=Math.min(G,E+1),!!(G%2)&&(A==="reverse"?(te=1-te,M&&(te-=M/g)):A==="mirror"&&(O=f)),S=Yr(0,1,te)*g}const F=b?{done:!1,value:C[0]}:O.next(S);l&&(F.value=l(F.value));let{done:W}=F;!b&&p!==null&&(W=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const U=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return U&&_!==Jd&&(F.value=zh(C,this.options,V,this.speed)),k&&k(F.value),U&&this.finish(),F}then(t,n){return this.finished.then(t,n)}get duration(){return Rr(this.calculatedDuration)}get time(){return Rr(this.currentTime)}set time(t){var n;t=Nr(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(In.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Rr(this.currentTime))}play(){var a,l;if(this.isStopped)return;const{driver:t=AS,startTime:n}=this.options;this.driver||(this.driver=t(f=>this.tick(f))),(l=(a=this.options).onPlay)==null||l.call(a);const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=n??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(In.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function zS(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Zi=e=>e*180/Math.PI,ef=e=>{const t=Zi(Math.atan2(e[1],e[0]));return tf(t)},WS={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:ef,rotateZ:ef,skewX:e=>Zi(Math.atan(e[1])),skewY:e=>Zi(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},tf=e=>(e=e%360,e<0&&(e+=360),e),q1=ef,J1=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),eg=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),HS={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:J1,scaleY:eg,scale:e=>(J1(e)+eg(e))/2,rotateX:e=>tf(Zi(Math.atan2(e[6],e[5]))),rotateY:e=>tf(Zi(Math.atan2(-e[2],e[0]))),rotateZ:q1,rotate:q1,skewX:e=>Zi(Math.atan(e[4])),skewY:e=>Zi(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function nf(e){return e.includes("scale")?1:0}function rf(e,t){if(!e||e==="none")return nf(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,a;if(n)i=HS,a=n;else{const g=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=WS,a=g}if(!a)return nf(t);const l=i[t],f=a[1].split(",").map(YS);return typeof l=="function"?l(f):f[l]}const GS=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return rf(n,t)};function YS(e){return parseFloat(e.trim())}const fo=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ho=(()=>new Set(fo))(),tg=e=>e===uo||e===Pe,XS=new Set(["x","y","z"]),QS=fo.filter(e=>!XS.has(e));function KS(e){const t=[];return QS.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const Ji={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>rf(t,"x"),y:(e,{transform:t})=>rf(t,"y")};Ji.translateX=Ji.x;Ji.translateY=Ji.y;const es=new Set;let sf=!1,of=!1,af=!1;function T2(){if(of){const e=Array.from(es).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const a=KS(i);a.length&&(n.set(i,a),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const a=n.get(i);a&&a.forEach(([l,f])=>{var g;(g=i.getValue(l))==null||g.set(f)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}of=!1,sf=!1,es.forEach(e=>e.complete(af)),es.clear()}function b2(){es.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(of=!0)})}function ZS(){af=!0,b2(),T2(),af=!1}class Gh{constructor(t,n,i,a,l,f=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=a,this.element=l,this.isAsync=f}scheduleResolve(){this.state="scheduled",this.isAsync?(es.add(this),sf||(sf=!0,bt.read(b2),bt.resolveKeyframes(T2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:a}=this;if(t[0]===null){const l=a==null?void 0:a.get(),f=t[t.length-1];if(l!==void 0)t[0]=l;else if(i&&n){const g=i.readValue(n,f);g!=null&&(t[0]=g)}t[0]===void 0&&(t[0]=f),a&&l===void 0&&a.set(t[0])}zS(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),es.delete(this)}cancel(){this.state==="scheduled"&&(es.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const $S=e=>e.startsWith("--");function qS(e,t,n){$S(t)?e.style.setProperty(t,n):e.style[t]=n}const JS=_h(()=>window.ScrollTimeline!==void 0),eA={};function tA(e,t){const n=_h(e);return()=>eA[t]??n()}const I2=tA(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),jo=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,ng={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:jo([0,.65,.55,1]),circOut:jo([.55,0,1,.45]),backIn:jo([.31,.01,.66,-.59]),backOut:jo([.33,1.53,.69,.99])};function N2(e,t){if(e)return typeof e=="function"?I2()?v2(e,t):"ease-out":f2(e)?jo(e):Array.isArray(e)?e.map(n=>N2(n,t)||ng.easeOut):ng[e]}function nA(e,t,n,{delay:i=0,duration:a=300,repeat:l=0,repeatType:f="loop",ease:g="easeOut",times:p}={},m=void 0){const C={[t]:n};p&&(C.offset=p);const E=N2(g,a);Array.isArray(E)&&(C.easing=E);const A={delay:i,duration:a,easing:Array.isArray(E)?"linear":E,fill:"both",iterations:l+1,direction:f==="reverse"?"alternate":"normal"};return m&&(A.pseudoElement=m),e.animate(C,A)}function R2(e){return typeof e=="function"&&"applyToOptions"in e}function rA({type:e,...t}){return R2(e)&&I2()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class iA extends Wh{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:i,keyframes:a,pseudoElement:l,allowFlatten:f=!1,finalKeyframe:g,onComplete:p}=t;this.isPseudoElement=!!l,this.allowFlatten=f,this.options=t,Dh(typeof t.type!="string");const m=rA(t);this.animation=nA(n,i,a,m,l),m.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const C=zh(a,this.options,g,this.speed);this.updateMotionValue?this.updateMotionValue(C):qS(n,i,C),this.animation.cancel()}p==null||p(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,i;const t=((i=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:i.call(n).duration)||0;return Rr(Number(t))}get time(){return Rr(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Nr(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var i;return this.allowFlatten&&((i=this.animation.effect)==null||i.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&JS()?(this.animation.timeline=t,Jn):n(this)}}const M2={anticipate:l2,backInOut:a2,circInOut:u2};function sA(e){return e in M2}function oA(e){typeof e.ease=="string"&&sA(e.ease)&&(e.ease=M2[e.ease])}const rg=10;class aA extends iA{constructor(t){oA(t),A2(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:i,onComplete:a,element:l,...f}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const g=new Hh({...f,autoplay:!1}),p=Nr(this.finishedTime??this.time);n.setWithVelocity(g.sample(p-rg).value,g.sample(p).value,rg),g.stop()}}const ig=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ni.test(e)||e==="0")&&!e.startsWith("url("));function lA(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function cA(e,t,n,i){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],f=ig(a,t),g=ig(l,t);return!f||!g?!1:lA(e)||(n==="spring"||R2(n))&&i}function Yh(e){return e2(e)&&"offsetHeight"in e}const uA=new Set(["opacity","clipPath","filter","transform"]),dA=_h(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function fA(e){var m;const{motionValue:t,name:n,repeatDelay:i,repeatType:a,damping:l,type:f}=e;if(!Yh((m=t==null?void 0:t.owner)==null?void 0:m.current))return!1;const{onUpdate:g,transformTemplate:p}=t.owner.getProps();return dA()&&n&&uA.has(n)&&(n!=="transform"||!p)&&!g&&!i&&a!=="mirror"&&l!==0&&f!=="inertia"}const hA=40;class gA extends Wh{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:f="loop",keyframes:g,name:p,motionValue:m,element:C,...E}){var _;super(),this.stop=()=>{var k,V;this._animation&&(this._animation.stop(),(k=this.stopTimeline)==null||k.call(this)),(V=this.keyframeResolver)==null||V.cancel()},this.createdAt=In.now();const A={autoplay:t,delay:n,type:i,repeat:a,repeatDelay:l,repeatType:f,name:p,motionValue:m,element:C,...E},M=(C==null?void 0:C.KeyframeResolver)||Gh;this.keyframeResolver=new M(g,(k,V,N)=>this.onKeyframesResolved(k,V,A,!N),p,m,C),(_=this.keyframeResolver)==null||_.scheduleResolve()}onKeyframesResolved(t,n,i,a){this.keyframeResolver=void 0;const{name:l,type:f,velocity:g,delay:p,isHandoff:m,onUpdate:C}=i;this.resolvedAt=In.now(),cA(t,l,f,g)||((Xr.instantAnimations||!p)&&(C==null||C(zh(t,i,n))),t[0]=t[t.length-1],i.duration=0,i.repeat=0);const A={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>hA?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...i,keyframes:t},M=!m&&fA(A)?new aA({...A,element:A.motionValue.owner.current}):new Hh(A);M.finished.then(()=>this.notifyFinished()).catch(Jn),this.pendingTimeline&&(this.stopTimeline=M.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=M}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),ZS()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const pA=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function mA(e){const t=pA.exec(e);if(!t)return[,];const[,n,i,a]=t;return[`--${n??i}`,a]}function D2(e,t,n=1){const[i,a]=mA(e);if(!i)return;const l=window.getComputedStyle(t).getPropertyValue(i);if(l){const f=l.trim();return Jx(f)?parseFloat(f):f}return Bh(a)?D2(a,t,n+1):a}function Xh(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const _2=new Set(["width","height","top","left","right","bottom",...fo]),xA={test:e=>e==="auto",parse:e=>e},O2=e=>t=>t.test(e),k2=[uo,Pe,Mr,li,lS,aS,xA],sg=e=>k2.find(O2(e));function yA(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||t2(e):!0}const wA=new Set(["brightness","contrast","saturate","opacity"]);function CA(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(jh)||[];if(!i)return e;const a=n.replace(i,"");let l=wA.has(t)?1:0;return i!==n&&(l*=100),t+"("+l+a+")"}const EA=/\b([a-z-]*)\(.*?\)/gu,lf={...Ni,getAnimatableNone:e=>{const t=e.match(EA);return t?t.map(CA).join(" "):e}},og={...uo,transform:Math.round},vA={rotate:li,rotateX:li,rotateY:li,rotateZ:li,scale:fl,scaleX:fl,scaleY:fl,scaleZ:fl,skew:li,skewX:li,skewY:li,distance:Pe,translateX:Pe,translateY:Pe,translateZ:Pe,x:Pe,y:Pe,z:Pe,perspective:Pe,transformPerspective:Pe,opacity:wa,originX:X1,originY:X1,originZ:Pe},Qh={borderWidth:Pe,borderTopWidth:Pe,borderRightWidth:Pe,borderBottomWidth:Pe,borderLeftWidth:Pe,borderRadius:Pe,radius:Pe,borderTopLeftRadius:Pe,borderTopRightRadius:Pe,borderBottomRightRadius:Pe,borderBottomLeftRadius:Pe,width:Pe,maxWidth:Pe,height:Pe,maxHeight:Pe,top:Pe,right:Pe,bottom:Pe,left:Pe,padding:Pe,paddingTop:Pe,paddingRight:Pe,paddingBottom:Pe,paddingLeft:Pe,margin:Pe,marginTop:Pe,marginRight:Pe,marginBottom:Pe,marginLeft:Pe,backgroundPositionX:Pe,backgroundPositionY:Pe,...vA,zIndex:og,fillOpacity:wa,strokeOpacity:wa,numOctaves:og},SA={...Qh,color:ln,backgroundColor:ln,outlineColor:ln,fill:ln,stroke:ln,borderColor:ln,borderTopColor:ln,borderRightColor:ln,borderBottomColor:ln,borderLeftColor:ln,filter:lf,WebkitFilter:lf},P2=e=>SA[e];function L2(e,t){let n=P2(e);return n!==lf&&(n=Ni),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const AA=new Set(["auto","none","0"]);function TA(e,t,n){let i=0,a;for(;i<e.length&&!a;){const l=e[i];typeof l=="string"&&!AA.has(l)&&Ca(l).values.length&&(a=e[i]),i++}if(a&&n)for(const l of t)e[l]=L2(n,a)}class bA extends Gh{constructor(t,n,i,a,l){super(t,n,i,a,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let p=0;p<t.length;p++){let m=t[p];if(typeof m=="string"&&(m=m.trim(),Bh(m))){const C=D2(m,n.current);C!==void 0&&(t[p]=C),p===t.length-1&&(this.finalKeyframe=m)}}if(this.resolveNoneKeyframes(),!_2.has(i)||t.length!==2)return;const[a,l]=t,f=sg(a),g=sg(l);if(f!==g)if(tg(f)&&tg(g))for(let p=0;p<t.length;p++){const m=t[p];typeof m=="string"&&(t[p]=parseFloat(m))}else Ji[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let a=0;a<t.length;a++)(t[a]===null||yA(t[a]))&&i.push(a);i.length&&TA(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ji[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const a=n[n.length-1];a!==void 0&&t.getValue(i,a).jump(a,!1)}measureEndState(){var g;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const l=i.length-1,f=i[l];i[l]=Ji[n](t.measureViewportBox(),window.getComputedStyle(t.current)),f!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=f),(g=this.removedTransforms)!=null&&g.length&&this.removedTransforms.forEach(([p,m])=>{t.getValue(p).set(m)}),this.resolveNoneKeyframes()}}function IA(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let i=document;t&&(i=t.current);const a=(n==null?void 0:n[e])??i.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}const B2=(e,t)=>t&&typeof e=="number"?t.transform(e):e,ag=30,NA=e=>!isNaN(parseFloat(e));class RA{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,a=!0)=>{var f,g;const l=In.now();if(this.updatedAt!==l&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&((f=this.events.change)==null||f.notify(this.current),this.dependents))for(const p of this.dependents)p.dirty();a&&((g=this.events.renderRequest)==null||g.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=In.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=NA(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new Oh);const i=this.events[t].add(n);return t==="change"?()=>{i(),bt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=In.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>ag)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,ag);return n2(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Zs(e,t){return new RA(e,t)}const{schedule:Kh,cancel:OI}=h2(queueMicrotask,!1),sr={x:!1,y:!1};function j2(){return sr.x||sr.y}function MA(e){return e==="x"||e==="y"?sr[e]?null:(sr[e]=!0,()=>{sr[e]=!1}):sr.x||sr.y?null:(sr.x=sr.y=!0,()=>{sr.x=sr.y=!1})}function F2(e,t){const n=IA(e),i=new AbortController,a={passive:!0,...t,signal:i.signal};return[n,a,()=>i.abort()]}function lg(e){return!(e.pointerType==="touch"||j2())}function DA(e,t,n={}){const[i,a,l]=F2(e,n),f=g=>{if(!lg(g))return;const{target:p}=g,m=t(p,g);if(typeof m!="function"||!p)return;const C=E=>{lg(E)&&(m(E),p.removeEventListener("pointerleave",C))};p.addEventListener("pointerleave",C,a)};return i.forEach(g=>{g.addEventListener("pointerenter",f,a)}),l}const U2=(e,t)=>t?e===t?!0:U2(e,t.parentElement):!1,Zh=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,_A=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function OA(e){return _A.has(e.tagName)||e.tabIndex!==-1}const Ol=new WeakSet;function cg(e){return t=>{t.key==="Enter"&&e(t)}}function Wu(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const kA=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=cg(()=>{if(Ol.has(n))return;Wu(n,"down");const a=cg(()=>{Wu(n,"up")}),l=()=>Wu(n,"cancel");n.addEventListener("keyup",a,t),n.addEventListener("blur",l,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function ug(e){return Zh(e)&&!j2()}function PA(e,t,n={}){const[i,a,l]=F2(e,n),f=g=>{const p=g.currentTarget;if(!ug(g))return;Ol.add(p);const m=t(p,g),C=(M,_)=>{window.removeEventListener("pointerup",E),window.removeEventListener("pointercancel",A),Ol.has(p)&&Ol.delete(p),ug(M)&&typeof m=="function"&&m(M,{success:_})},E=M=>{C(M,p===window||p===document||n.useGlobalTarget||U2(p,M.target))},A=M=>{C(M,!1)};window.addEventListener("pointerup",E,a),window.addEventListener("pointercancel",A,a)};return i.forEach(g=>{(n.useGlobalTarget?window:g).addEventListener("pointerdown",f,a),Yh(g)&&(g.addEventListener("focus",m=>kA(m,a)),!OA(g)&&!g.hasAttribute("tabindex")&&(g.tabIndex=0))}),l}function V2(e){return e2(e)&&"ownerSVGElement"in e}function LA(e){return V2(e)&&e.tagName==="svg"}const un=e=>!!(e&&e.getVelocity),BA=[...k2,ln,Ni],jA=e=>BA.find(O2(e)),$h=R.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class FA extends R.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const i=n.offsetParent,a=Yh(i)&&i.offsetWidth||0,l=this.props.sizeRef.current;l.height=n.offsetHeight||0,l.width=n.offsetWidth||0,l.top=n.offsetTop,l.left=n.offsetLeft,l.right=a-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function UA({children:e,isPresent:t,anchorX:n}){const i=R.useId(),a=R.useRef(null),l=R.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=R.useContext($h);return R.useInsertionEffect(()=>{const{width:g,height:p,top:m,left:C,right:E}=l.current;if(t||!a.current||!g||!p)return;const A=n==="left"?`left: ${C}`:`right: ${E}`;a.current.dataset.motionPopId=i;const M=document.createElement("style");return f&&(M.nonce=f),document.head.appendChild(M),M.sheet&&M.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${p}px !important;
            ${A}px !important;
            top: ${m}px !important;
          }
        `),()=>{document.head.contains(M)&&document.head.removeChild(M)}},[t]),y.jsx(FA,{isPresent:t,childRef:a,sizeRef:l,children:R.cloneElement(e,{ref:a})})}const VA=({children:e,initial:t,isPresent:n,onExitComplete:i,custom:a,presenceAffectsLayout:l,mode:f,anchorX:g})=>{const p=Ih(zA),m=R.useId();let C=!0,E=R.useMemo(()=>(C=!1,{id:m,initial:t,isPresent:n,custom:a,onExitComplete:A=>{p.set(A,!0);for(const M of p.values())if(!M)return;i&&i()},register:A=>(p.set(A,!1),()=>p.delete(A))}),[n,p,i]);return l&&C&&(E={...E}),R.useMemo(()=>{p.forEach((A,M)=>p.set(M,!1))},[n]),R.useEffect(()=>{!n&&!p.size&&i&&i()},[n]),f==="popLayout"&&(e=y.jsx(UA,{isPresent:n,anchorX:g,children:e})),y.jsx(Bc.Provider,{value:E,children:e})};function zA(){return new Map}function z2(e=!0){const t=R.useContext(Bc);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:a}=t,l=R.useId();R.useEffect(()=>{if(e)return a(l)},[e]);const f=R.useCallback(()=>e&&i&&i(l),[l,i,e]);return!n&&i?[!1,f]:[!0]}const hl=e=>e.key||"";function dg(e){const t=[];return R.Children.forEach(e,n=>{R.isValidElement(n)&&t.push(n)}),t}const $s=({children:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:a=!0,mode:l="sync",propagate:f=!1,anchorX:g="left"})=>{const[p,m]=z2(f),C=R.useMemo(()=>dg(e),[e]),E=f&&!p?[]:C.map(hl),A=R.useRef(!0),M=R.useRef(C),_=Ih(()=>new Map),[k,V]=R.useState(C),[N,b]=R.useState(C);qx(()=>{A.current=!1,M.current=C;for(let F=0;F<N.length;F++){const W=hl(N[F]);E.includes(W)?_.delete(W):_.get(W)!==!0&&_.set(W,!1)}},[N,E.length,E.join("-")]);const S=[];if(C!==k){let F=[...C];for(let W=0;W<N.length;W++){const U=N[W],B=hl(U);E.includes(B)||(F.splice(W,0,U),S.push(U))}return l==="wait"&&S.length&&(F=S),b(dg(F)),V(C),null}const{forceRender:O}=R.useContext(bh);return y.jsx(y.Fragment,{children:N.map(F=>{const W=hl(F),U=f&&!p?!1:C===N||E.includes(W),B=()=>{if(_.has(W))_.set(W,!0);else return;let G=!0;_.forEach(te=>{te||(G=!1)}),G&&(O==null||O(),b(M.current),f&&(m==null||m()),i&&i())};return y.jsx(VA,{isPresent:U,initial:!A.current||n?void 0:!1,custom:t,presenceAffectsLayout:a,mode:l,onExitComplete:U?void 0:B,anchorX:g,children:F},W)})})},W2=R.createContext({strict:!1}),fg={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qs={};for(const e in fg)qs[e]={isEnabled:t=>fg[e].some(n=>!!t[n])};function WA(e){for(const t in e)qs[t]={...qs[t],...e[t]}}const HA=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function dc(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||HA.has(e)}let H2=e=>!dc(e);function GA(e){e&&(H2=t=>t.startsWith("on")?!dc(t):e(t))}try{GA(require("@emotion/is-prop-valid").default)}catch{}function YA(e,t,n){const i={};for(const a in e)a==="values"&&typeof e.values=="object"||(H2(a)||n===!0&&dc(a)||!t&&!dc(a)||e.draggable&&a.startsWith("onDrag"))&&(i[a]=e[a]);return i}function XA(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...i)=>e(...i);return new Proxy(n,{get:(i,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const jc=R.createContext({});function Fc(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Ea(e){return typeof e=="string"||Array.isArray(e)}const qh=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Jh=["initial",...qh];function Uc(e){return Fc(e.animate)||Jh.some(t=>Ea(e[t]))}function G2(e){return!!(Uc(e)||e.variants)}function QA(e,t){if(Uc(e)){const{initial:n,animate:i}=e;return{initial:n===!1||Ea(n)?n:void 0,animate:Ea(i)?i:void 0}}return e.inherit!==!1?t:{}}function KA(e){const{initial:t,animate:n}=QA(e,R.useContext(jc));return R.useMemo(()=>({initial:t,animate:n}),[hg(t),hg(n)])}function hg(e){return Array.isArray(e)?e.join(" "):e}const ZA=Symbol.for("motionComponentSymbol");function _s(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function $A(e,t,n){return R.useCallback(i=>{i&&e.onMount&&e.onMount(i),t&&(i?t.mount(i):t.unmount()),n&&(typeof n=="function"?n(i):_s(n)&&(n.current=i))},[t])}const e0=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qA="framerAppearId",Y2="data-"+e0(qA),X2=R.createContext({});function JA(e,t,n,i,a){var k,V;const{visualElement:l}=R.useContext(jc),f=R.useContext(W2),g=R.useContext(Bc),p=R.useContext($h).reducedMotion,m=R.useRef(null);i=i||f.renderer,!m.current&&i&&(m.current=i(e,{visualState:t,parent:l,props:n,presenceContext:g,blockInitialAnimation:g?g.initial===!1:!1,reducedMotionConfig:p}));const C=m.current,E=R.useContext(X2);C&&!C.projection&&a&&(C.type==="html"||C.type==="svg")&&e4(m.current,n,a,E);const A=R.useRef(!1);R.useInsertionEffect(()=>{C&&A.current&&C.update(n,g)});const M=n[Y2],_=R.useRef(!!M&&!((k=window.MotionHandoffIsComplete)!=null&&k.call(window,M))&&((V=window.MotionHasOptimisedAnimation)==null?void 0:V.call(window,M)));return qx(()=>{C&&(A.current=!0,window.MotionIsMounted=!0,C.updateFeatures(),Kh.render(C.render),_.current&&C.animationState&&C.animationState.animateChanges())}),R.useEffect(()=>{C&&(!_.current&&C.animationState&&C.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var N;(N=window.MotionHandoffMarkAsComplete)==null||N.call(window,M)}),_.current=!1))}),C}function e4(e,t,n,i){const{layoutId:a,layout:l,drag:f,dragConstraints:g,layoutScroll:p,layoutRoot:m,layoutCrossfade:C}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Q2(e.parent)),e.projection.setOptions({layoutId:a,layout:l,alwaysMeasureLayout:!!f||g&&_s(g),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:i,crossfade:C,layoutScroll:p,layoutRoot:m})}function Q2(e){if(e)return e.options.allowProjection!==!1?e.projection:Q2(e.parent)}function t4({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:i,Component:a}){e&&WA(e);function l(g,p){let m;const C={...R.useContext($h),...g,layoutId:n4(g)},{isStatic:E}=C,A=KA(g),M=i(g,E);if(!E&&Nh){r4();const _=i4(C);m=_.MeasureLayout,A.visualElement=JA(a,M,C,t,_.ProjectionNode)}return y.jsxs(jc.Provider,{value:A,children:[m&&A.visualElement?y.jsx(m,{visualElement:A.visualElement,...C}):null,n(a,g,$A(M,A.visualElement,p),M,E,A.visualElement)]})}l.displayName=`motion.${typeof a=="string"?a:`create(${a.displayName??a.name??""})`}`;const f=R.forwardRef(l);return f[ZA]=a,f}function n4({layoutId:e}){const t=R.useContext(bh).id;return t&&e!==void 0?t+"-"+e:e}function r4(e,t){R.useContext(W2).strict}function i4(e){const{drag:t,layout:n}=qs;if(!t&&!n)return{};const i={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const va={};function s4(e){for(const t in e)va[t]=e[t],Lh(t)&&(va[t].isCSSVariable=!0)}function K2(e,{layout:t,layoutId:n}){return ho.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!va[e]||e==="opacity")}const o4={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},a4=fo.length;function l4(e,t,n){let i="",a=!0;for(let l=0;l<a4;l++){const f=fo[l],g=e[f];if(g===void 0)continue;let p=!0;if(typeof g=="number"?p=g===(f.startsWith("scale")?1:0):p=parseFloat(g)===0,!p||n){const m=B2(g,Qh[f]);if(!p){a=!1;const C=o4[f]||f;i+=`${C}(${m}) `}n&&(t[f]=m)}}return i=i.trim(),n?i=n(t,a?"":i):a&&(i="none"),i}function t0(e,t,n){const{style:i,vars:a,transformOrigin:l}=e;let f=!1,g=!1;for(const p in t){const m=t[p];if(ho.has(p)){f=!0;continue}else if(Lh(p)){a[p]=m;continue}else{const C=B2(m,Qh[p]);p.startsWith("origin")?(g=!0,l[p]=C):i[p]=C}}if(t.transform||(f||n?i.transform=l4(t,e.transform,n):i.transform&&(i.transform="none")),g){const{originX:p="50%",originY:m="50%",originZ:C=0}=l;i.transformOrigin=`${p} ${m} ${C}`}}const n0=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Z2(e,t,n){for(const i in t)!un(t[i])&&!K2(i,n)&&(e[i]=t[i])}function c4({transformTemplate:e},t){return R.useMemo(()=>{const n=n0();return t0(n,t,e),Object.assign({},n.vars,n.style)},[t])}function u4(e,t){const n=e.style||{},i={};return Z2(i,n,e),Object.assign(i,c4(e,t)),i}function d4(e,t){const n={},i=u4(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}const f4={offset:"stroke-dashoffset",array:"stroke-dasharray"},h4={offset:"strokeDashoffset",array:"strokeDasharray"};function g4(e,t,n=1,i=0,a=!0){e.pathLength=1;const l=a?f4:h4;e[l.offset]=Pe.transform(-i);const f=Pe.transform(t),g=Pe.transform(n);e[l.array]=`${f} ${g}`}function $2(e,{attrX:t,attrY:n,attrScale:i,pathLength:a,pathSpacing:l=1,pathOffset:f=0,...g},p,m,C){if(t0(e,g,m),p){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:E,style:A}=e;E.transform&&(A.transform=E.transform,delete E.transform),(A.transform||E.transformOrigin)&&(A.transformOrigin=E.transformOrigin??"50% 50%",delete E.transformOrigin),A.transform&&(A.transformBox=(C==null?void 0:C.transformBox)??"fill-box",delete E.transformBox),t!==void 0&&(E.x=t),n!==void 0&&(E.y=n),i!==void 0&&(E.scale=i),a!==void 0&&g4(E,a,l,f,!1)}const q2=()=>({...n0(),attrs:{}}),J2=e=>typeof e=="string"&&e.toLowerCase()==="svg";function p4(e,t,n,i){const a=R.useMemo(()=>{const l=q2();return $2(l,t,J2(i),e.transformTemplate,e.style),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};Z2(l,e.style,e),a.style={...l,...a.style}}return a}const m4=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function r0(e){return typeof e!="string"||e.includes("-")?!1:!!(m4.indexOf(e)>-1||/[A-Z]/u.test(e))}function x4(e=!1){return(n,i,a,{latestValues:l},f)=>{const p=(r0(n)?p4:d4)(i,l,f,n),m=YA(i,typeof n=="string",e),C=n!==R.Fragment?{...m,...p,ref:a}:{},{children:E}=i,A=R.useMemo(()=>un(E)?E.get():E,[E]);return R.createElement(n,{...C,children:A})}}function gg(e){const t=[{},{}];return e==null||e.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function i0(e,t,n,i){if(typeof t=="function"){const[a,l]=gg(i);t=t(n!==void 0?n:e.custom,a,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,l]=gg(i);t=t(n!==void 0?n:e.custom,a,l)}return t}function kl(e){return un(e)?e.get():e}function y4({scrapeMotionValuesFromProps:e,createRenderState:t},n,i,a){return{latestValues:w4(n,i,a,e),renderState:t()}}const ey=e=>(t,n)=>{const i=R.useContext(jc),a=R.useContext(Bc),l=()=>y4(e,t,i,a);return n?l():Ih(l)};function w4(e,t,n,i){const a={},l=i(e,{});for(const A in l)a[A]=kl(l[A]);let{initial:f,animate:g}=e;const p=Uc(e),m=G2(e);t&&m&&!p&&e.inherit!==!1&&(f===void 0&&(f=t.initial),g===void 0&&(g=t.animate));let C=n?n.initial===!1:!1;C=C||f===!1;const E=C?g:f;if(E&&typeof E!="boolean"&&!Fc(E)){const A=Array.isArray(E)?E:[E];for(let M=0;M<A.length;M++){const _=i0(e,A[M]);if(_){const{transitionEnd:k,transition:V,...N}=_;for(const b in N){let S=N[b];if(Array.isArray(S)){const O=C?S.length-1:0;S=S[O]}S!==null&&(a[b]=S)}for(const b in k)a[b]=k[b]}}}return a}function s0(e,t,n){var l;const{style:i}=e,a={};for(const f in i)(un(i[f])||t.style&&un(t.style[f])||K2(f,e)||((l=n==null?void 0:n.getValue(f))==null?void 0:l.liveStyle)!==void 0)&&(a[f]=i[f]);return a}const C4={useVisualState:ey({scrapeMotionValuesFromProps:s0,createRenderState:n0})};function ty(e,t,n){const i=s0(e,t,n);for(const a in e)if(un(e[a])||un(t[a])){const l=fo.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;i[l]=e[a]}return i}const E4={useVisualState:ey({scrapeMotionValuesFromProps:ty,createRenderState:q2})};function v4(e,t){return function(i,{forwardMotionProps:a}={forwardMotionProps:!1}){const f={...r0(i)?E4:C4,preloadedFeatures:e,useRender:x4(a),createVisualElement:t,Component:i};return t4(f)}}function Sa(e,t,n){const i=e.getProps();return i0(i,t,n!==void 0?n:i.custom,e)}const cf=e=>Array.isArray(e);function S4(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Zs(n))}function A4(e){return cf(e)?e[e.length-1]||0:e}function T4(e,t){const n=Sa(e,t);let{transitionEnd:i={},transition:a={},...l}=n||{};l={...l,...i};for(const f in l){const g=A4(l[f]);S4(e,f,g)}}function b4(e){return!!(un(e)&&e.add)}function uf(e,t){const n=e.getValue("willChange");if(b4(n))return n.add(t);if(!n&&Xr.WillChange){const i=new Xr.WillChange("auto");e.addValue("willChange",i),i.add(t)}}function ny(e){return e.props[Y2]}const I4=e=>e!==null;function N4(e,{repeat:t,repeatType:n="loop"},i){const a=e.filter(I4),l=t&&n!=="loop"&&t%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const R4={type:"spring",stiffness:500,damping:25,restSpeed:10},M4=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),D4={type:"keyframes",duration:.8},_4={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},O4=(e,{keyframes:t})=>t.length>2?D4:ho.has(e)?e.startsWith("scale")?M4(t[1]):R4:_4;function k4({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:a,repeat:l,repeatType:f,repeatDelay:g,from:p,elapsed:m,...C}){return!!Object.keys(C).length}const o0=(e,t,n,i={},a,l)=>f=>{const g=Xh(i,e)||{},p=g.delay||i.delay||0;let{elapsed:m=0}=i;m=m-Nr(p);const C={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...g,delay:-m,onUpdate:A=>{t.set(A),g.onUpdate&&g.onUpdate(A)},onComplete:()=>{f(),g.onComplete&&g.onComplete()},name:e,motionValue:t,element:l?void 0:a};k4(g)||Object.assign(C,O4(e,C)),C.duration&&(C.duration=Nr(C.duration)),C.repeatDelay&&(C.repeatDelay=Nr(C.repeatDelay)),C.from!==void 0&&(C.keyframes[0]=C.from);let E=!1;if((C.type===!1||C.duration===0&&!C.repeatDelay)&&(C.duration=0,C.delay===0&&(E=!0)),(Xr.instantAnimations||Xr.skipAnimations)&&(E=!0,C.duration=0,C.delay=0),C.allowFlatten=!g.type&&!g.ease,E&&!l&&t.get()!==void 0){const A=N4(C.keyframes,g);if(A!==void 0){bt.update(()=>{C.onUpdate(A),C.onComplete()});return}}return g.isSync?new Hh(C):new gA(C)};function P4({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function ry(e,t,{delay:n=0,transitionOverride:i,type:a}={}){let{transition:l=e.getDefaultTransition(),transitionEnd:f,...g}=t;i&&(l=i);const p=[],m=a&&e.animationState&&e.animationState.getState()[a];for(const C in g){const E=e.getValue(C,e.latestValues[C]??null),A=g[C];if(A===void 0||m&&P4(m,C))continue;const M={delay:n,...Xh(l||{},C)},_=E.get();if(_!==void 0&&!E.isAnimating&&!Array.isArray(A)&&A===_&&!M.velocity)continue;let k=!1;if(window.MotionHandoffAnimation){const N=ny(e);if(N){const b=window.MotionHandoffAnimation(N,C,bt);b!==null&&(M.startTime=b,k=!0)}}uf(e,C),E.start(o0(C,E,A,e.shouldReduceMotion&&_2.has(C)?{type:!1}:M,e,k));const V=E.animation;V&&p.push(V)}return f&&Promise.all(p).then(()=>{bt.update(()=>{f&&T4(e,f)})}),p}function df(e,t,n={}){var p;const i=Sa(e,t,n.type==="exit"?(p=e.presenceContext)==null?void 0:p.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(a=n.transitionOverride);const l=i?()=>Promise.all(ry(e,i,n)):()=>Promise.resolve(),f=e.variantChildren&&e.variantChildren.size?(m=0)=>{const{delayChildren:C=0,staggerChildren:E,staggerDirection:A}=a;return L4(e,t,C+m,E,A,n)}:()=>Promise.resolve(),{when:g}=a;if(g){const[m,C]=g==="beforeChildren"?[l,f]:[f,l];return m().then(()=>C())}else return Promise.all([l(),f(n.delay)])}function L4(e,t,n=0,i=0,a=1,l){const f=[],g=(e.variantChildren.size-1)*i,p=a===1?(m=0)=>m*i:(m=0)=>g-m*i;return Array.from(e.variantChildren).sort(B4).forEach((m,C)=>{m.notify("AnimationStart",t),f.push(df(m,t,{...l,delay:n+p(C)}).then(()=>m.notify("AnimationComplete",t)))}),Promise.all(f)}function B4(e,t){return e.sortNodePosition(t)}function j4(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const a=t.map(l=>df(e,l,n));i=Promise.all(a)}else if(typeof t=="string")i=df(e,t,n);else{const a=typeof t=="function"?Sa(e,t,n.custom):t;i=Promise.all(ry(e,a,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}function iy(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}const F4=Jh.length;function sy(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?sy(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<F4;n++){const i=Jh[n],a=e.props[i];(Ea(a)||a===!1)&&(t[i]=a)}return t}const U4=[...qh].reverse(),V4=qh.length;function z4(e){return t=>Promise.all(t.map(({animation:n,options:i})=>j4(e,n,i)))}function W4(e){let t=z4(e),n=pg(),i=!0;const a=p=>(m,C)=>{var A;const E=Sa(e,C,p==="exit"?(A=e.presenceContext)==null?void 0:A.custom:void 0);if(E){const{transition:M,transitionEnd:_,...k}=E;m={...m,...k,..._}}return m};function l(p){t=p(e)}function f(p){const{props:m}=e,C=sy(e.parent)||{},E=[],A=new Set;let M={},_=1/0;for(let V=0;V<V4;V++){const N=U4[V],b=n[N],S=m[N]!==void 0?m[N]:C[N],O=Ea(S),F=N===p?b.isActive:null;F===!1&&(_=V);let W=S===C[N]&&S!==m[N]&&O;if(W&&i&&e.manuallyAnimateOnMount&&(W=!1),b.protectedKeys={...M},!b.isActive&&F===null||!S&&!b.prevProp||Fc(S)||typeof S=="boolean")continue;const U=H4(b.prevProp,S);let B=U||N===p&&b.isActive&&!W&&O||V>_&&O,G=!1;const te=Array.isArray(S)?S:[S];let me=te.reduce(a(N),{});F===!1&&(me={});const{prevResolvedValues:he={}}=b,de={...he,...me},pe=re=>{B=!0,A.has(re)&&(G=!0,A.delete(re)),b.needsAnimating[re]=!0;const X=e.getValue(re);X&&(X.liveStyle=!1)};for(const re in de){const X=me[re],fe=he[re];if(M.hasOwnProperty(re))continue;let oe=!1;cf(X)&&cf(fe)?oe=!iy(X,fe):oe=X!==fe,oe?X!=null?pe(re):A.add(re):X!==void 0&&A.has(re)?pe(re):b.protectedKeys[re]=!0}b.prevProp=S,b.prevResolvedValues=me,b.isActive&&(M={...M,...me}),i&&e.blockInitialAnimation&&(B=!1),B&&(!(W&&U)||G)&&E.push(...te.map(re=>({animation:re,options:{type:N}})))}if(A.size){const V={};if(typeof m.initial!="boolean"){const N=Sa(e,Array.isArray(m.initial)?m.initial[0]:m.initial);N&&N.transition&&(V.transition=N.transition)}A.forEach(N=>{const b=e.getBaseTarget(N),S=e.getValue(N);S&&(S.liveStyle=!0),V[N]=b??null}),E.push({animation:V})}let k=!!E.length;return i&&(m.initial===!1||m.initial===m.animate)&&!e.manuallyAnimateOnMount&&(k=!1),i=!1,k?t(E):Promise.resolve()}function g(p,m){var E;if(n[p].isActive===m)return Promise.resolve();(E=e.variantChildren)==null||E.forEach(A=>{var M;return(M=A.animationState)==null?void 0:M.setActive(p,m)}),n[p].isActive=m;const C=f(p);for(const A in n)n[A].protectedKeys={};return C}return{animateChanges:f,setActive:g,setAnimateFunction:l,getState:()=>n,reset:()=>{n=pg(),i=!0}}}function H4(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!iy(t,e):!1}function zi(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function pg(){return{animate:zi(!0),whileInView:zi(),whileHover:zi(),whileTap:zi(),whileDrag:zi(),whileFocus:zi(),exit:zi()}}class _i{constructor(t){this.isMounted=!1,this.node=t}update(){}}class G4 extends _i{constructor(t){super(t),t.animationState||(t.animationState=W4(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Fc(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let Y4=0;class X4 extends _i{constructor(){super(...arguments),this.id=Y4++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const a=this.node.animationState.setActive("exit",!t);n&&!t&&a.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Q4={animation:{Feature:G4},exit:{Feature:X4}};function Aa(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}function La(e){return{point:{x:e.pageX,y:e.pageY}}}const K4=e=>t=>Zh(t)&&e(t,La(t));function Zo(e,t,n,i){return Aa(e,t,K4(n),i)}function oy({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function Z4({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $4(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}const ay=1e-4,q4=1-ay,J4=1+ay,ly=.01,e8=0-ly,t8=0+ly;function gn(e){return e.max-e.min}function n8(e,t,n){return Math.abs(e-t)<=n}function mg(e,t,n,i=.5){e.origin=i,e.originPoint=At(t.min,t.max,e.origin),e.scale=gn(n)/gn(t),e.translate=At(n.min,n.max,e.origin)-e.originPoint,(e.scale>=q4&&e.scale<=J4||isNaN(e.scale))&&(e.scale=1),(e.translate>=e8&&e.translate<=t8||isNaN(e.translate))&&(e.translate=0)}function $o(e,t,n,i){mg(e.x,t.x,n.x,i?i.originX:void 0),mg(e.y,t.y,n.y,i?i.originY:void 0)}function xg(e,t,n){e.min=n.min+t.min,e.max=e.min+gn(t)}function r8(e,t,n){xg(e.x,t.x,n.x),xg(e.y,t.y,n.y)}function yg(e,t,n){e.min=t.min-n.min,e.max=e.min+gn(t)}function qo(e,t,n){yg(e.x,t.x,n.x),yg(e.y,t.y,n.y)}const wg=()=>({translate:0,scale:1,origin:0,originPoint:0}),Os=()=>({x:wg(),y:wg()}),Cg=()=>({min:0,max:0}),Lt=()=>({x:Cg(),y:Cg()});function Qn(e){return[e("x"),e("y")]}function Hu(e){return e===void 0||e===1}function ff({scale:e,scaleX:t,scaleY:n}){return!Hu(e)||!Hu(t)||!Hu(n)}function Gi(e){return ff(e)||cy(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function cy(e){return Eg(e.x)||Eg(e.y)}function Eg(e){return e&&e!=="0%"}function fc(e,t,n){const i=e-n,a=t*i;return n+a}function vg(e,t,n,i,a){return a!==void 0&&(e=fc(e,a,i)),fc(e,n,i)+t}function hf(e,t=0,n=1,i,a){e.min=vg(e.min,t,n,i,a),e.max=vg(e.max,t,n,i,a)}function uy(e,{x:t,y:n}){hf(e.x,t.translate,t.scale,t.originPoint),hf(e.y,n.translate,n.scale,n.originPoint)}const Sg=.999999999999,Ag=1.0000000000001;function i8(e,t,n,i=!1){const a=n.length;if(!a)return;t.x=t.y=1;let l,f;for(let g=0;g<a;g++){l=n[g],f=l.projectionDelta;const{visualElement:p}=l.options;p&&p.props.style&&p.props.style.display==="contents"||(i&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Ps(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),f&&(t.x*=f.x.scale,t.y*=f.y.scale,uy(e,f)),i&&Gi(l.latestValues)&&Ps(e,l.latestValues))}t.x<Ag&&t.x>Sg&&(t.x=1),t.y<Ag&&t.y>Sg&&(t.y=1)}function ks(e,t){e.min=e.min+t,e.max=e.max+t}function Tg(e,t,n,i,a=.5){const l=At(e.min,e.max,a);hf(e,t,n,l,i)}function Ps(e,t){Tg(e.x,t.x,t.scaleX,t.scale,t.originX),Tg(e.y,t.y,t.scaleY,t.scale,t.originY)}function dy(e,t){return oy($4(e.getBoundingClientRect(),t))}function s8(e,t,n){const i=dy(e,n),{scroll:a}=t;return a&&(ks(i.x,a.offset.x),ks(i.y,a.offset.y)),i}const fy=({current:e})=>e?e.ownerDocument.defaultView:null,bg=(e,t)=>Math.abs(e-t);function o8(e,t){const n=bg(e.x,t.x),i=bg(e.y,t.y);return Math.sqrt(n**2+i**2)}class hy{constructor(t,n,{transformPagePoint:i,contextWindow:a,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Yu(this.lastMoveEventInfo,this.history),A=this.startEvent!==null,M=o8(E.offset,{x:0,y:0})>=3;if(!A&&!M)return;const{point:_}=E,{timestamp:k}=tn;this.history.push({..._,timestamp:k});const{onStart:V,onMove:N}=this.handlers;A||(V&&V(this.lastMoveEvent,E),this.startEvent=this.lastMoveEvent),N&&N(this.lastMoveEvent,E)},this.handlePointerMove=(E,A)=>{this.lastMoveEvent=E,this.lastMoveEventInfo=Gu(A,this.transformPagePoint),bt.update(this.updatePoint,!0)},this.handlePointerUp=(E,A)=>{this.end();const{onEnd:M,onSessionEnd:_,resumeAnimation:k}=this.handlers;if(this.dragSnapToOrigin&&k&&k(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const V=Yu(E.type==="pointercancel"?this.lastMoveEventInfo:Gu(A,this.transformPagePoint),this.history);this.startEvent&&M&&M(E,V),_&&_(E,V)},!Zh(t))return;this.dragSnapToOrigin=l,this.handlers=n,this.transformPagePoint=i,this.contextWindow=a||window;const f=La(t),g=Gu(f,this.transformPagePoint),{point:p}=g,{timestamp:m}=tn;this.history=[{...p,timestamp:m}];const{onSessionStart:C}=n;C&&C(t,Yu(g,this.history)),this.removeListeners=Oa(Zo(this.contextWindow,"pointermove",this.handlePointerMove),Zo(this.contextWindow,"pointerup",this.handlePointerUp),Zo(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ii(this.updatePoint)}}function Gu(e,t){return t?{point:t(e.point)}:e}function Ig(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Yu({point:e},t){return{point:e,delta:Ig(e,gy(t)),offset:Ig(e,a8(t)),velocity:l8(t,.1)}}function a8(e){return e[0]}function gy(e){return e[e.length-1]}function l8(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const a=gy(e);for(;n>=0&&(i=e[n],!(a.timestamp-i.timestamp>Nr(t)));)n--;if(!i)return{x:0,y:0};const l=Rr(a.timestamp-i.timestamp);if(l===0)return{x:0,y:0};const f={x:(a.x-i.x)/l,y:(a.y-i.y)/l};return f.x===1/0&&(f.x=0),f.y===1/0&&(f.y=0),f}function c8(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?At(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?At(n,e,i.max):Math.min(e,n)),e}function Ng(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function u8(e,{top:t,left:n,bottom:i,right:a}){return{x:Ng(e.x,n,a),y:Ng(e.y,t,i)}}function Rg(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function d8(e,t){return{x:Rg(e.x,t.x),y:Rg(e.y,t.y)}}function f8(e,t){let n=.5;const i=gn(e),a=gn(t);return a>i?n=ya(t.min,t.max-i,e.min):i>a&&(n=ya(e.min,e.max-a,t.min)),Yr(0,1,n)}function h8(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const gf=.35;function g8(e=gf){return e===!1?e=0:e===!0&&(e=gf),{x:Mg(e,"left","right"),y:Mg(e,"top","bottom")}}function Mg(e,t,n){return{min:Dg(e,t),max:Dg(e,n)}}function Dg(e,t){return typeof e=="number"?e:e[t]||0}const p8=new WeakMap;class m8{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Lt(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=C=>{const{dragSnapToOrigin:E}=this.getProps();E?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(La(C).point)},l=(C,E)=>{const{drag:A,dragPropagation:M,onDragStart:_}=this.getProps();if(A&&!M&&(this.openDragLock&&this.openDragLock(),this.openDragLock=MA(A),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Qn(V=>{let N=this.getAxisMotionValue(V).get()||0;if(Mr.test(N)){const{projection:b}=this.visualElement;if(b&&b.layout){const S=b.layout.layoutBox[V];S&&(N=gn(S)*(parseFloat(N)/100))}}this.originPoint[V]=N}),_&&bt.postRender(()=>_(C,E)),uf(this.visualElement,"transform");const{animationState:k}=this.visualElement;k&&k.setActive("whileDrag",!0)},f=(C,E)=>{const{dragPropagation:A,dragDirectionLock:M,onDirectionLock:_,onDrag:k}=this.getProps();if(!A&&!this.openDragLock)return;const{offset:V}=E;if(M&&this.currentDirection===null){this.currentDirection=x8(V),this.currentDirection!==null&&_&&_(this.currentDirection);return}this.updateAxis("x",E.point,V),this.updateAxis("y",E.point,V),this.visualElement.render(),k&&k(C,E)},g=(C,E)=>this.stop(C,E),p=()=>Qn(C=>{var E;return this.getAnimationState(C)==="paused"&&((E=this.getAxisMotionValue(C).animation)==null?void 0:E.play())}),{dragSnapToOrigin:m}=this.getProps();this.panSession=new hy(t,{onSessionStart:a,onStart:l,onMove:f,onSessionEnd:g,resumeAnimation:p},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,contextWindow:fy(this.visualElement)})}stop(t,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:a}=n;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&bt.postRender(()=>l(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,i){const{drag:a}=this.getProps();if(!i||!gl(t,a,this.currentDirection))return;const l=this.getAxisMotionValue(t);let f=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(f=c8(f,this.constraints[t],this.elastic[t])),l.set(f)}resolveConstraints(){var l;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,a=this.constraints;t&&_s(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=u8(i.layoutBox,t):this.constraints=!1,this.elastic=g8(n),a!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Qn(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=h8(i.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!_s(t))return!1;const i=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const l=s8(i,a.root,this.visualElement.getTransformPagePoint());let f=d8(a.layout.layoutBox,l);if(n){const g=n(Z4(f));this.hasMutatedConstraints=!!g,g&&(f=oy(g))}return f}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:a,dragTransition:l,dragSnapToOrigin:f,onDragTransitionEnd:g}=this.getProps(),p=this.constraints||{},m=Qn(C=>{if(!gl(C,n,this.currentDirection))return;let E=p&&p[C]||{};f&&(E={min:0,max:0});const A=a?200:1e6,M=a?40:1e7,_={type:"inertia",velocity:i?t[C]:0,bounceStiffness:A,bounceDamping:M,timeConstant:750,restDelta:1,restSpeed:10,...l,...E};return this.startAxisValueAnimation(C,_)});return Promise.all(m).then(g)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return uf(this.visualElement,t),i.start(o0(t,i,0,n,this.visualElement,!1))}stopAnimation(){Qn(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Qn(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),a=i[n];return a||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){Qn(n=>{const{drag:i}=this.getProps();if(!gl(n,i,this.currentDirection))return;const{projection:a}=this.visualElement,l=this.getAxisMotionValue(n);if(a&&a.layout){const{min:f,max:g}=a.layout.layoutBox[n];l.set(t[n]-At(f,g,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!_s(n)||!i||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Qn(f=>{const g=this.getAxisMotionValue(f);if(g&&this.constraints!==!1){const p=g.get();a[f]=f8({min:p,max:p},this.constraints[f])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Qn(f=>{if(!gl(f,t,null))return;const g=this.getAxisMotionValue(f),{min:p,max:m}=this.constraints[f];g.set(At(p,m,a[f]))})}addListeners(){if(!this.visualElement.current)return;p8.set(this.visualElement,this);const t=this.visualElement.current,n=Zo(t,"pointerdown",p=>{const{drag:m,dragListener:C=!0}=this.getProps();m&&C&&this.start(p)}),i=()=>{const{dragConstraints:p}=this.getProps();_s(p)&&p.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,l=a.addEventListener("measure",i);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),bt.read(i);const f=Aa(window,"resize",()=>this.scalePositionWithinConstraints()),g=a.addEventListener("didUpdate",({delta:p,hasLayoutChanged:m})=>{this.isDragging&&m&&(Qn(C=>{const E=this.getAxisMotionValue(C);E&&(this.originPoint[C]+=p[C].translate,E.set(E.get()+p[C].translate))}),this.visualElement.render())});return()=>{f(),n(),l(),g&&g()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:a=!1,dragConstraints:l=!1,dragElastic:f=gf,dragMomentum:g=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:a,dragConstraints:l,dragElastic:f,dragMomentum:g}}}function gl(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function x8(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class y8 extends _i{constructor(t){super(t),this.removeGroupControls=Jn,this.removeListeners=Jn,this.controls=new m8(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Jn}unmount(){this.removeGroupControls(),this.removeListeners()}}const _g=e=>(t,n)=>{e&&bt.postRender(()=>e(t,n))};class w8 extends _i{constructor(){super(...arguments),this.removePointerDownListener=Jn}onPointerDown(t){this.session=new hy(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:fy(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:a}=this.node.getProps();return{onSessionStart:_g(t),onStart:_g(n),onMove:i,onEnd:(l,f)=>{delete this.session,a&&bt.postRender(()=>a(l,f))}}}mount(){this.removePointerDownListener=Zo(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Pl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Og(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Oo={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Pe.test(e))e=parseFloat(e);else return e;const n=Og(e,t.target.x),i=Og(e,t.target.y);return`${n}% ${i}%`}},C8={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,a=Ni.parse(e);if(a.length>5)return i;const l=Ni.createTransformer(e),f=typeof a[0]!="number"?1:0,g=n.x.scale*t.x,p=n.y.scale*t.y;a[0+f]/=g,a[1+f]/=p;const m=At(g,p,.5);return typeof a[2+f]=="number"&&(a[2+f]/=m),typeof a[3+f]=="number"&&(a[3+f]/=m),l(a)}};class E8 extends R.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:a}=this.props,{projection:l}=t;s4(v8),l&&(n.group&&n.group.add(l),i&&i.register&&a&&i.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Pl.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:a,isPresent:l}=this.props,{projection:f}=i;return f&&(f.isPresent=l,a||t.layoutDependency!==n||n===void 0||t.isPresent!==l?f.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?f.promote():f.relegate()||bt.postRender(()=>{const g=f.getStack();(!g||!g.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Kh.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(a),i&&i.deregister&&i.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function py(e){const[t,n]=z2(),i=R.useContext(bh);return y.jsx(E8,{...e,layoutGroup:i,switchLayoutGroup:R.useContext(X2),isPresent:t,safeToRemove:n})}const v8={borderRadius:{...Oo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Oo,borderTopRightRadius:Oo,borderBottomLeftRadius:Oo,borderBottomRightRadius:Oo,boxShadow:C8};function S8(e,t,n){const i=un(e)?e:Zs(e);return i.start(o0("",i,t,n)),i.animation}const A8=(e,t)=>e.depth-t.depth;class T8{constructor(){this.children=[],this.isDirty=!1}add(t){Rh(this.children,t),this.isDirty=!0}remove(t){Mh(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(A8),this.isDirty=!1,this.children.forEach(t)}}function b8(e,t){const n=In.now(),i=({timestamp:a})=>{const l=a-n;l>=t&&(Ii(i),e(l-t))};return bt.setup(i,!0),()=>Ii(i)}const my=["TopLeft","TopRight","BottomLeft","BottomRight"],I8=my.length,kg=e=>typeof e=="string"?parseFloat(e):e,Pg=e=>typeof e=="number"||Pe.test(e);function N8(e,t,n,i,a,l){a?(e.opacity=At(0,n.opacity??1,R8(i)),e.opacityExit=At(t.opacity??1,0,M8(i))):l&&(e.opacity=At(t.opacity??1,n.opacity??1,i));for(let f=0;f<I8;f++){const g=`border${my[f]}Radius`;let p=Lg(t,g),m=Lg(n,g);if(p===void 0&&m===void 0)continue;p||(p=0),m||(m=0),p===0||m===0||Pg(p)===Pg(m)?(e[g]=Math.max(At(kg(p),kg(m),i),0),(Mr.test(m)||Mr.test(p))&&(e[g]+="%")):e[g]=m}(t.rotate||n.rotate)&&(e.rotate=At(t.rotate||0,n.rotate||0,i))}function Lg(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const R8=xy(0,.5,c2),M8=xy(.5,.95,Jn);function xy(e,t,n){return i=>i<e?0:i>t?1:n(ya(e,t,i))}function Bg(e,t){e.min=t.min,e.max=t.max}function Xn(e,t){Bg(e.x,t.x),Bg(e.y,t.y)}function jg(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function Fg(e,t,n,i,a){return e-=t,e=fc(e,1/n,i),a!==void 0&&(e=fc(e,1/a,i)),e}function D8(e,t=0,n=1,i=.5,a,l=e,f=e){if(Mr.test(t)&&(t=parseFloat(t),t=At(f.min,f.max,t/100)-f.min),typeof t!="number")return;let g=At(l.min,l.max,i);e===l&&(g-=t),e.min=Fg(e.min,t,n,g,a),e.max=Fg(e.max,t,n,g,a)}function Ug(e,t,[n,i,a],l,f){D8(e,t[n],t[i],t[a],t.scale,l,f)}const _8=["x","scaleX","originX"],O8=["y","scaleY","originY"];function Vg(e,t,n,i){Ug(e.x,t,_8,n?n.x:void 0,i?i.x:void 0),Ug(e.y,t,O8,n?n.y:void 0,i?i.y:void 0)}function zg(e){return e.translate===0&&e.scale===1}function yy(e){return zg(e.x)&&zg(e.y)}function Wg(e,t){return e.min===t.min&&e.max===t.max}function k8(e,t){return Wg(e.x,t.x)&&Wg(e.y,t.y)}function Hg(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function wy(e,t){return Hg(e.x,t.x)&&Hg(e.y,t.y)}function Gg(e){return gn(e.x)/gn(e.y)}function Yg(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class P8{constructor(){this.members=[]}add(t){Rh(this.members,t),t.scheduleRender()}remove(t){if(Mh(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(a=>t===a);if(n===0)return!1;let i;for(let a=n;a>=0;a--){const l=this.members[a];if(l.isPresent!==!1){i=l;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function L8(e,t,n){let i="";const a=e.x.translate/t.x,l=e.y.translate/t.y,f=(n==null?void 0:n.z)||0;if((a||l||f)&&(i=`translate3d(${a}px, ${l}px, ${f}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:m,rotate:C,rotateX:E,rotateY:A,skewX:M,skewY:_}=n;m&&(i=`perspective(${m}px) ${i}`),C&&(i+=`rotate(${C}deg) `),E&&(i+=`rotateX(${E}deg) `),A&&(i+=`rotateY(${A}deg) `),M&&(i+=`skewX(${M}deg) `),_&&(i+=`skewY(${_}deg) `)}const g=e.x.scale*t.x,p=e.y.scale*t.y;return(g!==1||p!==1)&&(i+=`scale(${g}, ${p})`),i||"none"}const Xu=["","X","Y","Z"],B8={visibility:"hidden"},j8=1e3;let F8=0;function Qu(e,t,n,i){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),i&&(i[e]=0))}function Cy(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=ny(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:a,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",bt,!(a||l))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&Cy(i)}function Ey({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:a}){return class{constructor(f={},g=t==null?void 0:t()){this.id=F8++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(z8),this.nodes.forEach(X8),this.nodes.forEach(Q8),this.nodes.forEach(W8)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=f,this.root=g?g.root||g:this,this.path=g?[...g.path,g]:[],this.parent=g,this.depth=g?g.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new T8)}addEventListener(f,g){return this.eventHandlers.has(f)||this.eventHandlers.set(f,new Oh),this.eventHandlers.get(f).add(g)}notifyListeners(f,...g){const p=this.eventHandlers.get(f);p&&p.notify(...g)}hasListeners(f){return this.eventHandlers.has(f)}mount(f){if(this.instance)return;this.isSVG=V2(f)&&!LA(f),this.instance=f;const{layoutId:g,layout:p,visualElement:m}=this.options;if(m&&!m.current&&m.mount(f),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(p||g)&&(this.isLayoutDirty=!0),e){let C;const E=()=>this.root.updateBlockedByResize=!1;e(f,()=>{this.root.updateBlockedByResize=!0,C&&C(),C=b8(E,250),Pl.hasAnimatedSinceResize&&(Pl.hasAnimatedSinceResize=!1,this.nodes.forEach(Qg))})}g&&this.root.registerSharedNode(g,this),this.options.animate!==!1&&m&&(g||p)&&this.addEventListener("didUpdate",({delta:C,hasLayoutChanged:E,hasRelativeLayoutChanged:A,layout:M})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||m.getDefaultTransition()||J8,{onLayoutAnimationStart:k,onLayoutAnimationComplete:V}=m.getProps(),N=!this.targetLayout||!wy(this.targetLayout,M),b=!E&&A;if(this.options.layoutRoot||this.resumeFrom||b||E&&(N||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const S={...Xh(_,"layout"),onPlay:k,onComplete:V};(m.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S),this.setAnimationOrigin(C,b)}else E||Qg(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=M})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const f=this.getStack();f&&f.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ii(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(K8),this.animationId++)}getTransformTemplate(){const{visualElement:f}=this.options;return f&&f.getProps().transformTemplate}willUpdate(f=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Cy(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let C=0;C<this.path.length;C++){const E=this.path[C];E.shouldResetTransform=!0,E.updateScroll("snapshot"),E.options.layoutRoot&&E.willUpdate(!1)}const{layoutId:g,layout:p}=this.options;if(g===void 0&&!p)return;const m=this.getTransformTemplate();this.prevTransformTemplateValue=m?m(this.latestValues,""):void 0,this.updateSnapshot(),f&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Xg);return}this.isUpdating||this.nodes.forEach(G8),this.isUpdating=!1,this.nodes.forEach(Y8),this.nodes.forEach(U8),this.nodes.forEach(V8),this.clearAllSnapshots();const g=In.now();tn.delta=Yr(0,1e3/60,g-tn.timestamp),tn.timestamp=g,tn.isProcessing=!0,ju.update.process(tn),ju.preRender.process(tn),ju.render.process(tn),tn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Kh.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(H8),this.sharedNodes.forEach(Z8)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,bt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){bt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!gn(this.snapshot.measuredBox.x)&&!gn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const f=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Lt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:g}=this.options;g&&g.notify("LayoutMeasure",this.layout.layoutBox,f?f.layoutBox:void 0)}updateScroll(f="measure"){let g=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===f&&(g=!1),g&&this.instance){const p=i(this.instance);this.scroll={animationId:this.root.animationId,phase:f,isRoot:p,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:p}}}resetTransform(){if(!a)return;const f=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,g=this.projectionDelta&&!yy(this.projectionDelta),p=this.getTransformTemplate(),m=p?p(this.latestValues,""):void 0,C=m!==this.prevTransformTemplateValue;f&&this.instance&&(g||Gi(this.latestValues)||C)&&(a(this.instance,m),this.shouldResetTransform=!1,this.scheduleRender())}measure(f=!0){const g=this.measurePageBox();let p=this.removeElementScroll(g);return f&&(p=this.removeTransform(p)),eT(p),{animationId:this.root.animationId,measuredBox:g,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){var m;const{visualElement:f}=this.options;if(!f)return Lt();const g=f.measureViewportBox();if(!(((m=this.scroll)==null?void 0:m.wasRoot)||this.path.some(tT))){const{scroll:C}=this.root;C&&(ks(g.x,C.offset.x),ks(g.y,C.offset.y))}return g}removeElementScroll(f){var p;const g=Lt();if(Xn(g,f),(p=this.scroll)!=null&&p.wasRoot)return g;for(let m=0;m<this.path.length;m++){const C=this.path[m],{scroll:E,options:A}=C;C!==this.root&&E&&A.layoutScroll&&(E.wasRoot&&Xn(g,f),ks(g.x,E.offset.x),ks(g.y,E.offset.y))}return g}applyTransform(f,g=!1){const p=Lt();Xn(p,f);for(let m=0;m<this.path.length;m++){const C=this.path[m];!g&&C.options.layoutScroll&&C.scroll&&C!==C.root&&Ps(p,{x:-C.scroll.offset.x,y:-C.scroll.offset.y}),Gi(C.latestValues)&&Ps(p,C.latestValues)}return Gi(this.latestValues)&&Ps(p,this.latestValues),p}removeTransform(f){const g=Lt();Xn(g,f);for(let p=0;p<this.path.length;p++){const m=this.path[p];if(!m.instance||!Gi(m.latestValues))continue;ff(m.latestValues)&&m.updateSnapshot();const C=Lt(),E=m.measurePageBox();Xn(C,E),Vg(g,m.latestValues,m.snapshot?m.snapshot.layoutBox:void 0,C)}return Gi(this.latestValues)&&Vg(g,this.latestValues),g}setTargetDelta(f){this.targetDelta=f,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(f){this.options={...this.options,...f,crossfade:f.crossfade!==void 0?f.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==tn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(f=!1){var A;const g=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=g.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=g.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=g.isSharedProjectionDirty);const p=!!this.resumingFrom||this!==g;if(!(f||p&&this.isSharedProjectionDirty||this.isProjectionDirty||(A=this.parent)!=null&&A.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:C,layoutId:E}=this.options;if(!(!this.layout||!(C||E))){if(this.resolvedRelativeTargetAt=tn.timestamp,!this.targetDelta&&!this.relativeTarget){const M=this.getClosestProjectingParent();M&&M.layout&&this.animationProgress!==1?(this.relativeParent=M,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lt(),this.relativeTargetOrigin=Lt(),qo(this.relativeTargetOrigin,this.layout.layoutBox,M.layout.layoutBox),Xn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Lt(),this.targetWithTransforms=Lt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),r8(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xn(this.target,this.layout.layoutBox),uy(this.target,this.targetDelta)):Xn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const M=this.getClosestProjectingParent();M&&!!M.resumingFrom==!!this.resumingFrom&&!M.options.layoutScroll&&M.target&&this.animationProgress!==1?(this.relativeParent=M,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lt(),this.relativeTargetOrigin=Lt(),qo(this.relativeTargetOrigin,this.target,M.target),Xn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||ff(this.parent.latestValues)||cy(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var _;const f=this.getLead(),g=!!this.resumingFrom||this!==f;let p=!0;if((this.isProjectionDirty||(_=this.parent)!=null&&_.isProjectionDirty)&&(p=!1),g&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(p=!1),this.resolvedRelativeTargetAt===tn.timestamp&&(p=!1),p)return;const{layout:m,layoutId:C}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(m||C))return;Xn(this.layoutCorrected,this.layout.layoutBox);const E=this.treeScale.x,A=this.treeScale.y;i8(this.layoutCorrected,this.treeScale,this.path,g),f.layout&&!f.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(f.target=f.layout.layoutBox,f.targetWithTransforms=Lt());const{target:M}=f;if(!M){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(jg(this.prevProjectionDelta.x,this.projectionDelta.x),jg(this.prevProjectionDelta.y,this.projectionDelta.y)),$o(this.projectionDelta,this.layoutCorrected,M,this.latestValues),(this.treeScale.x!==E||this.treeScale.y!==A||!Yg(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yg(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",M))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(f=!0){var g;if((g=this.options.visualElement)==null||g.scheduleRender(),f){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Os(),this.projectionDelta=Os(),this.projectionDeltaWithTransform=Os()}setAnimationOrigin(f,g=!1){const p=this.snapshot,m=p?p.latestValues:{},C={...this.latestValues},E=Os();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!g;const A=Lt(),M=p?p.source:void 0,_=this.layout?this.layout.source:void 0,k=M!==_,V=this.getStack(),N=!V||V.members.length<=1,b=!!(k&&!N&&this.options.crossfade===!0&&!this.path.some(q8));this.animationProgress=0;let S;this.mixTargetDelta=O=>{const F=O/1e3;Kg(E.x,f.x,F),Kg(E.y,f.y,F),this.setTargetDelta(E),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(qo(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$8(this.relativeTarget,this.relativeTargetOrigin,A,F),S&&k8(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Lt()),Xn(S,this.relativeTarget)),k&&(this.animationValues=C,N8(C,m,this.latestValues,F,b,N)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(f){var g,p,m;this.notifyListeners("animationStart"),(g=this.currentAnimation)==null||g.stop(),(m=(p=this.resumingFrom)==null?void 0:p.currentAnimation)==null||m.stop(),this.pendingAnimation&&(Ii(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=bt.update(()=>{Pl.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Zs(0)),this.currentAnimation=S8(this.motionValue,[0,1e3],{...f,velocity:0,isSync:!0,onUpdate:C=>{this.mixTargetDelta(C),f.onUpdate&&f.onUpdate(C)},onStop:()=>{},onComplete:()=>{f.onComplete&&f.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const f=this.getStack();f&&f.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(j8),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const f=this.getLead();let{targetWithTransforms:g,target:p,layout:m,latestValues:C}=f;if(!(!g||!p||!m)){if(this!==f&&this.layout&&m&&vy(this.options.animationType,this.layout.layoutBox,m.layoutBox)){p=this.target||Lt();const E=gn(this.layout.layoutBox.x);p.x.min=f.target.x.min,p.x.max=p.x.min+E;const A=gn(this.layout.layoutBox.y);p.y.min=f.target.y.min,p.y.max=p.y.min+A}Xn(g,p),Ps(g,C),$o(this.projectionDeltaWithTransform,this.layoutCorrected,g,C)}}registerSharedNode(f,g){this.sharedNodes.has(f)||this.sharedNodes.set(f,new P8),this.sharedNodes.get(f).add(g);const m=g.options.initialPromotionConfig;g.promote({transition:m?m.transition:void 0,preserveFollowOpacity:m&&m.shouldPreserveFollowOpacity?m.shouldPreserveFollowOpacity(g):void 0})}isLead(){const f=this.getStack();return f?f.lead===this:!0}getLead(){var g;const{layoutId:f}=this.options;return f?((g=this.getStack())==null?void 0:g.lead)||this:this}getPrevLead(){var g;const{layoutId:f}=this.options;return f?(g=this.getStack())==null?void 0:g.prevLead:void 0}getStack(){const{layoutId:f}=this.options;if(f)return this.root.sharedNodes.get(f)}promote({needsReset:f,transition:g,preserveFollowOpacity:p}={}){const m=this.getStack();m&&m.promote(this,p),f&&(this.projectionDelta=void 0,this.needsReset=!0),g&&this.setOptions({transition:g})}relegate(){const f=this.getStack();return f?f.relegate(this):!1}resetSkewAndRotation(){const{visualElement:f}=this.options;if(!f)return;let g=!1;const{latestValues:p}=f;if((p.z||p.rotate||p.rotateX||p.rotateY||p.rotateZ||p.skewX||p.skewY)&&(g=!0),!g)return;const m={};p.z&&Qu("z",f,m,this.animationValues);for(let C=0;C<Xu.length;C++)Qu(`rotate${Xu[C]}`,f,m,this.animationValues),Qu(`skew${Xu[C]}`,f,m,this.animationValues);f.render();for(const C in m)f.setStaticValue(C,m[C]),this.animationValues&&(this.animationValues[C]=m[C]);f.scheduleRender()}getProjectionStyles(f){if(!this.instance||this.isSVG)return;if(!this.isVisible)return B8;const g={visibility:""},p=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,g.opacity="",g.pointerEvents=kl(f==null?void 0:f.pointerEvents)||"",g.transform=p?p(this.latestValues,""):"none",g;const m=this.getLead();if(!this.projectionDelta||!this.layout||!m.target){const M={};return this.options.layoutId&&(M.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,M.pointerEvents=kl(f==null?void 0:f.pointerEvents)||""),this.hasProjected&&!Gi(this.latestValues)&&(M.transform=p?p({},""):"none",this.hasProjected=!1),M}const C=m.animationValues||m.latestValues;this.applyTransformsToTarget(),g.transform=L8(this.projectionDeltaWithTransform,this.treeScale,C),p&&(g.transform=p(C,g.transform));const{x:E,y:A}=this.projectionDelta;g.transformOrigin=`${E.origin*100}% ${A.origin*100}% 0`,m.animationValues?g.opacity=m===this?C.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:C.opacityExit:g.opacity=m===this?C.opacity!==void 0?C.opacity:"":C.opacityExit!==void 0?C.opacityExit:0;for(const M in va){if(C[M]===void 0)continue;const{correct:_,applyTo:k,isCSSVariable:V}=va[M],N=g.transform==="none"?C[M]:_(C[M],m);if(k){const b=k.length;for(let S=0;S<b;S++)g[k[S]]=N}else V?this.options.visualElement.renderState.vars[M]=N:g[M]=N}return this.options.layoutId&&(g.pointerEvents=m===this?kl(f==null?void 0:f.pointerEvents)||"":"none"),g}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(f=>{var g;return(g=f.currentAnimation)==null?void 0:g.stop()}),this.root.nodes.forEach(Xg),this.root.sharedNodes.clear()}}}function U8(e){e.updateLayout()}function V8(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:a}=e.layout,{animationType:l}=e.options,f=t.source!==e.layout.source;l==="size"?Qn(E=>{const A=f?t.measuredBox[E]:t.layoutBox[E],M=gn(A);A.min=i[E].min,A.max=A.min+M}):vy(l,t.layoutBox,i)&&Qn(E=>{const A=f?t.measuredBox[E]:t.layoutBox[E],M=gn(i[E]);A.max=A.min+M,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[E].max=e.relativeTarget[E].min+M)});const g=Os();$o(g,i,t.layoutBox);const p=Os();f?$o(p,e.applyTransform(a,!0),t.measuredBox):$o(p,i,t.layoutBox);const m=!yy(g);let C=!1;if(!e.resumeFrom){const E=e.getClosestProjectingParent();if(E&&!E.resumeFrom){const{snapshot:A,layout:M}=E;if(A&&M){const _=Lt();qo(_,t.layoutBox,A.layoutBox);const k=Lt();qo(k,i,M.layoutBox),wy(_,k)||(C=!0),E.options.layoutRoot&&(e.relativeTarget=k,e.relativeTargetOrigin=_,e.relativeParent=E)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:t,delta:p,layoutDelta:g,hasLayoutChanged:m,hasRelativeLayoutChanged:C})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function z8(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function W8(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function H8(e){e.clearSnapshot()}function Xg(e){e.clearMeasurements()}function G8(e){e.isLayoutDirty=!1}function Y8(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Qg(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function X8(e){e.resolveTargetDelta()}function Q8(e){e.calcProjection()}function K8(e){e.resetSkewAndRotation()}function Z8(e){e.removeLeadSnapshot()}function Kg(e,t,n){e.translate=At(t.translate,0,n),e.scale=At(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function Zg(e,t,n,i){e.min=At(t.min,n.min,i),e.max=At(t.max,n.max,i)}function $8(e,t,n,i){Zg(e.x,t.x,n.x,i),Zg(e.y,t.y,n.y,i)}function q8(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const J8={duration:.45,ease:[.4,0,.1,1]},$g=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),qg=$g("applewebkit/")&&!$g("chrome/")?Math.round:Jn;function Jg(e){e.min=qg(e.min),e.max=qg(e.max)}function eT(e){Jg(e.x),Jg(e.y)}function vy(e,t,n){return e==="position"||e==="preserve-aspect"&&!n8(Gg(t),Gg(n),.2)}function tT(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const nT=Ey({attachResizeListener:(e,t)=>Aa(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ku={current:void 0},Sy=Ey({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Ku.current){const e=new nT({});e.mount(window),e.setOptions({layoutScroll:!0}),Ku.current=e}return Ku.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),rT={pan:{Feature:w8},drag:{Feature:y8,ProjectionNode:Sy,MeasureLayout:py}};function ep(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const a="onHover"+n,l=i[a];l&&bt.postRender(()=>l(t,La(t)))}class iT extends _i{mount(){const{current:t}=this.node;t&&(this.unmount=DA(t,(n,i)=>(ep(this.node,i,"Start"),a=>ep(this.node,a,"End"))))}unmount(){}}class sT extends _i{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Oa(Aa(this.node.current,"focus",()=>this.onFocus()),Aa(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function tp(e,t,n){const{props:i}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const a="onTap"+(n==="End"?"":n),l=i[a];l&&bt.postRender(()=>l(t,La(t)))}class oT extends _i{mount(){const{current:t}=this.node;t&&(this.unmount=PA(t,(n,i)=>(tp(this.node,i,"Start"),(a,{success:l})=>tp(this.node,a,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const pf=new WeakMap,Zu=new WeakMap,aT=e=>{const t=pf.get(e.target);t&&t(e)},lT=e=>{e.forEach(aT)};function cT({root:e,...t}){const n=e||document;Zu.has(n)||Zu.set(n,{});const i=Zu.get(n),a=JSON.stringify(t);return i[a]||(i[a]=new IntersectionObserver(lT,{root:e,...t})),i[a]}function uT(e,t,n){const i=cT(t);return pf.set(e,n),i.observe(e),()=>{pf.delete(e),i.unobserve(e)}}const dT={some:0,all:1};class fT extends _i{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:a="some",once:l}=t,f={root:n?n.current:void 0,rootMargin:i,threshold:typeof a=="number"?a:dT[a]},g=p=>{const{isIntersecting:m}=p;if(this.isInView===m||(this.isInView=m,l&&!m&&this.hasEnteredView))return;m&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",m);const{onViewportEnter:C,onViewportLeave:E}=this.node.getProps(),A=m?C:E;A&&A(p)};return uT(this.node.current,f,g)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(hT(t,n))&&this.startObserver()}unmount(){}}function hT({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const gT={inView:{Feature:fT},tap:{Feature:oT},focus:{Feature:sT},hover:{Feature:iT}},pT={layout:{ProjectionNode:Sy,MeasureLayout:py}},mf={current:null},Ay={current:!1};function mT(){if(Ay.current=!0,!!Nh)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>mf.current=e.matches;e.addListener(t),t()}else mf.current=!1}const xT=new WeakMap;function yT(e,t,n){for(const i in t){const a=t[i],l=n[i];if(un(a))e.addValue(i,a);else if(un(l))e.addValue(i,Zs(a,{owner:e}));else if(l!==a)if(e.hasValue(i)){const f=e.getValue(i);f.liveStyle===!0?f.jump(a):f.hasAnimated||f.set(a)}else{const f=e.getStaticValue(i);e.addValue(i,Zs(f!==void 0?f:a,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const np=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class wT{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:a,blockInitialAnimation:l,visualState:f},g={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Gh,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const A=In.now();this.renderScheduledAt<A&&(this.renderScheduledAt=A,bt.render(this.render,!1,!0))};const{latestValues:p,renderState:m}=f;this.latestValues=p,this.baseTarget={...p},this.initialValues=n.initial?{...p}:{},this.renderState=m,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=g,this.blockInitialAnimation=!!l,this.isControllingVariants=Uc(n),this.isVariantNode=G2(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:C,...E}=this.scrapeMotionValuesFromProps(n,{},this);for(const A in E){const M=E[A];p[A]!==void 0&&un(M)&&M.set(p[A],!1)}}mount(t){this.current=t,xT.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),Ay.current||mT(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:mf.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ii(this.notifyUpdate),Ii(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=ho.has(t);i&&this.onBindTransform&&this.onBindTransform();const a=n.on("change",g=>{this.latestValues[t]=g,this.props.onUpdate&&bt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),l=n.on("renderRequest",this.scheduleRender);let f;window.MotionCheckAppearSync&&(f=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{a(),l(),f&&f(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in qs){const n=qs[t];if(!n)continue;const{isEnabled:i,Feature:a}=n;if(!this.features[t]&&a&&i(this.props)&&(this.features[t]=new a(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Lt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<np.length;i++){const a=np[i];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const l="on"+a,f=t[l];f&&(this.propEventSubscriptions[a]=this.on(a,f))}this.prevMotionValues=yT(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=Zs(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(Jx(i)||t2(i))?i=parseFloat(i):!jA(i)&&Ni.test(n)&&(i=L2(t,n)),this.setBaseTarget(t,un(i)?i.get():i)),un(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var l;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const f=i0(this.props,n,(l=this.presenceContext)==null?void 0:l.custom);f&&(i=f[t])}if(n&&i!==void 0)return i;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!un(a)?a:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new Oh),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class Ty extends wT{constructor(){super(...arguments),this.KeyframeResolver=bA}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;un(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function by(e,{style:t,vars:n},i,a){Object.assign(e.style,t,a&&a.getProjectionStyles(i));for(const l in n)e.style.setProperty(l,n[l])}function CT(e){return window.getComputedStyle(e)}class ET extends Ty{constructor(){super(...arguments),this.type="html",this.renderInstance=by}readValueFromInstance(t,n){var i;if(ho.has(n))return(i=this.projection)!=null&&i.isProjecting?nf(n):GS(t,n);{const a=CT(t),l=(Lh(n)?a.getPropertyValue(n):a[n])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(t,{transformPagePoint:n}){return dy(t,n)}build(t,n,i){t0(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return s0(t,n,i)}}const Iy=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function vT(e,t,n,i){by(e,t,void 0,i);for(const a in t.attrs)e.setAttribute(Iy.has(a)?a:e0(a),t.attrs[a])}class ST extends Ty{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Lt}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(ho.has(n)){const i=P2(n);return i&&i.default||0}return n=Iy.has(n)?n:e0(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return ty(t,n,i)}build(t,n,i){$2(t,n,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(t,n,i,a){vT(t,n,i,a)}mount(t){this.isSVGTag=J2(t.tagName),super.mount(t)}}const AT=(e,t)=>r0(e)?new ST(t):new ET(t,{allowProjection:e!==R.Fragment}),TT=v4({...Q4,...gT,...rT,...pT},AT),ts=XA(TT);function bT({post:e,userid:t,isAdmin:n,onClose:i,onSuccess:a,showMessage:l}){var b;const[f,g]=R.useState(e.title||""),[p,m]=R.useState(e.content||""),[C,E]=R.useState([]),[A,M]=R.useState([]),[_,k]=R.useState(!1),V=S=>{const O=Array.from(S.target.files);E(O);const F=O.map(W=>new Promise(U=>{const B=new FileReader;B.onloadend=()=>U(B.result),B.readAsDataURL(W)}));Promise.all(F).then(M)},N=async S=>{if(S.preventDefault(),!p.trim()){l("กรุณากรอกเนื้อหาข่าวสาร","error");return}k(!0);try{const O=new FormData;O.append("postId",e.id),O.append("title",f),O.append("content",p),O.append("userid",t),C.forEach(U=>{O.append("images",U)}),console.log("Sending edit request for post:",e.id);const F=await fetch("/api/edit-post",{method:"PUT",body:O}),W=await F.json();if(console.log("Edit response:",W),F.ok&&W.status)l("แก้ไขโพสต์สำเร็จ! ✏️","success"),a(),i();else throw new Error(W.message||"Failed to update post")}catch(O){console.error("Edit post error:",O),l(`เกิดข้อผิดพลาดขณะแก้ไขโพสต์: ${O.message}`,"error")}finally{k(!1)}};return y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,padding:"20px"},children:y.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"24px",maxWidth:"600px",width:"100%",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.3)"},children:[y.jsx("h3",{style:{margin:"0 0 20px 0",color:"#1e293b",fontSize:"20px",fontWeight:"600"},children:"แก้ไขโพสต์"}),y.jsxs("form",{onSubmit:N,children:[y.jsx("div",{style:{marginBottom:"16px"},children:y.jsx("input",{type:"text",placeholder:"หัวข้อข่าว (ไม่บังคับ)",value:f,onChange:S=>g(S.target.value),style:{width:"100%",padding:"12px 16px",border:"2px solid #f1f5f9",borderRadius:"12px",fontSize:"16px",fontWeight:"500",outline:"none",transition:"all 0.2s ease",background:"#fafafa"},onFocus:S=>S.target.style.borderColor="#3b82f6",onBlur:S=>S.target.style.borderColor="#f1f5f9"})}),y.jsx("div",{style:{marginBottom:"20px"},children:y.jsx("textarea",{placeholder:"เขียนข่าวสาร...",value:p,onChange:S=>m(S.target.value),required:!0,rows:"4",style:{width:"100%",padding:"16px",border:"2px solid #f1f5f9",borderRadius:"12px",fontSize:"16px",outline:"none",resize:"vertical",minHeight:"100px",fontFamily:"inherit",lineHeight:"1.6",background:"#fafafa",transition:"all 0.2s ease"},onFocus:S=>S.target.style.borderColor="#3b82f6",onBlur:S=>S.target.style.borderColor="#f1f5f9"})}),((b=e.images)==null?void 0:b.length)>0&&y.jsxs("div",{style:{marginBottom:"16px"},children:[y.jsx("p",{style:{marginBottom:"8px",fontWeight:"500",color:"#374151"},children:"รูปภาพปัจจุบัน:"}),y.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(100px, 1fr))",gap:"8px",marginBottom:"12px"},children:e.images.map((S,O)=>y.jsx("img",{src:S,alt:`current-${O}`,style:{width:"100%",height:"80px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e2e8f0"}},O))})]}),y.jsxs("div",{style:{marginBottom:"20px"},children:[y.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:V,style:{display:"none"},id:"editImageUpload"}),y.jsx("label",{htmlFor:"editImageUpload",style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"#f8fafc",border:"2px solid #e2e8f0",borderRadius:"10px",color:"#475569",fontWeight:"500",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseOver:S=>{S.target.style.background="#f1f5f9",S.target.style.borderColor="#cbd5e1"},onMouseOut:S=>{S.target.style.background="#f8fafc",S.target.style.borderColor="#e2e8f0"},children:"📎 เพิ่มรูปใหม่"})]}),A.length>0&&y.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px",marginBottom:"20px",padding:"16px",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0"},children:A.map((S,O)=>y.jsxs("div",{style:{position:"relative"},children:[y.jsx("img",{src:S,alt:`preview-${O}`,style:{width:"100%",height:"100px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e2e8f0"}}),y.jsx("button",{type:"button",onClick:()=>{const F=C.filter((U,B)=>B!==O),W=A.filter((U,B)=>B!==O);E(F),M(W)},style:{position:"absolute",top:"4px",right:"4px",width:"24px",height:"24px",background:"rgba(0,0,0,0.7)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"✕"})]},O))}),y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[y.jsx("button",{type:"button",onClick:i,style:{padding:"12px 20px",background:"transparent",border:"2px solid #e2e8f0",borderRadius:"10px",color:"#64748b",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:S=>{S.target.style.borderColor="#cbd5e1",S.target.style.color="#475569"},onMouseOut:S=>{S.target.style.borderColor="#e2e8f0",S.target.style.color="#64748b"},children:"ยกเลิก"}),y.jsx("button",{type:"submit",disabled:!p.trim()||_,style:{padding:"12px 24px",background:!p.trim()||_?"#e2e8f0":"#3b82f6",border:"none",borderRadius:"10px",color:!p.trim()||_?"#94a3b8":"white",fontWeight:"600",cursor:!p.trim()||_?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"100px"},onMouseOver:S=>{!p.trim()||_||(S.target.style.background="#2563eb")},onMouseOut:S=>{!p.trim()||_||(S.target.style.background="#3b82f6")},children:_?"กำลังแก้ไข...":"บันทึก"})]})]})]})})}function IT({title:e,setTitle:t,content:n,setContent:i,imageFiles:a,setImageFiles:l,imageBase64List:f,setImageBase64List:g,isExpanded:p,setIsExpanded:m,isSubmitting:C,setIsSubmitting:E,userid:A,fetchPosts:M,showMessage:_}){const[k,V]=R.useState(!1),[N,b]=R.useState(null),[S,O]=R.useState("back"),[F,W]=R.useState(!1),U=R.useRef(null),B=R.useRef(null),G=j=>{const q=Array.from(j.target.files);l(q);const re=q.map(X=>new Promise(fe=>{const oe=new FileReader;oe.onloadend=()=>fe(oe.result),oe.readAsDataURL(X)}));Promise.all(re).then(g)},te=async(j="back")=>{try{V(!0),O(j),N&&N.getTracks().forEach(X=>X.stop());const q={video:j==="back"?{facingMode:{ideal:"environment"}}:{facingMode:"user"}};console.log(`🎥 เปิดกล้อง${j==="back"?"หลัง":"หน้า"}...`);const re=await navigator.mediaDevices.getUserMedia(q);b(re),setTimeout(()=>{U.current&&(U.current.srcObject=re,U.current.play().catch(X=>{console.error("Error playing video:",X)}))},100)}catch(q){console.error("Error accessing camera:",q),V(!1),q.name==="NotAllowedError"?_("กรุณาอนุญาตให้เข้าถึงกล้องในเบราว์เซอร์","error"):q.name==="NotFoundError"?_("ไม่พบกล้องในอุปกรณ์นี้","error"):q.name==="NotSupportedError"?_("เบราว์เซอร์นี้ไม่รองรับการใช้งานกล้อง","error"):_("ไม่สามารถเปิดกล้องได้ กรุณาลองใหม่อีกครั้ง","error")}},me=()=>{te(S==="back"?"front":"back")},he=()=>{N&&(N.getTracks().forEach(j=>j.stop()),b(null)),V(!1)},de=()=>{if(U.current&&B.current){W(!0);const j=U.current,q=B.current,re=q.getContext("2d");if(j.readyState!==4){_("กรุณารอสักครู่ให้กล้องเตรียมพร้อม","error"),W(!1);return}q.width=j.videoWidth||640,q.height=j.videoHeight||480,S==="front"?(re.scale(-1,1),re.drawImage(j,-q.width,0,q.width,q.height)):re.drawImage(j,0,0,q.width,q.height),q.toBlob(X=>{if(X){const fe=new File([X],`photo_${Date.now()}.jpg`,{type:"image/jpeg"}),oe=[...a,fe];l(oe);const ve=new FileReader;ve.onloadend=()=>{g(Te=>[...Te,ve.result])},ve.readAsDataURL(fe),he(),_("ถ่ายรูปสำเร็จ! 📸","success")}else _("เกิดข้อผิดพลาดในการถ่ายรูป","error");W(!1)},"image/jpeg",.8)}else _("กล้องยังไม่พร้อม กรุณาลองใหม่อีกครั้ง","error"),W(!1)},pe=async j=>{if(j.preventDefault(),!n.trim()){_("กรุณากรอกเนื้อหาข่าวสาร","error");return}if(!A){_("ไม่พบข้อมูลผู้ใช้ กรุณาเข้าสู่ระบบใหม่","error");return}E(!0);try{const q=new FormData;q.append("title",e||""),q.append("content",n),q.append("userid",A),a.forEach(oe=>{q.append("images",oe)}),console.log("📤 Sending post data:",{title:e||"",content:n.substring(0,50)+"...",userid:A,filesCount:a.length});const re=await fetch("/api/post",{method:"POST",body:q}),X=await re.text();console.log("📥 Raw response:",X);let fe;try{fe=JSON.parse(X)}catch(oe){throw console.error("❌ Failed to parse response:",oe),new Error("Invalid response from server")}if(re.ok&&fe.status)console.log("✅ Post created successfully"),t(""),i(""),l([]),g([]),m(!1),await M(),_("โพสต์ข่าวสารสำเร็จ! 🎉","success");else throw console.error("❌ Server error:",fe),new Error(fe.message||"Failed to create post")}catch(q){console.error("💥 Submit error:",q),_(`เกิดข้อผิดพลาดขณะโพสต์: ${q.message}`,"error")}finally{E(!1)}};return y.jsx("section",{className:"new-post-section",children:y.jsx($s,{children:p?y.jsxs(ts.form,{onSubmit:pe,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #f1f5f9",marginBottom:"24px",boxSizing:"border-box",maxWidth:"100%",overflow:"hidden"},children:[y.jsx("div",{style:{marginBottom:"16px"},children:y.jsx("input",{type:"text",placeholder:"หัวข้อข่าว (ไม่บังคับ)",value:e,onChange:j=>t(j.target.value),style:{width:"100%",padding:"12px 16px",border:"2px solid #f1f5f9",borderRadius:"12px",fontSize:"16px",fontWeight:"500",outline:"none",transition:"all 0.2s ease",background:"#fafafa",boxSizing:"border-box"},onFocus:j=>j.target.style.borderColor="#3b82f6",onBlur:j=>j.target.style.borderColor="#f1f5f9"})}),y.jsx("div",{style:{marginBottom:"20px"},children:y.jsx("textarea",{placeholder:"เขียนข่าวสาร...",value:n,onChange:j=>i(j.target.value),required:!0,rows:"4",style:{width:"100%",padding:"16px",border:"2px solid #f1f5f9",borderRadius:"12px",fontSize:"16px",outline:"none",resize:"vertical",minHeight:"100px",fontFamily:"inherit",lineHeight:"1.6",background:"#fafafa",transition:"all 0.2s ease",boxSizing:"border-box",overflow:"auto"},onFocus:j=>j.target.style.borderColor="#3b82f6",onBlur:j=>j.target.style.borderColor="#f1f5f9"})}),y.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"20px",flexWrap:"wrap"},children:[y.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:G,style:{display:"none"},id:"imageUpload"}),y.jsx("label",{htmlFor:"imageUpload",style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"#f8fafc",border:"2px solid #e2e8f0",borderRadius:"10px",color:"#475569",fontWeight:"500",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseOver:j=>{j.target.style.background="#f1f5f9",j.target.style.borderColor="#cbd5e1"},onMouseOut:j=>{j.target.style.background="#f8fafc",j.target.style.borderColor="#e2e8f0"},children:"📎 เลือกรูป"}),y.jsx("button",{type:"button",onClick:()=>te("back"),style:{display:"inline-flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"#f8fafc",border:"2px solid #e2e8f0",borderRadius:"10px",color:"#475569",fontWeight:"500",cursor:"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseOver:j=>{j.target.style.background="#f1f5f9",j.target.style.borderColor="#cbd5e1"},onMouseOut:j=>{j.target.style.background="#f8fafc",j.target.style.borderColor="#e2e8f0"},children:"📷 ถ่ายรูป"})]}),k&&y.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.92)",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:[y.jsxs("div",{style:{position:"absolute",top:"24px",left:"50%",transform:"translateX(-50%)",color:"white",fontSize:"16px",fontWeight:"500",opacity:"0.9"},children:["กล้อง",S==="back"?"หลัง":"หน้า"]}),N?y.jsxs(y.Fragment,{children:[y.jsx("video",{ref:U,autoPlay:!0,playsInline:!0,muted:!0,style:{maxWidth:"90vw",maxHeight:"65vh",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0,0,0,0.3)",transform:S==="front"?"scaleX(-1)":"none"}}),y.jsxs("div",{style:{marginTop:"32px",display:"flex",gap:"16px",alignItems:"center"},children:[y.jsx("button",{type:"button",onClick:me,style:{width:"48px",height:"48px",backgroundColor:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",transition:"all 0.2s ease",backdropFilter:"blur(10px)"},onMouseOver:j=>j.target.style.backgroundColor="rgba(255,255,255,0.3)",onMouseOut:j=>j.target.style.backgroundColor="rgba(255,255,255,0.2)",children:"🔄"}),y.jsx("button",{type:"button",onClick:de,disabled:F,style:{width:"72px",height:"72px",backgroundColor:F?"rgba(255,255,255,0.3)":"white",border:"4px solid rgba(255,255,255,0.3)",borderRadius:"50%",color:F?"rgba(0,0,0,0.5)":"#000",cursor:F?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",transition:"all 0.2s ease"},children:F?"⏳":"📸"}),y.jsx("button",{type:"button",onClick:he,style:{width:"48px",height:"48px",backgroundColor:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px",transition:"all 0.2s ease",backdropFilter:"blur(10px)"},onMouseOver:j=>j.target.style.backgroundColor="rgba(255,255,255,0.3)",onMouseOut:j=>j.target.style.backgroundColor="rgba(255,255,255,0.2)",children:"✕"})]})]}):y.jsxs("div",{style:{color:"white",fontSize:"16px",textAlign:"center",background:"rgba(255,255,255,0.1)",padding:"32px",borderRadius:"16px",backdropFilter:"blur(10px)"},children:[y.jsx("div",{style:{fontSize:"2rem",marginBottom:"16px"},children:"�"}),y.jsx("div",{style:{marginBottom:"8px"},children:"กำลังเปิดกล้อง..."}),y.jsx("div",{style:{fontSize:"14px",opacity:.7},children:"อนุญาตการเข้าถึงกล้องในเบราว์เซอร์"})]}),y.jsx("canvas",{ref:B,style:{display:"none"}})]}),f.length>0&&y.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"12px",marginBottom:"20px",padding:"16px",background:"#f8fafc",borderRadius:"12px",border:"1px solid #e2e8f0",boxSizing:"border-box",maxWidth:"100%",overflow:"hidden"},children:f.map((j,q)=>y.jsxs("div",{style:{position:"relative"},children:[y.jsx("img",{src:j,alt:`preview-${q}`,style:{width:"100%",height:"100px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e2e8f0"}}),y.jsx("button",{type:"button",onClick:()=>{const re=a.filter((fe,oe)=>oe!==q),X=f.filter((fe,oe)=>oe!==q);l(re),g(X)},style:{position:"absolute",top:"4px",right:"4px",width:"24px",height:"24px",background:"rgba(0,0,0,0.7)",border:"none",borderRadius:"50%",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"✕"})]},q))}),y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[y.jsx("button",{type:"button",onClick:()=>{m(!1),t(""),i(""),l([]),g([]),O("back"),he()},style:{padding:"12px 20px",background:"transparent",border:"2px solid #e2e8f0",borderRadius:"10px",color:"#64748b",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseOver:j=>{j.target.style.borderColor="#cbd5e1",j.target.style.color="#475569"},onMouseOut:j=>{j.target.style.borderColor="#e2e8f0",j.target.style.color="#64748b"},children:"ยกเลิก"}),y.jsx("button",{type:"submit",disabled:!n.trim()||C,style:{padding:"12px 24px",background:!n.trim()||C?"#e2e8f0":"#3b82f6",border:"none",borderRadius:"10px",color:!n.trim()||C?"#94a3b8":"white",fontWeight:"600",cursor:!n.trim()||C?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"100px"},onMouseOver:j=>{!n.trim()||C||(j.target.style.background="#2563eb")},onMouseOut:j=>{!n.trim()||C||(j.target.style.background="#3b82f6")},children:C?"กำลังโพสต์...":"โพสต์"})]})]}):y.jsx("button",{onClick:()=>m(!0),style:{width:"100%",padding:"16px",background:"white",border:"2px solid #f1f5f9",borderRadius:"16px",color:"#64748b",fontSize:"16px",fontWeight:"500",cursor:"pointer",marginBottom:"24px",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},onMouseOver:j=>{j.target.style.borderColor="#e2e8f0",j.target.style.background="#fafafa"},onMouseOut:j=>{j.target.style.borderColor="#f1f5f9",j.target.style.background="white"},children:"✍️ เขียนข่าวสาร..."})})})}function NT(){const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(!1),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState([]),[A,M]=R.useState([]),[_,k]=R.useState([]),[V,N]=R.useState(!1),[b,S]=R.useState(!1),[O,F]=R.useState(null),[W,U]=R.useState(!1),[B,G]=R.useState(""),[te,me]=R.useState(!1),[he,de]=R.useState(""),[pe,j]=R.useState("success"),[q,re]=R.useState(null),[X,fe]=R.useState(new Set),oe=Zr(),ve=(K,Be="success")=>{de(K),j(Be),me(!0)},Te=()=>{me(!1)};R.useEffect(()=>{const K=localStorage.getItem("token");if(console.log("Token from localStorage:",K,"Type:",typeof K),!K||K==="null"||K==="undefined"){console.log("No valid token found, redirecting to login"),oe("/login");return}const Be=typeof K=="string"?K:JSON.stringify(K);console.log("Using token:",Be.substring(0,30)+"..."),fetch(`/api/user/${Be}`).then(je=>je.json()).then(je=>{console.log("API Response:",je),je.status&&je.data?(t(je.data.realname),i(je.data.userid),l(je.data.admin),je.data.profileImage?G(`data:image/jpeg;base64,${je.data.profileImage}`):je.data.avatar&&G(je.data.avatar),localStorage.setItem("user",JSON.stringify(je.data))):(localStorage.removeItem("token"),oe("/login"))}).catch(()=>{localStorage.removeItem("token"),oe("/login")}),st()},[]);const st=async()=>{try{const Be=await(await fetch("/api/post")).json();console.log("Posts API response:",Be),Be.status&&Be.data?(console.log("Setting posts:",Be.data),Be.data.forEach((je,Oe)=>{var Ue;console.log(`Post ${Oe}:`,{id:je.id,likes:je.likes,likesBy:je.likesBy,title:((Ue=je.title)==null?void 0:Ue.substring(0,20))+"..."})}),k(Be.data)):(console.log("No posts data received"),k([]))}catch(K){console.error("Error fetching posts:",K),k([])}},Ze=async K=>{if(window.confirm("คุณต้องการลบโพสต์นี้ใช่หรือไม่?"))try{const Be=localStorage.getItem("token");(await fetch(`/api/post/${K}`,{method:"DELETE",headers:{Authorization:`Bearer ${Be}`}})).ok?(await st(),ve("ลบโพสต์สำเร็จแล้ว! 🗑️","success")):ve("ลบโพสต์ไม่สำเร็จ","error")}catch{ve("เกิดข้อผิดพลาดขณะลบโพสต์","error")}},Ft=async K=>{var Be,je;if(X.has(K)){console.log("Already processing like for post:",K);return}try{fe(Le=>new Set([...Le,K])),console.log("Sending like request for post:",K),console.log("Current userid:",n,"Type:",typeof n);const Oe=await fetch("/api/like",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({postId:K,userid:n})}),Ue=await Oe.json();if(console.log("Like response:",Ue),Oe.ok&&Ue.status)console.log("Before update - Post likes:",(Be=_.find(Le=>Le.id===K))==null?void 0:Be.likes),console.log("Before update - Post likesBy:",(je=_.find(Le=>Le.id===K))==null?void 0:je.likesBy),console.log("API Response:",Ue.data),k(Le=>{var xe;const Fe=Le.map(Zt=>Zt.id===K?{...Zt,likes:Ue.data.likes,likesBy:Ue.data.likesBy||[]}:Zt),kt=Fe.find(Zt=>Zt.id===K);return console.log("After update - Post data:",{id:kt==null?void 0:kt.id,likes:kt==null?void 0:kt.likes,likesBy:kt==null?void 0:kt.likesBy,userInArray:(xe=kt==null?void 0:kt.likesBy)==null?void 0:xe.some(Zt=>String(Zt)===String(n))}),Fe}),console.log("Updated to - likes:",Ue.data.likes,"likesBy:",Ue.data.likesBy);else throw new Error(Ue.message||"Failed to toggle like")}catch(Oe){console.error("Like post error:",Oe),ve(`เกิดข้อผิดพลาด: ${Oe.message}`,"error")}finally{fe(Oe=>{const Ue=new Set(Oe);return Ue.delete(K),Ue})}},ge=K=>{re(K)},Re=()=>{re(null)},ct=()=>{st()},Ut=R.useCallback(K=>{if(!K.likesBy||!n)return!1;const Be=K.likesBy.some(je=>String(je)===String(n));return console.log(`isUserLiked check for post ${K.id}:`,{userid:n,likes:K.likes,likesBy:K.likesBy,hasUserInArray:Be,result:Be}),Be},[n]),Se=K=>{F(K),S(!0)},Ae=()=>{S(!1),F(null)};function Ge(K){const Be=/(https?:\/\/[^\s]+)/g;return K.split(Be).map((Oe,Ue)=>Be.test(Oe)?y.jsx("a",{href:Oe,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:Oe},Ue):Oe)}return y.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",padding:"20px"},children:y.jsxs("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[y.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"24px",marginBottom:"24px",textAlign:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #f1f5f9"},children:[y.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",margin:"0 auto 16px",background:"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",border:"3px solid #e2e8f0"},children:B?y.jsx("img",{src:B,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"},onError:K=>{K.target.style.display="none"}}):y.jsx("div",{style:{fontSize:"32px",color:"#94a3b8"},children:"👤"})}),y.jsx("div",{style:{fontSize:"20px",fontWeight:"600",color:"#1e293b",marginBottom:"4px"},children:e||"ผู้ใช้"}),y.jsx("div",{style:{fontSize:"14px",color:"#64748b",background:a?"#fef3c7":"#f1f5f9",padding:"4px 12px",borderRadius:"20px",display:"inline-block",fontWeight:"500"},children:a?"👑 ผู้ดูแลระบบ":"✨ สมาชิก"})]}),y.jsx("div",{style:{width:"100%",maxWidth:4500,margin:"0 auto"},children:y.jsx(IT,{title:f,setTitle:g,content:p,setContent:m,imageFiles:C,setImageFiles:E,imageBase64List:A,setImageBase64List:M,isExpanded:V,setIsExpanded:N,isSubmitting:W,setIsSubmitting:U,userid:n,fetchPosts:st,showMessage:ve})}),y.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[y.jsxs("section",{style:{marginTop:"8px"},children:[y.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",color:"#374151",marginBottom:"20px",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:"📰 ข่าวสารล่าสุด"}),y.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:_.length===0?y.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:"48px 20px",background:"white",borderRadius:"16px",border:"2px dashed #e5e7eb"},children:[y.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📝"}),y.jsx("div",{style:{fontSize:"16px",fontWeight:"500"},children:"ยังไม่มีข่าวสาร"}),y.jsx("div",{style:{fontSize:"14px",marginTop:"8px"},children:"เป็นคนแรกที่แชร์ข่าวสารกันเลย!"})]}):y.jsx($s,{children:_.map(K=>{var Be,je;return y.jsxs(ts.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},style:{background:"white",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #f1f5f9",position:"relative"},children:[y.jsx("div",{style:{position:"absolute",top:"16px",right:"16px",fontSize:"12px",color:"#6b7280",background:"#f8fafc",padding:"4px 8px",borderRadius:"6px",border:"1px solid #e2e8f0",fontWeight:"500"},children:new Date(K.date).toLocaleDateString("th-TH")}),K.title&&y.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1e293b",marginBottom:"12px",lineHeight:"1.4",marginRight:"80px"},children:K.title}),y.jsx("p",{style:{fontSize:"16px",color:"#374151",lineHeight:"1.6",marginBottom:((Be=K.images)==null?void 0:Be.length)>0?"16px":"20px",whiteSpace:"pre-wrap"},children:Ge(K.content)}),((je=K.images)==null?void 0:je.length)>0&&y.jsx("div",{style:{display:"grid",gridTemplateColumns:K.images.length===1?"1fr":"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px",marginBottom:"20px"},children:K.images.map((Oe,Ue)=>y.jsx("img",{src:Oe,alt:`โพสต์ ${Ue+1}`,style:{width:"100%",height:K.images.length===1?"auto":"200px",objectFit:"cover",borderRadius:"12px",cursor:"pointer",transition:"transform 0.2s ease",border:"1px solid #e2e8f0"},onClick:()=>Se(Oe),onMouseOver:Le=>Le.target.style.transform="scale(1.02)",onMouseOut:Le=>Le.target.style.transform="scale(1)"},Ue))}),y.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"16px",borderTop:"1px solid #f1f5f9"},children:[y.jsx("div",{style:{fontSize:"14px",color:"#6b7280",display:"flex",alignItems:"center",gap:"8px"},children:y.jsxs("span",{style:{background:"#f3f4f6",padding:"4px 8px",borderRadius:"6px",fontWeight:"500",display:"inline-flex",alignItems:"center",gap:"8px"},children:[y.jsx("span",{children:K.postedBy}),K.postedYear&&y.jsx("small",{style:{background:"#eef2ff",color:"#3730a3",padding:"2px 6px",borderRadius:"6px",fontSize:"12px",fontWeight:600,marginLeft:"5px"},children:`ชั้นปี ${K.postedYear}`})]})}),y.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[y.jsxs("button",{onClick:()=>Ft(K.id),disabled:X.has(K.id),style:{padding:"8px 12px",background:X.has(K.id)?"#f3f4f6":Ut(K)?"#fef3f2":"#f8fafc",border:`1px solid ${X.has(K.id)?"#d1d5db":Ut(K)?"#fecaca":"#e2e8f0"}`,borderRadius:"8px",color:X.has(K.id)?"#9ca3af":Ut(K)?"#dc2626":"#64748b",cursor:X.has(K.id)?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"4px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease",opacity:X.has(K.id)?.7:1},onMouseOver:Oe=>{X.has(K.id)||(Ut(K)?(Oe.target.style.background="#fee2e2",Oe.target.style.borderColor="#fca5a5"):(Oe.target.style.background="#f1f5f9",Oe.target.style.borderColor="#cbd5e1"))},onMouseOut:Oe=>{X.has(K.id)||(Ut(K)?(Oe.target.style.background="#fef3f2",Oe.target.style.borderColor="#fecaca"):(Oe.target.style.background="#f8fafc",Oe.target.style.borderColor="#e2e8f0"))},title:X.has(K.id)?"กำลังประมวลผล...":Ut(K)?"ยกเลิกไลค์":"กดไลค์",children:[X.has(K.id)?"⏳":Ut(K)?"❤️":"🤍",y.jsx("span",{children:K.likes||0})]}),(a||String(K.userid)===String(n))&&y.jsx("button",{onClick:()=>ge(K),style:{padding:"8px",background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"8px",color:"#2563eb",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:Oe=>{Oe.target.style.background="#dbeafe",Oe.target.style.borderColor="#93c5fd"},onMouseOut:Oe=>{Oe.target.style.background="#eff6ff",Oe.target.style.borderColor="#bfdbfe"},title:"แก้ไขโพสต์",children:"✏️"}),(a||String(K.userid)===String(n))&&y.jsx("button",{onClick:()=>Ze(K.id),style:{padding:"8px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",color:"#dc2626",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},onMouseOver:Oe=>{Oe.target.style.background="#fee2e2",Oe.target.style.borderColor="#fca5a5"},onMouseOut:Oe=>{Oe.target.style.background="#fef2f2",Oe.target.style.borderColor="#fecaca"},title:"ลบโพสต์",children:"🗑️"})]})]})]},K.id)})})})]}),b&&y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.9)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},onClick:Ae,children:y.jsx("img",{src:O,alt:"expanded",style:{maxWidth:"90vw",maxHeight:"90vh",borderRadius:"12px",boxShadow:"0 8px 32px rgba(0,0,0,0.5)"},onClick:K=>K.stopPropagation()})})]}),te&&y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:y.jsxs("div",{style:{backgroundColor:"white",padding:"32px",borderRadius:"20px",boxShadow:"0 20px 50px rgba(0, 0, 0, 0.3)",textAlign:"center",maxWidth:"400px",margin:"20px",border:`3px solid ${pe==="success"?"#10b981":"#ef4444"}`},children:[y.jsx("div",{style:{fontSize:"3rem",marginBottom:"16px"},children:pe==="success"?"✅":"❌"}),y.jsx("h3",{style:{margin:"0 0 12px 0",color:pe==="success"?"#10b981":"#ef4444",fontSize:"1.25rem",fontWeight:"600"},children:pe==="success"?"สำเร็จ!":"เกิดข้อผิดพลาด!"}),y.jsx("p",{style:{margin:"0 0 24px 0",color:"#6b7280",fontSize:"1rem",lineHeight:"1.5"},children:he}),y.jsx("button",{onClick:Te,style:{backgroundColor:pe==="success"?"#10b981":"#ef4444",color:"white",border:"none",padding:"12px 24px",borderRadius:"10px",fontSize:"16px",fontWeight:"600",cursor:"pointer",minWidth:"100px",transition:"all 0.2s ease"},onMouseOver:K=>K.target.style.opacity="0.9",onMouseOut:K=>K.target.style.opacity="1",children:"ตกลง"})]})}),q&&y.jsx(bT,{post:q,userid:n,isAdmin:a,onClose:Re,onSuccess:ct,showMessage:ve})]})})}const Ny="/assets/logo-0b13794e.png";function RT(){const[e,t]=R.useState("login"),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(!1),[C,E]=R.useState(""),[A,M]=R.useState(!1),[_,k]=R.useState(""),[V,N]=R.useState(""),[b,S]=R.useState(""),[O,F]=R.useState(""),[W,U]=R.useState(""),[B,G]=R.useState(""),[te,me]=R.useState(""),he="";console.log("🔍 Environment:","production"),console.log("🔍 API URL:",he);const de=Zr();R.useEffect(()=>{M(!0)},[]);const pe=async q=>{var re,X;q.preventDefault(),g(""),m(!0),E("กำลังเข้าสู่ระบบ...");try{const fe=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:a})}),oe=await fe.json();if(console.log("Login response data:",oe),fe.ok){E("เข้าสู่ระบบสำเร็จ! กำลังนำคุณไปยังหน้าหลัก...");const ve=oe.token||((re=oe.data)==null?void 0:re.token),Te=(X=oe.data)==null?void 0:X.user;console.log("⚡ Fast login - Token:",ve?"OK":"Missing"),console.log("⚡ Fast login - User info:",Te?"OK":"Missing"),ve?(localStorage.setItem("token",ve),console.log("✅ Token saved")):console.error("❌ No token received"),Te?(localStorage.setItem("userInfo",JSON.stringify(Te)),console.log("✅ User info saved immediately:",Te)):console.error("❌ No user info received"),de("/")}else g(oe.error||oe.message||"เข้าสู่ระบบไม่สำเร็จ"),E("")}catch{g("เกิดข้อผิดพลาดในการเชื่อมต่อ"),E("")}finally{m(!1)}},j=async q=>{if(q.preventDefault(),G(""),!_||!O||!W||!V||!b||!te){G("กรุณากรอกข้อมูลให้ครบ");return}if(O!==W){G("รหัสผ่านไม่ตรงกัน");return}try{const re=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:_,realname:V,userid:b,password:O,blood:te})}),X=await re.json();re.ok?(alert("สมัครสมาชิกสำเร็จ"),t("login")):G(X.error||X.message||"สมัครสมาชิกไม่สำเร็จ")}catch{G("เกิดข้อผิดพลาด")}};return y.jsx("div",{className:"login-bg",children:y.jsxs("div",{className:`container ${A?"fade-in":""}`,children:[y.jsx("div",{className:"logo-container",children:y.jsx("img",{src:Ny,alt:"logo",className:"logo"})}),y.jsxs("div",{className:"tabs",children:[y.jsx("button",{className:e==="login"?"active":"",onClick:()=>t("login"),children:"Login"}),y.jsx("button",{className:e==="register"?"active":"",onClick:()=>t("register"),children:"Register"})]}),e==="login"&&y.jsxs("form",{className:"form active",onSubmit:pe,children:[y.jsx("input",{type:"text",placeholder:"ชื่อผู้ใช้ หรือ รหัสประจำตัวประชาชน",value:n,onChange:q=>i(q.target.value),required:!0,disabled:p}),y.jsx("input",{type:"password",placeholder:"รหัสผ่าน",value:a,onChange:q=>l(q.target.value),required:!0,disabled:p}),f&&y.jsx("div",{className:"error-message",children:f}),C&&y.jsx("div",{className:"success-message",children:C}),y.jsx("button",{type:"submit",disabled:p,className:"btn",children:p?"กำลังเข้าสู่ระบบ...":"เข้าสู่ระบบ"})]}),e==="register"&&y.jsxs("form",{className:"form active",onSubmit:j,children:[y.jsx("input",{type:"text",placeholder:"ชื่อผู้ใช้",value:_,onChange:q=>k(q.target.value),required:!0}),y.jsx("input",{type:"text",placeholder:"ชื่อ-นามสกุล",value:V,onChange:q=>N(q.target.value),required:!0}),y.jsx("input",{type:"text",placeholder:"รหัสประจำตัวประชาชน",value:b,onChange:q=>S(q.target.value),required:!0}),y.jsx("input",{type:"password",placeholder:"รหัสผ่าน",value:O,onChange:q=>F(q.target.value),required:!0}),y.jsx("input",{type:"password",placeholder:"ยืนยันรหัสผ่าน",value:W,onChange:q=>U(q.target.value),required:!0}),y.jsxs("select",{value:te,onChange:q=>me(q.target.value),required:!0,className:"register-blood-select",children:[y.jsx("option",{value:"",children:"เลือกกรุ๊ปเลือด"}),y.jsx("option",{value:"A",children:"A"}),y.jsx("option",{value:"B",children:"B"}),y.jsx("option",{value:"O",children:"O"}),y.jsx("option",{value:"AB",children:"AB"})]}),B&&y.jsx("div",{className:"error-message",children:B}),y.jsx("button",{type:"submit",className:"btn",children:"สมัครสมาชิก"})]}),e==="login"&&y.jsxs("div",{className:"login-footer",children:["ยังไม่มีบัญชี? ",y.jsx("span",{className:"login-link",onClick:()=>t("register"),children:"สมัครสมาชิก"})]})]})})}function MT(){const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState("student"),[A,M]=R.useState(""),[_,k]=R.useState(!1),V=Zr();R.useEffect(()=>{k(!0)},[]);const N=async b=>{b.preventDefault(),M("");try{const S=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,realname:n,userid:a,password:f,blood:p,role:C})}),O=await S.json();S.ok?(alert("สมัครสมาชิกสำเร็จ"),V("/login")):M(O.error||O.message||"สมัครสมาชิกไม่สำเร็จ")}catch{M("เกิดข้อผิดพลาด")}};return y.jsxs("div",{className:`register-container ${_?"fade-in":""}`,children:[y.jsx("h2",{className:"register-title",children:"สมัครสมาชิก"}),y.jsxs("form",{onSubmit:N,className:"register-form",children:[y.jsx("input",{type:"text",placeholder:"ชื่อผู้ใช้",value:e,onChange:b=>t(b.target.value),required:!0,className:"register-input"}),y.jsx("input",{type:"text",placeholder:"ชื่อ-นามสกุล",value:n,onChange:b=>i(b.target.value),required:!0,className:"register-input"}),y.jsx("input",{type:"text",placeholder:"รหัสประจำตัวประชาชน",value:a,onChange:b=>l(b.target.value),required:!0,className:"register-input"}),y.jsx("input",{type:"password",placeholder:"รหัสผ่าน",value:f,onChange:b=>g(b.target.value),required:!0,className:"register-input"}),y.jsxs("select",{value:p,onChange:b=>m(b.target.value),required:!0,className:"register-select",children:[y.jsx("option",{value:"",children:"เลือกกรุ๊ปเลือด"}),y.jsx("option",{value:"A",children:"A"}),y.jsx("option",{value:"B",children:"B"}),y.jsx("option",{value:"O",children:"O"}),y.jsx("option",{value:"AB",children:"AB"})]}),y.jsx("input",{type:"hidden",name:"role",value:C}),A&&y.jsx("div",{className:"register-error",children:A}),y.jsx("button",{type:"submit",className:"register-button",children:"สมัครสมาชิก"})]}),y.jsxs("div",{className:"register-footer",children:["มีบัญชีอยู่แล้ว? ",y.jsx(Th,{to:"/login",children:"เข้าสู่ระบบ"})]})]})}const DT=()=>{const[e,t]=R.useState([]);R.useEffect(()=>{fetch("/api/users").then(f=>f.json()).then(f=>t(f)).catch(f=>console.error(f))},[]);const n=f=>f?typeof f=="string"?`data:image/png;base64,${f}`:f.data?`data:image/png;base64,${btoa(new Uint8Array(f.data).reduce((p,m)=>p+String.fromCharCode(m),""))}`:"":"",i=async(f,g)=>{await fetch("/api/user/setAdmin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:f,admin:g})}),t(e.map(p=>p.userid===f?{...p,admin:g}:p)),console.log(g?`User ${f} is now Admin`:`User ${f} is no longer Admin`)},a=async(f,g)=>{try{(await(await fetch("/api/user/role",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:f,role:g})})).json()).status&&(t(e.map(C=>C.userid===f?{...C,role:g,admin:g==="admin"}:C)),console.log(`User ${f} role updated to ${g}`))}catch(p){console.error("Error updating role:",p)}},l={student:"นักเรียนนายสิบ",teacher:"อาจารย์",officer:"นายทหาร",admin:"ผู้ดูแลระบบ"};return y.jsx("div",{className:"userlist-bg",children:y.jsxs("div",{className:"userlist-container",children:[y.jsx("h1",{className:"userlist-title",children:"รายชื่อผู้ใช้ระบบ"}),y.jsxs("table",{className:"userlist-table",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"ID"}),y.jsx("th",{children:"Username"}),y.jsx("th",{children:"Real Name"}),y.jsx("th",{children:"UserID"}),y.jsx("th",{children:"Blood"}),y.jsx("th",{children:"Gun Number"}),y.jsx("th",{children:"Point"}),y.jsx("th",{children:"Major"}),y.jsx("th",{children:"Role"}),y.jsx("th",{children:"Profile Image"}),y.jsx("th",{children:"Admin"})]})}),y.jsx("tbody",{children:e.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:"11",className:"userlist-loading",children:"ไม่พบข้อมูลผู้ใช้"})}):e.map(f=>y.jsxs("tr",{children:[y.jsx("td",{children:f.id}),y.jsx("td",{children:f.username}),y.jsx("td",{children:f.realname}),y.jsx("td",{children:f.userid}),y.jsx("td",{children:f.blood}),y.jsx("td",{children:f.gunNumber}),y.jsx("td",{children:f.point}),y.jsx("td",{children:f.major}),y.jsx("td",{children:y.jsx("select",{value:f.role||"student",onChange:g=>a(f.userid,g.target.value),className:"role-select",children:Object.entries(l).map(([g,p])=>y.jsx("option",{value:g,children:p},g))})}),y.jsx("td",{children:f.profileImage&&f.profileImage.data?y.jsx("img",{src:n(f.profileImage),alt:"profile",className:"userlist-avatar"}):y.jsx("div",{className:"userlist-no-avatar",children:"No Image"})}),y.jsxs("td",{children:[y.jsx("input",{type:"checkbox",checked:!!f.admin,onChange:g=>i(f.userid,g.target.checked),className:"userlist-checkbox"})," ",f.admin?"YES":"NO"]})]},f.id))})]})]})})},pl=({children:e})=>localStorage.getItem("token")?e:y.jsx(ac,{to:"/login",replace:!0});function _T(){var S;const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(0),[f,g]=R.useState([]),[p,m]=R.useState(""),[C,E]=R.useState(""),[A,M]=R.useState(!0),[_,k]=R.useState(""),V=Zr(),N=[{value:"ME",label:"วิศวกรรมเครื่องกล"},{value:"EE",label:"วิศวกรรมไฟฟ้าสื่อสาร"},{value:"CYBER",label:"ความมั่นคงปลอดภัยทางไซเบอร์"},{value:"SCIEN",label:"วิทยาศาสตร์และเทคโนโลยี (EN)"},{value:"CE",label:"วิศวกรรมโยธา"},{value:"GEO",label:"วิศวกรรมแผนที่"},{value:"IE",label:"วิศวกรรมอุตสาหการ"},{value:"SCI",label:"วิทยาศาสตร์และเทคโนโลยี"},{value:"SOC",label:"สังคมศาสตร์เพื่อการพัฒนา"}];R.useEffect(()=>{const O=localStorage.getItem("token");if(!O){M(!1);return}fetch("/api/user/me",{headers:{Authorization:`Bearer ${O}`}}).then(F=>F.json()).then(F=>{if(!F.data||!F.data.userid){M(!1);return}m(F.data.userid),t(F.data.realname||""),E(F.data.major||""),i(F.data.profileImage?`data:image/jpeg;base64,${F.data.profileImage}`:"");const W=F.data.adjustments||[];g(W),l(F.data.point||0),k(!!F.data.admin),M(!1)}).catch(()=>M(!1))},[]);function b(O){if(!O)return"";const F=new Date(O);return isNaN(F)?O:F.toLocaleDateString("th-TH",{year:"numeric",month:"2-digit",day:"2-digit"})}return A?y.jsx("div",{className:"behavior-point-container",children:y.jsx("div",{className:"loading",children:"Loading..."})}):y.jsx("div",{className:"behavior-point-bg",children:y.jsxs("div",{className:"behavior-point-container",children:[y.jsx("h1",{className:"behavior-point-title",children:"คะแนนความประพฤติ"}),y.jsxs("div",{className:"behavior-card",children:[y.jsx("h2",{children:"ข้อมูลผู้ใช้"}),y.jsxs("div",{className:"profile-section",children:[n?y.jsx("img",{src:n,alt:"Profile",className:"profile-img"}):y.jsx("div",{className:"profile-img no-img",children:"No Image"}),y.jsxs("div",{className:"profile-info",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"ชื่อ:"})," ",e]}),y.jsxs("p",{children:[y.jsx("strong",{children:"รหัส:"})," ",p]}),C&&y.jsxs("p",{children:[y.jsx("strong",{children:"สาขา:"})," ",((S=N.find(O=>O.value===C))==null?void 0:S.label)||C]}),y.jsxs("p",{children:[y.jsx("strong",{children:"คะแนนพฤติกรรม:"})," ",y.jsx("span",{className:"point",children:a})]}),_&&y.jsx("p",{className:"admin-badge",children:"สถานะ: Admin"})]})]}),_&&y.jsx("button",{className:"deduct-point-btn",onClick:()=>V("/DeductPoint"),children:"ไปหน้าหักคะแนน (DeductPoint)"}),y.jsx("h3",{children:"ประวัติการปรับคะแนน"}),y.jsxs("div",{style:{fontWeight:600,display:"flex",padding:"4px 0",borderBottom:"1px solid #e0e0e0",marginBottom:4},children:[y.jsx("span",{style:{flex:1},children:"วันที่"}),y.jsx("span",{style:{width:60,textAlign:"center"},children:"คะแนน"}),y.jsx("span",{style:{flex:2},children:"เหตุผล"}),y.jsx("span",{style:{flex:1},children:"โดย"})]}),y.jsxs("ul",{className:"adjustment-list",children:[f.length===0&&y.jsx("li",{className:"no-history",children:"ไม่มีประวัติการปรับคะแนน"}),f.map((O,F)=>y.jsxs("li",{className:O.change>0?"plus":O.change<0?"minus":"",style:{display:"flex",alignItems:"center"},children:[y.jsx("span",{className:"adj-date",style:{flex:1},children:b(O.date)}),y.jsxs("span",{className:"adj-change",style:{width:60,textAlign:"center"},children:[O.change>0?"+":"",O.change]}),y.jsxs("span",{className:"adj-reason",style:{flex:2},children:["(",O.reason,")"]}),y.jsxs("span",{className:"adj-operator",style:{flex:1},children:["โดย: ",O.operator]})]},F))]})]})]})})}function OT(){const[e,t]=R.useState(""),[n,i]=R.useState(-1),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),C=async E=>{E.preventDefault();const M=await(await fetch("/api/behavior/deduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:e,change:n,reason:a,operator:f})})).json();m(M.message||(M.status?"สำเร็จ":"เกิดข้อผิดพลาด"))};return y.jsx("div",{className:"deduct-point-bg",children:y.jsxs("div",{className:"deduct-point-container",children:[y.jsx("h1",{className:"deduct-point-title",children:"ระบบตัดคะแนนความประพฤติ"}),y.jsxs("div",{className:"deduct-point-card",children:[y.jsx("h2",{children:"ตัดคะแนน"}),y.jsxs("form",{onSubmit:C,children:[y.jsx("div",{children:y.jsxs("label",{children:["รหัสนักเรียน:",y.jsx("input",{value:e,onChange:E=>t(E.target.value),required:!0})]})}),y.jsx("div",{children:y.jsxs("label",{children:["คะแนนที่ตัด:",y.jsx("input",{type:"number",value:Math.abs(n),onChange:E=>i(-Math.abs(Number(E.target.value))),min:"1",required:!0})]})}),y.jsx("div",{children:y.jsxs("label",{children:["เหตุผล:",y.jsx("input",{value:a,onChange:E=>l(E.target.value),required:!0})]})}),y.jsx("div",{children:y.jsxs("label",{children:["ผู้ตัดคะแนน:",y.jsx("input",{value:f,onChange:E=>g(E.target.value),required:!0})]})}),y.jsx("button",{type:"submit",children:"ตัดคะแนน"})]}),p&&y.jsx("div",{className:"message",children:p})]})]})})}const rp=[{value:"ME",label:"วิศวกรรมเครื่องกล"},{value:"EE",label:"วิศวกรรมไฟฟ้าสื่อสาร"},{value:"CYBER",label:"ความมั่นคงปลอดภัยทางไซเบอร์"},{value:"SCIEN",label:"วิทยาศาสตร์และเทคโนโลยี (EN)"},{value:"CE",label:"วิศวกรรมโยธา"},{value:"GEO",label:"วิศวกรรมแผนที่"},{value:"IE",label:"วิศวกรรมอุตสาหการ"},{value:"SCI",label:"วิทยาศาสตร์และเทคโนโลยี"},{value:"SOC",label:"สังคมศาสตร์เพื่อการพัฒนา"}];function kT(){const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState(null),[A,M]=R.useState(""),[_,k]=R.useState(""),[V,N]=R.useState(""),[b,S]=R.useState(""),[O,F]=R.useState(""),[W,U]=R.useState([{key:"",value:1}]),[B,G]=R.useState(""),[te,me]=R.useState(""),[he,de]=R.useState(""),[pe,j]=R.useState(""),[q,re]=R.useState(!1),[X,fe]=R.useState(""),[oe,ve]=R.useState("success"),Te=Zr();R.useEffect(()=>{const Se=localStorage.getItem("token");fetch("/api/user/me",{headers:{Authorization:`Bearer ${Se}`}}).then(Ae=>Ae.json()).then(Ae=>{if(Ae.status){t(Ae.data.realname||""),i(Ae.data.userid||""),l(Ae.data.blood||""),g(Ae.data.gunNumber||"");let Ge=Ae.data.major||"";Ge.startsWith("สาขาวิชา")&&(Ge=Ge.replace("สาขาวิชา","").trim());const K=rp.find(Be=>Be.label===Ge||Be.value===Ge);if(m(K?K.value:""),k(Ae.data.club1||""),N(Ae.data.club2||""),S(Ae.data.club3||""),F(Ae.data.year||""),G(Ae.data.battalion||""),me(Ae.data.company||""),de(Ae.data.platoon||""),j(Ae.data.squad||""),Ae.data.profileImage&&M(`data:image/jpeg;base64,${Ae.data.profileImage}`),Ae.data.other)try{const Be=typeof Ae.data.other=="string"?JSON.parse(Ae.data.other):Ae.data.other;Array.isArray(Be)&&U(Be)}catch{}}}).catch(Ae=>{console.error("Error fetching user data:",Ae)})},[]);const st=Se=>{const Ae=Se.target.files[0];Ae&&(E(Ae),M(URL.createObjectURL(Ae)))},Ze=(Se,Ae,Ge)=>{U(K=>{const Be=[...K];return Be[Se][Ae]=Ge,Be})},Ft=()=>{U(Se=>[...Se,{key:"",value:1}])},ge=Se=>{U(Ae=>Ae.filter((Ge,K)=>K!==Se))},Re=(Se,Ae="success")=>{fe(Se),ve(Ae),re(!0)},ct=()=>{re(!1),oe==="success"&&Te("/")},Ut=Se=>{Se.preventDefault();const Ae=localStorage.getItem("token"),Ge=new FormData;Ge.append("realname",e),Ge.append("userid",n),Ge.append("blood",a),Ge.append("gunNumber",f),Ge.append("major",p),Ge.append("club1",_),Ge.append("club2",V),Ge.append("club3",b),Ge.append("year",O),Ge.append("other",JSON.stringify(W)),Ge.append("battalion",B),Ge.append("company",te),Ge.append("platoon",he),Ge.append("squad",pe),C&&Ge.append("profileImage",C),fetch("/api/user/update",{method:"POST",headers:{Authorization:`Bearer ${Ae}`},body:Ge}).then(K=>K.json()).then(K=>{K.success?Re("บันทึกข้อมูลเรียบร้อยแล้ว! 🎉","success"):Re("ไม่สามารถบันทึกข้อมูลได้ กรุณาลองใหม่อีกครั้ง","error")}).catch(K=>{console.error("Error:",K),Re("เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง","error")})};return y.jsxs("div",{className:"edit-profile-minimal",children:[y.jsxs("form",{className:"edit-profile-form",onSubmit:Ut,children:[y.jsx("h2",{className:"edit-profile-title",children:"แก้ไขข้อมูลส่วนตัว"}),y.jsxs("div",{className:"section-container",children:[y.jsx("h3",{className:"section-title",children:"รูปโปรไฟล์"}),y.jsxs("div",{className:"profile-img-block",children:[A&&y.jsx("img",{src:A,alt:"Preview",className:"profile-img"}),y.jsx("input",{type:"file",accept:"image/*",onChange:st})]})]}),y.jsxs("div",{className:"section-container",children:[y.jsx("h3",{className:"section-title",children:"ข้อมูลพื้นฐาน"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"ชื่อ-นามสกุล"}),y.jsx("input",{type:"text",placeholder:"กรอกชื่อ-นามสกุล",value:e,onChange:Se=>t(Se.target.value),required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"รหัสประจำตัว"}),y.jsx("input",{type:"text",placeholder:"กรอกรหัสประจำตัว",value:n,onChange:Se=>i(Se.target.value),required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"กรุ๊ปเลือด"}),y.jsx("input",{type:"text",placeholder:"กรอกกรุ๊ปเลือด เช่น A, B, AB, O",value:a,onChange:Se=>l(Se.target.value),required:!0})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"เลขปืน (ไม่บังคับ)"}),y.jsx("input",{type:"text",placeholder:"กรอกเลขปืน",value:f,onChange:Se=>g(Se.target.value)})]})]}),y.jsxs("div",{className:"section-container",children:[y.jsx("h3",{className:"section-title",children:"ข้อมูลการศึกษา"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"สาขาวิชา"}),y.jsxs("select",{value:p,onChange:Se=>m(Se.target.value),required:!0,children:[y.jsx("option",{value:"",children:"-- เลือกสาขาวิชา --"}),rp.map(Se=>y.jsx("option",{value:Se.value,children:Se.label},Se.value))]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"ชั้นปี"}),y.jsxs("select",{value:O,onChange:Se=>F(Se.target.value),required:!0,children:[y.jsx("option",{value:"",children:"-- เลือกชั้นปี --"}),y.jsx("option",{value:"1",children:"ชั้นปี 1"}),y.jsx("option",{value:"2",children:"ชั้นปี 2"}),y.jsx("option",{value:"3",children:"ชั้นปี 3"}),y.jsx("option",{value:"4",children:"ชั้นปี 4"}),y.jsx("option",{value:"5",children:"ชั้นปี 5"})]})]})]}),y.jsxs("div",{className:"section-container",children:[y.jsx("h3",{className:"section-title",children:"ข้อมูลสังกัด (ไม่บังคับ)"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"กองพัน"}),y.jsxs("select",{value:B,onChange:Se=>G(Se.target.value),children:[y.jsx("option",{value:"",children:"-- เลือกกองพัน --"}),y.jsx("option",{value:"1",children:"กองพัน 1"}),y.jsx("option",{value:"2",children:"กองพัน 2"}),y.jsx("option",{value:"3",children:"กองพัน 3"}),y.jsx("option",{value:"4",children:"กองพัน 4"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"กองร้อย"}),y.jsxs("select",{value:te,onChange:Se=>me(Se.target.value),children:[y.jsx("option",{value:"",children:"-- เลือกกองร้อย --"}),y.jsx("option",{value:"1",children:"กองร้อย 1"}),y.jsx("option",{value:"2",children:"กองร้อย 2"}),y.jsx("option",{value:"3",children:"กองร้อย 3"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"หมู่"}),y.jsxs("select",{value:he,onChange:Se=>de(Se.target.value),children:[y.jsx("option",{value:"",children:"-- เลือกหมู่ --"}),y.jsx("option",{value:"1",children:"หมู่ 1"}),y.jsx("option",{value:"2",children:"หมู่ 2"}),y.jsx("option",{value:"3",children:"หมู่ 3"}),y.jsx("option",{value:"4",children:"หมู่ 4"})]})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"หมวด"}),y.jsxs("select",{value:pe,onChange:Se=>j(Se.target.value),children:[y.jsx("option",{value:"",children:"-- เลือกหมวด --"}),y.jsx("option",{value:"1",children:"หมวด 1"}),y.jsx("option",{value:"2",children:"หมวด 2"}),y.jsx("option",{value:"3",children:"หมวด 3"})]})]})]}),y.jsxs("div",{className:"section-container",children:[y.jsx("h3",{className:"section-title",children:"ข้อมูลชมรม (ไม่บังคับ)"}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"ชมรมที่ 1"}),y.jsx("input",{type:"text",placeholder:"กรอกชื่อชมรมที่ 1",value:_,onChange:Se=>k(Se.target.value)})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"ชมรมที่ 2"}),y.jsx("input",{type:"text",placeholder:"กรอกชื่อชมรมที่ 2",value:V,onChange:Se=>N(Se.target.value)})]}),y.jsxs("div",{className:"form-group",children:[y.jsx("label",{className:"form-label",children:"ชมรมที่ 3"}),y.jsx("input",{type:"text",placeholder:"กรอกชื่อชมรมที่ 3",value:b,onChange:Se=>S(Se.target.value)})]})]}),y.jsxs("div",{className:"sale-container",children:[y.jsx("h3",{className:"section-title",children:"รายการจำหน่าย (ไม่บังคับ)"}),y.jsx("p",{className:"sale-description",children:"เพิ่มรายการที่ต้องการจำหน่าย เช่น อุปกรณ์การเรียน เครื่องแบบ หรืออื่นๆ"}),W.map((Se,Ae)=>y.jsxs("div",{className:"sale-input-row",children:[y.jsx("input",{placeholder:"ชื่อรายการ",value:Se.key,onChange:Ge=>Ze(Ae,"key",Ge.target.value),style:{flex:2,minWidth:0}}),y.jsx("button",{type:"button",onClick:()=>ge(Ae),style:{padding:"0 10px",height:36,background:"#e57373",color:"#fff",border:"none",borderRadius:4,cursor:"pointer"},children:"-"})]},Ae)),y.jsx("button",{type:"button",onClick:Ft,style:{width:"100%",marginTop:4,background:"#1976d2",color:"#fff",border:"none",borderRadius:6,padding:"10px 0",fontSize:"1rem",fontWeight:500,cursor:"pointer"},children:"+ เพิ่มรายการจำหน่าย"})]}),y.jsx("button",{type:"submit",className:"save-button",children:"บันทึกข้อมูล"})]}),q&&y.jsx("div",{className:"success-popup-backdrop",children:y.jsxs("div",{className:"success-popup",children:[y.jsx("div",{className:"success-icon",children:oe==="success"?"✅":"❌"}),y.jsx("h3",{className:"success-title",children:oe==="success"?"สำเร็จ!":"เกิดข้อผิดพลาด!"}),y.jsx("p",{className:"success-message",children:X}),y.jsx("button",{onClick:ct,className:"success-close-btn",children:"ตกลง"})]})})]})}var Js={},PT=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Ry={},zn={};let a0;const LT=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];zn.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};zn.getSymbolTotalCodewords=function(t){return LT[t]};zn.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};zn.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');a0=t};zn.isKanjiModeEnabled=function(){return typeof a0<"u"};zn.toSJIS=function(t){return a0(t)};var Vc={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+n)}}e.isValid=function(i){return i&&typeof i.bit<"u"&&i.bit>=0&&i.bit<4},e.from=function(i,a){if(e.isValid(i))return i;try{return t(i)}catch{return a}}})(Vc);function My(){this.buffer=[],this.length=0}My.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var BT=My;function Ba(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}Ba.prototype.set=function(e,t,n,i){const a=e*this.size+t;this.data[a]=n,i&&(this.reservedBit[a]=!0)};Ba.prototype.get=function(e,t){return this.data[e*this.size+t]};Ba.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n};Ba.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var jT=Ba,Dy={};(function(e){const t=zn.getSymbolSize;e.getRowColCoords=function(i){if(i===1)return[];const a=Math.floor(i/7)+2,l=t(i),f=l===145?26:Math.ceil((l-13)/(2*a-2))*2,g=[l-7];for(let p=1;p<a-1;p++)g[p]=g[p-1]-f;return g.push(6),g.reverse()},e.getPositions=function(i){const a=[],l=e.getRowColCoords(i),f=l.length;for(let g=0;g<f;g++)for(let p=0;p<f;p++)g===0&&p===0||g===0&&p===f-1||g===f-1&&p===0||a.push([l[g],l[p]]);return a}})(Dy);var _y={};const FT=zn.getSymbolSize,ip=7;_y.getPositions=function(t){const n=FT(t);return[[0,0],[n-ip,0],[0,n-ip]]};var Oy={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},e.from=function(a){return e.isValid(a)?parseInt(a,10):void 0},e.getPenaltyN1=function(a){const l=a.size;let f=0,g=0,p=0,m=null,C=null;for(let E=0;E<l;E++){g=p=0,m=C=null;for(let A=0;A<l;A++){let M=a.get(E,A);M===m?g++:(g>=5&&(f+=t.N1+(g-5)),m=M,g=1),M=a.get(A,E),M===C?p++:(p>=5&&(f+=t.N1+(p-5)),C=M,p=1)}g>=5&&(f+=t.N1+(g-5)),p>=5&&(f+=t.N1+(p-5))}return f},e.getPenaltyN2=function(a){const l=a.size;let f=0;for(let g=0;g<l-1;g++)for(let p=0;p<l-1;p++){const m=a.get(g,p)+a.get(g,p+1)+a.get(g+1,p)+a.get(g+1,p+1);(m===4||m===0)&&f++}return f*t.N2},e.getPenaltyN3=function(a){const l=a.size;let f=0,g=0,p=0;for(let m=0;m<l;m++){g=p=0;for(let C=0;C<l;C++)g=g<<1&2047|a.get(m,C),C>=10&&(g===1488||g===93)&&f++,p=p<<1&2047|a.get(C,m),C>=10&&(p===1488||p===93)&&f++}return f*t.N3},e.getPenaltyN4=function(a){let l=0;const f=a.data.length;for(let p=0;p<f;p++)l+=a.data[p];return Math.abs(Math.ceil(l*100/f/5)-10)*t.N4};function n(i,a,l){switch(i){case e.Patterns.PATTERN000:return(a+l)%2===0;case e.Patterns.PATTERN001:return a%2===0;case e.Patterns.PATTERN010:return l%3===0;case e.Patterns.PATTERN011:return(a+l)%3===0;case e.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(l/3))%2===0;case e.Patterns.PATTERN101:return a*l%2+a*l%3===0;case e.Patterns.PATTERN110:return(a*l%2+a*l%3)%2===0;case e.Patterns.PATTERN111:return(a*l%3+(a+l)%2)%2===0;default:throw new Error("bad maskPattern:"+i)}}e.applyMask=function(a,l){const f=l.size;for(let g=0;g<f;g++)for(let p=0;p<f;p++)l.isReserved(p,g)||l.xor(p,g,n(a,p,g))},e.getBestMask=function(a,l){const f=Object.keys(e.Patterns).length;let g=0,p=1/0;for(let m=0;m<f;m++){l(m),e.applyMask(m,a);const C=e.getPenaltyN1(a)+e.getPenaltyN2(a)+e.getPenaltyN3(a)+e.getPenaltyN4(a);e.applyMask(m,a),C<p&&(p=C,g=m)}return g}})(Oy);var zc={};const pi=Vc,ml=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xl=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];zc.getBlocksCount=function(t,n){switch(n){case pi.L:return ml[(t-1)*4+0];case pi.M:return ml[(t-1)*4+1];case pi.Q:return ml[(t-1)*4+2];case pi.H:return ml[(t-1)*4+3];default:return}};zc.getTotalCodewordsCount=function(t,n){switch(n){case pi.L:return xl[(t-1)*4+0];case pi.M:return xl[(t-1)*4+1];case pi.Q:return xl[(t-1)*4+2];case pi.H:return xl[(t-1)*4+3];default:return}};var ky={},Wc={};const Jo=new Uint8Array(512),hc=new Uint8Array(256);(function(){let t=1;for(let n=0;n<255;n++)Jo[n]=t,hc[t]=n,t<<=1,t&256&&(t^=285);for(let n=255;n<512;n++)Jo[n]=Jo[n-255]})();Wc.log=function(t){if(t<1)throw new Error("log("+t+")");return hc[t]};Wc.exp=function(t){return Jo[t]};Wc.mul=function(t,n){return t===0||n===0?0:Jo[hc[t]+hc[n]]};(function(e){const t=Wc;e.mul=function(i,a){const l=new Uint8Array(i.length+a.length-1);for(let f=0;f<i.length;f++)for(let g=0;g<a.length;g++)l[f+g]^=t.mul(i[f],a[g]);return l},e.mod=function(i,a){let l=new Uint8Array(i);for(;l.length-a.length>=0;){const f=l[0];for(let p=0;p<a.length;p++)l[p]^=t.mul(a[p],f);let g=0;for(;g<l.length&&l[g]===0;)g++;l=l.slice(g)}return l},e.generateECPolynomial=function(i){let a=new Uint8Array([1]);for(let l=0;l<i;l++)a=e.mul(a,new Uint8Array([1,t.exp(l)]));return a}})(ky);const Py=ky;function l0(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}l0.prototype.initialize=function(t){this.degree=t,this.genPoly=Py.generateECPolynomial(this.degree)};l0.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const n=new Uint8Array(t.length+this.degree);n.set(t);const i=Py.mod(n,this.genPoly),a=this.degree-i.length;if(a>0){const l=new Uint8Array(this.degree);return l.set(i,a),l}return i};var UT=l0,Ly={},Oi={},c0={};c0.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Or={};const By="[0-9]+",VT="[A-Z $%*+\\-./:]+";let Ta="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ta=Ta.replace(/u/g,"\\u");const zT="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ta+`)(?:.|[\r
]))+`;Or.KANJI=new RegExp(Ta,"g");Or.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Or.BYTE=new RegExp(zT,"g");Or.NUMERIC=new RegExp(By,"g");Or.ALPHANUMERIC=new RegExp(VT,"g");const WT=new RegExp("^"+Ta+"$"),HT=new RegExp("^"+By+"$"),GT=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Or.testKanji=function(t){return WT.test(t)};Or.testNumeric=function(t){return HT.test(t)};Or.testAlphanumeric=function(t){return GT.test(t)};(function(e){const t=c0,n=Or;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(l,f){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!t.isValid(f))throw new Error("Invalid version: "+f);return f>=1&&f<10?l.ccBits[0]:f<27?l.ccBits[1]:l.ccBits[2]},e.getBestModeForData=function(l){return n.testNumeric(l)?e.NUMERIC:n.testAlphanumeric(l)?e.ALPHANUMERIC:n.testKanji(l)?e.KANJI:e.BYTE},e.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},e.isValid=function(l){return l&&l.bit&&l.ccBits};function i(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+a)}}e.from=function(l,f){if(e.isValid(l))return l;try{return i(l)}catch{return f}}})(Oi);(function(e){const t=zn,n=zc,i=Vc,a=Oi,l=c0,f=7973,g=t.getBCHDigit(f);function p(A,M,_){for(let k=1;k<=40;k++)if(M<=e.getCapacity(k,_,A))return k}function m(A,M){return a.getCharCountIndicator(A,M)+4}function C(A,M){let _=0;return A.forEach(function(k){const V=m(k.mode,M);_+=V+k.getBitsLength()}),_}function E(A,M){for(let _=1;_<=40;_++)if(C(A,_)<=e.getCapacity(_,M,a.MIXED))return _}e.from=function(M,_){return l.isValid(M)?parseInt(M,10):_},e.getCapacity=function(M,_,k){if(!l.isValid(M))throw new Error("Invalid QR Code version");typeof k>"u"&&(k=a.BYTE);const V=t.getSymbolTotalCodewords(M),N=n.getTotalCodewordsCount(M,_),b=(V-N)*8;if(k===a.MIXED)return b;const S=b-m(k,M);switch(k){case a.NUMERIC:return Math.floor(S/10*3);case a.ALPHANUMERIC:return Math.floor(S/11*2);case a.KANJI:return Math.floor(S/13);case a.BYTE:default:return Math.floor(S/8)}},e.getBestVersionForData=function(M,_){let k;const V=i.from(_,i.M);if(Array.isArray(M)){if(M.length>1)return E(M,V);if(M.length===0)return 1;k=M[0]}else k=M;return p(k.mode,k.getLength(),V)},e.getEncodedBits=function(M){if(!l.isValid(M)||M<7)throw new Error("Invalid QR Code version");let _=M<<12;for(;t.getBCHDigit(_)-g>=0;)_^=f<<t.getBCHDigit(_)-g;return M<<12|_}})(Ly);var jy={};const xf=zn,Fy=1335,YT=21522,sp=xf.getBCHDigit(Fy);jy.getEncodedBits=function(t,n){const i=t.bit<<3|n;let a=i<<10;for(;xf.getBCHDigit(a)-sp>=0;)a^=Fy<<xf.getBCHDigit(a)-sp;return(i<<10|a)^YT};var Uy={};const XT=Oi;function eo(e){this.mode=XT.NUMERIC,this.data=e.toString()}eo.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};eo.prototype.getLength=function(){return this.data.length};eo.prototype.getBitsLength=function(){return eo.getBitsLength(this.data.length)};eo.prototype.write=function(t){let n,i,a;for(n=0;n+3<=this.data.length;n+=3)i=this.data.substr(n,3),a=parseInt(i,10),t.put(a,10);const l=this.data.length-n;l>0&&(i=this.data.substr(n),a=parseInt(i,10),t.put(a,l*3+1))};var QT=eo;const KT=Oi,$u=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function to(e){this.mode=KT.ALPHANUMERIC,this.data=e}to.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};to.prototype.getLength=function(){return this.data.length};to.prototype.getBitsLength=function(){return to.getBitsLength(this.data.length)};to.prototype.write=function(t){let n;for(n=0;n+2<=this.data.length;n+=2){let i=$u.indexOf(this.data[n])*45;i+=$u.indexOf(this.data[n+1]),t.put(i,11)}this.data.length%2&&t.put($u.indexOf(this.data[n]),6)};var ZT=to;const $T=Oi;function no(e){this.mode=$T.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}no.getBitsLength=function(t){return t*8};no.prototype.getLength=function(){return this.data.length};no.prototype.getBitsLength=function(){return no.getBitsLength(this.data.length)};no.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)};var qT=no;const JT=Oi,eb=zn;function ro(e){this.mode=JT.KANJI,this.data=e}ro.getBitsLength=function(t){return t*13};ro.prototype.getLength=function(){return this.data.length};ro.prototype.getBitsLength=function(){return ro.getBitsLength(this.data.length)};ro.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=eb.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);n=(n>>>8&255)*192+(n&255),e.put(n,13)}};var tb=ro,Vy={exports:{}};(function(e){var t={single_source_shortest_paths:function(n,i,a){var l={},f={};f[i]=0;var g=t.PriorityQueue.make();g.push(i,0);for(var p,m,C,E,A,M,_,k,V;!g.empty();){p=g.pop(),m=p.value,E=p.cost,A=n[m]||{};for(C in A)A.hasOwnProperty(C)&&(M=A[C],_=E+M,k=f[C],V=typeof f[C]>"u",(V||k>_)&&(f[C]=_,g.push(C,_),l[C]=m))}if(typeof a<"u"&&typeof f[a]>"u"){var N=["Could not find a path from ",i," to ",a,"."].join("");throw new Error(N)}return l},extract_shortest_path_from_predecessor_list:function(n,i){for(var a=[],l=i;l;)a.push(l),n[l],l=n[l];return a.reverse(),a},find_path:function(n,i,a){var l=t.single_source_shortest_paths(n,i,a);return t.extract_shortest_path_from_predecessor_list(l,a)},PriorityQueue:{make:function(n){var i=t.PriorityQueue,a={},l;n=n||{};for(l in i)i.hasOwnProperty(l)&&(a[l]=i[l]);return a.queue=[],a.sorter=n.sorter||i.default_sorter,a},default_sorter:function(n,i){return n.cost-i.cost},push:function(n,i){var a={value:n,cost:i};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Vy);var nb=Vy.exports;(function(e){const t=Oi,n=QT,i=ZT,a=qT,l=tb,f=Or,g=zn,p=nb;function m(N){return unescape(encodeURIComponent(N)).length}function C(N,b,S){const O=[];let F;for(;(F=N.exec(S))!==null;)O.push({data:F[0],index:F.index,mode:b,length:F[0].length});return O}function E(N){const b=C(f.NUMERIC,t.NUMERIC,N),S=C(f.ALPHANUMERIC,t.ALPHANUMERIC,N);let O,F;return g.isKanjiModeEnabled()?(O=C(f.BYTE,t.BYTE,N),F=C(f.KANJI,t.KANJI,N)):(O=C(f.BYTE_KANJI,t.BYTE,N),F=[]),b.concat(S,O,F).sort(function(U,B){return U.index-B.index}).map(function(U){return{data:U.data,mode:U.mode,length:U.length}})}function A(N,b){switch(b){case t.NUMERIC:return n.getBitsLength(N);case t.ALPHANUMERIC:return i.getBitsLength(N);case t.KANJI:return l.getBitsLength(N);case t.BYTE:return a.getBitsLength(N)}}function M(N){return N.reduce(function(b,S){const O=b.length-1>=0?b[b.length-1]:null;return O&&O.mode===S.mode?(b[b.length-1].data+=S.data,b):(b.push(S),b)},[])}function _(N){const b=[];for(let S=0;S<N.length;S++){const O=N[S];switch(O.mode){case t.NUMERIC:b.push([O,{data:O.data,mode:t.ALPHANUMERIC,length:O.length},{data:O.data,mode:t.BYTE,length:O.length}]);break;case t.ALPHANUMERIC:b.push([O,{data:O.data,mode:t.BYTE,length:O.length}]);break;case t.KANJI:b.push([O,{data:O.data,mode:t.BYTE,length:m(O.data)}]);break;case t.BYTE:b.push([{data:O.data,mode:t.BYTE,length:m(O.data)}])}}return b}function k(N,b){const S={},O={start:{}};let F=["start"];for(let W=0;W<N.length;W++){const U=N[W],B=[];for(let G=0;G<U.length;G++){const te=U[G],me=""+W+G;B.push(me),S[me]={node:te,lastCount:0},O[me]={};for(let he=0;he<F.length;he++){const de=F[he];S[de]&&S[de].node.mode===te.mode?(O[de][me]=A(S[de].lastCount+te.length,te.mode)-A(S[de].lastCount,te.mode),S[de].lastCount+=te.length):(S[de]&&(S[de].lastCount=te.length),O[de][me]=A(te.length,te.mode)+4+t.getCharCountIndicator(te.mode,b))}}F=B}for(let W=0;W<F.length;W++)O[F[W]].end=0;return{map:O,table:S}}function V(N,b){let S;const O=t.getBestModeForData(N);if(S=t.from(b,O),S!==t.BYTE&&S.bit<O.bit)throw new Error('"'+N+'" cannot be encoded with mode '+t.toString(S)+`.
 Suggested mode is: `+t.toString(O));switch(S===t.KANJI&&!g.isKanjiModeEnabled()&&(S=t.BYTE),S){case t.NUMERIC:return new n(N);case t.ALPHANUMERIC:return new i(N);case t.KANJI:return new l(N);case t.BYTE:return new a(N)}}e.fromArray=function(b){return b.reduce(function(S,O){return typeof O=="string"?S.push(V(O,null)):O.data&&S.push(V(O.data,O.mode)),S},[])},e.fromString=function(b,S){const O=E(b,g.isKanjiModeEnabled()),F=_(O),W=k(F,S),U=p.find_path(W.map,"start","end"),B=[];for(let G=1;G<U.length-1;G++)B.push(W.table[U[G]].node);return e.fromArray(M(B))},e.rawSplit=function(b){return e.fromArray(E(b,g.isKanjiModeEnabled()))}})(Uy);const Hc=zn,qu=Vc,rb=BT,ib=jT,sb=Dy,ob=_y,yf=Oy,wf=zc,ab=UT,gc=Ly,lb=jy,cb=Oi,Ju=Uy;function ub(e,t){const n=e.size,i=ob.getPositions(t);for(let a=0;a<i.length;a++){const l=i[a][0],f=i[a][1];for(let g=-1;g<=7;g++)if(!(l+g<=-1||n<=l+g))for(let p=-1;p<=7;p++)f+p<=-1||n<=f+p||(g>=0&&g<=6&&(p===0||p===6)||p>=0&&p<=6&&(g===0||g===6)||g>=2&&g<=4&&p>=2&&p<=4?e.set(l+g,f+p,!0,!0):e.set(l+g,f+p,!1,!0))}}function db(e){const t=e.size;for(let n=8;n<t-8;n++){const i=n%2===0;e.set(n,6,i,!0),e.set(6,n,i,!0)}}function fb(e,t){const n=sb.getPositions(t);for(let i=0;i<n.length;i++){const a=n[i][0],l=n[i][1];for(let f=-2;f<=2;f++)for(let g=-2;g<=2;g++)f===-2||f===2||g===-2||g===2||f===0&&g===0?e.set(a+f,l+g,!0,!0):e.set(a+f,l+g,!1,!0)}}function hb(e,t){const n=e.size,i=gc.getEncodedBits(t);let a,l,f;for(let g=0;g<18;g++)a=Math.floor(g/3),l=g%3+n-8-3,f=(i>>g&1)===1,e.set(a,l,f,!0),e.set(l,a,f,!0)}function ed(e,t,n){const i=e.size,a=lb.getEncodedBits(t,n);let l,f;for(l=0;l<15;l++)f=(a>>l&1)===1,l<6?e.set(l,8,f,!0):l<8?e.set(l+1,8,f,!0):e.set(i-15+l,8,f,!0),l<8?e.set(8,i-l-1,f,!0):l<9?e.set(8,15-l-1+1,f,!0):e.set(8,15-l-1,f,!0);e.set(i-8,8,1,!0)}function gb(e,t){const n=e.size;let i=-1,a=n-1,l=7,f=0;for(let g=n-1;g>0;g-=2)for(g===6&&g--;;){for(let p=0;p<2;p++)if(!e.isReserved(a,g-p)){let m=!1;f<t.length&&(m=(t[f]>>>l&1)===1),e.set(a,g-p,m),l--,l===-1&&(f++,l=7)}if(a+=i,a<0||n<=a){a-=i,i=-i;break}}}function pb(e,t,n){const i=new rb;n.forEach(function(p){i.put(p.mode.bit,4),i.put(p.getLength(),cb.getCharCountIndicator(p.mode,e)),p.write(i)});const a=Hc.getSymbolTotalCodewords(e),l=wf.getTotalCodewordsCount(e,t),f=(a-l)*8;for(i.getLengthInBits()+4<=f&&i.put(0,4);i.getLengthInBits()%8!==0;)i.putBit(0);const g=(f-i.getLengthInBits())/8;for(let p=0;p<g;p++)i.put(p%2?17:236,8);return mb(i,e,t)}function mb(e,t,n){const i=Hc.getSymbolTotalCodewords(t),a=wf.getTotalCodewordsCount(t,n),l=i-a,f=wf.getBlocksCount(t,n),g=i%f,p=f-g,m=Math.floor(i/f),C=Math.floor(l/f),E=C+1,A=m-C,M=new ab(A);let _=0;const k=new Array(f),V=new Array(f);let N=0;const b=new Uint8Array(e.buffer);for(let U=0;U<f;U++){const B=U<p?C:E;k[U]=b.slice(_,_+B),V[U]=M.encode(k[U]),_+=B,N=Math.max(N,B)}const S=new Uint8Array(i);let O=0,F,W;for(F=0;F<N;F++)for(W=0;W<f;W++)F<k[W].length&&(S[O++]=k[W][F]);for(F=0;F<A;F++)for(W=0;W<f;W++)S[O++]=V[W][F];return S}function xb(e,t,n,i){let a;if(Array.isArray(e))a=Ju.fromArray(e);else if(typeof e=="string"){let m=t;if(!m){const C=Ju.rawSplit(e);m=gc.getBestVersionForData(C,n)}a=Ju.fromString(e,m||40)}else throw new Error("Invalid data");const l=gc.getBestVersionForData(a,n);if(!l)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=l;else if(t<l)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+l+`.
`);const f=pb(t,n,a),g=Hc.getSymbolSize(t),p=new ib(g);return ub(p,t),db(p),fb(p,t),ed(p,n,0),t>=7&&hb(p,t),gb(p,f),isNaN(i)&&(i=yf.getBestMask(p,ed.bind(null,p,n))),yf.applyMask(i,p),ed(p,n,i),{modules:p,version:t,errorCorrectionLevel:n,maskPattern:i,segments:a}}Ry.create=function(t,n){if(typeof t>"u"||t==="")throw new Error("No input text");let i=qu.M,a,l;return typeof n<"u"&&(i=qu.from(n.errorCorrectionLevel,qu.M),a=gc.from(n.version),l=yf.from(n.maskPattern),n.toSJISFunc&&Hc.setToSJISFunction(n.toSJISFunc)),xb(t,a,i,l)};var zy={},u0={};(function(e){function t(n){if(typeof n=="number"&&(n=n.toString()),typeof n!="string")throw new Error("Color should be defined as hex string");let i=n.slice().replace("#","").split("");if(i.length<3||i.length===5||i.length>8)throw new Error("Invalid hex color: "+n);(i.length===3||i.length===4)&&(i=Array.prototype.concat.apply([],i.map(function(l){return[l,l]}))),i.length===6&&i.push("F","F");const a=parseInt(i.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+i.slice(0,6).join("")}}e.getOptions=function(i){i||(i={}),i.color||(i.color={});const a=typeof i.margin>"u"||i.margin===null||i.margin<0?4:i.margin,l=i.width&&i.width>=21?i.width:void 0,f=i.scale||4;return{width:l,scale:l?4:f,margin:a,color:{dark:t(i.color.dark||"#000000ff"),light:t(i.color.light||"#ffffffff")},type:i.type,rendererOpts:i.rendererOpts||{}}},e.getScale=function(i,a){return a.width&&a.width>=i+a.margin*2?a.width/(i+a.margin*2):a.scale},e.getImageWidth=function(i,a){const l=e.getScale(i,a);return Math.floor((i+a.margin*2)*l)},e.qrToImageData=function(i,a,l){const f=a.modules.size,g=a.modules.data,p=e.getScale(f,l),m=Math.floor((f+l.margin*2)*p),C=l.margin*p,E=[l.color.light,l.color.dark];for(let A=0;A<m;A++)for(let M=0;M<m;M++){let _=(A*m+M)*4,k=l.color.light;if(A>=C&&M>=C&&A<m-C&&M<m-C){const V=Math.floor((A-C)/p),N=Math.floor((M-C)/p);k=E[g[V*f+N]?1:0]}i[_++]=k.r,i[_++]=k.g,i[_++]=k.b,i[_]=k.a}}})(u0);(function(e){const t=u0;function n(a,l,f){a.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=f,l.width=f,l.style.height=f+"px",l.style.width=f+"px"}function i(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(l,f,g){let p=g,m=f;typeof p>"u"&&(!f||!f.getContext)&&(p=f,f=void 0),f||(m=i()),p=t.getOptions(p);const C=t.getImageWidth(l.modules.size,p),E=m.getContext("2d"),A=E.createImageData(C,C);return t.qrToImageData(A.data,l,p),n(E,m,C),E.putImageData(A,0,0),m},e.renderToDataURL=function(l,f,g){let p=g;typeof p>"u"&&(!f||!f.getContext)&&(p=f,f=void 0),p||(p={});const m=e.render(l,f,p),C=p.type||"image/png",E=p.rendererOpts||{};return m.toDataURL(C,E.quality)}})(zy);var Wy={};const yb=u0;function op(e,t){const n=e.a/255,i=t+'="'+e.hex+'"';return n<1?i+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':i}function td(e,t,n){let i=e+t;return typeof n<"u"&&(i+=" "+n),i}function wb(e,t,n){let i="",a=0,l=!1,f=0;for(let g=0;g<e.length;g++){const p=Math.floor(g%t),m=Math.floor(g/t);!p&&!l&&(l=!0),e[g]?(f++,g>0&&p>0&&e[g-1]||(i+=l?td("M",p+n,.5+m+n):td("m",a,0),a=0,l=!1),p+1<t&&e[g+1]||(i+=td("h",f),f=0)):a++}return i}Wy.render=function(t,n,i){const a=yb.getOptions(n),l=t.modules.size,f=t.modules.data,g=l+a.margin*2,p=a.color.light.a?"<path "+op(a.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",m="<path "+op(a.color.dark,"stroke")+' d="'+wb(f,l,a.margin)+'"/>',C='viewBox="0 0 '+g+" "+g+'"',A='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+C+' shape-rendering="crispEdges">'+p+m+`</svg>
`;return typeof i=="function"&&i(null,A),A};const Cb=PT,Cf=Ry,Hy=zy,Eb=Wy;function d0(e,t,n,i,a){const l=[].slice.call(arguments,1),f=l.length,g=typeof l[f-1]=="function";if(!g&&!Cb())throw new Error("Callback required as last argument");if(g){if(f<2)throw new Error("Too few arguments provided");f===2?(a=n,n=t,t=i=void 0):f===3&&(t.getContext&&typeof a>"u"?(a=i,i=void 0):(a=i,i=n,n=t,t=void 0))}else{if(f<1)throw new Error("Too few arguments provided");return f===1?(n=t,t=i=void 0):f===2&&!t.getContext&&(i=n,n=t,t=void 0),new Promise(function(p,m){try{const C=Cf.create(n,i);p(e(C,t,i))}catch(C){m(C)}})}try{const p=Cf.create(n,i);a(null,e(p,t,i))}catch(p){a(p)}}Js.create=Cf.create;Js.toCanvas=d0.bind(null,Hy.render);Js.toDataURL=d0.bind(null,Hy.renderToDataURL);Js.toString=d0.bind(null,function(e,t,n){return Eb.render(e,n)});function vb(){const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState(""),[A,M]=R.useState(!1),[_,k]=R.useState(""),[V,N]=R.useState(""),[b,S]=R.useState(""),[O,F]=R.useState([]),[W,U]=R.useState(""),[B,G]=R.useState(""),[te,me]=R.useState(""),[he,de]=R.useState(""),[pe,j]=R.useState(""),[q,re]=R.useState(""),[X,fe]=R.useState(""),oe="",ve=Zr(),Te=[{value:"ME",label:"วิศวกรรมเครื่องกล"},{value:"EE",label:"วิศวกรรมไฟฟ้าสื่อสาร"},{value:"CYBER",label:"ความมั่นคงปลอดภัยทางไซเบอร์"},{value:"SCIEN",label:"วิทยาศาสตร์และเทคโนโลยี (EN)"},{value:"CE",label:"วิศวกรรมโยธา"},{value:"GEO",label:"วิศวกรรมแผนที่"},{value:"IE",label:"วิศวกรรมอุตสาหการ"},{value:"SCI",label:"วิทยาศาสตร์และเทคโนโลยี"},{value:"SOC",label:"สังคมศาสตร์เพื่อการพัฒนา"}];R.useEffect(()=>{const ge=localStorage.getItem("token");ge?(console.log("API URL:",oe),fetch("/api/user/me",{headers:{Authorization:`Bearer ${ge}`}}).then(Re=>Re.json()).then(Re=>{t(Re.data.realname),i(Re.data.userid),l(Re.data.blood),g(Re.data.gunNumber||"N/A"),m(Re.data.major||"-"),E(Re.data.point??"-"),M(Re.data.admin??!1),F(Re.data.adjustments||[]),U(Re.data.club1||""),G(Re.data.club2||""),me(Re.data.club3||""),de(Re.data.battalion||""),j(Re.data.company||""),re(Re.data.platoon||""),fe(Re.data.squad||""),Re.data.profileImage&&k(`data:image/jpeg;base64,${Re.data.profileImage}`),st(Re.data.userid),Re.data.gunNumber&&Ze(Re.data.gunNumber)})):ve("/login")},[ve]);const st=async ge=>{try{const Re=await Js.toDataURL(ge,{width:60});N(Re)}catch(Re){console.error("Error generating QR Code:",Re)}},Ze=async ge=>{try{const Re=`GUN-${ge}`,ct=await Js.toDataURL(Re,{width:60});S(ct)}catch(Re){console.error("Error generating Gun QR Code:",Re)}},Ft=()=>{ve("/edit-profile")};return y.jsx("div",{className:"view-profile-bg",children:y.jsxs("div",{className:"view-profile-container",children:[y.jsxs("div",{className:"view-profile-header",children:[y.jsx("div",{className:"view-profile-avatar",children:_?y.jsx("img",{src:_,alt:"Profile",className:"view-profile-avatar-img"}):e?e[0]:""}),y.jsxs("div",{children:[y.jsx("div",{className:"view-profile-name",children:e}),y.jsx("div",{className:"view-profile-major",children:p}),y.jsx("button",{onClick:Ft,className:"btn",type:"button",children:"Edit profile"})]})]}),y.jsxs("div",{className:"view-profile-main-row",children:[y.jsxs("div",{className:"view-profile-card",children:[y.jsx("div",{className:"view-profile-card-title",children:"User details"}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"รหัสประจำตัว: "}),n]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"หมู่โลหิต: "}),a]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"หมายเลขปืน: "}),f]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"สาขา: "}),(()=>{const ge=Te.find(Re=>Re.value===p||Re.label===p);return ge?ge.label:p&&!p.startsWith("สาขาวิชา")?`สาขาวิชา${p}`:p})()]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"คะแนนพฤติกรรม: "}),C]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"สิทธิ์ผู้ดูแล: "}),A?"ผู้ดูแลระบบ":"ทั่วไป"]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"ชมรม: "}),y.jsxs("ul",{className:"view-profile-clubs-list",children:[W&&y.jsx("li",{children:W}),B&&y.jsx("li",{children:B}),te&&y.jsx("li",{children:te}),!W&&!B&&!te&&y.jsx("li",{className:"view-profile-no-club",children:"-"})]})]}),y.jsxs("div",{className:"view-profile-row",children:[y.jsx("span",{children:"สังกัด: "}),he||pe||X||q?y.jsxs("span",{children:[he&&`กองพัน ${he}`,he&&pe&&" ",pe&&`กองร้อย ${pe}`,(he||pe)&&X&&" ",X&&`หมวด ${X}`,(he||pe||X)&&q&&" ",q&&`หมู่ ${q}`]}):y.jsx("span",{children:"-"})]}),y.jsx("div",{className:"view-profile-card-subtitle",children:"ประวัติการปรับคะแนน"}),y.jsxs("div",{className:"view-profile-history",children:[O.length===0&&y.jsx("div",{className:"view-profile-no-data",children:"ไม่มีข้อมูล"}),O.map(ge=>y.jsxs("div",{className:"view-profile-history-item",children:[y.jsxs("div",{children:["วันที่: ",new Date(ge.date).toLocaleDateString()]}),y.jsxs("div",{children:["เปลี่ยนแปลง: ",y.jsxs("b",{children:[ge.change>0?"+":"",ge.change]})," (",ge.reason,")"]}),y.jsxs("div",{children:["โดย: ",ge.operator]})]},ge.id))]})]}),y.jsxs("div",{className:"view-profile-card view-profile-qr-only",children:[y.jsx("div",{className:"view-profile-card-title",children:"QR Code"}),V&&y.jsx("img",{src:V,alt:"QR Code",className:"view-profile-qr-img"}),y.jsx("div",{className:"view-profile-card-title view-profile-qr-title",children:"Gun QR Code"}),b&&y.jsx("img",{src:b,alt:"Gun QR Code",className:"view-profile-qr-img"})]})]})]})})}var Ce;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ce||(Ce={}));var ap=new Map([[Ce.QR_CODE,"QR_CODE"],[Ce.AZTEC,"AZTEC"],[Ce.CODABAR,"CODABAR"],[Ce.CODE_39,"CODE_39"],[Ce.CODE_93,"CODE_93"],[Ce.CODE_128,"CODE_128"],[Ce.DATA_MATRIX,"DATA_MATRIX"],[Ce.MAXICODE,"MAXICODE"],[Ce.ITF,"ITF"],[Ce.EAN_13,"EAN_13"],[Ce.EAN_8,"EAN_8"],[Ce.PDF_417,"PDF_417"],[Ce.RSS_14,"RSS_14"],[Ce.RSS_EXPANDED,"RSS_EXPANDED"],[Ce.UPC_A,"UPC_A"],[Ce.UPC_E,"UPC_E"],[Ce.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),lp;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(lp||(lp={}));function Sb(e){return Object.values(Ce).includes(e)}var Qr;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Qr||(Qr={}));var lr=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[Qr.SCAN_TYPE_CAMERA,Qr.SCAN_TYPE_FILE],e}(),Gy=function(){function e(t,n){this.format=t,this.formatName=n}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!ap.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,ap.get(t))},e}(),cp=function(){function e(){}return e.createFromText=function(t){var n={text:t};return{decodedText:t,result:n}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),Ef;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Ef||(Ef={}));var Yy=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:Ef.UNKWOWN_ERROR}},e}(),Xy=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,n){(this.verbose||n===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function Ar(e){return typeof e>"u"||e===null}function Ab(e,t,n){return e>n?n:e<t?t:e}var Ls=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),at=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(t){return"Last Match: ".concat(t)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),up=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),Qy=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,n){if(typeof t!="object"){var i=typeof t;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(a),f=Object.keys(t),g=0,p=f;g<p.length;g++){var m=p[g];if(l.has(m))return n.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},e}(),vf={exports:{}};(function(e,t){(function(n,i){i(t)})(So,function(n){function i(T){return T==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,r){T.__proto__=r}||function(T,r){for(var s in r)r.hasOwnProperty(s)&&(T[s]=r[s])};function l(T,r){a(T,r);function s(){this.constructor=T}T.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}function f(T,r){var s=Object.setPrototypeOf;s?s(T,r):T.__proto__=r}function g(T,r){r===void 0&&(r=T.constructor);var s=Error.captureStackTrace;s&&s(T,r)}var p=function(T){l(r,T);function r(s){var o=this.constructor,c=T.call(this,s)||this;return Object.defineProperty(c,"name",{value:o.name,enumerable:!1}),f(c,o.prototype),g(c),c}return r}(Error);class m extends p{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}m.kind="Exception";class C extends m{}C.kind="ArgumentException";class E extends m{}E.kind="IllegalArgumentException";class A{constructor(r){if(this.binarizer=r,r===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,s){return this.binarizer.getBlackRow(r,s)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,s,o,c){const u=this.binarizer.getLuminanceSource().crop(r,s,o,c);return new A(this.binarizer.createBinarizer(u))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new A(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new A(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class M extends m{static getChecksumInstance(){return new M}}M.kind="ChecksumException";class _{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class k{static arraycopy(r,s,o,c,u){for(;u--;)o[c++]=r[s++]}static currentTimeMillis(){return Date.now()}}class V extends m{}V.kind="IndexOutOfBoundsException";class N extends V{constructor(r=void 0,s=void 0){super(s),this.index=r,this.message=s}}N.kind="ArrayIndexOutOfBoundsException";class b{static fill(r,s){for(let o=0,c=r.length;o<c;o++)r[o]=s}static fillWithin(r,s,o,c){b.rangeCheck(r.length,s,o);for(let u=s;u<o;u++)r[u]=c}static rangeCheck(r,s,o){if(s>o)throw new E("fromIndex("+s+") > toIndex("+o+")");if(s<0)throw new N(s);if(o>r)throw new N(o)}static asList(...r){return r}static create(r,s,o){return Array.from({length:r}).map(u=>Array.from({length:s}).fill(o))}static createInt32Array(r,s,o){return Array.from({length:r}).map(u=>Int32Array.from({length:s}).fill(o))}static equals(r,s){if(!r||!s||!r.length||!s.length||r.length!==s.length)return!1;for(let o=0,c=r.length;o<c;o++)if(r[o]!==s[o])return!1;return!0}static hashCode(r){if(r===null)return 0;let s=1;for(const o of r)s=31*s+o;return s}static fillUint8Array(r,s){for(let o=0;o!==r.length;o++)r[o]=s}static copyOf(r,s){return r.slice(0,s)}static copyOfUint8Array(r,s){if(r.length<=s){const o=new Uint8Array(s);return o.set(r),o}return r.slice(0,s)}static copyOfRange(r,s,o){const c=o-s,u=new Int32Array(c);return k.arraycopy(r,s,u,0,c),u}static binarySearch(r,s,o){o===void 0&&(o=b.numberComparator);let c=0,u=r.length-1;for(;c<=u;){const d=u+c>>1,h=o(s,r[d]);if(h>0)c=d+1;else if(h<0)u=d-1;else return d}return-c-1}static numberComparator(r,s){return r-s}}class S{static numberOfTrailingZeros(r){let s;if(r===0)return 32;let o=31;return s=r<<16,s!==0&&(o-=16,r=s),s=r<<8,s!==0&&(o-=8,r=s),s=r<<4,s!==0&&(o-=4,r=s),s=r<<2,s!==0&&(o-=2,r=s),o-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let s=1;return r>>>16||(s+=16,r<<=16),r>>>24||(s+=8,r<<=8),r>>>28||(s+=4,r<<=4),r>>>30||(s+=2,r<<=2),s-=r>>>31,s}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,s){return Math.trunc(r/s)}static parseInt(r,s=void 0){return parseInt(r,s)}}S.MIN_VALUE_32_BITS=-2147483648,S.MAX_VALUE=Number.MAX_SAFE_INTEGER;class O{constructor(r,s){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,s==null?this.bits=O.makeArray(r):this.bits=s)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const s=O.makeArray(r);k.arraycopy(this.bits,0,s,0,this.bits.length),this.bits=s}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const s=this.size;if(r>=s)return s;const o=this.bits;let c=Math.floor(r/32),u=o[c];u&=~((1<<(r&31))-1);const d=o.length;for(;u===0;){if(++c===d)return s;u=o[c]}const h=c*32+S.numberOfTrailingZeros(u);return h>s?s:h}getNextUnset(r){const s=this.size;if(r>=s)return s;const o=this.bits;let c=Math.floor(r/32),u=~o[c];u&=~((1<<(r&31))-1);const d=o.length;for(;u===0;){if(++c===d)return s;u=~o[c]}const h=c*32+S.numberOfTrailingZeros(u);return h>s?s:h}setBulk(r,s){this.bits[Math.floor(r/32)]=s}setRange(r,s){if(s<r||r<0||s>this.size)throw new E;if(s===r)return;s--;const o=Math.floor(r/32),c=Math.floor(s/32),u=this.bits;for(let d=o;d<=c;d++){const h=d>o?0:r&31,w=(2<<(d<c?31:s&31))-(1<<h);u[d]|=w}}clear(){const r=this.bits.length,s=this.bits;for(let o=0;o<r;o++)s[o]=0}isRange(r,s,o){if(s<r||r<0||s>this.size)throw new E;if(s===r)return!0;s--;const c=Math.floor(r/32),u=Math.floor(s/32),d=this.bits;for(let h=c;h<=u;h++){const x=h>c?0:r&31,v=(2<<(h<u?31:s&31))-(1<<x)&4294967295;if((d[h]&v)!==(o?v:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,s){if(s<0||s>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+s);for(let o=s;o>0;o--)this.appendBit((r>>o-1&1)===1)}appendBitArray(r){const s=r.size;this.ensureCapacity(this.size+s);for(let o=0;o<s;o++)this.appendBit(r.get(o))}xor(r){if(this.size!==r.size)throw new E("Sizes don't match");const s=this.bits;for(let o=0,c=s.length;o<c;o++)s[o]^=r.bits[o]}toBytes(r,s,o,c){for(let u=0;u<c;u++){let d=0;for(let h=0;h<8;h++)this.get(r)&&(d|=1<<7-h),r++;s[o+u]=d}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),s=Math.floor((this.size-1)/32),o=s+1,c=this.bits;for(let u=0;u<o;u++){let d=c[u];d=d>>1&1431655765|(d&1431655765)<<1,d=d>>2&858993459|(d&858993459)<<2,d=d>>4&252645135|(d&252645135)<<4,d=d>>8&16711935|(d&16711935)<<8,d=d>>16&65535|(d&65535)<<16,r[s-u]=d}if(this.size!==o*32){const u=o*32-this.size;let d=r[0]>>>u;for(let h=1;h<o;h++){const x=r[h];d|=x<<32-u,r[h-1]=d,d=x>>>u}r[o-1]=d}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof O))return!1;const s=r;return this.size===s.size&&b.equals(this.bits,s.bits)}hashCode(){return 31*this.size+b.hashCode(this.bits)}toString(){let r="";for(let s=0,o=this.size;s<o;s++)s&7||(r+=" "),r+=this.get(s)?"X":".";return r}clone(){return new O(this.size,this.bits.slice())}}var F;(function(T){T[T.OTHER=0]="OTHER",T[T.PURE_BARCODE=1]="PURE_BARCODE",T[T.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",T[T.TRY_HARDER=3]="TRY_HARDER",T[T.CHARACTER_SET=4]="CHARACTER_SET",T[T.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",T[T.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",T[T.ASSUME_GS1=7]="ASSUME_GS1",T[T.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",T[T.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",T[T.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(F||(F={}));var W=F;class U extends m{static getFormatInstance(){return new U}}U.kind="FormatException";var B;(function(T){T[T.Cp437=0]="Cp437",T[T.ISO8859_1=1]="ISO8859_1",T[T.ISO8859_2=2]="ISO8859_2",T[T.ISO8859_3=3]="ISO8859_3",T[T.ISO8859_4=4]="ISO8859_4",T[T.ISO8859_5=5]="ISO8859_5",T[T.ISO8859_6=6]="ISO8859_6",T[T.ISO8859_7=7]="ISO8859_7",T[T.ISO8859_8=8]="ISO8859_8",T[T.ISO8859_9=9]="ISO8859_9",T[T.ISO8859_10=10]="ISO8859_10",T[T.ISO8859_11=11]="ISO8859_11",T[T.ISO8859_13=12]="ISO8859_13",T[T.ISO8859_14=13]="ISO8859_14",T[T.ISO8859_15=14]="ISO8859_15",T[T.ISO8859_16=15]="ISO8859_16",T[T.SJIS=16]="SJIS",T[T.Cp1250=17]="Cp1250",T[T.Cp1251=18]="Cp1251",T[T.Cp1252=19]="Cp1252",T[T.Cp1256=20]="Cp1256",T[T.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",T[T.UTF8=22]="UTF8",T[T.ASCII=23]="ASCII",T[T.Big5=24]="Big5",T[T.GB18030=25]="GB18030",T[T.EUC_KR=26]="EUC_KR"})(B||(B={}));class G{constructor(r,s,o,...c){this.valueIdentifier=r,this.name=o,typeof s=="number"?this.values=Int32Array.from([s]):this.values=s,this.otherEncodingNames=c,G.VALUE_IDENTIFIER_TO_ECI.set(r,this),G.NAME_TO_ECI.set(o,this);const u=this.values;for(let d=0,h=u.length;d!==h;d++){const x=u[d];G.VALUES_TO_ECI.set(x,this)}for(const d of c)G.NAME_TO_ECI.set(d,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new U("incorect value");const s=G.VALUES_TO_ECI.get(r);if(s===void 0)throw new U("incorect value");return s}static getCharacterSetECIByName(r){const s=G.NAME_TO_ECI.get(r);if(s===void 0)throw new U("incorect value");return s}equals(r){if(!(r instanceof G))return!1;const s=r;return this.getName()===s.getName()}}G.VALUE_IDENTIFIER_TO_ECI=new Map,G.VALUES_TO_ECI=new Map,G.NAME_TO_ECI=new Map,G.Cp437=new G(B.Cp437,Int32Array.from([0,2]),"Cp437"),G.ISO8859_1=new G(B.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),G.ISO8859_2=new G(B.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),G.ISO8859_3=new G(B.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),G.ISO8859_4=new G(B.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),G.ISO8859_5=new G(B.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),G.ISO8859_6=new G(B.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),G.ISO8859_7=new G(B.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),G.ISO8859_8=new G(B.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),G.ISO8859_9=new G(B.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),G.ISO8859_10=new G(B.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),G.ISO8859_11=new G(B.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),G.ISO8859_13=new G(B.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),G.ISO8859_14=new G(B.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),G.ISO8859_15=new G(B.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),G.ISO8859_16=new G(B.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),G.SJIS=new G(B.SJIS,20,"SJIS","Shift_JIS"),G.Cp1250=new G(B.Cp1250,21,"Cp1250","windows-1250"),G.Cp1251=new G(B.Cp1251,22,"Cp1251","windows-1251"),G.Cp1252=new G(B.Cp1252,23,"Cp1252","windows-1252"),G.Cp1256=new G(B.Cp1256,24,"Cp1256","windows-1256"),G.UnicodeBigUnmarked=new G(B.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),G.UTF8=new G(B.UTF8,26,"UTF8","UTF-8"),G.ASCII=new G(B.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),G.Big5=new G(B.Big5,28,"Big5"),G.GB18030=new G(B.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),G.EUC_KR=new G(B.EUC_KR,30,"EUC_KR","EUC-KR");class te extends m{}te.kind="UnsupportedOperationException";class me{static decode(r,s){const o=this.encodingName(s);return this.customDecoder?this.customDecoder(r,o):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(o)?this.decodeFallback(r,o):new TextDecoder(o).decode(r)}static shouldDecodeOnFallback(r){return!me.isBrowser()&&r==="ISO-8859-1"}static encode(r,s){const o=this.encodingName(s);return this.customEncoder?this.customEncoder(r,o):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof G?r:G.getCharacterSetECIByName(r)}static decodeFallback(r,s){const o=this.encodingCharacterSet(s);if(me.isDecodeFallbackSupported(o)){let c="";for(let u=0,d=r.length;u<d;u++){let h=r[u].toString(16);h.length<2&&(h="0"+h),c+="%"+h}return decodeURIComponent(c)}if(o.equals(G.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new te(`Encoding ${this.encodingName(s)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(G.UTF8)||r.equals(G.ISO8859_1)||r.equals(G.ASCII)}static encodeFallback(r){const o=btoa(unescape(encodeURIComponent(r))).split(""),c=[];for(let u=0;u<o.length;u++)c.push(o[u].charCodeAt(0));return new Uint8Array(c)}}class he{static castAsNonUtf8Char(r,s=null){const o=s?s.getName():this.ISO88591;return me.decode(new Uint8Array([r]),o)}static guessEncoding(r,s){if(s!=null&&s.get(W.CHARACTER_SET)!==void 0)return s.get(W.CHARACTER_SET).toString();const o=r.length;let c=!0,u=!0,d=!0,h=0,x=0,w=0,v=0,I=0,D=0,L=0,z=0,H=0,Y=0,$=0;const ce=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let ue=0;ue<o&&(c||u||d);ue++){const se=r[ue]&255;d&&(h>0?se&128?h--:d=!1:se&128&&(se&64?(h++,se&32?(h++,se&16?(h++,se&8?d=!1:v++):w++):x++):d=!1)),c&&(se>127&&se<160?c=!1:se>159&&(se<192||se===215||se===247)&&$++),u&&(I>0?se<64||se===127||se>252?u=!1:I--:se===128||se===160||se>239?u=!1:se>160&&se<224?(D++,z=0,L++,L>H&&(H=L)):se>127?(I++,L=0,z++,z>Y&&(Y=z)):(L=0,z=0))}return d&&h>0&&(d=!1),u&&I>0&&(u=!1),d&&(ce||x+w+v>0)?he.UTF8:u&&(he.ASSUME_SHIFT_JIS||H>=3||Y>=3)?he.SHIFT_JIS:c&&u?H===2&&D===2||$*10>=o?he.SHIFT_JIS:he.ISO88591:c?he.ISO88591:u?he.SHIFT_JIS:d?he.UTF8:he.PLATFORM_DEFAULT_ENCODING}static format(r,...s){let o=-1;function c(d,h,x,w,v,I){if(d==="%%")return"%";if(s[++o]===void 0)return;d=w?parseInt(w.substr(1)):void 0;let D=v?parseInt(v.substr(1)):void 0,L;switch(I){case"s":L=s[o];break;case"c":L=s[o][0];break;case"f":L=parseFloat(s[o]).toFixed(d);break;case"p":L=parseFloat(s[o]).toPrecision(d);break;case"e":L=parseFloat(s[o]).toExponential(d);break;case"x":L=parseInt(s[o]).toString(D||16);break;case"d":L=parseFloat(parseInt(s[o],D||10).toPrecision(d)).toFixed(0);break}L=typeof L=="object"?JSON.stringify(L):(+L).toString(D);let z=parseInt(x),H=x&&x[0]+""=="0"?"0":" ";for(;L.length<z;)L=h!==void 0?L+H:H+L;return L}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(u,c)}static getBytes(r,s){return me.encode(r,s)}static getCharCode(r,s=0){return r.charCodeAt(s)}static getCharAt(r){return String.fromCharCode(r)}}he.SHIFT_JIS=G.SJIS.getName(),he.GB2312="GB2312",he.ISO88591=G.ISO8859_1.getName(),he.EUC_JP="EUC_JP",he.UTF8=G.UTF8.getName(),he.PLATFORM_DEFAULT_ENCODING=he.UTF8,he.ASSUME_SHIFT_JIS=!1;class de{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=he.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,s,o){for(let c=s;s<s+o;c++)this.append(r[c]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+1)}substring(r,s){return this.value.substring(r,s)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+s.length)}}class pe{constructor(r,s,o,c){if(this.width=r,this.height=s,this.rowSize=o,this.bits=c,s==null&&(s=r),this.height=s,r<1||s<1)throw new E("Both dimensions must be greater than 0");o==null&&(o=Math.floor((r+31)/32)),this.rowSize=o,c==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const s=r.length,o=r[0].length,c=new pe(o,s);for(let u=0;u<s;u++){const d=r[u];for(let h=0;h<o;h++)d[h]&&c.set(h,u)}return c}static parseFromString(r,s,o){if(r===null)throw new E("stringRepresentation cannot be null");const c=new Array(r.length);let u=0,d=0,h=-1,x=0,w=0;for(;w<r.length;)if(r.charAt(w)===`
`||r.charAt(w)==="\r"){if(u>d){if(h===-1)h=u-d;else if(u-d!==h)throw new E("row lengths do not match");d=u,x++}w++}else if(r.substring(w,w+s.length)===s)w+=s.length,c[u]=!0,u++;else if(r.substring(w,w+o.length)===o)w+=o.length,c[u]=!1,u++;else throw new E("illegal character encountered: "+r.substring(w));if(u>d){if(h===-1)h=u-d;else if(u-d!==h)throw new E("row lengths do not match");x++}const v=new pe(h,x);for(let I=0;I<u;I++)c[I]&&v.set(Math.floor(I%h),Math.floor(I/h));return v}get(r,s){const o=s*this.rowSize+Math.floor(r/32);return(this.bits[o]>>>(r&31)&1)!==0}set(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]|=1<<(r&31)&4294967295}unset(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]&=~(1<<(r&31)&4294967295)}flip(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new E("input matrix dimensions do not match");const s=new O(Math.floor(this.width/32)+1),o=this.rowSize,c=this.bits;for(let u=0,d=this.height;u<d;u++){const h=u*o,x=r.getRow(u,s).getBitArray();for(let w=0;w<o;w++)c[h+w]^=x[w]}}clear(){const r=this.bits,s=r.length;for(let o=0;o<s;o++)r[o]=0}setRegion(r,s,o,c){if(s<0||r<0)throw new E("Left and top must be nonnegative");if(c<1||o<1)throw new E("Height and width must be at least 1");const u=r+o,d=s+c;if(d>this.height||u>this.width)throw new E("The region must fit inside the matrix");const h=this.rowSize,x=this.bits;for(let w=s;w<d;w++){const v=w*h;for(let I=r;I<u;I++)x[v+Math.floor(I/32)]|=1<<(I&31)&4294967295}}getRow(r,s){s==null||s.getSize()<this.width?s=new O(this.width):s.clear();const o=this.rowSize,c=this.bits,u=r*o;for(let d=0;d<o;d++)s.setBulk(d*32,c[u+d]);return s}setRow(r,s){k.arraycopy(s.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),s=this.getHeight();let o=new O(r),c=new O(r);for(let u=0,d=Math.floor((s+1)/2);u<d;u++)o=this.getRow(u,o),c=this.getRow(s-1-u,c),o.reverse(),c.reverse(),this.setRow(u,c),this.setRow(s-1-u,o)}getEnclosingRectangle(){const r=this.width,s=this.height,o=this.rowSize,c=this.bits;let u=r,d=s,h=-1,x=-1;for(let w=0;w<s;w++)for(let v=0;v<o;v++){const I=c[w*o+v];if(I!==0){if(w<d&&(d=w),w>x&&(x=w),v*32<u){let D=0;for(;!(I<<31-D&4294967295);)D++;v*32+D<u&&(u=v*32+D)}if(v*32+31>h){let D=31;for(;!(I>>>D);)D--;v*32+D>h&&(h=v*32+D)}}}return h<u||x<d?null:Int32Array.from([u,d,h-u+1,x-d+1])}getTopLeftOnBit(){const r=this.rowSize,s=this.bits;let o=0;for(;o<s.length&&s[o]===0;)o++;if(o===s.length)return null;const c=o/r;let u=o%r*32;const d=s[o];let h=0;for(;!(d<<31-h&4294967295);)h++;return u+=h,Int32Array.from([u,c])}getBottomRightOnBit(){const r=this.rowSize,s=this.bits;let o=s.length-1;for(;o>=0&&s[o]===0;)o--;if(o<0)return null;const c=Math.floor(o/r);let u=Math.floor(o%r)*32;const d=s[o];let h=31;for(;!(d>>>h);)h--;return u+=h,Int32Array.from([u,c])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof pe))return!1;const s=r;return this.width===s.width&&this.height===s.height&&this.rowSize===s.rowSize&&b.equals(this.bits,s.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+b.hashCode(this.bits),r}toString(r="X ",s="  ",o=`
`){return this.buildToString(r,s,o)}buildToString(r,s,o){let c=new de;for(let u=0,d=this.height;u<d;u++){for(let h=0,x=this.width;h<x;h++)c.append(this.get(h,u)?r:s);c.append(o)}return c.toString()}clone(){return new pe(this.width,this.height,this.rowSize,this.bits.slice())}}class j extends m{static getNotFoundInstance(){return new j}}j.kind="NotFoundException";class q extends _{constructor(r){super(r),this.luminances=q.EMPTY,this.buckets=new Int32Array(q.LUMINANCE_BUCKETS)}getBlackRow(r,s){const o=this.getLuminanceSource(),c=o.getWidth();s==null||s.getSize()<c?s=new O(c):s.clear(),this.initArrays(c);const u=o.getRow(r,this.luminances),d=this.buckets;for(let x=0;x<c;x++)d[(u[x]&255)>>q.LUMINANCE_SHIFT]++;const h=q.estimateBlackPoint(d);if(c<3)for(let x=0;x<c;x++)(u[x]&255)<h&&s.set(x);else{let x=u[0]&255,w=u[1]&255;for(let v=1;v<c-1;v++){const I=u[v+1]&255;(w*4-x-I)/2<h&&s.set(v),x=w,w=I}}return s}getBlackMatrix(){const r=this.getLuminanceSource(),s=r.getWidth(),o=r.getHeight(),c=new pe(s,o);this.initArrays(s);const u=this.buckets;for(let x=1;x<5;x++){const w=Math.floor(o*x/5),v=r.getRow(w,this.luminances),I=Math.floor(s*4/5);for(let D=Math.floor(s/5);D<I;D++){const L=v[D]&255;u[L>>q.LUMINANCE_SHIFT]++}}const d=q.estimateBlackPoint(u),h=r.getMatrix();for(let x=0;x<o;x++){const w=x*s;for(let v=0;v<s;v++)(h[w+v]&255)<d&&c.set(v,x)}return c}createBinarizer(r){return new q(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const s=this.buckets;for(let o=0;o<q.LUMINANCE_BUCKETS;o++)s[o]=0}static estimateBlackPoint(r){const s=r.length;let o=0,c=0,u=0;for(let v=0;v<s;v++)r[v]>u&&(c=v,u=r[v]),r[v]>o&&(o=r[v]);let d=0,h=0;for(let v=0;v<s;v++){const I=v-c,D=r[v]*I*I;D>h&&(d=v,h=D)}if(c>d){const v=c;c=d,d=v}if(d-c<=s/16)throw new j;let x=d-1,w=-1;for(let v=d-1;v>c;v--){const I=v-c,D=I*I*(d-v)*(o-r[v]);D>w&&(x=v,w=D)}return x<<q.LUMINANCE_SHIFT}}q.LUMINANCE_BITS=5,q.LUMINANCE_SHIFT=8-q.LUMINANCE_BITS,q.LUMINANCE_BUCKETS=1<<q.LUMINANCE_BITS,q.EMPTY=Uint8ClampedArray.from([0]);class re extends q{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),s=r.getWidth(),o=r.getHeight();if(s>=re.MINIMUM_DIMENSION&&o>=re.MINIMUM_DIMENSION){const c=r.getMatrix();let u=s>>re.BLOCK_SIZE_POWER;s&re.BLOCK_SIZE_MASK&&u++;let d=o>>re.BLOCK_SIZE_POWER;o&re.BLOCK_SIZE_MASK&&d++;const h=re.calculateBlackPoints(c,u,d,s,o),x=new pe(s,o);re.calculateThresholdForBlock(c,u,d,s,o,h,x),this.matrix=x}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new re(r)}static calculateThresholdForBlock(r,s,o,c,u,d,h){const x=u-re.BLOCK_SIZE,w=c-re.BLOCK_SIZE;for(let v=0;v<o;v++){let I=v<<re.BLOCK_SIZE_POWER;I>x&&(I=x);const D=re.cap(v,2,o-3);for(let L=0;L<s;L++){let z=L<<re.BLOCK_SIZE_POWER;z>w&&(z=w);const H=re.cap(L,2,s-3);let Y=0;for(let ce=-2;ce<=2;ce++){const ue=d[D+ce];Y+=ue[H-2]+ue[H-1]+ue[H]+ue[H+1]+ue[H+2]}const $=Y/25;re.thresholdBlock(r,z,I,$,c,h)}}}static cap(r,s,o){return r<s?s:r>o?o:r}static thresholdBlock(r,s,o,c,u,d){for(let h=0,x=o*u+s;h<re.BLOCK_SIZE;h++,x+=u)for(let w=0;w<re.BLOCK_SIZE;w++)(r[x+w]&255)<=c&&d.set(s+w,o+h)}static calculateBlackPoints(r,s,o,c,u){const d=u-re.BLOCK_SIZE,h=c-re.BLOCK_SIZE,x=new Array(o);for(let w=0;w<o;w++){x[w]=new Int32Array(s);let v=w<<re.BLOCK_SIZE_POWER;v>d&&(v=d);for(let I=0;I<s;I++){let D=I<<re.BLOCK_SIZE_POWER;D>h&&(D=h);let L=0,z=255,H=0;for(let $=0,ce=v*c+D;$<re.BLOCK_SIZE;$++,ce+=c){for(let ue=0;ue<re.BLOCK_SIZE;ue++){const se=r[ce+ue]&255;L+=se,se<z&&(z=se),se>H&&(H=se)}if(H-z>re.MIN_DYNAMIC_RANGE)for($++,ce+=c;$<re.BLOCK_SIZE;$++,ce+=c)for(let ue=0;ue<re.BLOCK_SIZE;ue++)L+=r[ce+ue]&255}let Y=L>>re.BLOCK_SIZE_POWER*2;if(H-z<=re.MIN_DYNAMIC_RANGE&&(Y=z/2,w>0&&I>0)){const $=(x[w-1][I]+2*x[w][I-1]+x[w-1][I-1])/4;z<$&&(Y=$)}x[w][I]=Y}}return x}}re.BLOCK_SIZE_POWER=3,re.BLOCK_SIZE=1<<re.BLOCK_SIZE_POWER,re.BLOCK_SIZE_MASK=re.BLOCK_SIZE-1,re.MINIMUM_DIMENSION=re.BLOCK_SIZE*5,re.MIN_DYNAMIC_RANGE=24;class X{constructor(r,s){this.width=r,this.height=s}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,s,o,c){throw new te("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new te("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new te("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let s=new de;for(let o=0;o<this.height;o++){const c=this.getRow(o,r);for(let u=0;u<this.width;u++){const d=c[u]&255;let h;d<64?h="#":d<128?h="+":d<192?h=".":h=" ",s.append(h)}s.append(`
`)}return s.toString()}}class fe extends X{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,s){const o=this.delegate.getRow(r,s),c=this.getWidth();for(let u=0;u<c;u++)o[u]=255-(o[u]&255);return o}getMatrix(){const r=this.delegate.getMatrix(),s=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(s);for(let c=0;c<s;c++)o[c]=255-(r[c]&255);return o}isCropSupported(){return this.delegate.isCropSupported()}crop(r,s,o,c){return new fe(this.delegate.crop(r,s,o,c))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new fe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new fe(this.delegate.rotateCounterClockwise45())}}class oe extends X{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=oe.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const s=r.getContext("2d").getImageData(0,0,r.width,r.height);return oe.toGrayscaleBuffer(s.data,r.width,r.height)}static toGrayscaleBuffer(r,s,o){const c=new Uint8ClampedArray(s*o);for(let u=0,d=0,h=r.length;u<h;u+=4,d++){let x;if(r[u+3]===0)x=255;else{const v=r[u],I=r[u+1],D=r[u+2];x=306*v+601*I+117*D+512>>10}c[d]=x}return c}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const o=this.getWidth(),c=r*o;return s===null?s=this.buffer.slice(c,c+o):(s.length<o&&(s=new Uint8ClampedArray(o)),s.set(this.buffer.slice(c,c+o))),s}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,s,o,c){return super.crop(r,s,o,c),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const s=this.getTempCanvasElement(),o=s.getContext("2d"),c=r*oe.DEGREE_TO_RADIANS,u=this.canvas.width,d=this.canvas.height,h=Math.ceil(Math.abs(Math.cos(c))*u+Math.abs(Math.sin(c))*d),x=Math.ceil(Math.abs(Math.sin(c))*u+Math.abs(Math.cos(c))*d);return s.width=h,s.height=x,o.translate(h/2,x/2),o.rotate(c),o.drawImage(this.canvas,u/-2,d/-2),this.buffer=oe.makeBufferFromCanvasImageData(s),this}invert(){return new fe(this)}}oe.DEGREE_TO_RADIANS=Math.PI/180;class ve{constructor(r,s,o){this.deviceId=r,this.label=s,this.kind="videoinput",this.groupId=o||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Te=(globalThis||So||self||window||void 0)&&(globalThis||So||self||window||void 0).__awaiter||function(T,r,s,o){function c(u){return u instanceof s?u:new s(function(d){d(u)})}return new(s||(s=Promise))(function(u,d){function h(v){try{w(o.next(v))}catch(I){d(I)}}function x(v){try{w(o.throw(v))}catch(I){d(I)}}function w(v){v.done?u(v.value):c(v.value).then(h,x)}w((o=o.apply(T,r||[])).next())})};class st{constructor(r,s=500,o){this.reader=r,this.timeBetweenScansMillis=s,this._hints=o,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return Te(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),s=[];for(const o of r){const c=o.kind==="video"?"videoinput":o.kind;if(c!=="videoinput")continue;const u=o.deviceId||o.id,d=o.label||`Video device ${s.length+1}`,h=o.groupId,x={deviceId:u,label:d,kind:c,groupId:h};s.push(x)}return s})}getVideoInputDevices(){return Te(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(s=>new ve(s.deviceId,s.label))})}findDeviceById(r){return Te(this,void 0,void 0,function*(){const s=yield this.listVideoInputDevices();return s?s.find(o=>o.deviceId===r):null})}decodeFromInputVideoDevice(r,s){return Te(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,s)})}decodeOnceFromVideoDevice(r,s){return Te(this,void 0,void 0,function*(){this.reset();let o;r?o={deviceId:{exact:r}}:o={facingMode:"environment"};const c={video:o};return yield this.decodeOnceFromConstraints(c,s)})}decodeOnceFromConstraints(r,s){return Te(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(o,s)})}decodeOnceFromStream(r,s){return Te(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(r,s);return yield this.decodeOnce(o)})}decodeFromInputVideoDeviceContinuously(r,s,o){return Te(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,s,o)})}decodeFromVideoDevice(r,s,o){return Te(this,void 0,void 0,function*(){let c;r?c={deviceId:{exact:r}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeFromConstraints(u,s,o)})}decodeFromConstraints(r,s,o){return Te(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(c,s,o)})}decodeFromStream(r,s,o){return Te(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(r,s);return yield this.decodeContinuously(c,o)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,s){return Te(this,void 0,void 0,function*(){const o=this.prepareVideoElement(s);return this.addVideoSource(o,r),this.videoElement=o,this.stream=r,yield this.playVideoOnLoadAsync(o),o})}playVideoOnLoadAsync(r){return new Promise((s,o)=>this.playVideoOnLoad(r,()=>s()))}playVideoOnLoad(r,s){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",s),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return Te(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,s){const o=document.getElementById(r);if(!o)throw new C(`element with id '${r}' not found`);if(o.nodeName.toLowerCase()!==s.toLowerCase())throw new C(`element with id '${r}' must be an ${s} element`);return o}decodeFromImage(r,s){if(!r&&!s)throw new C("either imageElement with a src set or an url must be provided");return s&&!r?this.decodeFromImageUrl(s):this.decodeFromImageElement(r)}decodeFromVideo(r,s){if(!r&&!s)throw new C("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrl(s):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,s,o){if(r===void 0&&s===void 0)throw new C("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrlContinuously(s,o):this.decodeFromVideoElementContinuously(r,o)}decodeFromImageElement(r){if(!r)throw new C("An image element must be provided.");this.reset();const s=this.prepareImageElement(r);this.imageElement=s;let o;return this.isImageLoaded(s)?o=this.decodeOnce(s,!1,!0):o=this._decodeOnLoadImage(s),o}decodeFromVideoElement(r){const s=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(s)}decodeFromVideoElementContinuously(r,s){const o=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(o,s)}_decodeFromVideoElementSetup(r){if(!r)throw new C("A video element must be provided.");this.reset();const s=this.prepareVideoElement(r);return this.videoElement=s,s}decodeFromImageUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const s=this.prepareImageElement();this.imageElement=s;const o=this._decodeOnLoadImage(s);return s.src=r,o}decodeFromVideoUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),o=this.decodeFromVideoElement(s);return s.src=r,o}decodeFromVideoUrlContinuously(r,s){if(!r)throw new C("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),c=this.decodeFromVideoElementContinuously(o,s);return o.src=r,c}_decodeOnLoadImage(r){return new Promise((s,o)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(s,o),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return Te(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,s){return Te(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,s)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let s;return typeof r>"u"&&(s=document.createElement("img"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(s=r),s}prepareVideoElement(r){let s;return!r&&typeof document<"u"&&(s=document.createElement("video"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(s=r),s.setAttribute("autoplay","true"),s.setAttribute("muted","true"),s.setAttribute("playsinline","true"),s}decodeOnce(r,s=!0,o=!0){this._stopAsyncDecode=!1;const c=(u,d)=>{if(this._stopAsyncDecode){d(new j("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const h=this.decode(r);u(h)}catch(h){const x=s&&h instanceof j,v=(h instanceof M||h instanceof U)&&o;if(x||v)return setTimeout(c,this._timeBetweenDecodingAttempts,u,d);d(h)}};return new Promise((u,d)=>c(u,d))}decodeContinuously(r,s){this._stopContinuousDecode=!1;const o=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const c=this.decode(r);s(c,null),setTimeout(o,this.timeBetweenScansMillis)}catch(c){s(null,c);const u=c instanceof M||c instanceof U,d=c instanceof j;(u||d)&&setTimeout(o,this._timeBetweenDecodingAttempts)}};o()}decode(r){const s=this.createBinaryBitmap(r);return this.decodeBitmap(s)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,s,o){s||(s={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),o||(o=this.captureCanvasContext),o.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}drawImageOnCanvas(r,s,o=this.captureCanvasContext){s||(s={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),o||(o=this.captureCanvasContext),o.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const s=this.getCaptureCanvas(r),o=new oe(s),c=new re(o);return new A(c)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const o=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=o}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const s=this.createCaptureCanvas(r);this.captureCanvas=s}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const s=document.createElement("canvas");let o,c;return typeof r<"u"&&(r instanceof HTMLVideoElement?(o=r.videoWidth,c=r.videoHeight):r instanceof HTMLImageElement&&(o=r.naturalWidth||r.width,c=r.naturalHeight||r.height)),s.style.width=o+"px",s.style.height=c+"px",s.width=o,s.height=c,s}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,s){try{r.srcObject=s}catch{r.src=URL.createObjectURL(s)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class Ze{constructor(r,s,o=s==null?0:8*s.length,c,u,d=k.currentTimeMillis()){this.text=r,this.rawBytes=s,this.numBits=o,this.resultPoints=c,this.format=u,this.timestamp=d,this.text=r,this.rawBytes=s,o==null?this.numBits=s==null?0:8*s.length:this.numBits=o,this.resultPoints=c,this.format=u,this.resultMetadata=null,d==null?this.timestamp=k.currentTimeMillis():this.timestamp=d}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,s){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,s)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const s=this.resultPoints;if(s===null)this.resultPoints=r;else if(r!==null&&r.length>0){const o=new Array(s.length+r.length);k.arraycopy(s,0,o,0,s.length),k.arraycopy(r,0,o,s.length,r.length),this.resultPoints=o}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ft;(function(T){T[T.AZTEC=0]="AZTEC",T[T.CODABAR=1]="CODABAR",T[T.CODE_39=2]="CODE_39",T[T.CODE_93=3]="CODE_93",T[T.CODE_128=4]="CODE_128",T[T.DATA_MATRIX=5]="DATA_MATRIX",T[T.EAN_8=6]="EAN_8",T[T.EAN_13=7]="EAN_13",T[T.ITF=8]="ITF",T[T.MAXICODE=9]="MAXICODE",T[T.PDF_417=10]="PDF_417",T[T.QR_CODE=11]="QR_CODE",T[T.RSS_14=12]="RSS_14",T[T.RSS_EXPANDED=13]="RSS_EXPANDED",T[T.UPC_A=14]="UPC_A",T[T.UPC_E=15]="UPC_E",T[T.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ft||(Ft={}));var ge=Ft,Re;(function(T){T[T.OTHER=0]="OTHER",T[T.ORIENTATION=1]="ORIENTATION",T[T.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",T[T.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",T[T.ISSUE_NUMBER=4]="ISSUE_NUMBER",T[T.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",T[T.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",T[T.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",T[T.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",T[T.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",T[T.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Re||(Re={}));var ct=Re;class Ut{constructor(r,s,o,c,u=-1,d=-1){this.rawBytes=r,this.text=s,this.byteSegments=o,this.ecLevel=c,this.structuredAppendSequenceNumber=u,this.structuredAppendParity=d,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Se{exp(r){return this.expTable[r]}log(r){if(r===0)throw new E;return this.logTable[r]}static addOrSubtract(r,s){return r^s}}class Ae{constructor(r,s){if(s.length===0)throw new E;this.field=r;const o=s.length;if(o>1&&s[0]===0){let c=1;for(;c<o&&s[c]===0;)c++;c===o?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(o-c),k.arraycopy(s,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const s=this.coefficients;let o;if(r===1){o=0;for(let d=0,h=s.length;d!==h;d++){const x=s[d];o=Se.addOrSubtract(o,x)}return o}o=s[0];const c=s.length,u=this.field;for(let d=1;d<c;d++)o=Se.addOrSubtract(u.multiply(r,o),s[d]);return o}addOrSubtract(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,o=r.coefficients;if(s.length>o.length){const d=s;s=o,o=d}let c=new Int32Array(o.length);const u=o.length-s.length;k.arraycopy(o,0,c,0,u);for(let d=u;d<o.length;d++)c[d]=Se.addOrSubtract(s[d-u],o[d]);return new Ae(this.field,c)}multiply(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const s=this.coefficients,o=s.length,c=r.coefficients,u=c.length,d=new Int32Array(o+u-1),h=this.field;for(let x=0;x<o;x++){const w=s[x];for(let v=0;v<u;v++)d[x+v]=Se.addOrSubtract(d[x+v],h.multiply(w,c[v]))}return new Ae(h,d)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const s=this.coefficients.length,o=this.field,c=new Int32Array(s),u=this.coefficients;for(let d=0;d<s;d++)c[d]=o.multiply(u[d],r);return new Ae(o,c)}multiplyByMonomial(r,s){if(r<0)throw new E;if(s===0)return this.field.getZero();const o=this.coefficients,c=o.length,u=new Int32Array(c+r),d=this.field;for(let h=0;h<c;h++)u[h]=d.multiply(o[h],s);return new Ae(d,u)}divide(r){if(!this.field.equals(r.field))throw new E("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new E("Divide by 0");const s=this.field;let o=s.getZero(),c=this;const u=r.getCoefficient(r.getDegree()),d=s.inverse(u);for(;c.getDegree()>=r.getDegree()&&!c.isZero();){const h=c.getDegree()-r.getDegree(),x=s.multiply(c.getCoefficient(c.getDegree()),d),w=r.multiplyByMonomial(h,x),v=s.buildMonomial(h,x);o=o.addOrSubtract(v),c=c.addOrSubtract(w)}return[o,c]}toString(){let r="";for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);if(o!==0){if(o<0?(r+=" - ",o=-o):r.length>0&&(r+=" + "),s===0||o!==1){const c=this.field.log(o);c===0?r+="1":c===1?r+="a":(r+="a^",r+=c)}s!==0&&(s===1?r+="x":(r+="x^",r+=s))}}return r}}class Ge extends m{}Ge.kind="ArithmeticException";class K extends Se{constructor(r,s,o){super(),this.primitive=r,this.size=s,this.generatorBase=o;const c=new Int32Array(s);let u=1;for(let h=0;h<s;h++)c[h]=u,u*=2,u>=s&&(u^=r,u&=s-1);this.expTable=c;const d=new Int32Array(s);for(let h=0;h<s-1;h++)d[c[h]]=h;this.logTable=d,this.zero=new Ae(this,Int32Array.from([0])),this.one=new Ae(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new E;if(s===0)return this.zero;const o=new Int32Array(r+1);return o[0]=s,new Ae(this,o)}inverse(r){if(r===0)throw new Ge;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+S.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}K.AZTEC_DATA_12=new K(4201,4096,1),K.AZTEC_DATA_10=new K(1033,1024,1),K.AZTEC_DATA_6=new K(67,64,1),K.AZTEC_PARAM=new K(19,16,1),K.QR_CODE_FIELD_256=new K(285,256,0),K.DATA_MATRIX_FIELD_256=new K(301,256,1),K.AZTEC_DATA_8=K.DATA_MATRIX_FIELD_256,K.MAXICODE_FIELD_64=K.AZTEC_DATA_6;class Be extends m{}Be.kind="ReedSolomonException";class je extends m{}je.kind="IllegalStateException";class Oe{constructor(r){this.field=r}decode(r,s){const o=this.field,c=new Ae(o,r),u=new Int32Array(s);let d=!0;for(let L=0;L<s;L++){const z=c.evaluateAt(o.exp(L+o.getGeneratorBase()));u[u.length-1-L]=z,z!==0&&(d=!1)}if(d)return;const h=new Ae(o,u),x=this.runEuclideanAlgorithm(o.buildMonomial(s,1),h,s),w=x[0],v=x[1],I=this.findErrorLocations(w),D=this.findErrorMagnitudes(v,I);for(let L=0;L<I.length;L++){const z=r.length-1-o.log(I[L]);if(z<0)throw new Be("Bad error location");r[z]=K.addOrSubtract(r[z],D[L])}}runEuclideanAlgorithm(r,s,o){if(r.getDegree()<s.getDegree()){const L=r;r=s,s=L}const c=this.field;let u=r,d=s,h=c.getZero(),x=c.getOne();for(;d.getDegree()>=(o/2|0);){let L=u,z=h;if(u=d,h=x,u.isZero())throw new Be("r_{i-1} was zero");d=L;let H=c.getZero();const Y=u.getCoefficient(u.getDegree()),$=c.inverse(Y);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){const ce=d.getDegree()-u.getDegree(),ue=c.multiply(d.getCoefficient(d.getDegree()),$);H=H.addOrSubtract(c.buildMonomial(ce,ue)),d=d.addOrSubtract(u.multiplyByMonomial(ce,ue))}if(x=H.multiply(h).addOrSubtract(z),d.getDegree()>=u.getDegree())throw new je("Division algorithm failed to reduce polynomial?")}const w=x.getCoefficient(0);if(w===0)throw new Be("sigmaTilde(0) was zero");const v=c.inverse(w),I=x.multiplyScalar(v),D=d.multiplyScalar(v);return[I,D]}findErrorLocations(r){const s=r.getDegree();if(s===1)return Int32Array.from([r.getCoefficient(1)]);const o=new Int32Array(s);let c=0;const u=this.field;for(let d=1;d<u.getSize()&&c<s;d++)r.evaluateAt(d)===0&&(o[c]=u.inverse(d),c++);if(c!==s)throw new Be("Error locator degree does not match number of roots");return o}findErrorMagnitudes(r,s){const o=s.length,c=new Int32Array(o),u=this.field;for(let d=0;d<o;d++){const h=u.inverse(s[d]);let x=1;for(let w=0;w<o;w++)if(d!==w){const v=u.multiply(s[w],h),I=v&1?v&-2:v|1;x=u.multiply(x,I)}c[d]=u.multiply(r.evaluateAt(h),u.inverse(x)),u.getGeneratorBase()!==0&&(c[d]=u.multiply(c[d],h))}return c}}var Ue;(function(T){T[T.UPPER=0]="UPPER",T[T.LOWER=1]="LOWER",T[T.MIXED=2]="MIXED",T[T.DIGIT=3]="DIGIT",T[T.PUNCT=4]="PUNCT",T[T.BINARY=5]="BINARY"})(Ue||(Ue={}));class Le{decode(r){this.ddata=r;let s=r.getBits(),o=this.extractBits(s),c=this.correctBits(o),u=Le.convertBoolArrayToByteArray(c),d=Le.getEncodedData(c),h=new Ut(u,d,null,null);return h.setNumBits(c.length),h}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let s=r.length,o=Ue.UPPER,c=Ue.UPPER,u="",d=0;for(;d<s;)if(c===Ue.BINARY){if(s-d<5)break;let h=Le.readCode(r,d,5);if(d+=5,h===0){if(s-d<11)break;h=Le.readCode(r,d,11)+31,d+=11}for(let x=0;x<h;x++){if(s-d<8){d=s;break}const w=Le.readCode(r,d,8);u+=he.castAsNonUtf8Char(w),d+=8}c=o}else{let h=c===Ue.DIGIT?4:5;if(s-d<h)break;let x=Le.readCode(r,d,h);d+=h;let w=Le.getCharacter(c,x);w.startsWith("CTRL_")?(o=c,c=Le.getTable(w.charAt(5)),w.charAt(6)==="L"&&(o=c)):(u+=w,c=o)}return u}static getTable(r){switch(r){case"L":return Ue.LOWER;case"P":return Ue.PUNCT;case"M":return Ue.MIXED;case"D":return Ue.DIGIT;case"B":return Ue.BINARY;case"U":default:return Ue.UPPER}}static getCharacter(r,s){switch(r){case Ue.UPPER:return Le.UPPER_TABLE[s];case Ue.LOWER:return Le.LOWER_TABLE[s];case Ue.MIXED:return Le.MIXED_TABLE[s];case Ue.PUNCT:return Le.PUNCT_TABLE[s];case Ue.DIGIT:return Le.DIGIT_TABLE[s];default:throw new je("Bad table")}}correctBits(r){let s,o;this.ddata.getNbLayers()<=2?(o=6,s=K.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(o=8,s=K.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(o=10,s=K.AZTEC_DATA_10):(o=12,s=K.AZTEC_DATA_12);let c=this.ddata.getNbDatablocks(),u=r.length/o;if(u<c)throw new U;let d=r.length%o,h=new Int32Array(u);for(let D=0;D<u;D++,d+=o)h[D]=Le.readCode(r,d,o);try{new Oe(s).decode(h,u-c)}catch(D){throw new U(D)}let x=(1<<o)-1,w=0;for(let D=0;D<c;D++){let L=h[D];if(L===0||L===x)throw new U;(L===1||L===x-1)&&w++}let v=new Array(c*o-w),I=0;for(let D=0;D<c;D++){let L=h[D];if(L===1||L===x-1)v.fill(L>1,I,I+o-1),I+=o-1;else for(let z=o-1;z>=0;--z)v[I++]=(L&1<<z)!==0}return v}extractBits(r){let s=this.ddata.isCompact(),o=this.ddata.getNbLayers(),c=(s?11:14)+o*4,u=new Int32Array(c),d=new Array(this.totalBitsInLayer(o,s));if(s)for(let h=0;h<u.length;h++)u[h]=h;else{let h=c+1+2*S.truncDivision(S.truncDivision(c,2)-1,15),x=c/2,w=S.truncDivision(h,2);for(let v=0;v<x;v++){let I=v+S.truncDivision(v,15);u[x-v-1]=w-I-1,u[x+v]=w+I+1}}for(let h=0,x=0;h<o;h++){let w=(o-h)*4+(s?9:12),v=h*2,I=c-1-v;for(let D=0;D<w;D++){let L=D*2;for(let z=0;z<2;z++)d[x+L+z]=r.get(u[v+z],u[v+D]),d[x+2*w+L+z]=r.get(u[v+D],u[I-z]),d[x+4*w+L+z]=r.get(u[I-z],u[I-D]),d[x+6*w+L+z]=r.get(u[I-D],u[v+z])}x+=w*8}return d}static readCode(r,s,o){let c=0;for(let u=s;u<s+o;u++)c<<=1,r[u]&&(c|=1);return c}static readByte(r,s){let o=r.length-s;return o>=8?Le.readCode(r,s,8):Le.readCode(r,s,o)<<8-o}static convertBoolArrayToByteArray(r){let s=new Uint8Array((r.length+7)/8);for(let o=0;o<s.length;o++)s[o]=Le.readByte(r,8*o);return s}totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}Le.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Le.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Le.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Le.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Le.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Fe{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,s,o,c){const u=r-o,d=s-c;return Math.sqrt(u*u+d*d)}static sum(r){let s=0;for(let o=0,c=r.length;o!==c;o++){const u=r[o];s+=u}return s}}class kt{static floatToIntBits(r){return r}}kt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class xe{constructor(r,s){this.x=r,this.y=s}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof xe){const s=r;return this.x===s.x&&this.y===s.y}return!1}hashCode(){return 31*kt.floatToIntBits(this.x)+kt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const s=this.distance(r[0],r[1]),o=this.distance(r[1],r[2]),c=this.distance(r[0],r[2]);let u,d,h;if(o>=s&&o>=c?(d=r[0],u=r[1],h=r[2]):c>=o&&c>=s?(d=r[1],u=r[0],h=r[2]):(d=r[2],u=r[0],h=r[1]),this.crossProductZ(u,d,h)<0){const x=u;u=h,h=x}r[0]=u,r[1]=d,r[2]=h}static distance(r,s){return Fe.distance(r.x,r.y,s.x,s.y)}static crossProductZ(r,s,o){const c=s.x,u=s.y;return(o.x-c)*(r.y-u)-(o.y-u)*(r.x-c)}}class Zt{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class ki extends Zt{constructor(r,s,o,c,u){super(r,s),this.compact=o,this.nbDatablocks=c,this.nbLayers=u}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ie{constructor(r,s,o,c){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),s==null&&(s=ie.INIT_SIZE),o==null&&(o=r.getWidth()/2|0),c==null&&(c=r.getHeight()/2|0);const u=s/2|0;if(this.leftInit=o-u,this.rightInit=o+u,this.upInit=c-u,this.downInit=c+u,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new j}detect(){let r=this.leftInit,s=this.rightInit,o=this.upInit,c=this.downInit,u=!1,d=!0,h=!1,x=!1,w=!1,v=!1,I=!1;const D=this.width,L=this.height;for(;d;){d=!1;let z=!0;for(;(z||!x)&&s<D;)z=this.containsBlackPoint(o,c,s,!1),z?(s++,d=!0,x=!0):x||s++;if(s>=D){u=!0;break}let H=!0;for(;(H||!w)&&c<L;)H=this.containsBlackPoint(r,s,c,!0),H?(c++,d=!0,w=!0):w||c++;if(c>=L){u=!0;break}let Y=!0;for(;(Y||!v)&&r>=0;)Y=this.containsBlackPoint(o,c,r,!1),Y?(r--,d=!0,v=!0):v||r--;if(r<0){u=!0;break}let $=!0;for(;($||!I)&&o>=0;)$=this.containsBlackPoint(r,s,o,!0),$?(o--,d=!0,I=!0):I||o--;if(o<0){u=!0;break}d&&(h=!0)}if(!u&&h){const z=s-r;let H=null;for(let ue=1;H===null&&ue<z;ue++)H=this.getBlackPointOnSegment(r,c-ue,r+ue,c);if(H==null)throw new j;let Y=null;for(let ue=1;Y===null&&ue<z;ue++)Y=this.getBlackPointOnSegment(r,o+ue,r+ue,o);if(Y==null)throw new j;let $=null;for(let ue=1;$===null&&ue<z;ue++)$=this.getBlackPointOnSegment(s,o+ue,s-ue,o);if($==null)throw new j;let ce=null;for(let ue=1;ce===null&&ue<z;ue++)ce=this.getBlackPointOnSegment(s,c-ue,s-ue,c);if(ce==null)throw new j;return this.centerEdges(ce,H,$,Y)}else throw new j}getBlackPointOnSegment(r,s,o,c){const u=Fe.round(Fe.distance(r,s,o,c)),d=(o-r)/u,h=(c-s)/u,x=this.image;for(let w=0;w<u;w++){const v=Fe.round(r+w*d),I=Fe.round(s+w*h);if(x.get(v,I))return new xe(v,I)}return null}centerEdges(r,s,o,c){const u=r.getX(),d=r.getY(),h=s.getX(),x=s.getY(),w=o.getX(),v=o.getY(),I=c.getX(),D=c.getY(),L=ie.CORR;return u<this.width/2?[new xe(I-L,D+L),new xe(h+L,x+L),new xe(w-L,v-L),new xe(u+L,d-L)]:[new xe(I+L,D+L),new xe(h+L,x-L),new xe(w-L,v+L),new xe(u-L,d-L)]}containsBlackPoint(r,s,o,c){const u=this.image;if(c){for(let d=r;d<=s;d++)if(u.get(d,o))return!0}else for(let d=r;d<=s;d++)if(u.get(o,d))return!0;return!1}}ie.INIT_SIZE=10,ie.CORR=1;class De{static checkAndNudgePoints(r,s){const o=r.getWidth(),c=r.getHeight();let u=!0;for(let d=0;d<s.length&&u;d+=2){const h=Math.floor(s[d]),x=Math.floor(s[d+1]);if(h<-1||h>o||x<-1||x>c)throw new j;u=!1,h===-1?(s[d]=0,u=!0):h===o&&(s[d]=o-1,u=!0),x===-1?(s[d+1]=0,u=!0):x===c&&(s[d+1]=c-1,u=!0)}u=!0;for(let d=s.length-2;d>=0&&u;d-=2){const h=Math.floor(s[d]),x=Math.floor(s[d+1]);if(h<-1||h>o||x<-1||x>c)throw new j;u=!1,h===-1?(s[d]=0,u=!0):h===o&&(s[d]=o-1,u=!0),x===-1?(s[d+1]=0,u=!0):x===c&&(s[d+1]=c-1,u=!0)}}}class Ve{constructor(r,s,o,c,u,d,h,x,w){this.a11=r,this.a21=s,this.a31=o,this.a12=c,this.a22=u,this.a32=d,this.a13=h,this.a23=x,this.a33=w}static quadrilateralToQuadrilateral(r,s,o,c,u,d,h,x,w,v,I,D,L,z,H,Y){const $=Ve.quadrilateralToSquare(r,s,o,c,u,d,h,x);return Ve.squareToQuadrilateral(w,v,I,D,L,z,H,Y).times($)}transformPoints(r){const s=r.length,o=this.a11,c=this.a12,u=this.a13,d=this.a21,h=this.a22,x=this.a23,w=this.a31,v=this.a32,I=this.a33;for(let D=0;D<s;D+=2){const L=r[D],z=r[D+1],H=u*L+x*z+I;r[D]=(o*L+d*z+w)/H,r[D+1]=(c*L+h*z+v)/H}}transformPointsWithValues(r,s){const o=this.a11,c=this.a12,u=this.a13,d=this.a21,h=this.a22,x=this.a23,w=this.a31,v=this.a32,I=this.a33,D=r.length;for(let L=0;L<D;L++){const z=r[L],H=s[L],Y=u*z+x*H+I;r[L]=(o*z+d*H+w)/Y,s[L]=(c*z+h*H+v)/Y}}static squareToQuadrilateral(r,s,o,c,u,d,h,x){const w=r-o+u-h,v=s-c+d-x;if(w===0&&v===0)return new Ve(o-r,u-o,r,c-s,d-c,s,0,0,1);{const I=o-u,D=h-u,L=c-d,z=x-d,H=I*z-D*L,Y=(w*z-D*v)/H,$=(I*v-w*L)/H;return new Ve(o-r+Y*o,h-r+$*h,r,c-s+Y*c,x-s+$*x,s,Y,$,1)}}static quadrilateralToSquare(r,s,o,c,u,d,h,x){return Ve.squareToQuadrilateral(r,s,o,c,u,d,h,x).buildAdjoint()}buildAdjoint(){return new Ve(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new Ve(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class et extends De{sampleGrid(r,s,o,c,u,d,h,x,w,v,I,D,L,z,H,Y,$,ce,ue){const se=Ve.quadrilateralToQuadrilateral(c,u,d,h,x,w,v,I,D,L,z,H,Y,$,ce,ue);return this.sampleGridWithTransform(r,s,o,se)}sampleGridWithTransform(r,s,o,c){if(s<=0||o<=0)throw new j;const u=new pe(s,o),d=new Float32Array(2*s);for(let h=0;h<o;h++){const x=d.length,w=h+.5;for(let v=0;v<x;v+=2)d[v]=v/2+.5,d[v+1]=w;c.transformPoints(d),De.checkAndNudgePoints(r,d);try{for(let v=0;v<x;v+=2)r.get(Math.floor(d[v]),Math.floor(d[v+1]))&&u.set(v/2,h)}catch{throw new j}}return u}}class tt{static setGridSampler(r){tt.gridSampler=r}static getInstance(){return tt.gridSampler}}tt.gridSampler=new et;class ot{constructor(r,s){this.x=r,this.y=s}toResultPoint(){return new xe(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class $r{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let s=this.getMatrixCenter(),o=this.getBullsEyeCorners(s);if(r){let d=o[0];o[0]=o[2],o[2]=d}this.extractParameters(o);let c=this.sampleGrid(this.image,o[this.shift%4],o[(this.shift+1)%4],o[(this.shift+2)%4],o[(this.shift+3)%4]),u=this.getMatrixCornerPoints(o);return new ki(c,u,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new j;let s=2*this.nbCenterLayers,o=new Int32Array([this.sampleLine(r[0],r[1],s),this.sampleLine(r[1],r[2],s),this.sampleLine(r[2],r[3],s),this.sampleLine(r[3],r[0],s)]);this.shift=this.getRotation(o,s);let c=0;for(let d=0;d<4;d++){let h=o[(this.shift+d)%4];this.compact?(c<<=7,c+=h>>1&127):(c<<=10,c+=(h>>2&992)+(h>>1&31))}let u=this.getCorrectedParameterData(c,this.compact);this.compact?(this.nbLayers=(u>>6)+1,this.nbDataBlocks=(u&63)+1):(this.nbLayers=(u>>11)+1,this.nbDataBlocks=(u&2047)+1)}getRotation(r,s){let o=0;r.forEach((c,u,d)=>{let h=(c>>s-2<<1)+(c&1);o=(o<<3)+h}),o=((o&1)<<11)+(o>>1);for(let c=0;c<4;c++)if(S.bitCount(o^this.EXPECTED_CORNER_BITS[c])<=2)return c;throw new j}getCorrectedParameterData(r,s){let o,c;s?(o=7,c=2):(o=10,c=4);let u=o-c,d=new Int32Array(o);for(let x=o-1;x>=0;--x)d[x]=r&15,r>>=4;try{new Oe(K.AZTEC_PARAM).decode(d,u)}catch{throw new j}let h=0;for(let x=0;x<c;x++)h=(h<<4)+d[x];return h}getBullsEyeCorners(r){let s=r,o=r,c=r,u=r,d=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let I=this.getFirstDifferent(s,d,1,-1),D=this.getFirstDifferent(o,d,1,1),L=this.getFirstDifferent(c,d,-1,1),z=this.getFirstDifferent(u,d,-1,-1);if(this.nbCenterLayers>2){let H=this.distancePoint(z,I)*this.nbCenterLayers/(this.distancePoint(u,s)*(this.nbCenterLayers+2));if(H<.75||H>1.25||!this.isWhiteOrBlackRectangle(I,D,L,z))break}s=I,o=D,c=L,u=z,d=!d}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new j;this.compact=this.nbCenterLayers===5;let h=new xe(s.getX()+.5,s.getY()-.5),x=new xe(o.getX()+.5,o.getY()+.5),w=new xe(c.getX()-.5,c.getY()+.5),v=new xe(u.getX()-.5,u.getY()-.5);return this.expandSquare([h,x,w,v],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,s,o,c;try{let h=new ie(this.image).detect();r=h[0],s=h[1],o=h[2],c=h[3]}catch{let x=this.image.getWidth()/2,w=this.image.getHeight()/2;r=this.getFirstDifferent(new ot(x+7,w-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new ot(x+7,w+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new ot(x-7,w+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new ot(x-7,w-7),!1,-1,-1).toResultPoint()}let u=Fe.round((r.getX()+c.getX()+s.getX()+o.getX())/4),d=Fe.round((r.getY()+c.getY()+s.getY()+o.getY())/4);try{let h=new ie(this.image,15,u,d).detect();r=h[0],s=h[1],o=h[2],c=h[3]}catch{r=this.getFirstDifferent(new ot(u+7,d-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new ot(u+7,d+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new ot(u-7,d+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new ot(u-7,d-7),!1,-1,-1).toResultPoint()}return u=Fe.round((r.getX()+c.getX()+s.getX()+o.getX())/4),d=Fe.round((r.getY()+c.getY()+s.getY()+o.getY())/4),new ot(u,d)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,s,o,c,u){let d=tt.getInstance(),h=this.getDimension(),x=h/2-this.nbCenterLayers,w=h/2+this.nbCenterLayers;return d.sampleGrid(r,h,h,x,x,w,x,w,w,x,w,s.getX(),s.getY(),o.getX(),o.getY(),c.getX(),c.getY(),u.getX(),u.getY())}sampleLine(r,s,o){let c=0,u=this.distanceResultPoint(r,s),d=u/o,h=r.getX(),x=r.getY(),w=d*(s.getX()-r.getX())/u,v=d*(s.getY()-r.getY())/u;for(let I=0;I<o;I++)this.image.get(Fe.round(h+I*w),Fe.round(x+I*v))&&(c|=1<<o-I-1);return c}isWhiteOrBlackRectangle(r,s,o,c){let u=3;r=new ot(r.getX()-u,r.getY()+u),s=new ot(s.getX()-u,s.getY()-u),o=new ot(o.getX()+u,o.getY()-u),c=new ot(c.getX()+u,c.getY()+u);let d=this.getColor(c,r);if(d===0)return!1;let h=this.getColor(r,s);return h!==d||(h=this.getColor(s,o),h!==d)?!1:(h=this.getColor(o,c),h===d)}getColor(r,s){let o=this.distancePoint(r,s),c=(s.getX()-r.getX())/o,u=(s.getY()-r.getY())/o,d=0,h=r.getX(),x=r.getY(),w=this.image.get(r.getX(),r.getY()),v=Math.ceil(o);for(let D=0;D<v;D++)h+=c,x+=u,this.image.get(Fe.round(h),Fe.round(x))!==w&&d++;let I=d/o;return I>.1&&I<.9?0:I<=.1===w?1:-1}getFirstDifferent(r,s,o,c){let u=r.getX()+o,d=r.getY()+c;for(;this.isValid(u,d)&&this.image.get(u,d)===s;)u+=o,d+=c;for(u-=o,d-=c;this.isValid(u,d)&&this.image.get(u,d)===s;)u+=o;for(u-=o;this.isValid(u,d)&&this.image.get(u,d)===s;)d+=c;return d-=c,new ot(u,d)}expandSquare(r,s,o){let c=o/(2*s),u=r[0].getX()-r[2].getX(),d=r[0].getY()-r[2].getY(),h=(r[0].getX()+r[2].getX())/2,x=(r[0].getY()+r[2].getY())/2,w=new xe(h+c*u,x+c*d),v=new xe(h-c*u,x-c*d);u=r[1].getX()-r[3].getX(),d=r[1].getY()-r[3].getY(),h=(r[1].getX()+r[3].getX())/2,x=(r[1].getY()+r[3].getY())/2;let I=new xe(h+c*u,x+c*d),D=new xe(h-c*u,x-c*d);return[w,I,v,D]}isValid(r,s){return r>=0&&r<this.image.getWidth()&&s>0&&s<this.image.getHeight()}isValidPoint(r){let s=Fe.round(r.getX()),o=Fe.round(r.getY());return this.isValid(s,o)}distancePoint(r,s){return Fe.distance(r.getX(),r.getY(),s.getX(),s.getY())}distanceResultPoint(r,s){return Fe.distance(r.getX(),r.getY(),s.getX(),s.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(S.truncDivision(this.nbLayers-4,8)+1)+15}}class J{decode(r,s=null){let o=null,c=new $r(r.getBlackMatrix()),u=null,d=null;try{let v=c.detectMirror(!1);u=v.getPoints(),this.reportFoundResultPoints(s,u),d=new Le().decode(v)}catch(v){o=v}if(d==null)try{let v=c.detectMirror(!0);u=v.getPoints(),this.reportFoundResultPoints(s,u),d=new Le().decode(v)}catch(v){throw o??v}let h=new Ze(d.getText(),d.getRawBytes(),d.getNumBits(),u,ge.AZTEC,k.currentTimeMillis()),x=d.getByteSegments();x!=null&&h.putMetadata(ct.BYTE_SEGMENTS,x);let w=d.getECLevel();return w!=null&&h.putMetadata(ct.ERROR_CORRECTION_LEVEL,w),h}reportFoundResultPoints(r,s){if(r!=null){let o=r.get(W.NEED_RESULT_POINT_CALLBACK);o!=null&&s.forEach((c,u,d)=>{o.foundPossibleResultPoint(c)})}}reset(){}}class ae extends st{constructor(r=500){super(new J,r)}}class ye{decode(r,s){try{return this.doDecode(r,s)}catch{if(s&&s.get(W.TRY_HARDER)===!0&&r.isRotateSupported()){const u=r.rotateCounterClockwise(),d=this.doDecode(u,s),h=d.getResultMetadata();let x=270;h!==null&&h.get(ct.ORIENTATION)===!0&&(x=x+h.get(ct.ORIENTATION)%360),d.putMetadata(ct.ORIENTATION,x);const w=d.getResultPoints();if(w!==null){const v=u.getHeight();for(let I=0;I<w.length;I++)w[I]=new xe(v-w[I].getY()-1,w[I].getX())}return d}else throw new j}}reset(){}doDecode(r,s){const o=r.getWidth(),c=r.getHeight();let u=new O(o);const d=s&&s.get(W.TRY_HARDER)===!0,h=Math.max(1,c>>(d?8:5));let x;d?x=c:x=15;const w=Math.trunc(c/2);for(let v=0;v<x;v++){const I=Math.trunc((v+1)/2),D=(v&1)===0,L=w+h*(D?I:-I);if(L<0||L>=c)break;try{u=r.getBlackRow(L,u)}catch{continue}for(let z=0;z<2;z++){if(z===1&&(u.reverse(),s&&s.get(W.NEED_RESULT_POINT_CALLBACK)===!0)){const H=new Map;s.forEach((Y,$)=>H.set($,Y)),H.delete(W.NEED_RESULT_POINT_CALLBACK),s=H}try{const H=this.decodeRow(L,u,s);if(z===1){H.putMetadata(ct.ORIENTATION,180);const Y=H.getResultPoints();Y!==null&&(Y[0]=new xe(o-Y[0].getX()-1,Y[0].getY()),Y[1]=new xe(o-Y[1].getX()-1,Y[1].getY()))}return H}catch{}}}throw new j}static recordPattern(r,s,o){const c=o.length;for(let w=0;w<c;w++)o[w]=0;const u=r.getSize();if(s>=u)throw new j;let d=!r.get(s),h=0,x=s;for(;x<u;){if(r.get(x)!==d)o[h]++;else{if(++h===c)break;o[h]=1,d=!d}x++}if(!(h===c||h===c-1&&x===u))throw new j}static recordPatternInReverse(r,s,o){let c=o.length,u=r.get(s);for(;s>0&&c>=0;)r.get(--s)!==u&&(c--,u=!u);if(c>=0)throw new j;ye.recordPattern(r,s+1,o)}static patternMatchVariance(r,s,o){const c=r.length;let u=0,d=0;for(let w=0;w<c;w++)u+=r[w],d+=s[w];if(u<d)return Number.POSITIVE_INFINITY;const h=u/d;o*=h;let x=0;for(let w=0;w<c;w++){const v=r[w],I=s[w]*h,D=v>I?v-I:I-v;if(D>o)return Number.POSITIVE_INFINITY;x+=D}return x/u}}class ee extends ye{static findStartPattern(r){const s=r.getSize(),o=r.getNextSet(0);let c=0,u=Int32Array.from([0,0,0,0,0,0]),d=o,h=!1;const x=6;for(let w=o;w<s;w++)if(r.get(w)!==h)u[c]++;else{if(c===x-1){let v=ee.MAX_AVG_VARIANCE,I=-1;for(let D=ee.CODE_START_A;D<=ee.CODE_START_C;D++){const L=ye.patternMatchVariance(u,ee.CODE_PATTERNS[D],ee.MAX_INDIVIDUAL_VARIANCE);L<v&&(v=L,I=D)}if(I>=0&&r.isRange(Math.max(0,d-(w-d)/2),d,!1))return Int32Array.from([d,w,I]);d+=u[0]+u[1],u=u.slice(2,u.length-1),u[c-1]=0,u[c]=0,c--}else c++;u[c]=1,h=!h}throw new j}static decodeCode(r,s,o){ye.recordPattern(r,o,s);let c=ee.MAX_AVG_VARIANCE,u=-1;for(let d=0;d<ee.CODE_PATTERNS.length;d++){const h=ee.CODE_PATTERNS[d],x=this.patternMatchVariance(s,h,ee.MAX_INDIVIDUAL_VARIANCE);x<c&&(c=x,u=d)}if(u>=0)return u;throw new j}decodeRow(r,s,o){const c=o&&o.get(W.ASSUME_GS1)===!0,u=ee.findStartPattern(s),d=u[2];let h=0;const x=new Uint8Array(20);x[h++]=d;let w;switch(d){case ee.CODE_START_A:w=ee.CODE_CODE_A;break;case ee.CODE_START_B:w=ee.CODE_CODE_B;break;case ee.CODE_START_C:w=ee.CODE_CODE_C;break;default:throw new U}let v=!1,I=!1,D="",L=u[0],z=u[1];const H=Int32Array.from([0,0,0,0,0,0]);let Y=0,$=0,ce=d,ue=0,se=!0,Qe=!1,ze=!1;for(;!v;){const ms=I;switch(I=!1,Y=$,$=ee.decodeCode(s,H,z),x[h++]=$,$!==ee.CODE_STOP&&(se=!0),$!==ee.CODE_STOP&&(ue++,ce+=ue*$),L=z,z+=H.reduce((Dw,_w)=>Dw+_w,0),$){case ee.CODE_START_A:case ee.CODE_START_B:case ee.CODE_START_C:throw new U}switch(w){case ee.CODE_CODE_A:if($<64)ze===Qe?D+=String.fromCharCode(" ".charCodeAt(0)+$):D+=String.fromCharCode(" ".charCodeAt(0)+$+128),ze=!1;else if($<96)ze===Qe?D+=String.fromCharCode($-64):D+=String.fromCharCode($+64),ze=!1;else switch($!==ee.CODE_STOP&&(se=!1),$){case ee.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+=String.fromCharCode(29));break;case ee.CODE_FNC_2:case ee.CODE_FNC_3:break;case ee.CODE_FNC_4_A:!Qe&&ze?(Qe=!0,ze=!1):Qe&&ze?(Qe=!1,ze=!1):ze=!0;break;case ee.CODE_SHIFT:I=!0,w=ee.CODE_CODE_B;break;case ee.CODE_CODE_B:w=ee.CODE_CODE_B;break;case ee.CODE_CODE_C:w=ee.CODE_CODE_C;break;case ee.CODE_STOP:v=!0;break}break;case ee.CODE_CODE_B:if($<96)ze===Qe?D+=String.fromCharCode(" ".charCodeAt(0)+$):D+=String.fromCharCode(" ".charCodeAt(0)+$+128),ze=!1;else switch($!==ee.CODE_STOP&&(se=!1),$){case ee.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+=String.fromCharCode(29));break;case ee.CODE_FNC_2:case ee.CODE_FNC_3:break;case ee.CODE_FNC_4_B:!Qe&&ze?(Qe=!0,ze=!1):Qe&&ze?(Qe=!1,ze=!1):ze=!0;break;case ee.CODE_SHIFT:I=!0,w=ee.CODE_CODE_A;break;case ee.CODE_CODE_A:w=ee.CODE_CODE_A;break;case ee.CODE_CODE_C:w=ee.CODE_CODE_C;break;case ee.CODE_STOP:v=!0;break}break;case ee.CODE_CODE_C:if($<100)$<10&&(D+="0"),D+=$;else switch($!==ee.CODE_STOP&&(se=!1),$){case ee.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+=String.fromCharCode(29));break;case ee.CODE_CODE_A:w=ee.CODE_CODE_A;break;case ee.CODE_CODE_B:w=ee.CODE_CODE_B;break;case ee.CODE_STOP:v=!0;break}break}ms&&(w=w===ee.CODE_CODE_A?ee.CODE_CODE_B:ee.CODE_CODE_A)}const vn=z-L;if(z=s.getNextUnset(z),!s.isRange(z,Math.min(s.getSize(),z+(z-L)/2),!1))throw new j;if(ce-=ue*Y,ce%103!==Y)throw new M;const rr=D.length;if(rr===0)throw new j;rr>0&&se&&(w===ee.CODE_CODE_C?D=D.substring(0,rr-2):D=D.substring(0,rr-1));const Sn=(u[1]+u[0])/2,ft=L+vn/2,Jt=x.length,_n=new Uint8Array(Jt);for(let ms=0;ms<Jt;ms++)_n[ms]=x[ms];const ps=[new xe(Sn,r),new xe(ft,r)];return new Ze(D,_n,0,ps,ge.CODE_128,new Date().getTime())}}ee.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],ee.MAX_AVG_VARIANCE=.25,ee.MAX_INDIVIDUAL_VARIANCE=.7,ee.CODE_SHIFT=98,ee.CODE_CODE_C=99,ee.CODE_CODE_B=100,ee.CODE_CODE_A=101,ee.CODE_FNC_1=102,ee.CODE_FNC_2=97,ee.CODE_FNC_3=96,ee.CODE_FNC_4_A=101,ee.CODE_FNC_4_B=100,ee.CODE_START_A=103,ee.CODE_START_B=104,ee.CODE_START_C=105,ee.CODE_STOP=106;class be extends ye{constructor(r=!1,s=!1){super(),this.usingCheckDigit=r,this.extendedMode=s,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,s,o){let c=this.counters;c.fill(0),this.decodeRowResult="";let u=be.findAsteriskPattern(s,c),d=s.getNextSet(u[1]),h=s.getSize(),x,w;do{be.recordPattern(s,d,c);let H=be.toNarrowWidePattern(c);if(H<0)throw new j;x=be.patternToChar(H),this.decodeRowResult+=x,w=d;for(let Y of c)d+=Y;d=s.getNextSet(d)}while(x!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let v=0;for(let H of c)v+=H;let I=d-w-v;if(d!==h&&I*2<v)throw new j;if(this.usingCheckDigit){let H=this.decodeRowResult.length-1,Y=0;for(let $=0;$<H;$++)Y+=be.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt($));if(this.decodeRowResult.charAt(H)!==be.ALPHABET_STRING.charAt(Y%43))throw new M;this.decodeRowResult=this.decodeRowResult.substring(0,H)}if(this.decodeRowResult.length===0)throw new j;let D;this.extendedMode?D=be.decodeExtended(this.decodeRowResult):D=this.decodeRowResult;let L=(u[1]+u[0])/2,z=w+v/2;return new Ze(D,null,0,[new xe(L,r),new xe(z,r)],ge.CODE_39,new Date().getTime())}static findAsteriskPattern(r,s){let o=r.getSize(),c=r.getNextSet(0),u=0,d=c,h=!1,x=s.length;for(let w=c;w<o;w++)if(r.get(w)!==h)s[u]++;else{if(u===x-1){if(this.toNarrowWidePattern(s)===be.ASTERISK_ENCODING&&r.isRange(Math.max(0,d-Math.floor((w-d)/2)),d,!1))return[d,w];d+=s[0]+s[1],s.copyWithin(0,2,2+u-1),s[u-1]=0,s[u]=0,u--}else u++;s[u]=1,h=!h}throw new j}static toNarrowWidePattern(r){let s=r.length,o=0,c;do{let u=2147483647;for(let x of r)x<u&&x>o&&(u=x);o=u,c=0;let d=0,h=0;for(let x=0;x<s;x++){let w=r[x];w>o&&(h|=1<<s-1-x,c++,d+=w)}if(c===3){for(let x=0;x<s&&c>0;x++){let w=r[x];if(w>o&&(c--,w*2>=d))return-1}return h}}while(c>3);return-1}static patternToChar(r){for(let s=0;s<be.CHARACTER_ENCODINGS.length;s++)if(be.CHARACTER_ENCODINGS[s]===r)return be.ALPHABET_STRING.charAt(s);if(r===be.ASTERISK_ENCODING)return"*";throw new j}static decodeExtended(r){let s=r.length,o="";for(let c=0;c<s;c++){let u=r.charAt(c);if(u==="+"||u==="$"||u==="%"||u==="/"){let d=r.charAt(c+1),h="\0";switch(u){case"+":if(d>="A"&&d<="Z")h=String.fromCharCode(d.charCodeAt(0)+32);else throw new U;break;case"$":if(d>="A"&&d<="Z")h=String.fromCharCode(d.charCodeAt(0)-64);else throw new U;break;case"%":if(d>="A"&&d<="E")h=String.fromCharCode(d.charCodeAt(0)-38);else if(d>="F"&&d<="J")h=String.fromCharCode(d.charCodeAt(0)-11);else if(d>="K"&&d<="O")h=String.fromCharCode(d.charCodeAt(0)+16);else if(d>="P"&&d<="T")h=String.fromCharCode(d.charCodeAt(0)+43);else if(d==="U")h="\0";else if(d==="V")h="@";else if(d==="W")h="`";else if(d==="X"||d==="Y"||d==="Z")h="";else throw new U;break;case"/":if(d>="A"&&d<="O")h=String.fromCharCode(d.charCodeAt(0)-32);else if(d==="Z")h=":";else throw new U;break}o+=h,c++}else o+=u}return o}}be.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",be.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],be.ASTERISK_ENCODING=148;class Ie extends ye{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,s,o){let c=this.decodeStart(s),u=this.decodeEnd(s),d=new de;Ie.decodeMiddle(s,c[1],u[0],d);let h=d.toString(),x=null;o!=null&&(x=o.get(W.ALLOWED_LENGTHS)),x==null&&(x=Ie.DEFAULT_ALLOWED_LENGTHS);let w=h.length,v=!1,I=0;for(let z of x){if(w===z){v=!0;break}z>I&&(I=z)}if(!v&&w>I&&(v=!0),!v)throw new U;const D=[new xe(c[1],r),new xe(u[0],r)];return new Ze(h,null,0,D,ge.ITF,new Date().getTime())}static decodeMiddle(r,s,o,c){let u=new Int32Array(10),d=new Int32Array(5),h=new Int32Array(5);for(u.fill(0),d.fill(0),h.fill(0);s<o;){ye.recordPattern(r,s,u);for(let w=0;w<5;w++){let v=2*w;d[w]=u[v],h[w]=u[v+1]}let x=Ie.decodeDigit(d);c.append(x.toString()),x=this.decodeDigit(h),c.append(x.toString()),u.forEach(function(w){s+=w})}}decodeStart(r){let s=Ie.skipWhiteSpace(r),o=Ie.findGuardPattern(r,s,Ie.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(r,o[0]),o}validateQuietZone(r,s){let o=this.narrowLineWidth*10;o=o<s?o:s;for(let c=s-1;o>0&&c>=0&&!r.get(c);c--)o--;if(o!==0)throw new j}static skipWhiteSpace(r){const s=r.getSize(),o=r.getNextSet(0);if(o===s)throw new j;return o}decodeEnd(r){r.reverse();try{let s=Ie.skipWhiteSpace(r),o;try{o=Ie.findGuardPattern(r,s,Ie.END_PATTERN_REVERSED[0])}catch(u){u instanceof j&&(o=Ie.findGuardPattern(r,s,Ie.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,o[0]);let c=o[0];return o[0]=r.getSize()-o[1],o[1]=r.getSize()-c,o}finally{r.reverse()}}static findGuardPattern(r,s,o){let c=o.length,u=new Int32Array(c),d=r.getSize(),h=!1,x=0,w=s;u.fill(0);for(let v=s;v<d;v++)if(r.get(v)!==h)u[x]++;else{if(x===c-1){if(ye.patternMatchVariance(u,o,Ie.MAX_INDIVIDUAL_VARIANCE)<Ie.MAX_AVG_VARIANCE)return[w,v];w+=u[0]+u[1],k.arraycopy(u,2,u,0,x-1),u[x-1]=0,u[x]=0,x--}else x++;u[x]=1,h=!h}throw new j}static decodeDigit(r){let s=Ie.MAX_AVG_VARIANCE,o=-1,c=Ie.PATTERNS.length;for(let u=0;u<c;u++){let d=Ie.PATTERNS[u],h=ye.patternMatchVariance(r,d,Ie.MAX_INDIVIDUAL_VARIANCE);h<s?(s=h,o=u):h===s&&(o=-1)}if(o>=0)return o%10;throw new j}}Ie.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ie.MAX_AVG_VARIANCE=.38,Ie.MAX_INDIVIDUAL_VARIANCE=.5,Ie.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ie.START_PATTERN=Int32Array.from([1,1,1,1]),Ie.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ye extends ye{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let s=!1,o,c=0,u=Int32Array.from([0,0,0]);for(;!s;){u=Int32Array.from([0,0,0]),o=Ye.findGuardPattern(r,c,!1,this.START_END_PATTERN,u);let d=o[0];c=o[1];let h=d-(c-d);h>=0&&(s=r.isRange(h,d,!1))}return o}static checkChecksum(r){return Ye.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let o=parseInt(r.charAt(s-1),10);return Ye.getStandardUPCEANChecksum(r.substring(0,s-1))===o}static getStandardUPCEANChecksum(r){let s=r.length,o=0;for(let c=s-1;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new U;o+=u}o*=3;for(let c=s-2;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new U;o+=u}return(1e3-o)%10}static decodeEnd(r,s){return Ye.findGuardPattern(r,s,!1,Ye.START_END_PATTERN,new Int32Array(Ye.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,s,o,c){return this.findGuardPattern(r,s,o,c,new Int32Array(c.length))}static findGuardPattern(r,s,o,c,u){let d=r.getSize();s=o?r.getNextUnset(s):r.getNextSet(s);let h=0,x=s,w=c.length,v=o;for(let I=s;I<d;I++)if(r.get(I)!==v)u[h]++;else{if(h===w-1){if(ye.patternMatchVariance(u,c,Ye.MAX_INDIVIDUAL_VARIANCE)<Ye.MAX_AVG_VARIANCE)return Int32Array.from([x,I]);x+=u[0]+u[1];let D=u.slice(2,u.length-1);for(let L=0;L<h-1;L++)u[L]=D[L];u[h-1]=0,u[h]=0,h--}else h++;u[h]=1,v=!v}throw new j}static decodeDigit(r,s,o,c){this.recordPattern(r,o,s);let u=this.MAX_AVG_VARIANCE,d=-1,h=c.length;for(let x=0;x<h;x++){let w=c[x],v=ye.patternMatchVariance(s,w,Ye.MAX_INDIVIDUAL_VARIANCE);v<u&&(u=v,d=x)}if(d>=0)return d;throw new j}}Ye.MAX_AVG_VARIANCE=.48,Ye.MAX_INDIVIDUAL_VARIANCE=.7,Ye.START_END_PATTERN=Int32Array.from([1,1,1]),Ye.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ye.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ye.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Gt{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,o){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(s,o,c),d=c.toString(),h=Gt.parseExtensionString(d),x=[new xe((o[0]+o[1])/2,r),new xe(u,r)],w=new Ze(d,null,0,x,ge.UPC_EAN_EXTENSION,new Date().getTime());return h!=null&&w.putAllMetadata(h),w}decodeMiddle(r,s,o){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=s[1],h=0;for(let w=0;w<5&&d<u;w++){let v=Ye.decodeDigit(r,c,d,Ye.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+v%10);for(let I of c)d+=I;v>=10&&(h|=1<<4-w),w!==4&&(d=r.getNextSet(d),d=r.getNextUnset(d))}if(o.length!==5)throw new j;let x=this.determineCheckDigit(h);if(Gt.extensionChecksum(o.toString())!==x)throw new j;return d}static extensionChecksum(r){let s=r.length,o=0;for(let c=s-2;c>=0;c-=2)o+=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);o*=3;for(let c=s-1;c>=0;c-=2)o+=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);return o*=3,o%10}determineCheckDigit(r){for(let s=0;s<10;s++)if(r===this.CHECK_DIGIT_ENCODINGS[s])return s;throw new j}static parseExtensionString(r){if(r.length!==5)return null;let s=Gt.parseExtension5String(r);return s==null?null:new Map([[ct.SUGGESTED_PRICE,s]])}static parseExtension5String(r){let s;switch(r.charAt(0)){case"0":s="£";break;case"5":s="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}s="";break;default:s="";break}let o=parseInt(r.substring(1)),c=(o/100).toString(),u=o%100,d=u<10?"0"+u:u.toString();return s+c+"."+d}}class qr{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,o){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(s,o,c),d=c.toString(),h=qr.parseExtensionString(d),x=[new xe((o[0]+o[1])/2,r),new xe(u,r)],w=new Ze(d,null,0,x,ge.UPC_EAN_EXTENSION,new Date().getTime());return h!=null&&w.putAllMetadata(h),w}decodeMiddle(r,s,o){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=s[1],h=0;for(let x=0;x<2&&d<u;x++){let w=Ye.decodeDigit(r,c,d,Ye.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w%10);for(let v of c)d+=v;w>=10&&(h|=1<<1-x),x!==1&&(d=r.getNextSet(d),d=r.getNextUnset(d))}if(o.length!==2)throw new j;if(parseInt(o.toString())%4!==h)throw new j;return d}static parseExtensionString(r){return r.length!==2?null:new Map([[ct.ISSUE_NUMBER,parseInt(r)]])}}class ja{static decodeRow(r,s,o){let c=Ye.findGuardPattern(s,o,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Gt().decodeRow(r,s,c)}catch{return new qr().decodeRow(r,s,c)}}}ja.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class $e extends Ye{constructor(){super(),this.decodeRowStringBuffer="",$e.L_AND_G_PATTERNS=$e.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let s=$e.L_PATTERNS[r-10],o=new Int32Array(s.length);for(let c=0;c<s.length;c++)o[c]=s[s.length-c-1];$e.L_AND_G_PATTERNS[r]=o}}decodeRow(r,s,o){let c=$e.findStartGuardPattern(s),u=o==null?null:o.get(W.NEED_RESULT_POINT_CALLBACK);if(u!=null){const se=new xe((c[0]+c[1])/2,r);u.foundPossibleResultPoint(se)}let d=this.decodeMiddle(s,c,this.decodeRowStringBuffer),h=d.rowOffset,x=d.resultString;if(u!=null){const se=new xe(h,r);u.foundPossibleResultPoint(se)}let w=this.decodeEnd(s,h);if(u!=null){const se=new xe((w[0]+w[1])/2,r);u.foundPossibleResultPoint(se)}let v=w[1],I=v+(v-w[0]);if(I>=s.getSize()||!s.isRange(v,I,!1))throw new j;let D=x.toString();if(D.length<8)throw new U;if(!$e.checkChecksum(D))throw new M;let L=(c[1]+c[0])/2,z=(w[1]+w[0])/2,H=this.getBarcodeFormat(),Y=[new xe(L,r),new xe(z,r)],$=new Ze(D,null,0,Y,H,new Date().getTime()),ce=0;try{let se=ja.decodeRow(r,s,w[1]);$.putMetadata(ct.UPC_EAN_EXTENSION,se.getText()),$.putAllMetadata(se.getResultMetadata()),$.addResultPoints(se.getResultPoints()),ce=se.getText().length}catch{}let ue=o==null?null:o.get(W.ALLOWED_EAN_EXTENSIONS);if(ue!=null){let se=!1;for(let Qe in ue)if(ce.toString()===Qe){se=!0;break}if(!se)throw new j}return $}decodeEnd(r,s){return $e.findGuardPattern(r,s,!1,$e.START_END_PATTERN,new Int32Array($e.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return $e.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let o=parseInt(r.charAt(s-1),10);return $e.getStandardUPCEANChecksum(r.substring(0,s-1))===o}static getStandardUPCEANChecksum(r){let s=r.length,o=0;for(let c=s-1;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new U;o+=u}o*=3;for(let c=s-2;c>=0;c-=2){let u=r.charAt(c).charCodeAt(0)-"0".charCodeAt(0);if(u<0||u>9)throw new U;o+=u}return(1e3-o)%10}}class pr extends $e{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,o){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=s[1],h=0;for(let w=0;w<6&&d<u;w++){let v=$e.decodeDigit(r,c,d,$e.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+v%10);for(let I of c)d+=I;v>=10&&(h|=1<<5-w)}o=pr.determineFirstDigit(o,h),d=$e.findGuardPattern(r,d,!0,$e.MIDDLE_PATTERN,new Int32Array($e.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<6&&d<u;w++){let v=$e.decodeDigit(r,c,d,$e.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+v);for(let I of c)d+=I}return{rowOffset:d,resultString:o}}getBarcodeFormat(){return ge.EAN_13}static determineFirstDigit(r,s){for(let o=0;o<10;o++)if(s===this.FIRST_DIGIT_ENCODINGS[o])return r=String.fromCharCode("0".charCodeAt(0)+o)+r,r;throw new j}}pr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class go extends $e{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,o){const c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d=s[1];for(let x=0;x<4&&d<u;x++){let w=$e.decodeDigit(r,c,d,$e.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w);for(let v of c)d+=v}d=$e.findGuardPattern(r,d,!0,$e.MIDDLE_PATTERN,new Int32Array($e.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<4&&d<u;x++){let w=$e.decodeDigit(r,c,d,$e.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w);for(let v of c)d+=v}return{rowOffset:d,resultString:o}}getBarcodeFormat(){return ge.EAN_8}}class nr extends $e{constructor(){super(...arguments),this.ean13Reader=new pr}getBarcodeFormat(){return ge.UPC_A}decode(r,s){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,s,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,s,o))}decodeMiddle(r,s,o){return this.ean13Reader.decodeMiddle(r,s,o)}maybeReturnResult(r){let s=r.getText();if(s.charAt(0)==="0"){let o=new Ze(s.substring(1),null,null,r.getResultPoints(),ge.UPC_A);return r.getResultMetadata()!=null&&o.putAllMetadata(r.getResultMetadata()),o}else throw new j}reset(){this.ean13Reader.reset()}}class yn extends $e{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,s,o){const c=this.decodeMiddleCounters.map(w=>w);c[0]=0,c[1]=0,c[2]=0,c[3]=0;const u=r.getSize();let d=s[1],h=0;for(let w=0;w<6&&d<u;w++){const v=yn.decodeDigit(r,c,d,yn.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+v%10);for(let I of c)d+=I;v>=10&&(h|=1<<5-w)}let x=yn.determineNumSysAndCheckDigit(o,h);return{rowOffset:d,resultString:x}}decodeEnd(r,s){return yn.findGuardPatternWithoutCounters(r,s,!0,yn.MIDDLE_END_PATTERN)}checkChecksum(r){return $e.checkChecksum(yn.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,s){for(let o=0;o<=1;o++)for(let c=0;c<10;c++)if(s===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][c]){let u=String.fromCharCode("0".charCodeAt(0)+o),d=String.fromCharCode("0".charCodeAt(0)+c);return u+r+d}throw j.getNotFoundInstance()}getBarcodeFormat(){return ge.UPC_E}static convertUPCEtoUPCA(r){const s=r.slice(1,7).split("").map(u=>u.charCodeAt(0)),o=new de;o.append(r.charAt(0));let c=s[5];switch(c){case 0:case 1:case 2:o.appendChars(s,0,2),o.append(c),o.append("0000"),o.appendChars(s,2,3);break;case 3:o.appendChars(s,0,3),o.append("00000"),o.appendChars(s,3,2);break;case 4:o.appendChars(s,0,4),o.append("00000"),o.append(s[4]);break;default:o.appendChars(s,0,5),o.append("0000"),o.append(c);break}return r.length>=8&&o.append(r.charAt(7)),o.toString()}}yn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),yn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Pi extends ye{constructor(r){super();let s=r==null?null:r.get(W.POSSIBLE_FORMATS),o=[];i(s)?(o.push(new pr),o.push(new nr),o.push(new go),o.push(new yn)):(s.indexOf(ge.EAN_13)>-1&&o.push(new pr),s.indexOf(ge.UPC_A)>-1&&o.push(new nr),s.indexOf(ge.EAN_8)>-1&&o.push(new go),s.indexOf(ge.UPC_E)>-1&&o.push(new yn)),this.readers=o}decodeRow(r,s,o){for(let c of this.readers)try{const u=c.decodeRow(r,s,o),d=u.getBarcodeFormat()===ge.EAN_13&&u.getText().charAt(0)==="0",h=o==null?null:o.get(W.POSSIBLE_FORMATS),x=h==null||h.includes(ge.UPC_A);if(d&&x){const w=u.getRawBytes(),v=new Ze(u.getText().substring(1),w,w?w.length:null,u.getResultPoints(),ge.UPC_A);return v.putAllMetadata(u.getResultMetadata()),v}return u}catch{}throw new j}reset(){for(let r of this.readers)r.reset()}}class Nt extends ye{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,s){for(let o=0;o<s.length;o++)if(ye.patternMatchVariance(r,s[o],Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE)return o;throw new j}static count(r){return Fe.sum(new Int32Array(r))}static increment(r,s){let o=0,c=s[0];for(let u=1;u<r.length;u++)s[u]>c&&(c=s[u],o=u);r[o]++}static decrement(r,s){let o=0,c=s[0];for(let u=1;u<r.length;u++)s[u]<c&&(c=s[u],o=u);r[o]--}static isFinderPattern(r){let s=r[0]+r[1],o=s+r[2]+r[3],c=s/o;if(c>=Nt.MIN_FINDER_PATTERN_RATIO&&c<=Nt.MAX_FINDER_PATTERN_RATIO){let u=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(let h of r)h>d&&(d=h),h<u&&(u=h);return d<10*u}return!1}}Nt.MAX_AVG_VARIANCE=.2,Nt.MAX_INDIVIDUAL_VARIANCE=.45,Nt.MIN_FINDER_PATTERN_RATIO=9.5/12,Nt.MAX_FINDER_PATTERN_RATIO=12.5/14;class Jr{constructor(r,s){this.value=r,this.checksumPortion=s}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Jr))return!1;const s=r;return this.value===s.value&&this.checksumPortion===s.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Li{constructor(r,s,o,c,u){this.value=r,this.startEnd=s,this.value=r,this.startEnd=s,this.resultPoints=new Array,this.resultPoints.push(new xe(o,u)),this.resultPoints.push(new xe(c,u))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof Li))return!1;const s=r;return this.value===s.value}hashCode(){return this.value}}class mr{constructor(){}static getRSSvalue(r,s,o){let c=0;for(let x of r)c+=x;let u=0,d=0,h=r.length;for(let x=0;x<h-1;x++){let w;for(w=1,d|=1<<x;w<r[x];w++,d&=~(1<<x)){let v=mr.combins(c-w-1,h-x-2);if(o&&d===0&&c-w-(h-x-1)>=h-x-1&&(v-=mr.combins(c-w-(h-x),h-x-2)),h-x-1>1){let I=0;for(let D=c-w-(h-x-2);D>s;D--)I+=mr.combins(c-w-D-1,h-x-3);v-=I*(h-1-x)}else c-w>s&&v--;u+=v}c-=w}return u}static combins(r,s){let o,c;r-s>s?(c=s,o=r-s):(c=r-s,o=s);let u=1,d=1;for(let h=r;h>o;h--)u*=h,d<=c&&(u/=d,d++);for(;d<=c;)u/=d,d++;return u}}class rw{static buildBitArray(r){let s=r.length*2-1;r[r.length-1].getRightChar()==null&&(s-=1);let o=12*s,c=new O(o),u=0,h=r[0].getRightChar().getValue();for(let x=11;x>=0;--x)h&1<<x&&c.set(u),u++;for(let x=1;x<r.length;++x){let w=r[x],v=w.getLeftChar().getValue();for(let I=11;I>=0;--I)v&1<<I&&c.set(u),u++;if(w.getRightChar()!=null){let I=w.getRightChar().getValue();for(let D=11;D>=0;--D)I&1<<D&&c.set(u),u++}}return c}}class Bi{constructor(r,s){s?this.decodedInformation=null:(this.finished=r,this.decodedInformation=s)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Xc{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class wn extends Xc{constructor(r,s){super(r),this.value=s}getValue(){return this.value}isFNC1(){return this.value===wn.FNC1}}wn.FNC1="$";class ji extends Xc{constructor(r,s,o){super(r),o?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=s}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Wn extends Xc{constructor(r,s,o){if(super(r),s<0||s>10||o<0||o>10)throw new U;this.firstDigit=s,this.secondDigit=o}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Wn.FNC1}isSecondDigitFNC1(){return this.secondDigit===Wn.FNC1}isAnyFNC1(){return this.firstDigit===Wn.FNC1||this.secondDigit===Wn.FNC1}}Wn.FNC1=10;class we{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new j;let s=r.substring(0,2);for(let u of we.TWO_DIGIT_DATA_LENGTH)if(u[0]===s)return u[1]===we.VARIABLE_LENGTH?we.processVariableAI(2,u[2],r):we.processFixedAI(2,u[1],r);if(r.length<3)throw new j;let o=r.substring(0,3);for(let u of we.THREE_DIGIT_DATA_LENGTH)if(u[0]===o)return u[1]===we.VARIABLE_LENGTH?we.processVariableAI(3,u[2],r):we.processFixedAI(3,u[1],r);for(let u of we.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(u[0]===o)return u[1]===we.VARIABLE_LENGTH?we.processVariableAI(4,u[2],r):we.processFixedAI(4,u[1],r);if(r.length<4)throw new j;let c=r.substring(0,4);for(let u of we.FOUR_DIGIT_DATA_LENGTH)if(u[0]===c)return u[1]===we.VARIABLE_LENGTH?we.processVariableAI(4,u[2],r):we.processFixedAI(4,u[1],r);throw new j}static processFixedAI(r,s,o){if(o.length<r)throw new j;let c=o.substring(0,r);if(o.length<r+s)throw new j;let u=o.substring(r,r+s),d=o.substring(r+s),h="("+c+")"+u,x=we.parseFieldsInGeneralPurpose(d);return x==null?h:h+x}static processVariableAI(r,s,o){let c=o.substring(0,r),u;o.length<r+s?u=o.length:u=r+s;let d=o.substring(r,u),h=o.substring(u),x="("+c+")"+d,w=we.parseFieldsInGeneralPurpose(h);return w==null?x:x+w}}we.VARIABLE_LENGTH=[],we.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",we.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",we.VARIABLE_LENGTH,20],["22",we.VARIABLE_LENGTH,29],["30",we.VARIABLE_LENGTH,8],["37",we.VARIABLE_LENGTH,8],["90",we.VARIABLE_LENGTH,30],["91",we.VARIABLE_LENGTH,30],["92",we.VARIABLE_LENGTH,30],["93",we.VARIABLE_LENGTH,30],["94",we.VARIABLE_LENGTH,30],["95",we.VARIABLE_LENGTH,30],["96",we.VARIABLE_LENGTH,30],["97",we.VARIABLE_LENGTH,3],["98",we.VARIABLE_LENGTH,30],["99",we.VARIABLE_LENGTH,30]],we.THREE_DIGIT_DATA_LENGTH=[["240",we.VARIABLE_LENGTH,30],["241",we.VARIABLE_LENGTH,30],["242",we.VARIABLE_LENGTH,6],["250",we.VARIABLE_LENGTH,30],["251",we.VARIABLE_LENGTH,30],["253",we.VARIABLE_LENGTH,17],["254",we.VARIABLE_LENGTH,20],["400",we.VARIABLE_LENGTH,30],["401",we.VARIABLE_LENGTH,30],["402",17],["403",we.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",we.VARIABLE_LENGTH,20],["421",we.VARIABLE_LENGTH,15],["422",3],["423",we.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],we.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",we.VARIABLE_LENGTH,15],["391",we.VARIABLE_LENGTH,18],["392",we.VARIABLE_LENGTH,15],["393",we.VARIABLE_LENGTH,18],["703",we.VARIABLE_LENGTH,30]],we.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",we.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",we.VARIABLE_LENGTH,20],["8003",we.VARIABLE_LENGTH,30],["8004",we.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",we.VARIABLE_LENGTH,30],["8008",we.VARIABLE_LENGTH,12],["8018",18],["8020",we.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",we.VARIABLE_LENGTH,70],["8200",we.VARIABLE_LENGTH,70]];class cs{constructor(r){this.buffer=new de,this.information=r}decodeAllCodes(r,s){let o=s,c=null;do{let u=this.decodeGeneralPurposeField(o,c),d=we.parseFieldsInGeneralPurpose(u.getNewString());if(d!=null&&r.append(d),u.isRemaining()?c=""+u.getRemainingValue():c=null,o===u.getNewPosition())break;o=u.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let s=r;s<r+3;++s)if(this.information.get(s))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let u=this.extractNumericValueFromBitArray(r,4);return u===0?new Wn(this.information.getSize(),Wn.FNC1,Wn.FNC1):new Wn(this.information.getSize(),u-1,Wn.FNC1)}let s=this.extractNumericValueFromBitArray(r,7),o=(s-8)/11,c=(s-8)%11;return new Wn(r+7,o,c)}extractNumericValueFromBitArray(r,s){return cs.extractNumericValueFromBitArray(this.information,r,s)}static extractNumericValueFromBitArray(r,s,o){let c=0;for(let u=0;u<o;++u)r.get(s+u)&&(c|=1<<o-u-1);return c}decodeGeneralPurposeField(r,s){this.buffer.setLengthToZero(),s!=null&&this.buffer.append(s),this.current.setPosition(r);let o=this.parseBlocks();return o!=null&&o.isRemaining()?new ji(this.current.getPosition(),this.buffer.toString(),o.getRemainingValue()):new ji(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,s;do{let o=this.current.getPosition();if(this.current.isAlpha()?(s=this.parseAlphaBlock(),r=s.isFinished()):this.current.isIsoIec646()?(s=this.parseIsoIec646Block(),r=s.isFinished()):(s=this.parseNumericBlock(),r=s.isFinished()),!(o!==this.current.getPosition())&&!r)break}while(!r);return s.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let s;return r.isSecondDigitFNC1()?s=new ji(this.current.getPosition(),this.buffer.toString()):s=new ji(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new Bi(!0,s)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let s=new ji(this.current.getPosition(),this.buffer.toString());return new Bi(!0,s)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Bi(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new ji(this.current.getPosition(),this.buffer.toString());return new Bi(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Bi(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new ji(this.current.getPosition(),this.buffer.toString());return new Bi(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Bi(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+7>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,7);if(o>=64&&o<116)return!0;if(r+8>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(r,8);return c>=232&&c<253}decodeIsoIec646(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new wn(r+5,wn.FNC1);if(s>=5&&s<15)return new wn(r+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(r,7);if(o>=64&&o<90)return new wn(r+7,""+(o+1));if(o>=90&&o<116)return new wn(r+7,""+(o+7));let c=this.extractNumericValueFromBitArray(r,8),u;switch(c){case 232:u="!";break;case 233:u='"';break;case 234:u="%";break;case 235:u="&";break;case 236:u="'";break;case 237:u="(";break;case 238:u=")";break;case 239:u="*";break;case 240:u="+";break;case 241:u=",";break;case 242:u="-";break;case 243:u=".";break;case 244:u="/";break;case 245:u=":";break;case 246:u=";";break;case 247:u="<";break;case 248:u="=";break;case 249:u=">";break;case 250:u="?";break;case 251:u="_";break;case 252:u=" ";break;default:throw new U}return new wn(r+8,u)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+6>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,6);return o>=16&&o<63}decodeAlphanumeric(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new wn(r+5,wn.FNC1);if(s>=5&&s<15)return new wn(r+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(r,6);if(o>=32&&o<58)return new wn(r+6,""+(o+33));let c;switch(o){case 58:c="*";break;case 59:c=",";break;case 60:c="-";break;case 61:c=".";break;case 62:c="/";break;default:throw new je("Decoding invalid alphanumeric value: "+o)}return new wn(r+6,c)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<5&&s+r<this.information.getSize();++s)if(s===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+s))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let s=r;s<r+3;++s)if(this.information.get(s))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<4&&s+r<this.information.getSize();++s)if(this.information.get(r+s))return!1;return!0}}class Qc{constructor(r){this.information=r,this.generalDecoder=new cs(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Cn extends Qc{constructor(r){super(r)}encodeCompressedGtin(r,s){r.append("(01)");let o=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,s,o)}encodeCompressedGtinWithoutAI(r,s,o){for(let c=0;c<4;++c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(s+10*c,10);u/100===0&&r.append("0"),u/10===0&&r.append("0"),r.append(u)}Cn.appendCheckDigit(r,o)}static appendCheckDigit(r,s){let o=0;for(let c=0;c<13;c++){let u=r.charAt(c+s).charCodeAt(0)-"0".charCodeAt(0);o+=c&1?u:3*u}o=10-o%10,o===10&&(o=0),r.append(o)}}Cn.GTIN_SIZE=40;class us extends Cn{constructor(r){super(r)}parseInformation(){let r=new de;r.append("(01)");let s=r.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(us.HEADER_SIZE,4);return r.append(o),this.encodeCompressedGtinWithoutAI(r,us.HEADER_SIZE+4,s),this.getGeneralDecoder().decodeAllCodes(r,us.HEADER_SIZE+44)}}us.HEADER_SIZE=1+1+2;class Fa extends Qc{constructor(r){super(r)}parseInformation(){let r=new de;return this.getGeneralDecoder().decodeAllCodes(r,Fa.HEADER_SIZE)}}Fa.HEADER_SIZE=2+1+2;class Ua extends Cn{constructor(r){super(r)}encodeCompressedWeight(r,s,o){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(s,o);this.addWeightCode(r,c);let u=this.checkWeight(c),d=1e5;for(let h=0;h<5;++h)u/d===0&&r.append("0"),d/=10;r.append(u)}}class xr extends Ua{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=xr.HEADER_SIZE+Ua.GTIN_SIZE+xr.WEIGHT_SIZE)throw new j;let r=new de;return this.encodeCompressedGtin(r,xr.HEADER_SIZE),this.encodeCompressedWeight(r,xr.HEADER_SIZE+Ua.GTIN_SIZE,xr.WEIGHT_SIZE),r.toString()}}xr.HEADER_SIZE=4+1,xr.WEIGHT_SIZE=15;class iw extends xr{constructor(r){super(r)}addWeightCode(r,s){r.append("(3103)")}checkWeight(r){return r}}class sw extends xr{constructor(r){super(r)}addWeightCode(r,s){s<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class yr extends Cn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<yr.HEADER_SIZE+Cn.GTIN_SIZE)throw new j;let r=new de;this.encodeCompressedGtin(r,yr.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(yr.HEADER_SIZE+Cn.GTIN_SIZE,yr.LAST_DIGIT_SIZE);r.append("(392"),r.append(s),r.append(")");let o=this.getGeneralDecoder().decodeGeneralPurposeField(yr.HEADER_SIZE+Cn.GTIN_SIZE+yr.LAST_DIGIT_SIZE,null);return r.append(o.getNewString()),r.toString()}}yr.HEADER_SIZE=5+1+2,yr.LAST_DIGIT_SIZE=2;class fn extends Cn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<fn.HEADER_SIZE+Cn.GTIN_SIZE)throw new j;let r=new de;this.encodeCompressedGtin(r,fn.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(fn.HEADER_SIZE+Cn.GTIN_SIZE,fn.LAST_DIGIT_SIZE);r.append("(393"),r.append(s),r.append(")");let o=this.getGeneralDecoder().extractNumericValueFromBitArray(fn.HEADER_SIZE+Cn.GTIN_SIZE+fn.LAST_DIGIT_SIZE,fn.FIRST_THREE_DIGITS_SIZE);o/100==0&&r.append("0"),o/10==0&&r.append("0"),r.append(o);let c=this.getGeneralDecoder().decodeGeneralPurposeField(fn.HEADER_SIZE+Cn.GTIN_SIZE+fn.LAST_DIGIT_SIZE+fn.FIRST_THREE_DIGITS_SIZE,null);return r.append(c.getNewString()),r.toString()}}fn.HEADER_SIZE=5+1+2,fn.LAST_DIGIT_SIZE=2,fn.FIRST_THREE_DIGITS_SIZE=10;class wt extends Ua{constructor(r,s,o){super(r),this.dateCode=o,this.firstAIdigits=s}parseInformation(){if(this.getInformation().getSize()!=wt.HEADER_SIZE+wt.GTIN_SIZE+wt.WEIGHT_SIZE+wt.DATE_SIZE)throw new j;let r=new de;return this.encodeCompressedGtin(r,wt.HEADER_SIZE),this.encodeCompressedWeight(r,wt.HEADER_SIZE+wt.GTIN_SIZE,wt.WEIGHT_SIZE),this.encodeCompressedDate(r,wt.HEADER_SIZE+wt.GTIN_SIZE+wt.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,s){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(s,wt.DATE_SIZE);if(o==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let c=o%32;o/=32;let u=o%12+1;o/=12;let d=o;d/10==0&&r.append("0"),r.append(d),u/10==0&&r.append("0"),r.append(u),c/10==0&&r.append("0"),r.append(c)}addWeightCode(r,s){r.append("("),r.append(this.firstAIdigits),r.append(s/1e5),r.append(")")}checkWeight(r){return r%1e5}}wt.HEADER_SIZE=7+1,wt.WEIGHT_SIZE=20,wt.DATE_SIZE=16;function g0(T){try{if(T.get(1))return new us(T);if(!T.get(2))return new Fa(T);switch(cs.extractNumericValueFromBitArray(T,1,4)){case 4:return new iw(T);case 5:return new sw(T)}switch(cs.extractNumericValueFromBitArray(T,1,5)){case 12:return new yr(T);case 13:return new fn(T)}switch(cs.extractNumericValueFromBitArray(T,1,7)){case 56:return new wt(T,"310","11");case 57:return new wt(T,"320","11");case 58:return new wt(T,"310","13");case 59:return new wt(T,"320","13");case 60:return new wt(T,"310","15");case 61:return new wt(T,"320","15");case 62:return new wt(T,"310","17");case 63:return new wt(T,"320","17")}}catch(r){throw console.log(r),new je("unknown decoder: "+T)}}class ei{constructor(r,s,o,c){this.leftchar=r,this.rightchar=s,this.finderpattern=o,this.maybeLast=c}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,s){return r instanceof ei?ei.equalsOrNull(r.leftchar,s.leftchar)&&ei.equalsOrNull(r.rightchar,s.rightchar)&&ei.equalsOrNull(r.finderpattern,s.finderpattern):!1}static equalsOrNull(r,s){return r===null?s===null:ei.equals(r,s)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Kc{constructor(r,s,o){this.pairs=r,this.rowNumber=s,this.wasReversed=o}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,s){return r instanceof Kc?this.checkEqualitity(r,s)&&r.wasReversed===s.wasReversed:!1}checkEqualitity(r,s){if(!r||!s)return;let o;return r.forEach((c,u)=>{s.forEach(d=>{c.getLeftChar().getValue()===d.getLeftChar().getValue()&&c.getRightChar().getValue()===d.getRightChar().getValue()&&c.getFinderPatter().getValue()===d.getFinderPatter().getValue()&&(o=!0)})}),o}}class ne extends Nt{constructor(r){super(...arguments),this.pairs=new Array(ne.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,s,o){this.pairs.length=0,this.startFromEven=!1;try{return ne.constructResult(this.decodeRow2pairs(r,s))}catch(c){this.verbose&&console.log(c)}return this.pairs.length=0,this.startFromEven=!0,ne.constructResult(this.decodeRow2pairs(r,s))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,s){let o=!1;for(;!o;)try{this.pairs.push(this.retrieveNextPair(s,this.pairs,r))}catch(u){if(u instanceof j){if(!this.pairs.length)throw new j;o=!0}}if(this.checkChecksum())return this.pairs;let c;if(this.rows.length?c=!0:c=!1,this.storeRow(r,!1),c){let u=this.checkRowsBoolean(!1);if(u!=null||(u=this.checkRowsBoolean(!0),u!=null))return u}throw new j}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let s=null;try{s=this.checkRows(new Array,0)}catch(o){this.verbose&&console.log(o)}return r&&(this.rows=this.rows.reverse()),s}checkRows(r,s){for(let o=s;o<this.rows.length;o++){let c=this.rows[o];this.pairs.length=0;for(let d of r)this.pairs.push(d.getPairs());if(this.pairs.push(c.getPairs()),!ne.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let u=new Array(r);u.push(c);try{return this.checkRows(u,o+1)}catch(d){this.verbose&&console.log(d)}}throw new j}static isValidSequence(r){for(let s of ne.FINDER_PATTERN_SEQUENCES){if(r.length>s.length)continue;let o=!0;for(let c=0;c<r.length;c++)if(r[c].getFinderPattern().getValue()!=s[c]){o=!1;break}if(o)return!0}return!1}storeRow(r,s){let o=0,c=!1,u=!1;for(;o<this.rows.length;){let d=this.rows[o];if(d.getRowNumber()>r){u=d.isEquivalent(this.pairs);break}c=d.isEquivalent(this.pairs),o++}u||c||ne.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new Kc(this.pairs,r,s)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,s){for(let o of s)if(o.getPairs().length!==r.length){for(let c of o.getPairs())for(let u of r)if(ei.equals(c,u))break}}static isPartialRow(r,s){for(let o of s){let c=!0;for(let u of r){let d=!1;for(let h of o.getPairs())if(u.equals(h)){d=!0;break}if(!d){c=!1;break}}if(c)return!0}return!1}getRows(){return this.rows}static constructResult(r){let s=rw.buildBitArray(r),c=g0(s).parseInformation(),u=r[0].getFinderPattern().getResultPoints(),d=r[r.length-1].getFinderPattern().getResultPoints(),h=[u[0],u[1],d[0],d[1]];return new Ze(c,null,null,h,ge.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),s=r.getLeftChar(),o=r.getRightChar();if(o==null)return!1;let c=o.getChecksumPortion(),u=2;for(let h=1;h<this.pairs.size();++h){let x=this.pairs.get(h);c+=x.getLeftChar().getChecksumPortion(),u++;let w=x.getRightChar();w!=null&&(c+=w.getChecksumPortion(),u++)}return c%=211,211*(u-4)+c==s.getValue()}static getNextSecondBar(r,s){let o;return r.get(s)?(o=r.getNextUnset(s),o=r.getNextSet(o)):(o=r.getNextSet(s),o=r.getNextUnset(o)),o}retrieveNextPair(r,s,o){let c=s.length%2==0;this.startFromEven&&(c=!c);let u,d=!0,h=-1;do this.findNextPair(r,s,h),u=this.parseFoundFinderPattern(r,o,c),u==null?h=ne.getNextSecondBar(r,this.startEnd[0]):d=!1;while(d);let x=this.decodeDataCharacter(r,u,c,!0);if(!this.isEmptyPair(s)&&s[s.length-1].mustBeLast())throw new j;let w;try{w=this.decodeDataCharacter(r,u,c,!1)}catch(v){w=null,this.verbose&&console.log(v)}return new ei(x,w,u,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,s,o){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=r.getSize(),d;o>=0?d=o:this.isEmptyPair(s)?d=0:d=s[s.length-1].getFinderPattern().getStartEnd()[1];let h=s.length%2!=0;this.startFromEven&&(h=!h);let x=!1;for(;d<u&&(x=!r.get(d),!!x);)d++;let w=0,v=d;for(let I=d;I<u;I++)if(r.get(I)!=x)c[w]++;else{if(w==3){if(h&&ne.reverseCounters(c),ne.isFinderPattern(c)){this.startEnd[0]=v,this.startEnd[1]=I;return}h&&ne.reverseCounters(c),v+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,w--}else w++;c[w]=1,x=!x}throw new j}static reverseCounters(r){let s=r.length;for(let o=0;o<s/2;++o){let c=r[o];r[o]=r[s-o-1],r[s-o-1]=c}}parseFoundFinderPattern(r,s,o){let c,u,d;if(o){let w=this.startEnd[0]-1;for(;w>=0&&!r.get(w);)w--;w++,c=this.startEnd[0]-w,u=w,d=this.startEnd[1]}else u=this.startEnd[0],d=r.getNextUnset(this.startEnd[1]+1),c=d-this.startEnd[1];let h=this.getDecodeFinderCounters();k.arraycopy(h,0,h,1,h.length-1),h[0]=c;let x;try{x=this.parseFinderValue(h,ne.FINDER_PATTERNS)}catch{return null}return new Li(x,[u,d],u,d,s)}decodeDataCharacter(r,s,o,c){let u=this.getDataCharacterCounters();for(let ft=0;ft<u.length;ft++)u[ft]=0;if(c)ne.recordPatternInReverse(r,s.getStartEnd()[0],u);else{ne.recordPattern(r,s.getStartEnd()[1],u);for(let ft=0,Jt=u.length-1;ft<Jt;ft++,Jt--){let _n=u[ft];u[ft]=u[Jt],u[Jt]=_n}}let d=17,h=Fe.sum(new Int32Array(u))/d,x=(s.getStartEnd()[1]-s.getStartEnd()[0])/15;if(Math.abs(h-x)/x>.3)throw new j;let w=this.getOddCounts(),v=this.getEvenCounts(),I=this.getOddRoundingErrors(),D=this.getEvenRoundingErrors();for(let ft=0;ft<u.length;ft++){let Jt=1*u[ft]/h,_n=Jt+.5;if(_n<1){if(Jt<.3)throw new j;_n=1}else if(_n>8){if(Jt>8.7)throw new j;_n=8}let ps=ft/2;ft&1?(v[ps]=_n,D[ps]=Jt-_n):(w[ps]=_n,I[ps]=Jt-_n)}this.adjustOddEvenCounts(d);let L=4*s.getValue()+(o?0:2)+(c?0:1)-1,z=0,H=0;for(let ft=w.length-1;ft>=0;ft--){if(ne.isNotA1left(s,o,c)){let Jt=ne.WEIGHTS[L][2*ft];H+=w[ft]*Jt}z+=w[ft]}let Y=0;for(let ft=v.length-1;ft>=0;ft--)if(ne.isNotA1left(s,o,c)){let Jt=ne.WEIGHTS[L][2*ft+1];Y+=v[ft]*Jt}let $=H+Y;if(z&1||z>13||z<4)throw new j;let ce=(13-z)/2,ue=ne.SYMBOL_WIDEST[ce],se=9-ue,Qe=mr.getRSSvalue(w,ue,!0),ze=mr.getRSSvalue(v,se,!1),vn=ne.EVEN_TOTAL_SUBSET[ce],rr=ne.GSUM[ce],Sn=Qe*vn+ze+rr;return new Jr(Sn,$)}static isNotA1left(r,s,o){return!(r.getValue()==0&&s&&o)}adjustOddEvenCounts(r){let s=Fe.sum(new Int32Array(this.getOddCounts())),o=Fe.sum(new Int32Array(this.getEvenCounts())),c=!1,u=!1;s>13?u=!0:s<4&&(c=!0);let d=!1,h=!1;o>13?h=!0:o<4&&(d=!0);let x=s+o-r,w=(s&1)==1,v=(o&1)==0;if(x==1)if(w){if(v)throw new j;u=!0}else{if(!v)throw new j;h=!0}else if(x==-1)if(w){if(v)throw new j;c=!0}else{if(!v)throw new j;d=!0}else if(x==0){if(w){if(!v)throw new j;s<o?(c=!0,h=!0):(u=!0,d=!0)}else if(v)throw new j}else throw new j;if(c){if(u)throw new j;ne.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&ne.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(h)throw new j;ne.increment(this.getEvenCounts(),this.getOddRoundingErrors())}h&&ne.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ne.SYMBOL_WIDEST=[7,5,4,3,1],ne.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ne.GSUM=[0,348,1388,2948,3988],ne.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ne.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ne.FINDER_PAT_A=0,ne.FINDER_PAT_B=1,ne.FINDER_PAT_C=2,ne.FINDER_PAT_D=3,ne.FINDER_PAT_E=4,ne.FINDER_PAT_F=5,ne.FINDER_PATTERN_SEQUENCES=[[ne.FINDER_PAT_A,ne.FINDER_PAT_A],[ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B],[ne.FINDER_PAT_A,ne.FINDER_PAT_C,ne.FINDER_PAT_B,ne.FINDER_PAT_D],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_C],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_D,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_D],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_E],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F]],ne.MAX_PAIRS=11;class ow extends Jr{constructor(r,s,o){super(r,s),this.count=0,this.finderPattern=o}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Rt extends Nt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,s,o){const c=this.decodePair(s,!1,r,o);Rt.addOrTally(this.possibleLeftPairs,c),s.reverse();let u=this.decodePair(s,!0,r,o);Rt.addOrTally(this.possibleRightPairs,u),s.reverse();for(let d of this.possibleLeftPairs)if(d.getCount()>1){for(let h of this.possibleRightPairs)if(h.getCount()>1&&Rt.checkChecksum(d,h))return Rt.constructResult(d,h)}throw new j}static addOrTally(r,s){if(s==null)return;let o=!1;for(let c of r)if(c.getValue()===s.getValue()){c.incrementCount(),o=!0;break}o||r.push(s)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,s){let o=4537077*r.getValue()+s.getValue(),c=new String(o).toString(),u=new de;for(let w=13-c.length;w>0;w--)u.append("0");u.append(c);let d=0;for(let w=0;w<13;w++){let v=u.charAt(w).charCodeAt(0)-"0".charCodeAt(0);d+=w&1?v:3*v}d=10-d%10,d===10&&(d=0),u.append(d.toString());let h=r.getFinderPattern().getResultPoints(),x=s.getFinderPattern().getResultPoints();return new Ze(u.toString(),null,0,[h[0],h[1],x[0],x[1]],ge.RSS_14,new Date().getTime())}static checkChecksum(r,s){let o=(r.getChecksumPortion()+16*s.getChecksumPortion())%79,c=9*r.getFinderPattern().getValue()+s.getFinderPattern().getValue();return c>72&&c--,c>8&&c--,o===c}decodePair(r,s,o,c){try{let u=this.findFinderPattern(r,s),d=this.parseFoundFinderPattern(r,o,s,u),h=c==null?null:c.get(W.NEED_RESULT_POINT_CALLBACK);if(h!=null){let v=(u[0]+u[1])/2;s&&(v=r.getSize()-1-v),h.foundPossibleResultPoint(new xe(v,o))}let x=this.decodeDataCharacter(r,d,!0),w=this.decodeDataCharacter(r,d,!1);return new ow(1597*x.getValue()+w.getValue(),x.getChecksumPortion()+4*w.getChecksumPortion(),d)}catch{return null}}decodeDataCharacter(r,s,o){let c=this.getDataCharacterCounters();for(let Y=0;Y<c.length;Y++)c[Y]=0;if(o)ye.recordPatternInReverse(r,s.getStartEnd()[0],c);else{ye.recordPattern(r,s.getStartEnd()[1]+1,c);for(let Y=0,$=c.length-1;Y<$;Y++,$--){let ce=c[Y];c[Y]=c[$],c[$]=ce}}let u=o?16:15,d=Fe.sum(new Int32Array(c))/u,h=this.getOddCounts(),x=this.getEvenCounts(),w=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors();for(let Y=0;Y<c.length;Y++){let $=c[Y]/d,ce=Math.floor($+.5);ce<1?ce=1:ce>8&&(ce=8);let ue=Math.floor(Y/2);Y&1?(x[ue]=ce,v[ue]=$-ce):(h[ue]=ce,w[ue]=$-ce)}this.adjustOddEvenCounts(o,u);let I=0,D=0;for(let Y=h.length-1;Y>=0;Y--)D*=9,D+=h[Y],I+=h[Y];let L=0,z=0;for(let Y=x.length-1;Y>=0;Y--)L*=9,L+=x[Y],z+=x[Y];let H=D+3*L;if(o){if(I&1||I>12||I<4)throw new j;let Y=(12-I)/2,$=Rt.OUTSIDE_ODD_WIDEST[Y],ce=9-$,ue=mr.getRSSvalue(h,$,!1),se=mr.getRSSvalue(x,ce,!0),Qe=Rt.OUTSIDE_EVEN_TOTAL_SUBSET[Y],ze=Rt.OUTSIDE_GSUM[Y];return new Jr(ue*Qe+se+ze,H)}else{if(z&1||z>10||z<4)throw new j;let Y=(10-z)/2,$=Rt.INSIDE_ODD_WIDEST[Y],ce=9-$,ue=mr.getRSSvalue(h,$,!0),se=mr.getRSSvalue(x,ce,!1),Qe=Rt.INSIDE_ODD_TOTAL_SUBSET[Y],ze=Rt.INSIDE_GSUM[Y];return new Jr(se*Qe+ue+ze,H)}}findFinderPattern(r,s){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let c=r.getSize(),u=!1,d=0;for(;d<c&&(u=!r.get(d),s!==u);)d++;let h=0,x=d;for(let w=d;w<c;w++)if(r.get(w)!==u)o[h]++;else{if(h===3){if(Nt.isFinderPattern(o))return[x,w];x+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,h--}else h++;o[h]=1,u=!u}throw new j}parseFoundFinderPattern(r,s,o,c){let u=r.get(c[0]),d=c[0]-1;for(;d>=0&&u!==r.get(d);)d--;d++;const h=c[0]-d,x=this.getDecodeFinderCounters(),w=new Int32Array(x.length);k.arraycopy(x,0,w,1,x.length-1),w[0]=h;const v=this.parseFinderValue(w,Rt.FINDER_PATTERNS);let I=d,D=c[1];return o&&(I=r.getSize()-1-I,D=r.getSize()-1-D),new Li(v,[d,c[1]],I,D,s)}adjustOddEvenCounts(r,s){let o=Fe.sum(new Int32Array(this.getOddCounts())),c=Fe.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1,h=!1,x=!1;r?(o>12?d=!0:o<4&&(u=!0),c>12?x=!0:c<4&&(h=!0)):(o>11?d=!0:o<5&&(u=!0),c>10?x=!0:c<4&&(h=!0));let w=o+c-s,v=(o&1)===(r?1:0),I=(c&1)===1;if(w===1)if(v){if(I)throw new j;d=!0}else{if(!I)throw new j;x=!0}else if(w===-1)if(v){if(I)throw new j;u=!0}else{if(!I)throw new j;h=!0}else if(w===0){if(v){if(!I)throw new j;o<c?(u=!0,x=!0):(d=!0,h=!0)}else if(I)throw new j}else throw new j;if(u){if(d)throw new j;Nt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Nt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(x)throw new j;Nt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&Nt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Rt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Rt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Rt.OUTSIDE_GSUM=[0,161,961,2015,2715],Rt.INSIDE_GSUM=[0,336,1036,1516],Rt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Rt.INSIDE_ODD_WIDEST=[2,4,6,8],Rt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class ds extends ye{constructor(r,s){super(),this.readers=[],this.verbose=s===!0;const o=r?r.get(W.POSSIBLE_FORMATS):null,c=r&&r.get(W.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;o?((o.includes(ge.EAN_13)||o.includes(ge.UPC_A)||o.includes(ge.EAN_8)||o.includes(ge.UPC_E))&&this.readers.push(new Pi(r)),o.includes(ge.CODE_39)&&this.readers.push(new be(c)),o.includes(ge.CODE_128)&&this.readers.push(new ee),o.includes(ge.ITF)&&this.readers.push(new Ie),o.includes(ge.RSS_14)&&this.readers.push(new Rt),o.includes(ge.RSS_EXPANDED)&&this.readers.push(new ne(this.verbose))):(this.readers.push(new Pi(r)),this.readers.push(new be),this.readers.push(new Pi(r)),this.readers.push(new ee),this.readers.push(new Ie),this.readers.push(new Rt),this.readers.push(new ne(this.verbose)))}decodeRow(r,s,o){for(let c=0;c<this.readers.length;c++)try{return this.readers[c].decodeRow(r,s,o)}catch{}throw new j}reset(){this.readers.forEach(r=>r.reset())}}class aw extends st{constructor(r=500,s){super(new ds(s),r,s)}}class it{constructor(r,s,o){this.ecCodewords=r,this.ecBlocks=[s],o&&this.ecBlocks.push(o)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class nt{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ke{constructor(r,s,o,c,u,d){this.versionNumber=r,this.symbolSizeRows=s,this.symbolSizeColumns=o,this.dataRegionSizeRows=c,this.dataRegionSizeColumns=u,this.ecBlocks=d;let h=0;const x=d.getECCodewords(),w=d.getECBlocks();for(let v of w)h+=v.getCount()*(v.getDataCodewords()+x);this.totalCodewords=h}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,s){if(r&1||s&1)throw new U;for(let o of Ke.VERSIONS)if(o.symbolSizeRows===r&&o.symbolSizeColumns===s)return o;throw new U}toString(){return""+this.versionNumber}static buildVersions(){return[new Ke(1,10,10,8,8,new it(5,new nt(1,3))),new Ke(2,12,12,10,10,new it(7,new nt(1,5))),new Ke(3,14,14,12,12,new it(10,new nt(1,8))),new Ke(4,16,16,14,14,new it(12,new nt(1,12))),new Ke(5,18,18,16,16,new it(14,new nt(1,18))),new Ke(6,20,20,18,18,new it(18,new nt(1,22))),new Ke(7,22,22,20,20,new it(20,new nt(1,30))),new Ke(8,24,24,22,22,new it(24,new nt(1,36))),new Ke(9,26,26,24,24,new it(28,new nt(1,44))),new Ke(10,32,32,14,14,new it(36,new nt(1,62))),new Ke(11,36,36,16,16,new it(42,new nt(1,86))),new Ke(12,40,40,18,18,new it(48,new nt(1,114))),new Ke(13,44,44,20,20,new it(56,new nt(1,144))),new Ke(14,48,48,22,22,new it(68,new nt(1,174))),new Ke(15,52,52,24,24,new it(42,new nt(2,102))),new Ke(16,64,64,14,14,new it(56,new nt(2,140))),new Ke(17,72,72,16,16,new it(36,new nt(4,92))),new Ke(18,80,80,18,18,new it(48,new nt(4,114))),new Ke(19,88,88,20,20,new it(56,new nt(4,144))),new Ke(20,96,96,22,22,new it(68,new nt(4,174))),new Ke(21,104,104,24,24,new it(56,new nt(6,136))),new Ke(22,120,120,18,18,new it(68,new nt(6,175))),new Ke(23,132,132,20,20,new it(62,new nt(8,163))),new Ke(24,144,144,22,22,new it(62,new nt(8,156),new nt(2,155))),new Ke(25,8,18,6,16,new it(7,new nt(1,5))),new Ke(26,8,32,6,14,new it(11,new nt(1,10))),new Ke(27,12,26,10,24,new it(14,new nt(1,16))),new Ke(28,12,36,10,16,new it(18,new nt(1,22))),new Ke(29,16,36,14,16,new it(24,new nt(1,32))),new Ke(30,16,48,14,22,new it(28,new nt(1,49)))]}}Ke.VERSIONS=Ke.buildVersions();class Zc{constructor(r){const s=r.getHeight();if(s<8||s>144||s&1)throw new U;this.version=Zc.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new pe(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const s=r.getHeight(),o=r.getWidth();return Ke.getVersionForDimensions(s,o)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let s=0,o=4,c=0;const u=this.mappingBitMatrix.getHeight(),d=this.mappingBitMatrix.getWidth();let h=!1,x=!1,w=!1,v=!1;do if(o===u&&c===0&&!h)r[s++]=this.readCorner1(u,d)&255,o-=2,c+=2,h=!0;else if(o===u-2&&c===0&&d&3&&!x)r[s++]=this.readCorner2(u,d)&255,o-=2,c+=2,x=!0;else if(o===u+4&&c===2&&!(d&7)&&!w)r[s++]=this.readCorner3(u,d)&255,o-=2,c+=2,w=!0;else if(o===u-2&&c===0&&(d&7)===4&&!v)r[s++]=this.readCorner4(u,d)&255,o-=2,c+=2,v=!0;else{do o<u&&c>=0&&!this.readMappingMatrix.get(c,o)&&(r[s++]=this.readUtah(o,c,u,d)&255),o-=2,c+=2;while(o>=0&&c<d);o+=1,c+=3;do o>=0&&c<d&&!this.readMappingMatrix.get(c,o)&&(r[s++]=this.readUtah(o,c,u,d)&255),o+=2,c-=2;while(o<u&&c>=0);o+=3,c+=1}while(o<u||c<d);if(s!==this.version.getTotalCodewords())throw new U;return r}readModule(r,s,o,c){return r<0&&(r+=o,s+=4-(o+4&7)),s<0&&(s+=c,r+=4-(c+4&7)),this.readMappingMatrix.set(s,r),this.mappingBitMatrix.get(s,r)}readUtah(r,s,o,c){let u=0;return this.readModule(r-2,s-2,o,c)&&(u|=1),u<<=1,this.readModule(r-2,s-1,o,c)&&(u|=1),u<<=1,this.readModule(r-1,s-2,o,c)&&(u|=1),u<<=1,this.readModule(r-1,s-1,o,c)&&(u|=1),u<<=1,this.readModule(r-1,s,o,c)&&(u|=1),u<<=1,this.readModule(r,s-2,o,c)&&(u|=1),u<<=1,this.readModule(r,s-1,o,c)&&(u|=1),u<<=1,this.readModule(r,s,o,c)&&(u|=1),u}readCorner1(r,s){let o=0;return this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,1,r,s)&&(o|=1),o<<=1,this.readModule(r-1,2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(2,s-1,r,s)&&(o|=1),o<<=1,this.readModule(3,s-1,r,s)&&(o|=1),o}readCorner2(r,s){let o=0;return this.readModule(r-3,0,r,s)&&(o|=1),o<<=1,this.readModule(r-2,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(0,s-4,r,s)&&(o|=1),o<<=1,this.readModule(0,s-3,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o}readCorner3(r,s){let o=0;return this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(0,s-3,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-3,r,s)&&(o|=1),o<<=1,this.readModule(1,s-2,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o}readCorner4(r,s){let o=0;return this.readModule(r-3,0,r,s)&&(o|=1),o<<=1,this.readModule(r-2,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(2,s-1,r,s)&&(o|=1),o<<=1,this.readModule(3,s-1,r,s)&&(o|=1),o}extractDataRegion(r){const s=this.version.getSymbolSizeRows(),o=this.version.getSymbolSizeColumns();if(r.getHeight()!==s)throw new E("Dimension of bitMatrix must match the version size");const c=this.version.getDataRegionSizeRows(),u=this.version.getDataRegionSizeColumns(),d=s/c|0,h=o/u|0,x=d*c,w=h*u,v=new pe(w,x);for(let I=0;I<d;++I){const D=I*c;for(let L=0;L<h;++L){const z=L*u;for(let H=0;H<c;++H){const Y=I*(c+2)+1+H,$=D+H;for(let ce=0;ce<u;++ce){const ue=L*(u+2)+1+ce;if(r.get(ue,Y)){const se=z+ce;v.set(se,$)}}}}}return v}}class $c{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s){const o=s.getECBlocks();let c=0;const u=o.getECBlocks();for(let H of u)c+=H.getCount();const d=new Array(c);let h=0;for(let H of u)for(let Y=0;Y<H.getCount();Y++){const $=H.getDataCodewords(),ce=o.getECCodewords()+$;d[h++]=new $c($,new Uint8Array(ce))}const w=d[0].codewords.length-o.getECCodewords(),v=w-1;let I=0;for(let H=0;H<v;H++)for(let Y=0;Y<h;Y++)d[Y].codewords[H]=r[I++];const D=s.getVersionNumber()===24,L=D?8:h;for(let H=0;H<L;H++)d[H].codewords[w-1]=r[I++];const z=d[0].codewords.length;for(let H=w;H<z;H++)for(let Y=0;Y<h;Y++){const $=D?(Y+8)%h:Y,ce=D&&$>7?H-1:H;d[$].codewords[ce]=r[I++]}if(I!==r.length)throw new E;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class qc{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new E(""+r);let s=0,o=this.bitOffset,c=this.byteOffset;const u=this.bytes;if(o>0){const d=8-o,h=r<d?r:d,x=d-h,w=255>>8-h<<x;s=(u[c]&w)>>x,r-=h,o+=h,o===8&&(o=0,c++)}if(r>0){for(;r>=8;)s=s<<8|u[c]&255,c++,r-=8;if(r>0){const d=8-r,h=255>>d<<d;s=s<<r|(u[c]&h)>>d,o+=r}}return this.bitOffset=o,this.byteOffset=c,s}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Vt;(function(T){T[T.PAD_ENCODE=0]="PAD_ENCODE",T[T.ASCII_ENCODE=1]="ASCII_ENCODE",T[T.C40_ENCODE=2]="C40_ENCODE",T[T.TEXT_ENCODE=3]="TEXT_ENCODE",T[T.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",T[T.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",T[T.BASE256_ENCODE=6]="BASE256_ENCODE"})(Vt||(Vt={}));class ti{static decode(r){const s=new qc(r),o=new de,c=new de,u=new Array;let d=Vt.ASCII_ENCODE;do if(d===Vt.ASCII_ENCODE)d=this.decodeAsciiSegment(s,o,c);else{switch(d){case Vt.C40_ENCODE:this.decodeC40Segment(s,o);break;case Vt.TEXT_ENCODE:this.decodeTextSegment(s,o);break;case Vt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(s,o);break;case Vt.EDIFACT_ENCODE:this.decodeEdifactSegment(s,o);break;case Vt.BASE256_ENCODE:this.decodeBase256Segment(s,o,u);break;default:throw new U}d=Vt.ASCII_ENCODE}while(d!==Vt.PAD_ENCODE&&s.available()>0);return c.length()>0&&o.append(c.toString()),new Ut(r,o.toString(),u.length===0?null:u,null)}static decodeAsciiSegment(r,s,o){let c=!1;do{let u=r.readBits(8);if(u===0)throw new U;if(u<=128)return c&&(u+=128),s.append(String.fromCharCode(u-1)),Vt.ASCII_ENCODE;if(u===129)return Vt.PAD_ENCODE;if(u<=229){const d=u-130;d<10&&s.append("0"),s.append(""+d)}else switch(u){case 230:return Vt.C40_ENCODE;case 231:return Vt.BASE256_ENCODE;case 232:s.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:c=!0;break;case 236:s.append("[)>05"),o.insert(0,"");break;case 237:s.append("[)>06"),o.insert(0,"");break;case 238:return Vt.ANSIX12_ENCODE;case 239:return Vt.TEXT_ENCODE;case 240:return Vt.EDIFACT_ENCODE;case 241:break;default:if(u!==254||r.available()!==0)throw new U;break}}while(r.available()>0);return Vt.ASCII_ENCODE}static decodeC40Segment(r,s){let o=!1;const c=[];let u=0;do{if(r.available()===8)return;const d=r.readBits(8);if(d===254)return;this.parseTwoBytes(d,r.readBits(8),c);for(let h=0;h<3;h++){const x=c[h];switch(u){case 0:if(x<3)u=x+1;else if(x<this.C40_BASIC_SET_CHARS.length){const w=this.C40_BASIC_SET_CHARS[x];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else throw new U;break;case 1:o?(s.append(String.fromCharCode(x+128)),o=!1):s.append(String.fromCharCode(x)),u=0;break;case 2:if(x<this.C40_SHIFT2_SET_CHARS.length){const w=this.C40_SHIFT2_SET_CHARS[x];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else switch(x){case 27:s.append(String.fromCharCode(29));break;case 30:o=!0;break;default:throw new U}u=0;break;case 3:o?(s.append(String.fromCharCode(x+224)),o=!1):s.append(String.fromCharCode(x+96)),u=0;break;default:throw new U}}}while(r.available()>0)}static decodeTextSegment(r,s){let o=!1,c=[],u=0;do{if(r.available()===8)return;const d=r.readBits(8);if(d===254)return;this.parseTwoBytes(d,r.readBits(8),c);for(let h=0;h<3;h++){const x=c[h];switch(u){case 0:if(x<3)u=x+1;else if(x<this.TEXT_BASIC_SET_CHARS.length){const w=this.TEXT_BASIC_SET_CHARS[x];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else throw new U;break;case 1:o?(s.append(String.fromCharCode(x+128)),o=!1):s.append(String.fromCharCode(x)),u=0;break;case 2:if(x<this.TEXT_SHIFT2_SET_CHARS.length){const w=this.TEXT_SHIFT2_SET_CHARS[x];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else switch(x){case 27:s.append(String.fromCharCode(29));break;case 30:o=!0;break;default:throw new U}u=0;break;case 3:if(x<this.TEXT_SHIFT3_SET_CHARS.length){const w=this.TEXT_SHIFT3_SET_CHARS[x];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w),u=0}else throw new U;break;default:throw new U}}}while(r.available()>0)}static decodeAnsiX12Segment(r,s){const o=[];do{if(r.available()===8)return;const c=r.readBits(8);if(c===254)return;this.parseTwoBytes(c,r.readBits(8),o);for(let u=0;u<3;u++){const d=o[u];switch(d){case 0:s.append("\r");break;case 1:s.append("*");break;case 2:s.append(">");break;case 3:s.append(" ");break;default:if(d<14)s.append(String.fromCharCode(d+44));else if(d<40)s.append(String.fromCharCode(d+51));else throw new U;break}}}while(r.available()>0)}static parseTwoBytes(r,s,o){let c=(r<<8)+s-1,u=Math.floor(c/1600);o[0]=u,c-=u*1600,u=Math.floor(c/40),o[1]=u,o[2]=c-u*40}static decodeEdifactSegment(r,s){do{if(r.available()<=16)return;for(let o=0;o<4;o++){let c=r.readBits(6);if(c===31){const u=8-r.getBitOffset();u!==8&&r.readBits(u);return}c&32||(c|=64),s.append(String.fromCharCode(c))}}while(r.available()>0)}static decodeBase256Segment(r,s,o){let c=1+r.getByteOffset();const u=this.unrandomize255State(r.readBits(8),c++);let d;if(u===0?d=r.available()/8|0:u<250?d=u:d=250*(u-249)+this.unrandomize255State(r.readBits(8),c++),d<0)throw new U;const h=new Uint8Array(d);for(let x=0;x<d;x++){if(r.available()<8)throw new U;h[x]=this.unrandomize255State(r.readBits(8),c++)}o.push(h);try{s.append(me.decode(h,he.ISO88591))}catch(x){throw new je("Platform does not support required encoding: "+x.message)}}static unrandomize255State(r,s){const o=149*s%255+1,c=r-o;return c>=0?c:c+256}}ti.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ti.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ti.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ti.TEXT_SHIFT2_SET_CHARS=ti.C40_SHIFT2_SET_CHARS,ti.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class lw{constructor(){this.rsDecoder=new Oe(K.DATA_MATRIX_FIELD_256)}decode(r){const s=new Zc(r),o=s.getVersion(),c=s.readCodewords(),u=$c.getDataBlocks(c,o);let d=0;for(let w of u)d+=w.getNumDataCodewords();const h=new Uint8Array(d),x=u.length;for(let w=0;w<x;w++){const v=u[w],I=v.getCodewords(),D=v.getNumDataCodewords();this.correctErrors(I,D);for(let L=0;L<D;L++)h[L*x+w]=I[L]}return ti.decode(h)}correctErrors(r,s){const o=new Int32Array(r);try{this.rsDecoder.decode(o,r.length-s)}catch{throw new M}for(let c=0;c<s;c++)r[c]=o[c]}}class Pt{constructor(r){this.image=r,this.rectangleDetector=new ie(this.image)}detect(){const r=this.rectangleDetector.detect();let s=this.detectSolid1(r);if(s=this.detectSolid2(s),s[3]=this.correctTopRight(s),!s[3])throw new j;s=this.shiftToModuleCenter(s);const o=s[0],c=s[1],u=s[2],d=s[3];let h=this.transitionsBetween(o,d)+1,x=this.transitionsBetween(u,d)+1;(h&1)===1&&(h+=1),(x&1)===1&&(x+=1),4*h<7*x&&4*x<7*h&&(h=x=Math.max(h,x));let w=Pt.sampleGrid(this.image,o,c,u,d,h,x);return new Zt(w,[o,c,u,d])}static shiftPoint(r,s,o){let c=(s.getX()-r.getX())/(o+1),u=(s.getY()-r.getY())/(o+1);return new xe(r.getX()+c,r.getY()+u)}static moveAway(r,s,o){let c=r.getX(),u=r.getY();return c<s?c-=1:c+=1,u<o?u-=1:u+=1,new xe(c,u)}detectSolid1(r){let s=r[0],o=r[1],c=r[3],u=r[2],d=this.transitionsBetween(s,o),h=this.transitionsBetween(o,c),x=this.transitionsBetween(c,u),w=this.transitionsBetween(u,s),v=d,I=[u,s,o,c];return v>h&&(v=h,I[0]=s,I[1]=o,I[2]=c,I[3]=u),v>x&&(v=x,I[0]=o,I[1]=c,I[2]=u,I[3]=s),v>w&&(I[0]=c,I[1]=u,I[2]=s,I[3]=o),I}detectSolid2(r){let s=r[0],o=r[1],c=r[2],u=r[3],d=this.transitionsBetween(s,u),h=Pt.shiftPoint(o,c,(d+1)*4),x=Pt.shiftPoint(c,o,(d+1)*4),w=this.transitionsBetween(h,s),v=this.transitionsBetween(x,u);return w<v?(r[0]=s,r[1]=o,r[2]=c,r[3]=u):(r[0]=o,r[1]=c,r[2]=u,r[3]=s),r}correctTopRight(r){let s=r[0],o=r[1],c=r[2],u=r[3],d=this.transitionsBetween(s,u),h=this.transitionsBetween(o,u),x=Pt.shiftPoint(s,o,(h+1)*4),w=Pt.shiftPoint(c,o,(d+1)*4);d=this.transitionsBetween(x,u),h=this.transitionsBetween(w,u);let v=new xe(u.getX()+(c.getX()-o.getX())/(d+1),u.getY()+(c.getY()-o.getY())/(d+1)),I=new xe(u.getX()+(s.getX()-o.getX())/(h+1),u.getY()+(s.getY()-o.getY())/(h+1));if(!this.isValid(v))return this.isValid(I)?I:null;if(!this.isValid(I))return v;let D=this.transitionsBetween(x,v)+this.transitionsBetween(w,v),L=this.transitionsBetween(x,I)+this.transitionsBetween(w,I);return D>L?v:I}shiftToModuleCenter(r){let s=r[0],o=r[1],c=r[2],u=r[3],d=this.transitionsBetween(s,u)+1,h=this.transitionsBetween(c,u)+1,x=Pt.shiftPoint(s,o,h*4),w=Pt.shiftPoint(c,o,d*4);d=this.transitionsBetween(x,u)+1,h=this.transitionsBetween(w,u)+1,(d&1)===1&&(d+=1),(h&1)===1&&(h+=1);let v=(s.getX()+o.getX()+c.getX()+u.getX())/4,I=(s.getY()+o.getY()+c.getY()+u.getY())/4;s=Pt.moveAway(s,v,I),o=Pt.moveAway(o,v,I),c=Pt.moveAway(c,v,I),u=Pt.moveAway(u,v,I);let D,L;return x=Pt.shiftPoint(s,o,h*4),x=Pt.shiftPoint(x,u,d*4),D=Pt.shiftPoint(o,s,h*4),D=Pt.shiftPoint(D,c,d*4),w=Pt.shiftPoint(c,u,h*4),w=Pt.shiftPoint(w,o,d*4),L=Pt.shiftPoint(u,c,h*4),L=Pt.shiftPoint(L,s,d*4),[x,D,w,L]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,s,o,c,u,d,h){return tt.getInstance().sampleGrid(r,d,h,.5,.5,d-.5,.5,d-.5,h-.5,.5,h-.5,s.getX(),s.getY(),u.getX(),u.getY(),c.getX(),c.getY(),o.getX(),o.getY())}transitionsBetween(r,s){let o=Math.trunc(r.getX()),c=Math.trunc(r.getY()),u=Math.trunc(s.getX()),d=Math.trunc(s.getY()),h=Math.abs(d-c)>Math.abs(u-o);if(h){let H=o;o=c,c=H,H=u,u=d,d=H}let x=Math.abs(u-o),w=Math.abs(d-c),v=-x/2,I=c<d?1:-1,D=o<u?1:-1,L=0,z=this.image.get(h?c:o,h?o:c);for(let H=o,Y=c;H!==u;H+=D){let $=this.image.get(h?Y:H,h?H:Y);if($!==z&&(L++,z=$),v+=w,v>0){if(Y===d)break;Y+=I,v-=x}}return L}}class ni{constructor(){this.decoder=new lw}decode(r,s=null){let o,c;if(s!=null&&s.has(W.PURE_BARCODE)){const w=ni.extractPureBits(r.getBlackMatrix());o=this.decoder.decode(w),c=ni.NO_POINTS}else{const w=new Pt(r.getBlackMatrix()).detect();o=this.decoder.decode(w.getBits()),c=w.getPoints()}const u=o.getRawBytes(),d=new Ze(o.getText(),u,8*u.length,c,ge.DATA_MATRIX,k.currentTimeMillis()),h=o.getByteSegments();h!=null&&d.putMetadata(ct.BYTE_SEGMENTS,h);const x=o.getECLevel();return x!=null&&d.putMetadata(ct.ERROR_CORRECTION_LEVEL,x),d}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),o=r.getBottomRightOnBit();if(s==null||o==null)throw new j;const c=this.moduleSize(s,r);let u=s[1];const d=o[1];let h=s[0];const w=(o[0]-h+1)/c,v=(d-u+1)/c;if(w<=0||v<=0)throw new j;const I=c/2;u+=I,h+=I;const D=new pe(w,v);for(let L=0;L<v;L++){const z=u+L*c;for(let H=0;H<w;H++)r.get(h+H*c,z)&&D.set(H,L)}return D}static moduleSize(r,s){const o=s.getWidth();let c=r[0];const u=r[1];for(;c<o&&s.get(c,u);)c++;if(c===o)throw new j;const d=c-r[0];if(d===0)throw new j;return d}}ni.NO_POINTS=[];class cw extends st{constructor(r=500){super(new ni,r)}}var fs;(function(T){T[T.L=0]="L",T[T.M=1]="M",T[T.Q=2]="Q",T[T.H=3]="H"})(fs||(fs={}));class ht{constructor(r,s,o){this.value=r,this.stringValue=s,this.bits=o,ht.FOR_BITS.set(o,this),ht.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return ht.L;case"M":return ht.M;case"Q":return ht.Q;case"H":return ht.H;default:throw new C(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof ht))return!1;const s=r;return this.value===s.value}static forBits(r){if(r<0||r>=ht.FOR_BITS.size)throw new E;return ht.FOR_BITS.get(r)}}ht.FOR_BITS=new Map,ht.FOR_VALUE=new Map,ht.L=new ht(fs.L,"L",1),ht.M=new ht(fs.M,"M",0),ht.Q=new ht(fs.Q,"Q",3),ht.H=new ht(fs.H,"H",2);class sn{constructor(r){this.errorCorrectionLevel=ht.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,s){return S.bitCount(r^s)}static decodeFormatInformation(r,s){const o=sn.doDecodeFormatInformation(r,s);return o!==null?o:sn.doDecodeFormatInformation(r^sn.FORMAT_INFO_MASK_QR,s^sn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,s){let o=Number.MAX_SAFE_INTEGER,c=0;for(const u of sn.FORMAT_INFO_DECODE_LOOKUP){const d=u[0];if(d===r||d===s)return new sn(u[1]);let h=sn.numBitsDiffering(r,d);h<o&&(c=u[1],o=h),r!==s&&(h=sn.numBitsDiffering(s,d),h<o&&(c=u[1],o=h))}return o<=3?new sn(c):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof sn))return!1;const s=r;return this.errorCorrectionLevel===s.errorCorrectionLevel&&this.dataMask===s.dataMask}}sn.FORMAT_INFO_MASK_QR=21522,sn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Q{constructor(r,...s){this.ecCodewordsPerBlock=r,this.ecBlocks=s}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const s=this.ecBlocks;for(const o of s)r+=o.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class P{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ne{constructor(r,s,...o){this.versionNumber=r,this.alignmentPatternCenters=s,this.ecBlocks=o;let c=0;const u=o[0].getECCodewordsPerBlock(),d=o[0].getECBlocks();for(const h of d)c+=h.getCount()*(h.getDataCodewords()+u);this.totalCodewords=c}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new U;try{return this.getVersionForNumber((r-17)/4)}catch{throw new U}}static getVersionForNumber(r){if(r<1||r>40)throw new E;return Ne.VERSIONS[r-1]}static decodeVersionInformation(r){let s=Number.MAX_SAFE_INTEGER,o=0;for(let c=0;c<Ne.VERSION_DECODE_INFO.length;c++){const u=Ne.VERSION_DECODE_INFO[c];if(u===r)return Ne.getVersionForNumber(c+7);const d=sn.numBitsDiffering(r,u);d<s&&(o=c+7,s=d)}return s<=3?Ne.getVersionForNumber(o):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),s=new pe(r);s.setRegion(0,0,9,9),s.setRegion(r-8,0,8,9),s.setRegion(0,r-8,9,8);const o=this.alignmentPatternCenters.length;for(let c=0;c<o;c++){const u=this.alignmentPatternCenters[c]-2;for(let d=0;d<o;d++)c===0&&(d===0||d===o-1)||c===o-1&&d===0||s.setRegion(this.alignmentPatternCenters[d]-2,u,5,5)}return s.setRegion(6,9,1,r-17),s.setRegion(9,6,r-17,1),this.versionNumber>6&&(s.setRegion(r-11,0,3,6),s.setRegion(0,r-11,6,3)),s}toString(){return""+this.versionNumber}}Ne.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ne.VERSIONS=[new Ne(1,new Int32Array(0),new Q(7,new P(1,19)),new Q(10,new P(1,16)),new Q(13,new P(1,13)),new Q(17,new P(1,9))),new Ne(2,Int32Array.from([6,18]),new Q(10,new P(1,34)),new Q(16,new P(1,28)),new Q(22,new P(1,22)),new Q(28,new P(1,16))),new Ne(3,Int32Array.from([6,22]),new Q(15,new P(1,55)),new Q(26,new P(1,44)),new Q(18,new P(2,17)),new Q(22,new P(2,13))),new Ne(4,Int32Array.from([6,26]),new Q(20,new P(1,80)),new Q(18,new P(2,32)),new Q(26,new P(2,24)),new Q(16,new P(4,9))),new Ne(5,Int32Array.from([6,30]),new Q(26,new P(1,108)),new Q(24,new P(2,43)),new Q(18,new P(2,15),new P(2,16)),new Q(22,new P(2,11),new P(2,12))),new Ne(6,Int32Array.from([6,34]),new Q(18,new P(2,68)),new Q(16,new P(4,27)),new Q(24,new P(4,19)),new Q(28,new P(4,15))),new Ne(7,Int32Array.from([6,22,38]),new Q(20,new P(2,78)),new Q(18,new P(4,31)),new Q(18,new P(2,14),new P(4,15)),new Q(26,new P(4,13),new P(1,14))),new Ne(8,Int32Array.from([6,24,42]),new Q(24,new P(2,97)),new Q(22,new P(2,38),new P(2,39)),new Q(22,new P(4,18),new P(2,19)),new Q(26,new P(4,14),new P(2,15))),new Ne(9,Int32Array.from([6,26,46]),new Q(30,new P(2,116)),new Q(22,new P(3,36),new P(2,37)),new Q(20,new P(4,16),new P(4,17)),new Q(24,new P(4,12),new P(4,13))),new Ne(10,Int32Array.from([6,28,50]),new Q(18,new P(2,68),new P(2,69)),new Q(26,new P(4,43),new P(1,44)),new Q(24,new P(6,19),new P(2,20)),new Q(28,new P(6,15),new P(2,16))),new Ne(11,Int32Array.from([6,30,54]),new Q(20,new P(4,81)),new Q(30,new P(1,50),new P(4,51)),new Q(28,new P(4,22),new P(4,23)),new Q(24,new P(3,12),new P(8,13))),new Ne(12,Int32Array.from([6,32,58]),new Q(24,new P(2,92),new P(2,93)),new Q(22,new P(6,36),new P(2,37)),new Q(26,new P(4,20),new P(6,21)),new Q(28,new P(7,14),new P(4,15))),new Ne(13,Int32Array.from([6,34,62]),new Q(26,new P(4,107)),new Q(22,new P(8,37),new P(1,38)),new Q(24,new P(8,20),new P(4,21)),new Q(22,new P(12,11),new P(4,12))),new Ne(14,Int32Array.from([6,26,46,66]),new Q(30,new P(3,115),new P(1,116)),new Q(24,new P(4,40),new P(5,41)),new Q(20,new P(11,16),new P(5,17)),new Q(24,new P(11,12),new P(5,13))),new Ne(15,Int32Array.from([6,26,48,70]),new Q(22,new P(5,87),new P(1,88)),new Q(24,new P(5,41),new P(5,42)),new Q(30,new P(5,24),new P(7,25)),new Q(24,new P(11,12),new P(7,13))),new Ne(16,Int32Array.from([6,26,50,74]),new Q(24,new P(5,98),new P(1,99)),new Q(28,new P(7,45),new P(3,46)),new Q(24,new P(15,19),new P(2,20)),new Q(30,new P(3,15),new P(13,16))),new Ne(17,Int32Array.from([6,30,54,78]),new Q(28,new P(1,107),new P(5,108)),new Q(28,new P(10,46),new P(1,47)),new Q(28,new P(1,22),new P(15,23)),new Q(28,new P(2,14),new P(17,15))),new Ne(18,Int32Array.from([6,30,56,82]),new Q(30,new P(5,120),new P(1,121)),new Q(26,new P(9,43),new P(4,44)),new Q(28,new P(17,22),new P(1,23)),new Q(28,new P(2,14),new P(19,15))),new Ne(19,Int32Array.from([6,30,58,86]),new Q(28,new P(3,113),new P(4,114)),new Q(26,new P(3,44),new P(11,45)),new Q(26,new P(17,21),new P(4,22)),new Q(26,new P(9,13),new P(16,14))),new Ne(20,Int32Array.from([6,34,62,90]),new Q(28,new P(3,107),new P(5,108)),new Q(26,new P(3,41),new P(13,42)),new Q(30,new P(15,24),new P(5,25)),new Q(28,new P(15,15),new P(10,16))),new Ne(21,Int32Array.from([6,28,50,72,94]),new Q(28,new P(4,116),new P(4,117)),new Q(26,new P(17,42)),new Q(28,new P(17,22),new P(6,23)),new Q(30,new P(19,16),new P(6,17))),new Ne(22,Int32Array.from([6,26,50,74,98]),new Q(28,new P(2,111),new P(7,112)),new Q(28,new P(17,46)),new Q(30,new P(7,24),new P(16,25)),new Q(24,new P(34,13))),new Ne(23,Int32Array.from([6,30,54,78,102]),new Q(30,new P(4,121),new P(5,122)),new Q(28,new P(4,47),new P(14,48)),new Q(30,new P(11,24),new P(14,25)),new Q(30,new P(16,15),new P(14,16))),new Ne(24,Int32Array.from([6,28,54,80,106]),new Q(30,new P(6,117),new P(4,118)),new Q(28,new P(6,45),new P(14,46)),new Q(30,new P(11,24),new P(16,25)),new Q(30,new P(30,16),new P(2,17))),new Ne(25,Int32Array.from([6,32,58,84,110]),new Q(26,new P(8,106),new P(4,107)),new Q(28,new P(8,47),new P(13,48)),new Q(30,new P(7,24),new P(22,25)),new Q(30,new P(22,15),new P(13,16))),new Ne(26,Int32Array.from([6,30,58,86,114]),new Q(28,new P(10,114),new P(2,115)),new Q(28,new P(19,46),new P(4,47)),new Q(28,new P(28,22),new P(6,23)),new Q(30,new P(33,16),new P(4,17))),new Ne(27,Int32Array.from([6,34,62,90,118]),new Q(30,new P(8,122),new P(4,123)),new Q(28,new P(22,45),new P(3,46)),new Q(30,new P(8,23),new P(26,24)),new Q(30,new P(12,15),new P(28,16))),new Ne(28,Int32Array.from([6,26,50,74,98,122]),new Q(30,new P(3,117),new P(10,118)),new Q(28,new P(3,45),new P(23,46)),new Q(30,new P(4,24),new P(31,25)),new Q(30,new P(11,15),new P(31,16))),new Ne(29,Int32Array.from([6,30,54,78,102,126]),new Q(30,new P(7,116),new P(7,117)),new Q(28,new P(21,45),new P(7,46)),new Q(30,new P(1,23),new P(37,24)),new Q(30,new P(19,15),new P(26,16))),new Ne(30,Int32Array.from([6,26,52,78,104,130]),new Q(30,new P(5,115),new P(10,116)),new Q(28,new P(19,47),new P(10,48)),new Q(30,new P(15,24),new P(25,25)),new Q(30,new P(23,15),new P(25,16))),new Ne(31,Int32Array.from([6,30,56,82,108,134]),new Q(30,new P(13,115),new P(3,116)),new Q(28,new P(2,46),new P(29,47)),new Q(30,new P(42,24),new P(1,25)),new Q(30,new P(23,15),new P(28,16))),new Ne(32,Int32Array.from([6,34,60,86,112,138]),new Q(30,new P(17,115)),new Q(28,new P(10,46),new P(23,47)),new Q(30,new P(10,24),new P(35,25)),new Q(30,new P(19,15),new P(35,16))),new Ne(33,Int32Array.from([6,30,58,86,114,142]),new Q(30,new P(17,115),new P(1,116)),new Q(28,new P(14,46),new P(21,47)),new Q(30,new P(29,24),new P(19,25)),new Q(30,new P(11,15),new P(46,16))),new Ne(34,Int32Array.from([6,34,62,90,118,146]),new Q(30,new P(13,115),new P(6,116)),new Q(28,new P(14,46),new P(23,47)),new Q(30,new P(44,24),new P(7,25)),new Q(30,new P(59,16),new P(1,17))),new Ne(35,Int32Array.from([6,30,54,78,102,126,150]),new Q(30,new P(12,121),new P(7,122)),new Q(28,new P(12,47),new P(26,48)),new Q(30,new P(39,24),new P(14,25)),new Q(30,new P(22,15),new P(41,16))),new Ne(36,Int32Array.from([6,24,50,76,102,128,154]),new Q(30,new P(6,121),new P(14,122)),new Q(28,new P(6,47),new P(34,48)),new Q(30,new P(46,24),new P(10,25)),new Q(30,new P(2,15),new P(64,16))),new Ne(37,Int32Array.from([6,28,54,80,106,132,158]),new Q(30,new P(17,122),new P(4,123)),new Q(28,new P(29,46),new P(14,47)),new Q(30,new P(49,24),new P(10,25)),new Q(30,new P(24,15),new P(46,16))),new Ne(38,Int32Array.from([6,32,58,84,110,136,162]),new Q(30,new P(4,122),new P(18,123)),new Q(28,new P(13,46),new P(32,47)),new Q(30,new P(48,24),new P(14,25)),new Q(30,new P(42,15),new P(32,16))),new Ne(39,Int32Array.from([6,26,54,82,110,138,166]),new Q(30,new P(20,117),new P(4,118)),new Q(28,new P(40,47),new P(7,48)),new Q(30,new P(43,24),new P(22,25)),new Q(30,new P(10,15),new P(67,16))),new Ne(40,Int32Array.from([6,30,58,86,114,142,170]),new Q(30,new P(19,118),new P(6,119)),new Q(28,new P(18,47),new P(31,48)),new Q(30,new P(34,24),new P(34,25)),new Q(30,new P(20,15),new P(61,16)))];var Yt;(function(T){T[T.DATA_MASK_000=0]="DATA_MASK_000",T[T.DATA_MASK_001=1]="DATA_MASK_001",T[T.DATA_MASK_010=2]="DATA_MASK_010",T[T.DATA_MASK_011=3]="DATA_MASK_011",T[T.DATA_MASK_100=4]="DATA_MASK_100",T[T.DATA_MASK_101=5]="DATA_MASK_101",T[T.DATA_MASK_110=6]="DATA_MASK_110",T[T.DATA_MASK_111=7]="DATA_MASK_111"})(Yt||(Yt={}));class Hn{constructor(r,s){this.value=r,this.isMasked=s}unmaskBitMatrix(r,s){for(let o=0;o<s;o++)for(let c=0;c<s;c++)this.isMasked(o,c)&&r.flip(c,o)}}Hn.values=new Map([[Yt.DATA_MASK_000,new Hn(Yt.DATA_MASK_000,(T,r)=>(T+r&1)===0)],[Yt.DATA_MASK_001,new Hn(Yt.DATA_MASK_001,(T,r)=>(T&1)===0)],[Yt.DATA_MASK_010,new Hn(Yt.DATA_MASK_010,(T,r)=>r%3===0)],[Yt.DATA_MASK_011,new Hn(Yt.DATA_MASK_011,(T,r)=>(T+r)%3===0)],[Yt.DATA_MASK_100,new Hn(Yt.DATA_MASK_100,(T,r)=>(Math.floor(T/2)+Math.floor(r/3)&1)===0)],[Yt.DATA_MASK_101,new Hn(Yt.DATA_MASK_101,(T,r)=>T*r%6===0)],[Yt.DATA_MASK_110,new Hn(Yt.DATA_MASK_110,(T,r)=>T*r%6<3)],[Yt.DATA_MASK_111,new Hn(Yt.DATA_MASK_111,(T,r)=>(T+r+T*r%3&1)===0)]]);class uw{constructor(r){const s=r.getHeight();if(s<21||(s&3)!==1)throw new U;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let u=0;u<6;u++)r=this.copyBit(u,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let u=5;u>=0;u--)r=this.copyBit(8,u,r);const s=this.bitMatrix.getHeight();let o=0;const c=s-7;for(let u=s-1;u>=c;u--)o=this.copyBit(8,u,o);for(let u=s-8;u<s;u++)o=this.copyBit(u,8,o);if(this.parsedFormatInfo=sn.decodeFormatInformation(r,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new U}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),s=Math.floor((r-17)/4);if(s<=6)return Ne.getVersionForNumber(s);let o=0;const c=r-11;for(let d=5;d>=0;d--)for(let h=r-9;h>=c;h--)o=this.copyBit(h,d,o);let u=Ne.decodeVersionInformation(o);if(u!==null&&u.getDimensionForVersion()===r)return this.parsedVersion=u,u;o=0;for(let d=5;d>=0;d--)for(let h=r-9;h>=c;h--)o=this.copyBit(d,h,o);if(u=Ne.decodeVersionInformation(o),u!==null&&u.getDimensionForVersion()===r)return this.parsedVersion=u,u;throw new U}copyBit(r,s,o){return(this.isMirror?this.bitMatrix.get(s,r):this.bitMatrix.get(r,s))?o<<1|1:o<<1}readCodewords(){const r=this.readFormatInformation(),s=this.readVersion(),o=Hn.values.get(r.getDataMask()),c=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,c);const u=s.buildFunctionPattern();let d=!0;const h=new Uint8Array(s.getTotalCodewords());let x=0,w=0,v=0;for(let I=c-1;I>0;I-=2){I===6&&I--;for(let D=0;D<c;D++){const L=d?c-1-D:D;for(let z=0;z<2;z++)u.get(I-z,L)||(v++,w<<=1,this.bitMatrix.get(I-z,L)&&(w|=1),v===8&&(h[x++]=w,v=0,w=0))}d=!d}if(x!==s.getTotalCodewords())throw new U;return h}remask(){if(this.parsedFormatInfo===null)return;const r=Hn.values[this.parsedFormatInfo.getDataMask()],s=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,s)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let s=0,o=r.getWidth();s<o;s++)for(let c=s+1,u=r.getHeight();c<u;c++)r.get(s,c)!==r.get(c,s)&&(r.flip(c,s),r.flip(s,c))}}class Jc{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s,o){if(r.length!==s.getTotalCodewords())throw new E;const c=s.getECBlocksForLevel(o);let u=0;const d=c.getECBlocks();for(const z of d)u+=z.getCount();const h=new Array(u);let x=0;for(const z of d)for(let H=0;H<z.getCount();H++){const Y=z.getDataCodewords(),$=c.getECCodewordsPerBlock()+Y;h[x++]=new Jc(Y,new Uint8Array($))}const w=h[0].codewords.length;let v=h.length-1;for(;v>=0&&h[v].codewords.length!==w;)v--;v++;const I=w-c.getECCodewordsPerBlock();let D=0;for(let z=0;z<I;z++)for(let H=0;H<x;H++)h[H].codewords[z]=r[D++];for(let z=v;z<x;z++)h[z].codewords[I]=r[D++];const L=h[0].codewords.length;for(let z=I;z<L;z++)for(let H=0;H<x;H++){const Y=H<v?z:z+1;h[H].codewords[Y]=r[D++]}return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Gn;(function(T){T[T.TERMINATOR=0]="TERMINATOR",T[T.NUMERIC=1]="NUMERIC",T[T.ALPHANUMERIC=2]="ALPHANUMERIC",T[T.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",T[T.BYTE=4]="BYTE",T[T.ECI=5]="ECI",T[T.KANJI=6]="KANJI",T[T.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",T[T.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",T[T.HANZI=9]="HANZI"})(Gn||(Gn={}));class Me{constructor(r,s,o,c){this.value=r,this.stringValue=s,this.characterCountBitsForVersions=o,this.bits=c,Me.FOR_BITS.set(c,this),Me.FOR_VALUE.set(r,this)}static forBits(r){const s=Me.FOR_BITS.get(r);if(s===void 0)throw new E;return s}getCharacterCountBits(r){const s=r.getVersionNumber();let o;return s<=9?o=0:s<=26?o=1:o=2,this.characterCountBitsForVersions[o]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Me))return!1;const s=r;return this.value===s.value}toString(){return this.stringValue}}Me.FOR_BITS=new Map,Me.FOR_VALUE=new Map,Me.TERMINATOR=new Me(Gn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Me.NUMERIC=new Me(Gn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Me.ALPHANUMERIC=new Me(Gn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Me.STRUCTURED_APPEND=new Me(Gn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Me.BYTE=new Me(Gn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Me.ECI=new Me(Gn.ECI,"ECI",Int32Array.from([0,0,0]),7),Me.KANJI=new Me(Gn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Me.FNC1_FIRST_POSITION=new Me(Gn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Me.FNC1_SECOND_POSITION=new Me(Gn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Me.HANZI=new Me(Gn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class vt{static decode(r,s,o,c){const u=new qc(r);let d=new de;const h=new Array;let x=-1,w=-1;try{let v=null,I=!1,D;do{if(u.available()<4)D=Me.TERMINATOR;else{const L=u.readBits(4);D=Me.forBits(L)}switch(D){case Me.TERMINATOR:break;case Me.FNC1_FIRST_POSITION:case Me.FNC1_SECOND_POSITION:I=!0;break;case Me.STRUCTURED_APPEND:if(u.available()<16)throw new U;x=u.readBits(8),w=u.readBits(8);break;case Me.ECI:const L=vt.parseECIValue(u);if(v=G.getCharacterSetECIByValue(L),v===null)throw new U;break;case Me.HANZI:const z=u.readBits(4),H=u.readBits(D.getCharacterCountBits(s));z===vt.GB2312_SUBSET&&vt.decodeHanziSegment(u,d,H);break;default:const Y=u.readBits(D.getCharacterCountBits(s));switch(D){case Me.NUMERIC:vt.decodeNumericSegment(u,d,Y);break;case Me.ALPHANUMERIC:vt.decodeAlphanumericSegment(u,d,Y,I);break;case Me.BYTE:vt.decodeByteSegment(u,d,Y,v,h,c);break;case Me.KANJI:vt.decodeKanjiSegment(u,d,Y);break;default:throw new U}break}}while(D!==Me.TERMINATOR)}catch{throw new U}return new Ut(r,d.toString(),h.length===0?null:h,o===null?null:o.toString(),x,w)}static decodeHanziSegment(r,s,o){if(o*13>r.available())throw new U;const c=new Uint8Array(2*o);let u=0;for(;o>0;){const d=r.readBits(13);let h=d/96<<8&4294967295|d%96;h<959?h+=41377:h+=42657,c[u]=h>>8&255,c[u+1]=h&255,u+=2,o--}try{s.append(me.decode(c,he.GB2312))}catch(d){throw new U(d)}}static decodeKanjiSegment(r,s,o){if(o*13>r.available())throw new U;const c=new Uint8Array(2*o);let u=0;for(;o>0;){const d=r.readBits(13);let h=d/192<<8&4294967295|d%192;h<7936?h+=33088:h+=49472,c[u]=h>>8,c[u+1]=h,u+=2,o--}try{s.append(me.decode(c,he.SHIFT_JIS))}catch(d){throw new U(d)}}static decodeByteSegment(r,s,o,c,u,d){if(8*o>r.available())throw new U;const h=new Uint8Array(o);for(let w=0;w<o;w++)h[w]=r.readBits(8);let x;c===null?x=he.guessEncoding(h,d):x=c.getName();try{s.append(me.decode(h,x))}catch(w){throw new U(w)}u.push(h)}static toAlphaNumericChar(r){if(r>=vt.ALPHANUMERIC_CHARS.length)throw new U;return vt.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,s,o,c){const u=s.length();for(;o>1;){if(r.available()<11)throw new U;const d=r.readBits(11);s.append(vt.toAlphaNumericChar(Math.floor(d/45))),s.append(vt.toAlphaNumericChar(d%45)),o-=2}if(o===1){if(r.available()<6)throw new U;s.append(vt.toAlphaNumericChar(r.readBits(6)))}if(c)for(let d=u;d<s.length();d++)s.charAt(d)==="%"&&(d<s.length()-1&&s.charAt(d+1)==="%"?s.deleteCharAt(d+1):s.setCharAt(d,String.fromCharCode(29)))}static decodeNumericSegment(r,s,o){for(;o>=3;){if(r.available()<10)throw new U;const c=r.readBits(10);if(c>=1e3)throw new U;s.append(vt.toAlphaNumericChar(Math.floor(c/100))),s.append(vt.toAlphaNumericChar(Math.floor(c/10)%10)),s.append(vt.toAlphaNumericChar(c%10)),o-=3}if(o===2){if(r.available()<7)throw new U;const c=r.readBits(7);if(c>=100)throw new U;s.append(vt.toAlphaNumericChar(Math.floor(c/10))),s.append(vt.toAlphaNumericChar(c%10))}else if(o===1){if(r.available()<4)throw new U;const c=r.readBits(4);if(c>=10)throw new U;s.append(vt.toAlphaNumericChar(c))}}static parseECIValue(r){const s=r.readBits(8);if(!(s&128))return s&127;if((s&192)===128){const o=r.readBits(8);return(s&63)<<8&4294967295|o}if((s&224)===192){const o=r.readBits(16);return(s&31)<<16&4294967295|o}throw new U}}vt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",vt.GB2312_SUBSET=1;class p0{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const s=r[0];r[0]=r[2],r[2]=s}}class dw{constructor(){this.rsDecoder=new Oe(K.QR_CODE_FIELD_256)}decodeBooleanArray(r,s){return this.decodeBitMatrix(pe.parseFromBooleanArray(r),s)}decodeBitMatrix(r,s){const o=new uw(r);let c=null;try{return this.decodeBitMatrixParser(o,s)}catch(u){c=u}try{o.remask(),o.setMirror(!0),o.readVersion(),o.readFormatInformation(),o.mirror();const u=this.decodeBitMatrixParser(o,s);return u.setOther(new p0(!0)),u}catch(u){throw c!==null?c:u}}decodeBitMatrixParser(r,s){const o=r.readVersion(),c=r.readFormatInformation().getErrorCorrectionLevel(),u=r.readCodewords(),d=Jc.getDataBlocks(u,o,c);let h=0;for(const v of d)h+=v.getNumDataCodewords();const x=new Uint8Array(h);let w=0;for(const v of d){const I=v.getCodewords(),D=v.getNumDataCodewords();this.correctErrors(I,D);for(let L=0;L<D;L++)x[w++]=I[L]}return vt.decode(x,o,c,s)}correctErrors(r,s){const o=new Int32Array(r);try{this.rsDecoder.decode(o,r.length-s)}catch{throw new M}for(let c=0;c<s;c++)r[c]=o[c]}}class eu extends xe{constructor(r,s,o){super(r,s),this.estimatedModuleSize=o}aboutEquals(r,s,o){if(Math.abs(s-this.getY())<=r&&Math.abs(o-this.getX())<=r){const c=Math.abs(r-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(r,s,o){const c=(this.getX()+s)/2,u=(this.getY()+r)/2,d=(this.estimatedModuleSize+o)/2;return new eu(c,u,d)}}class Va{constructor(r,s,o,c,u,d,h){this.image=r,this.startX=s,this.startY=o,this.width=c,this.height=u,this.moduleSize=d,this.resultPointCallback=h,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,s=this.height,o=this.width,c=r+o,u=this.startY+s/2,d=new Int32Array(3),h=this.image;for(let x=0;x<s;x++){const w=u+(x&1?-Math.floor((x+1)/2):Math.floor((x+1)/2));d[0]=0,d[1]=0,d[2]=0;let v=r;for(;v<c&&!h.get(v,w);)v++;let I=0;for(;v<c;){if(h.get(v,w))if(I===1)d[1]++;else if(I===2){if(this.foundPatternCross(d)){const D=this.handlePossibleCenter(d,w,v);if(D!==null)return D}d[0]=d[2],d[1]=1,d[2]=0,I=1}else d[++I]++;else I===1&&I++,d[I]++;v++}if(this.foundPatternCross(d)){const D=this.handlePossibleCenter(d,w,c);if(D!==null)return D}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new j}static centerFromEnd(r,s){return s-r[2]-r[1]/2}foundPatternCross(r){const s=this.moduleSize,o=s/2;for(let c=0;c<3;c++)if(Math.abs(s-r[c])>=o)return!1;return!0}crossCheckVertical(r,s,o,c){const u=this.image,d=u.getHeight(),h=this.crossCheckStateCount;h[0]=0,h[1]=0,h[2]=0;let x=r;for(;x>=0&&u.get(s,x)&&h[1]<=o;)h[1]++,x--;if(x<0||h[1]>o)return NaN;for(;x>=0&&!u.get(s,x)&&h[0]<=o;)h[0]++,x--;if(h[0]>o)return NaN;for(x=r+1;x<d&&u.get(s,x)&&h[1]<=o;)h[1]++,x++;if(x===d||h[1]>o)return NaN;for(;x<d&&!u.get(s,x)&&h[2]<=o;)h[2]++,x++;if(h[2]>o)return NaN;const w=h[0]+h[1]+h[2];return 5*Math.abs(w-c)>=2*c?NaN:this.foundPatternCross(h)?Va.centerFromEnd(h,x):NaN}handlePossibleCenter(r,s,o){const c=r[0]+r[1]+r[2],u=Va.centerFromEnd(r,o),d=this.crossCheckVertical(s,u,2*r[1],c);if(!isNaN(d)){const h=(r[0]+r[1]+r[2])/3;for(const w of this.possibleCenters)if(w.aboutEquals(h,d,u))return w.combineEstimate(d,u,h);const x=new eu(u,d,h);this.possibleCenters.push(x),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(x)}return null}}class tu extends xe{constructor(r,s,o,c){super(r,s),this.estimatedModuleSize=o,this.count=c,c===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,s,o){if(Math.abs(s-this.getY())<=r&&Math.abs(o-this.getX())<=r){const c=Math.abs(r-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(r,s,o){const c=this.count+1,u=(this.count*this.getX()+s)/c,d=(this.count*this.getY()+r)/c,h=(this.count*this.estimatedModuleSize+o)/c;return new tu(u,d,h,c)}}class fw{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Xt{constructor(r,s){this.image=r,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=s}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const s=r!=null&&r.get(W.TRY_HARDER)!==void 0,o=r!=null&&r.get(W.PURE_BARCODE)!==void 0,c=this.image,u=c.getHeight(),d=c.getWidth();let h=Math.floor(3*u/(4*Xt.MAX_MODULES));(h<Xt.MIN_SKIP||s)&&(h=Xt.MIN_SKIP);let x=!1;const w=new Int32Array(5);for(let I=h-1;I<u&&!x;I+=h){w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0;let D=0;for(let L=0;L<d;L++)if(c.get(L,I))(D&1)===1&&D++,w[D]++;else if(D&1)w[D]++;else if(D===4)if(Xt.foundPatternCross(w)){if(this.handlePossibleCenter(w,I,L,o)===!0)if(h=2,this.hasSkipped===!0)x=this.haveMultiplyConfirmedCenters();else{const H=this.findRowSkip();H>w[2]&&(I+=H-w[2]-h,L=d-1)}else{w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,D=3;continue}D=0,w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0}else w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,D=3;else w[++D]++;Xt.foundPatternCross(w)&&this.handlePossibleCenter(w,I,d,o)===!0&&(h=w[0],this.hasSkipped&&(x=this.haveMultiplyConfirmedCenters()))}const v=this.selectBestPatterns();return xe.orderBestPatterns(v),new fw(v)}static centerFromEnd(r,s){return s-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let s=0;for(let u=0;u<5;u++){const d=r[u];if(d===0)return!1;s+=d}if(s<7)return!1;const o=s/7,c=o/2;return Math.abs(o-r[0])<c&&Math.abs(o-r[1])<c&&Math.abs(3*o-r[2])<3*c&&Math.abs(o-r[3])<c&&Math.abs(o-r[4])<c}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,s,o,c){const u=this.getCrossCheckStateCount();let d=0;const h=this.image;for(;r>=d&&s>=d&&h.get(s-d,r-d);)u[2]++,d++;if(r<d||s<d)return!1;for(;r>=d&&s>=d&&!h.get(s-d,r-d)&&u[1]<=o;)u[1]++,d++;if(r<d||s<d||u[1]>o)return!1;for(;r>=d&&s>=d&&h.get(s-d,r-d)&&u[0]<=o;)u[0]++,d++;if(u[0]>o)return!1;const x=h.getHeight(),w=h.getWidth();for(d=1;r+d<x&&s+d<w&&h.get(s+d,r+d);)u[2]++,d++;if(r+d>=x||s+d>=w)return!1;for(;r+d<x&&s+d<w&&!h.get(s+d,r+d)&&u[3]<o;)u[3]++,d++;if(r+d>=x||s+d>=w||u[3]>=o)return!1;for(;r+d<x&&s+d<w&&h.get(s+d,r+d)&&u[4]<o;)u[4]++,d++;if(u[4]>=o)return!1;const v=u[0]+u[1]+u[2]+u[3]+u[4];return Math.abs(v-c)<2*c&&Xt.foundPatternCross(u)}crossCheckVertical(r,s,o,c){const u=this.image,d=u.getHeight(),h=this.getCrossCheckStateCount();let x=r;for(;x>=0&&u.get(s,x);)h[2]++,x--;if(x<0)return NaN;for(;x>=0&&!u.get(s,x)&&h[1]<=o;)h[1]++,x--;if(x<0||h[1]>o)return NaN;for(;x>=0&&u.get(s,x)&&h[0]<=o;)h[0]++,x--;if(h[0]>o)return NaN;for(x=r+1;x<d&&u.get(s,x);)h[2]++,x++;if(x===d)return NaN;for(;x<d&&!u.get(s,x)&&h[3]<o;)h[3]++,x++;if(x===d||h[3]>=o)return NaN;for(;x<d&&u.get(s,x)&&h[4]<o;)h[4]++,x++;if(h[4]>=o)return NaN;const w=h[0]+h[1]+h[2]+h[3]+h[4];return 5*Math.abs(w-c)>=2*c?NaN:Xt.foundPatternCross(h)?Xt.centerFromEnd(h,x):NaN}crossCheckHorizontal(r,s,o,c){const u=this.image,d=u.getWidth(),h=this.getCrossCheckStateCount();let x=r;for(;x>=0&&u.get(x,s);)h[2]++,x--;if(x<0)return NaN;for(;x>=0&&!u.get(x,s)&&h[1]<=o;)h[1]++,x--;if(x<0||h[1]>o)return NaN;for(;x>=0&&u.get(x,s)&&h[0]<=o;)h[0]++,x--;if(h[0]>o)return NaN;for(x=r+1;x<d&&u.get(x,s);)h[2]++,x++;if(x===d)return NaN;for(;x<d&&!u.get(x,s)&&h[3]<o;)h[3]++,x++;if(x===d||h[3]>=o)return NaN;for(;x<d&&u.get(x,s)&&h[4]<o;)h[4]++,x++;if(h[4]>=o)return NaN;const w=h[0]+h[1]+h[2]+h[3]+h[4];return 5*Math.abs(w-c)>=c?NaN:Xt.foundPatternCross(h)?Xt.centerFromEnd(h,x):NaN}handlePossibleCenter(r,s,o,c){const u=r[0]+r[1]+r[2]+r[3]+r[4];let d=Xt.centerFromEnd(r,o),h=this.crossCheckVertical(s,Math.floor(d),r[2],u);if(!isNaN(h)&&(d=this.crossCheckHorizontal(Math.floor(d),Math.floor(h),r[2],u),!isNaN(d)&&(!c||this.crossCheckDiagonal(Math.floor(h),Math.floor(d),r[2],u)))){const x=u/7;let w=!1;const v=this.possibleCenters;for(let I=0,D=v.length;I<D;I++){const L=v[I];if(L.aboutEquals(x,h,d)){v[I]=L.combineEstimate(h,d,x),w=!0;break}}if(!w){const I=new tu(d,h,x);v.push(I),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(I)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let s=null;for(const o of this.possibleCenters)if(o.getCount()>=Xt.CENTER_QUORUM)if(s==null)s=o;else return this.hasSkipped=!0,Math.floor((Math.abs(s.getX()-o.getX())-Math.abs(s.getY()-o.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,s=0;const o=this.possibleCenters.length;for(const d of this.possibleCenters)d.getCount()>=Xt.CENTER_QUORUM&&(r++,s+=d.getEstimatedModuleSize());if(r<3)return!1;const c=s/o;let u=0;for(const d of this.possibleCenters)u+=Math.abs(d.getEstimatedModuleSize()-c);return u<=.05*s}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new j;const s=this.possibleCenters;let o;if(r>3){let c=0,u=0;for(const x of this.possibleCenters){const w=x.getEstimatedModuleSize();c+=w,u+=w*w}o=c/r;let d=Math.sqrt(u/r-o*o);s.sort((x,w)=>{const v=Math.abs(w.getEstimatedModuleSize()-o),I=Math.abs(x.getEstimatedModuleSize()-o);return v<I?-1:v>I?1:0});const h=Math.max(.2*o,d);for(let x=0;x<s.length&&s.length>3;x++){const w=s[x];Math.abs(w.getEstimatedModuleSize()-o)>h&&(s.splice(x,1),x--)}}if(s.length>3){let c=0;for(const u of s)c+=u.getEstimatedModuleSize();o=c/s.length,s.sort((u,d)=>{if(d.getCount()===u.getCount()){const h=Math.abs(d.getEstimatedModuleSize()-o),x=Math.abs(u.getEstimatedModuleSize()-o);return h<x?1:h>x?-1:0}else return d.getCount()-u.getCount()}),s.splice(3)}return[s[0],s[1],s[2]]}}Xt.CENTER_QUORUM=2,Xt.MIN_SKIP=3,Xt.MAX_MODULES=57;class po{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(W.NEED_RESULT_POINT_CALLBACK);const o=new Xt(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(o)}processFinderPatternInfo(r){const s=r.getTopLeft(),o=r.getTopRight(),c=r.getBottomLeft(),u=this.calculateModuleSize(s,o,c);if(u<1)throw new j("No pattern found in proccess finder.");const d=po.computeDimension(s,o,c,u),h=Ne.getProvisionalVersionForDimension(d),x=h.getDimensionForVersion()-7;let w=null;if(h.getAlignmentPatternCenters().length>0){const L=o.getX()-s.getX()+c.getX(),z=o.getY()-s.getY()+c.getY(),H=1-3/x,Y=Math.floor(s.getX()+H*(L-s.getX())),$=Math.floor(s.getY()+H*(z-s.getY()));for(let ce=4;ce<=16;ce<<=1)try{w=this.findAlignmentInRegion(u,Y,$,ce);break}catch(ue){if(!(ue instanceof j))throw ue}}const v=po.createTransform(s,o,c,w,d),I=po.sampleGrid(this.image,v,d);let D;return w===null?D=[c,s,o]:D=[c,s,o,w],new Zt(I,D)}static createTransform(r,s,o,c,u){const d=u-3.5;let h,x,w,v;return c!==null?(h=c.getX(),x=c.getY(),w=d-3,v=w):(h=s.getX()-r.getX()+o.getX(),x=s.getY()-r.getY()+o.getY(),w=d,v=d),Ve.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,w,v,3.5,d,r.getX(),r.getY(),s.getX(),s.getY(),h,x,o.getX(),o.getY())}static sampleGrid(r,s,o){return tt.getInstance().sampleGridWithTransform(r,o,o,s)}static computeDimension(r,s,o,c){const u=Fe.round(xe.distance(r,s)/c),d=Fe.round(xe.distance(r,o)/c);let h=Math.floor((u+d)/2)+7;switch(h&3){case 0:h++;break;case 2:h--;break;case 3:throw new j("Dimensions could be not found.")}return h}calculateModuleSize(r,s,o){return(this.calculateModuleSizeOneWay(r,s)+this.calculateModuleSizeOneWay(r,o))/2}calculateModuleSizeOneWay(r,s){const o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(s.getX()),Math.floor(s.getY())),c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(o)?c/7:isNaN(c)?o/7:(o+c)/14}sizeOfBlackWhiteBlackRunBothWays(r,s,o,c){let u=this.sizeOfBlackWhiteBlackRun(r,s,o,c),d=1,h=r-(o-r);h<0?(d=r/(r-h),h=0):h>=this.image.getWidth()&&(d=(this.image.getWidth()-1-r)/(h-r),h=this.image.getWidth()-1);let x=Math.floor(s-(c-s)*d);return d=1,x<0?(d=s/(s-x),x=0):x>=this.image.getHeight()&&(d=(this.image.getHeight()-1-s)/(x-s),x=this.image.getHeight()-1),h=Math.floor(r+(h-r)*d),u+=this.sizeOfBlackWhiteBlackRun(r,s,h,x),u-1}sizeOfBlackWhiteBlackRun(r,s,o,c){const u=Math.abs(c-s)>Math.abs(o-r);if(u){let L=r;r=s,s=L,L=o,o=c,c=L}const d=Math.abs(o-r),h=Math.abs(c-s);let x=-d/2;const w=r<o?1:-1,v=s<c?1:-1;let I=0;const D=o+w;for(let L=r,z=s;L!==D;L+=w){const H=u?z:L,Y=u?L:z;if(I===1===this.image.get(H,Y)){if(I===2)return Fe.distance(L,z,r,s);I++}if(x+=h,x>0){if(z===c)break;z+=v,x-=d}}return I===2?Fe.distance(o+w,c,r,s):NaN}findAlignmentInRegion(r,s,o,c){const u=Math.floor(c*r),d=Math.max(0,s-u),h=Math.min(this.image.getWidth()-1,s+u);if(h-d<r*3)throw new j("Alignment top exceeds estimated module size.");const x=Math.max(0,o-u),w=Math.min(this.image.getHeight()-1,o+u);if(w-x<r*3)throw new j("Alignment bottom exceeds estimated module size.");return new Va(this.image,d,x,h-d,w-x,r,this.resultPointCallback).find()}}class ri{constructor(){this.decoder=new dw}getDecoder(){return this.decoder}decode(r,s){let o,c;if(s!=null&&s.get(W.PURE_BARCODE)!==void 0){const x=ri.extractPureBits(r.getBlackMatrix());o=this.decoder.decodeBitMatrix(x,s),c=ri.NO_POINTS}else{const x=new po(r.getBlackMatrix()).detect(s);o=this.decoder.decodeBitMatrix(x.getBits(),s),c=x.getPoints()}o.getOther()instanceof p0&&o.getOther().applyMirroredCorrection(c);const u=new Ze(o.getText(),o.getRawBytes(),void 0,c,ge.QR_CODE,void 0),d=o.getByteSegments();d!==null&&u.putMetadata(ct.BYTE_SEGMENTS,d);const h=o.getECLevel();return h!==null&&u.putMetadata(ct.ERROR_CORRECTION_LEVEL,h),o.hasStructuredAppend()&&(u.putMetadata(ct.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),u.putMetadata(ct.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),u}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),o=r.getBottomRightOnBit();if(s===null||o===null)throw new j;const c=this.moduleSize(s,r);let u=s[1],d=o[1],h=s[0],x=o[0];if(h>=x||u>=d)throw new j;if(d-u!==x-h&&(x=h+(d-u),x>=r.getWidth()))throw new j;const w=Math.round((x-h+1)/c),v=Math.round((d-u+1)/c);if(w<=0||v<=0)throw new j;if(v!==w)throw new j;const I=Math.floor(c/2);u+=I,h+=I;const D=h+Math.floor((w-1)*c)-x;if(D>0){if(D>I)throw new j;h-=D}const L=u+Math.floor((v-1)*c)-d;if(L>0){if(L>I)throw new j;u-=L}const z=new pe(w,v);for(let H=0;H<v;H++){const Y=u+Math.floor(H*c);for(let $=0;$<w;$++)r.get(h+Math.floor($*c),Y)&&z.set($,H)}return z}static moduleSize(r,s){const o=s.getHeight(),c=s.getWidth();let u=r[0],d=r[1],h=!0,x=0;for(;u<c&&d<o;){if(h!==s.get(u,d)){if(++x===5)break;h=!h}u++,d++}if(u===c||d===o)throw new j;return(u-r[0])/7}}ri.NO_POINTS=new Array;class ke{PDF417Common(){}static getBitCountSum(r){return Fe.sum(r)}static toIntArray(r){if(r==null||!r.length)return ke.EMPTY_INT_ARRAY;const s=new Int32Array(r.length);let o=0;for(const c of r)s[o++]=c;return s}static getCodeword(r){const s=b.binarySearch(ke.SYMBOL_TABLE,r&262143);return s<0?-1:(ke.CODEWORD_TABLE[s]-1)%ke.NUMBER_OF_CODEWORDS}}ke.NUMBER_OF_CODEWORDS=929,ke.MAX_CODEWORDS_IN_BARCODE=ke.NUMBER_OF_CODEWORDS-1,ke.MIN_ROWS_IN_BARCODE=3,ke.MAX_ROWS_IN_BARCODE=90,ke.MODULES_IN_CODEWORD=17,ke.MODULES_IN_STOP_PATTERN=18,ke.BARS_IN_MODULE=8,ke.EMPTY_INT_ARRAY=new Int32Array([]),ke.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ke.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class hw{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class We{static detectMultiple(r,s,o){let c=r.getBlackMatrix(),u=We.detect(o,c);return u.length||(c=c.clone(),c.rotate180(),u=We.detect(o,c)),new hw(c,u)}static detect(r,s){const o=new Array;let c=0,u=0,d=!1;for(;c<s.getHeight();){const h=We.findVertices(s,c,u);if(h[0]==null&&h[3]==null){if(!d)break;d=!1,u=0;for(const x of o)x[1]!=null&&(c=Math.trunc(Math.max(c,x[1].getY()))),x[3]!=null&&(c=Math.max(c,Math.trunc(x[3].getY())));c+=We.ROW_STEP;continue}if(d=!0,o.push(h),!r)break;h[2]!=null?(u=Math.trunc(h[2].getX()),c=Math.trunc(h[2].getY())):(u=Math.trunc(h[4].getX()),c=Math.trunc(h[4].getY()))}return o}static findVertices(r,s,o){const c=r.getHeight(),u=r.getWidth(),d=new Array(8);return We.copyToResult(d,We.findRowsWithPattern(r,c,u,s,o,We.START_PATTERN),We.INDEXES_START_PATTERN),d[4]!=null&&(o=Math.trunc(d[4].getX()),s=Math.trunc(d[4].getY())),We.copyToResult(d,We.findRowsWithPattern(r,c,u,s,o,We.STOP_PATTERN),We.INDEXES_STOP_PATTERN),d}static copyToResult(r,s,o){for(let c=0;c<o.length;c++)r[o[c]]=s[c]}static findRowsWithPattern(r,s,o,c,u,d){const h=new Array(4);let x=!1;const w=new Int32Array(d.length);for(;c<s;c+=We.ROW_STEP){let I=We.findGuardPattern(r,u,c,o,!1,d,w);if(I!=null){for(;c>0;){const D=We.findGuardPattern(r,u,--c,o,!1,d,w);if(D!=null)I=D;else{c++;break}}h[0]=new xe(I[0],c),h[1]=new xe(I[1],c),x=!0;break}}let v=c+1;if(x){let I=0,D=Int32Array.from([Math.trunc(h[0].getX()),Math.trunc(h[1].getX())]);for(;v<s;v++){const L=We.findGuardPattern(r,D[0],v,o,!1,d,w);if(L!=null&&Math.abs(D[0]-L[0])<We.MAX_PATTERN_DRIFT&&Math.abs(D[1]-L[1])<We.MAX_PATTERN_DRIFT)D=L,I=0;else{if(I>We.SKIPPED_ROW_COUNT_MAX)break;I++}}v-=I+1,h[2]=new xe(D[0],v),h[3]=new xe(D[1],v)}return v-c<We.BARCODE_MIN_HEIGHT&&b.fill(h,null),h}static findGuardPattern(r,s,o,c,u,d,h){b.fillWithin(h,0,h.length,0);let x=s,w=0;for(;r.get(x,o)&&x>0&&w++<We.MAX_PIXEL_DRIFT;)x--;let v=x,I=0,D=d.length;for(let L=u;v<c;v++)if(r.get(v,o)!==L)h[I]++;else{if(I===D-1){if(We.patternMatchVariance(h,d,We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE)return new Int32Array([x,v]);x+=h[0]+h[1],k.arraycopy(h,2,h,0,I-1),h[I-1]=0,h[I]=0,I--}else I++;h[I]=1,L=!L}return I===D-1&&We.patternMatchVariance(h,d,We.MAX_INDIVIDUAL_VARIANCE)<We.MAX_AVG_VARIANCE?new Int32Array([x,v-1]):null}static patternMatchVariance(r,s,o){let c=r.length,u=0,d=0;for(let w=0;w<c;w++)u+=r[w],d+=s[w];if(u<d)return 1/0;let h=u/d;o*=h;let x=0;for(let w=0;w<c;w++){let v=r[w],I=s[w]*h,D=v>I?v-I:I-v;if(D>o)return 1/0;x+=D}return x/u}}We.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),We.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),We.MAX_AVG_VARIANCE=.42,We.MAX_INDIVIDUAL_VARIANCE=.8,We.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),We.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),We.MAX_PIXEL_DRIFT=3,We.MAX_PATTERN_DRIFT=5,We.SKIPPED_ROW_COUNT_MAX=25,We.ROW_STEP=5,We.BARCODE_MIN_HEIGHT=10;class $t{constructor(r,s){if(s.length===0)throw new E;this.field=r;let o=s.length;if(o>1&&s[0]===0){let c=1;for(;c<o&&s[c]===0;)c++;c===o?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(o-c),k.arraycopy(s,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let c=0;for(let u of this.coefficients)c=this.field.add(c,u);return c}let s=this.coefficients[0],o=this.coefficients.length;for(let c=1;c<o;c++)s=this.field.add(this.field.multiply(r,s),this.coefficients[c]);return s}add(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,o=r.coefficients;if(s.length>o.length){let d=s;s=o,o=d}let c=new Int32Array(o.length),u=o.length-s.length;k.arraycopy(o,0,c,0,u);for(let d=u;d<o.length;d++)c[d]=this.field.add(s[d-u],o[d]);return new $t(this.field,c)}subtract(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof $t?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new $t(this.field,new Int32Array([0]));let s=this.coefficients,o=s.length,c=r.coefficients,u=c.length,d=new Int32Array(o+u-1);for(let h=0;h<o;h++){let x=s[h];for(let w=0;w<u;w++)d[h+w]=this.field.add(d[h+w],this.field.multiply(x,c[w]))}return new $t(this.field,d)}negative(){let r=this.coefficients.length,s=new Int32Array(r);for(let o=0;o<r;o++)s[o]=this.field.subtract(0,this.coefficients[o]);return new $t(this.field,s)}multiplyScalar(r){if(r===0)return new $t(this.field,new Int32Array([0]));if(r===1)return this;let s=this.coefficients.length,o=new Int32Array(s);for(let c=0;c<s;c++)o[c]=this.field.multiply(this.coefficients[c],r);return new $t(this.field,o)}multiplyByMonomial(r,s){if(r<0)throw new E;if(s===0)return new $t(this.field,new Int32Array([0]));let o=this.coefficients.length,c=new Int32Array(o+r);for(let u=0;u<o;u++)c[u]=this.field.multiply(this.coefficients[u],s);return new $t(this.field,c)}toString(){let r=new de;for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);o!==0&&(o<0?(r.append(" - "),o=-o):r.length()>0&&r.append(" + "),(s===0||o!==1)&&r.append(o),s!==0&&(s===1?r.append("x"):(r.append("x^"),r.append(s))))}return r.toString()}}class gw{add(r,s){return(r+s)%this.modulus}subtract(r,s){return(this.modulus+r-s)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new E;return this.logTable[r]}inverse(r){if(r===0)throw new Ge;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class nu extends gw{constructor(r,s){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let o=1;for(let c=0;c<r;c++)this.expTable[c]=o,o=o*s%r;for(let c=0;c<r-1;c++)this.logTable[this.expTable[c]]=c;this.zero=new $t(this,new Int32Array([0])),this.one=new $t(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new E;if(s===0)return this.zero;let o=new Int32Array(r+1);return o[0]=s,new $t(this,o)}}nu.PDF417_GF=new nu(ke.NUMBER_OF_CODEWORDS,3);class m0{constructor(){this.field=nu.PDF417_GF}decode(r,s,o){let c=new $t(this.field,r),u=new Int32Array(s),d=!1;for(let z=s;z>0;z--){let H=c.evaluateAt(this.field.exp(z));u[s-z]=H,H!==0&&(d=!0)}if(!d)return 0;let h=this.field.getOne();if(o!=null)for(const z of o){let H=this.field.exp(r.length-1-z),Y=new $t(this.field,new Int32Array([this.field.subtract(0,H),1]));h=h.multiply(Y)}let x=new $t(this.field,u),w=this.runEuclideanAlgorithm(this.field.buildMonomial(s,1),x,s),v=w[0],I=w[1],D=this.findErrorLocations(v),L=this.findErrorMagnitudes(I,v,D);for(let z=0;z<D.length;z++){let H=r.length-1-this.field.log(D[z]);if(H<0)throw M.getChecksumInstance();r[H]=this.field.subtract(r[H],L[z])}return D.length}runEuclideanAlgorithm(r,s,o){if(r.getDegree()<s.getDegree()){let D=r;r=s,s=D}let c=r,u=s,d=this.field.getZero(),h=this.field.getOne();for(;u.getDegree()>=Math.round(o/2);){let D=c,L=d;if(c=u,d=h,c.isZero())throw M.getChecksumInstance();u=D;let z=this.field.getZero(),H=c.getCoefficient(c.getDegree()),Y=this.field.inverse(H);for(;u.getDegree()>=c.getDegree()&&!u.isZero();){let $=u.getDegree()-c.getDegree(),ce=this.field.multiply(u.getCoefficient(u.getDegree()),Y);z=z.add(this.field.buildMonomial($,ce)),u=u.subtract(c.multiplyByMonomial($,ce))}h=z.multiply(d).subtract(L).negative()}let x=h.getCoefficient(0);if(x===0)throw M.getChecksumInstance();let w=this.field.inverse(x),v=h.multiply(w),I=u.multiply(w);return[v,I]}findErrorLocations(r){let s=r.getDegree(),o=new Int32Array(s),c=0;for(let u=1;u<this.field.getSize()&&c<s;u++)r.evaluateAt(u)===0&&(o[c]=this.field.inverse(u),c++);if(c!==s)throw M.getChecksumInstance();return o}findErrorMagnitudes(r,s,o){let c=s.getDegree(),u=new Int32Array(c);for(let w=1;w<=c;w++)u[c-w]=this.field.multiply(w,s.getCoefficient(w));let d=new $t(this.field,u),h=o.length,x=new Int32Array(h);for(let w=0;w<h;w++){let v=this.field.inverse(o[w]),I=this.field.subtract(0,r.evaluateAt(v)),D=this.field.inverse(d.evaluateAt(v));x[w]=this.field.multiply(I,D)}return x}}class Fi{constructor(r,s,o,c,u){r instanceof Fi?this.constructor_2(r):this.constructor_1(r,s,o,c,u)}constructor_1(r,s,o,c,u){const d=s==null||o==null,h=c==null||u==null;if(d&&h)throw new j;d?(s=new xe(0,c.getY()),o=new xe(0,u.getY())):h&&(c=new xe(r.getWidth()-1,s.getY()),u=new xe(r.getWidth()-1,o.getY())),this.image=r,this.topLeft=s,this.bottomLeft=o,this.topRight=c,this.bottomRight=u,this.minX=Math.trunc(Math.min(s.getX(),o.getX())),this.maxX=Math.trunc(Math.max(c.getX(),u.getX())),this.minY=Math.trunc(Math.min(s.getY(),c.getY())),this.maxY=Math.trunc(Math.max(o.getY(),u.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,s){return r==null?s:s==null?r:new Fi(r.image,r.topLeft,r.bottomLeft,s.topRight,s.bottomRight)}addMissingRows(r,s,o){let c=this.topLeft,u=this.bottomLeft,d=this.topRight,h=this.bottomRight;if(r>0){let x=o?this.topLeft:this.topRight,w=Math.trunc(x.getY()-r);w<0&&(w=0);let v=new xe(x.getX(),w);o?c=v:d=v}if(s>0){let x=o?this.bottomLeft:this.bottomRight,w=Math.trunc(x.getY()+s);w>=this.image.getHeight()&&(w=this.image.getHeight()-1);let v=new xe(x.getX(),w);o?u=v:h=v}return new Fi(this.image,c,u,d,h)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class pw{constructor(r,s,o,c){this.columnCount=r,this.errorCorrectionLevel=c,this.rowCountUpperPart=s,this.rowCountLowerPart=o,this.rowCount=s+o}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class mo{constructor(){this.buffer=""}static form(r,s){let o=-1;function c(d,h,x,w,v,I){if(d==="%%")return"%";if(s[++o]===void 0)return;d=w?parseInt(w.substr(1)):void 0;let D=v?parseInt(v.substr(1)):void 0,L;switch(I){case"s":L=s[o];break;case"c":L=s[o][0];break;case"f":L=parseFloat(s[o]).toFixed(d);break;case"p":L=parseFloat(s[o]).toPrecision(d);break;case"e":L=parseFloat(s[o]).toExponential(d);break;case"x":L=parseInt(s[o]).toString(D||16);break;case"d":L=parseFloat(parseInt(s[o],D||10).toPrecision(d)).toFixed(0);break}L=typeof L=="object"?JSON.stringify(L):(+L).toString(D);let z=parseInt(x),H=x&&x[0]+""=="0"?"0":" ";for(;L.length<z;)L=h!==void 0?L+H:H+L;return L}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(u,c)}format(r,...s){this.buffer+=mo.form(r,s)}toString(){return this.buffer}}class xo{constructor(r){this.boundingBox=new Fi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let s=this.getCodeword(r);if(s!=null)return s;for(let o=1;o<xo.MAX_NEARBY_DISTANCE;o++){let c=this.imageRowToCodewordIndex(r)-o;if(c>=0&&(s=this.codewords[c],s!=null)||(c=this.imageRowToCodewordIndex(r)+o,c<this.codewords.length&&(s=this.codewords[c],s!=null)))return s}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,s){this.codewords[this.imageRowToCodewordIndex(r)]=s}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new mo;let s=0;for(const o of this.codewords){if(o==null){r.format("%3d:    |   %n",s++);continue}r.format("%3d: %3d|%3d%n",s++,o.getRowNumber(),o.getValue())}return r.toString()}}xo.MAX_NEARBY_DISTANCE=5;class yo{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let s=this.values.get(r);s==null&&(s=0),s++,this.values.set(r,s)}getValue(){let r=-1,s=new Array;for(const[o,c]of this.values.entries()){const u={getKey:()=>o,getValue:()=>c};u.getValue()>r?(r=u.getValue(),s=[],s.push(u.getKey())):u.getValue()===r&&s.push(u.getKey())}return ke.toIntArray(s)}getConfidence(r){return this.values.get(r)}}class x0 extends xo{constructor(r,s){super(r),this._isLeft=s}setRowNumbers(){for(let r of this.getCodewords())r!=null&&r.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let s=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(s,r);let o=this.getBoundingBox(),c=this._isLeft?o.getTopLeft():o.getTopRight(),u=this._isLeft?o.getBottomLeft():o.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),h=this.imageRowToCodewordIndex(Math.trunc(u.getY())),x=-1,w=1,v=0;for(let I=d;I<h;I++){if(s[I]==null)continue;let D=s[I],L=D.getRowNumber()-x;if(L===0)v++;else if(L===1)w=Math.max(w,v),v=1,x=D.getRowNumber();else if(L<0||D.getRowNumber()>=r.getRowCount()||L>I)s[I]=null;else{let z;w>2?z=(w-2)*L:z=L;let H=z>=I;for(let Y=1;Y<=z&&!H;Y++)H=s[I-Y]!=null;H?s[I]=null:(x=D.getRowNumber(),v=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let s=new Int32Array(r.getRowCount());for(let o of this.getCodewords())if(o!=null){let c=o.getRowNumber();if(c>=s.length)continue;s[c]++}return s}adjustIncompleteIndicatorColumnRowNumbers(r){let s=this.getBoundingBox(),o=this._isLeft?s.getTopLeft():s.getTopRight(),c=this._isLeft?s.getBottomLeft():s.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),h=this.getCodewords(),x=-1;for(let w=u;w<d;w++){if(h[w]==null)continue;let v=h[w];v.setRowNumberAsRowIndicatorColumn();let I=v.getRowNumber()-x;I===0||(I===1?x=v.getRowNumber():v.getRowNumber()>=r.getRowCount()?h[w]=null:x=v.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),s=new yo,o=new yo,c=new yo,u=new yo;for(let h of r){if(h==null)continue;h.setRowNumberAsRowIndicatorColumn();let x=h.getValue()%30,w=h.getRowNumber();switch(this._isLeft||(w+=2),w%3){case 0:o.setValue(x*3+1);break;case 1:u.setValue(x/3),c.setValue(x%3);break;case 2:s.setValue(x+1);break}}if(s.getValue().length===0||o.getValue().length===0||c.getValue().length===0||u.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+c.getValue()[0]<ke.MIN_ROWS_IN_BARCODE||o.getValue()[0]+c.getValue()[0]>ke.MAX_ROWS_IN_BARCODE)return null;let d=new pw(s.getValue()[0],o.getValue()[0],c.getValue()[0],u.getValue()[0]);return this.removeIncorrectCodewords(r,d),d}removeIncorrectCodewords(r,s){for(let o=0;o<r.length;o++){let c=r[o];if(r[o]==null)continue;let u=c.getValue()%30,d=c.getRowNumber();if(d>s.getRowCount()){r[o]=null;continue}switch(this._isLeft||(d+=2),d%3){case 0:u*3+1!==s.getRowCountUpperPart()&&(r[o]=null);break;case 1:(Math.trunc(u/3)!==s.getErrorCorrectionLevel()||u%3!==s.getRowCountLowerPart())&&(r[o]=null);break;case 2:u+1!==s.getColumnCount()&&(r[o]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class wo{constructor(r,s){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=s,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=ke.MAX_CODEWORDS_IN_BARCODE,s;do s=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<s);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r!=null&&r.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let s=1;s<this.barcodeColumnCount+1;s++){let o=this.detectionResultColumns[s].getCodewords();for(let c=0;c<o.length;c++)o[c]!=null&&(o[c].hasValidRowNumber()||this.adjustRowNumbers(s,c,o))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<r.length;o++)if(r[o]!=null&&s[o]!=null&&r[o].getRowNumber()===s[o].getRowNumber())for(let c=1;c<=this.barcodeColumnCount;c++){let u=this.detectionResultColumns[c].getCodewords()[o];u!=null&&(u.setRowNumber(r[o].getRowNumber()),u.hasValidRowNumber()||(this.detectionResultColumns[c].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let c=s[o].getRowNumber(),u=0;for(let d=this.barcodeColumnCount+1;d>0&&u<this.ADJUST_ROW_NUMBER_SKIP;d--){let h=this.detectionResultColumns[d].getCodewords()[o];h!=null&&(u=wo.adjustRowNumberIfValid(c,u,h),h.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,s=this.detectionResultColumns[0].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let c=s[o].getRowNumber(),u=0;for(let d=1;d<this.barcodeColumnCount+1&&u<this.ADJUST_ROW_NUMBER_SKIP;d++){let h=this.detectionResultColumns[d].getCodewords()[o];h!=null&&(u=wo.adjustRowNumberIfValid(c,u,h),h.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,s,o){return o==null||o.hasValidRowNumber()||(o.isValidRowNumber(r)?(o.setRowNumber(r),s=0):++s),s}adjustRowNumbers(r,s,o){if(!this.detectionResultColumns[r-1])return;let c=o[s],u=this.detectionResultColumns[r-1].getCodewords(),d=u;this.detectionResultColumns[r+1]!=null&&(d=this.detectionResultColumns[r+1].getCodewords());let h=new Array(14);h[2]=u[s],h[3]=d[s],s>0&&(h[0]=o[s-1],h[4]=u[s-1],h[5]=d[s-1]),s>1&&(h[8]=o[s-2],h[10]=u[s-2],h[11]=d[s-2]),s<o.length-1&&(h[1]=o[s+1],h[6]=u[s+1],h[7]=d[s+1]),s<o.length-2&&(h[9]=o[s+2],h[12]=u[s+2],h[13]=d[s+2]);for(let x of h)if(wo.adjustRowNumber(c,x))return}static adjustRowNumber(r,s){return s==null?!1:s.hasValidRowNumber()&&s.getBucket()===r.getBucket()?(r.setRowNumber(s.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,s){this.detectionResultColumns[r]=s}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let s=new mo;for(let o=0;o<r.getCodewords().length;o++){s.format("CW %3d:",o);for(let c=0;c<this.barcodeColumnCount+2;c++){if(this.detectionResultColumns[c]==null){s.format("    |   ");continue}let u=this.detectionResultColumns[c].getCodewords()[o];if(u==null){s.format("    |   ");continue}s.format(" %3d|%3d",u.getRowNumber(),u.getValue())}s.format("%n")}return s.toString()}}class Co{constructor(r,s,o,c){this.rowNumber=Co.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(s),this.bucket=Math.trunc(o),this.value=Math.trunc(c)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Co.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Co.BARCODE_ROW_UNKNOWN=-1;class En{static initialize(){for(let r=0;r<ke.SYMBOL_TABLE.length;r++){let s=ke.SYMBOL_TABLE[r],o=s&1;for(let c=0;c<ke.BARS_IN_MODULE;c++){let u=0;for(;(s&1)===o;)u+=1,s>>=1;o=s&1,En.RATIOS_TABLE[r]||(En.RATIOS_TABLE[r]=new Array(ke.BARS_IN_MODULE)),En.RATIOS_TABLE[r][ke.BARS_IN_MODULE-c-1]=Math.fround(u/ke.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let s=En.getDecodedCodewordValue(En.sampleBitCounts(r));return s!==-1?s:En.getClosestDecodedValue(r)}static sampleBitCounts(r){let s=Fe.sum(r),o=new Int32Array(ke.BARS_IN_MODULE),c=0,u=0;for(let d=0;d<ke.MODULES_IN_CODEWORD;d++){let h=s/(2*ke.MODULES_IN_CODEWORD)+d*s/ke.MODULES_IN_CODEWORD;u+r[c]<=h&&(u+=r[c],c++),o[c]++}return o}static getDecodedCodewordValue(r){let s=En.getBitValue(r);return ke.getCodeword(s)===-1?-1:s}static getBitValue(r){let s=0;for(let o=0;o<r.length;o++)for(let c=0;c<r[o];c++)s=s<<1|(o%2===0?1:0);return Math.trunc(s)}static getClosestDecodedValue(r){let s=Fe.sum(r),o=new Array(ke.BARS_IN_MODULE);if(s>1)for(let d=0;d<o.length;d++)o[d]=Math.fround(r[d]/s);let c=kt.MAX_VALUE,u=-1;this.bSymbolTableReady||En.initialize();for(let d=0;d<En.RATIOS_TABLE.length;d++){let h=0,x=En.RATIOS_TABLE[d];for(let w=0;w<ke.BARS_IN_MODULE;w++){let v=Math.fround(x[w]-o[w]);if(h+=Math.fround(v*v),h>=c)break}h<c&&(c=h,u=ke.SYMBOL_TABLE[d])}return u}}En.bSymbolTableReady=!1,En.RATIOS_TABLE=new Array(ke.SYMBOL_TABLE.length).map(T=>new Array(ke.BARS_IN_MODULE));class y0{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class w0{static parseLong(r,s=void 0){return parseInt(r,s)}}class C0 extends m{}C0.kind="NullPointerException";class mw{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,s,o){if(r==null)throw new C0;if(s<0||s>r.length||o<0||s+o>r.length||s+o<0)throw new V;if(o===0)return;for(let c=0;c<o;c++)this.write(r[s+c])}flush(){}close(){}}class xw extends m{}class yw extends mw{constructor(r=32){if(super(),this.count=0,r<0)throw new E("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let o=this.buf.length<<1;if(o-r<0&&(o=r),o<0){if(r<0)throw new xw;o=S.MAX_VALUE}this.buf=b.copyOfUint8Array(this.buf,o)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,s,o){if(s<0||s>r.length||o<0||s+o-r.length>0)throw new V;this.ensureCapacity(this.count+o),k.arraycopy(r,s,this.buf,this.count,o),this.count+=o}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return b.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var ut;(function(T){T[T.ALPHA=0]="ALPHA",T[T.LOWER=1]="LOWER",T[T.MIXED=2]="MIXED",T[T.PUNCT=3]="PUNCT",T[T.ALPHA_SHIFT=4]="ALPHA_SHIFT",T[T.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(ut||(ut={}));function E0(){if(typeof window<"u")return window.BigInt||null;if(typeof So<"u")return So.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let za;function ii(T){if(typeof za>"u"&&(za=E0()),za===null)throw new Error("BigInt is not supported!");return za(T)}function ww(){let T=[];T[0]=ii(1);let r=ii(900);T[1]=r;for(let s=2;s<16;s++)T[s]=T[s-1]*r;return T}class Z{static decode(r,s){let o=new de(""),c=G.ISO8859_1;o.enableDecoding(c);let u=1,d=r[u++],h=new y0;for(;u<r[0];){switch(d){case Z.TEXT_COMPACTION_MODE_LATCH:u=Z.textCompaction(r,u,o);break;case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:u=Z.byteCompaction(d,r,c,u,o);break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(r[u++]);break;case Z.NUMERIC_COMPACTION_MODE_LATCH:u=Z.numericCompaction(r,u,o);break;case Z.ECI_CHARSET:G.getCharacterSetECIByValue(r[u++]);break;case Z.ECI_GENERAL_PURPOSE:u+=2;break;case Z.ECI_USER_DEFINED:u++;break;case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:u=Z.decodeMacroBlock(r,u,h);break;case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:throw new U;default:u--,u=Z.textCompaction(r,u,o);break}if(u<r.length)d=r[u++];else throw U.getFormatInstance()}if(o.length()===0)throw U.getFormatInstance();let x=new Ut(null,o.toString(),null,s);return x.setOther(h),x}static decodeMacroBlock(r,s,o){if(s+Z.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw U.getFormatInstance();let c=new Int32Array(Z.NUMBER_OF_SEQUENCE_CODEWORDS);for(let h=0;h<Z.NUMBER_OF_SEQUENCE_CODEWORDS;h++,s++)c[h]=r[s];o.setSegmentIndex(S.parseInt(Z.decodeBase900toBase10(c,Z.NUMBER_OF_SEQUENCE_CODEWORDS)));let u=new de;s=Z.textCompaction(r,s,u),o.setFileId(u.toString());let d=-1;for(r[s]===Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(d=s+1);s<r[0];)switch(r[s]){case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(s++,r[s]){case Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let h=new de;s=Z.textCompaction(r,s+1,h),o.setFileName(h.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let x=new de;s=Z.textCompaction(r,s+1,x),o.setSender(x.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let w=new de;s=Z.textCompaction(r,s+1,w),o.setAddressee(w.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let v=new de;s=Z.numericCompaction(r,s+1,v),o.setSegmentCount(S.parseInt(v.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let I=new de;s=Z.numericCompaction(r,s+1,I),o.setTimestamp(w0.parseLong(I.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let D=new de;s=Z.numericCompaction(r,s+1,D),o.setChecksum(S.parseInt(D.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let L=new de;s=Z.numericCompaction(r,s+1,L),o.setFileSize(w0.parseLong(L.toString()));break;default:throw U.getFormatInstance()}break;case Z.MACRO_PDF417_TERMINATOR:s++,o.setLastSegment(!0);break;default:throw U.getFormatInstance()}if(d!==-1){let h=s-d;o.isLastSegment()&&h--,o.setOptionalData(b.copyOfRange(r,d,d+h))}return s}static textCompaction(r,s,o){let c=new Int32Array((r[0]-s)*2),u=new Int32Array((r[0]-s)*2),d=0,h=!1;for(;s<r[0]&&!h;){let x=r[s++];if(x<Z.TEXT_COMPACTION_MODE_LATCH)c[d]=x/30,c[d+1]=x%30,d+=2;else switch(x){case Z.TEXT_COMPACTION_MODE_LATCH:c[d++]=Z.TEXT_COMPACTION_MODE_LATCH;break;case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:s--,h=!0;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c[d]=Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,x=r[s++],u[d]=x,d++;break}}return Z.decodeTextCompaction(c,u,d,o),s}static decodeTextCompaction(r,s,o,c){let u=ut.ALPHA,d=ut.ALPHA,h=0;for(;h<o;){let x=r[h],w="";switch(u){case ut.ALPHA:if(x<26)w=String.fromCharCode(65+x);else switch(x){case 26:w=" ";break;case Z.LL:u=ut.LOWER;break;case Z.ML:u=ut.MIXED;break;case Z.PS:d=u,u=ut.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[h]);break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break;case ut.LOWER:if(x<26)w=String.fromCharCode(97+x);else switch(x){case 26:w=" ";break;case Z.AS:d=u,u=ut.ALPHA_SHIFT;break;case Z.ML:u=ut.MIXED;break;case Z.PS:d=u,u=ut.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[h]);break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break;case ut.MIXED:if(x<Z.PL)w=Z.MIXED_CHARS[x];else switch(x){case Z.PL:u=ut.PUNCT;break;case 26:w=" ";break;case Z.LL:u=ut.LOWER;break;case Z.AL:u=ut.ALPHA;break;case Z.PS:d=u,u=ut.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[h]);break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break;case ut.PUNCT:if(x<Z.PAL)w=Z.PUNCT_CHARS[x];else switch(x){case Z.PAL:u=ut.ALPHA;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[h]);break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break;case ut.ALPHA_SHIFT:if(u=d,x<26)w=String.fromCharCode(65+x);else switch(x){case 26:w=" ";break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break;case ut.PUNCT_SHIFT:if(u=d,x<Z.PAL)w=Z.PUNCT_CHARS[x];else switch(x){case Z.PAL:u=ut.ALPHA;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[h]);break;case Z.TEXT_COMPACTION_MODE_LATCH:u=ut.ALPHA;break}break}w!==""&&c.append(w),h++}}static byteCompaction(r,s,o,c,u){let d=new yw,h=0,x=0,w=!1;switch(r){case Z.BYTE_COMPACTION_MODE_LATCH:let v=new Int32Array(6),I=s[c++];for(;c<s[0]&&!w;)switch(v[h++]=I,x=900*x+I,I=s[c++],I){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:c--,w=!0;break;default:if(h%5===0&&h>0){for(let D=0;D<6;++D)d.write(Number(ii(x)>>ii(8*(5-D))));x=0,h=0}break}c===s[0]&&I<Z.TEXT_COMPACTION_MODE_LATCH&&(v[h++]=I);for(let D=0;D<h;D++)d.write(v[D]);break;case Z.BYTE_COMPACTION_MODE_LATCH_6:for(;c<s[0]&&!w;){let D=s[c++];if(D<Z.TEXT_COMPACTION_MODE_LATCH)h++,x=900*x+D;else switch(D){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:c--,w=!0;break}if(h%5===0&&h>0){for(let L=0;L<6;++L)d.write(Number(ii(x)>>ii(8*(5-L))));x=0,h=0}}break}return u.append(me.decode(d.toByteArray(),o)),c}static numericCompaction(r,s,o){let c=0,u=!1,d=new Int32Array(Z.MAX_NUMERIC_CODEWORDS);for(;s<r[0]&&!u;){let h=r[s++];if(s===r[0]&&(u=!0),h<Z.TEXT_COMPACTION_MODE_LATCH)d[c]=h,c++;else switch(h){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:s--,u=!0;break}(c%Z.MAX_NUMERIC_CODEWORDS===0||h===Z.NUMERIC_COMPACTION_MODE_LATCH||u)&&c>0&&(o.append(Z.decodeBase900toBase10(d,c)),c=0)}return s}static decodeBase900toBase10(r,s){let o=ii(0);for(let u=0;u<s;u++)o+=Z.EXP900[s-u-1]*ii(r[u]);let c=o.toString();if(c.charAt(0)!=="1")throw new U;return c.substring(1)}}Z.TEXT_COMPACTION_MODE_LATCH=900,Z.BYTE_COMPACTION_MODE_LATCH=901,Z.NUMERIC_COMPACTION_MODE_LATCH=902,Z.BYTE_COMPACTION_MODE_LATCH_6=924,Z.ECI_USER_DEFINED=925,Z.ECI_GENERAL_PURPOSE=926,Z.ECI_CHARSET=927,Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Z.MACRO_PDF417_TERMINATOR=922,Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Z.MAX_NUMERIC_CODEWORDS=15,Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Z.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Z.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Z.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Z.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Z.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Z.PL=25,Z.LL=27,Z.AS=27,Z.ML=28,Z.AL=28,Z.PS=29,Z.PAL=29,Z.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Z.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Z.EXP900=E0()?ww():[],Z.NUMBER_OF_SEQUENCE_CODEWORDS=2;class He{constructor(){}static decode(r,s,o,c,u,d,h){let x=new Fi(r,s,o,c,u),w=null,v=null,I;for(let z=!0;;z=!1){if(s!=null&&(w=He.getRowIndicatorColumn(r,x,s,!0,d,h)),c!=null&&(v=He.getRowIndicatorColumn(r,x,c,!1,d,h)),I=He.merge(w,v),I==null)throw j.getNotFoundInstance();let H=I.getBoundingBox();if(z&&H!=null&&(H.getMinY()<x.getMinY()||H.getMaxY()>x.getMaxY()))x=H;else break}I.setBoundingBox(x);let D=I.getBarcodeColumnCount()+1;I.setDetectionResultColumn(0,w),I.setDetectionResultColumn(D,v);let L=w!=null;for(let z=1;z<=D;z++){let H=L?z:D-z;if(I.getDetectionResultColumn(H)!==void 0)continue;let Y;H===0||H===D?Y=new x0(x,H===0):Y=new xo(x),I.setDetectionResultColumn(H,Y);let $=-1,ce=$;for(let ue=x.getMinY();ue<=x.getMaxY();ue++){if($=He.getStartColumn(I,H,ue,L),$<0||$>x.getMaxX()){if(ce===-1)continue;$=ce}let se=He.detectCodeword(r,x.getMinX(),x.getMaxX(),L,$,ue,d,h);se!=null&&(Y.setCodeword(ue,se),ce=$,d=Math.min(d,se.getWidth()),h=Math.max(h,se.getWidth()))}}return He.createDecoderResult(I)}static merge(r,s){if(r==null&&s==null)return null;let o=He.getBarcodeMetadata(r,s);if(o==null)return null;let c=Fi.merge(He.adjustBoundingBox(r),He.adjustBoundingBox(s));return new wo(o,c)}static adjustBoundingBox(r){if(r==null)return null;let s=r.getRowHeights();if(s==null)return null;let o=He.getMax(s),c=0;for(let h of s)if(c+=o-h,h>0)break;let u=r.getCodewords();for(let h=0;c>0&&u[h]==null;h++)c--;let d=0;for(let h=s.length-1;h>=0&&(d+=o-s[h],!(s[h]>0));h--);for(let h=u.length-1;d>0&&u[h]==null;h--)d--;return r.getBoundingBox().addMissingRows(c,d,r.isLeft())}static getMax(r){let s=-1;for(let o of r)s=Math.max(s,o);return s}static getBarcodeMetadata(r,s){let o;if(r==null||(o=r.getBarcodeMetadata())==null)return s==null?null:s.getBarcodeMetadata();let c;return s==null||(c=s.getBarcodeMetadata())==null?o:o.getColumnCount()!==c.getColumnCount()&&o.getErrorCorrectionLevel()!==c.getErrorCorrectionLevel()&&o.getRowCount()!==c.getRowCount()?null:o}static getRowIndicatorColumn(r,s,o,c,u,d){let h=new x0(s,c);for(let x=0;x<2;x++){let w=x===0?1:-1,v=Math.trunc(Math.trunc(o.getX()));for(let I=Math.trunc(Math.trunc(o.getY()));I<=s.getMaxY()&&I>=s.getMinY();I+=w){let D=He.detectCodeword(r,0,r.getWidth(),c,v,I,u,d);D!=null&&(h.setCodeword(I,D),c?v=D.getStartX():v=D.getEndX())}}return h}static adjustCodewordCount(r,s){let o=s[0][1],c=o.getValue(),u=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-He.getNumberOfECCodeWords(r.getBarcodeECLevel());if(c.length===0){if(u<1||u>ke.MAX_CODEWORDS_IN_BARCODE)throw j.getNotFoundInstance();o.setValue(u)}else c[0]!==u&&o.setValue(u)}static createDecoderResult(r){let s=He.createBarcodeMatrix(r);He.adjustCodewordCount(r,s);let o=new Array,c=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),u=[],d=new Array;for(let x=0;x<r.getBarcodeRowCount();x++)for(let w=0;w<r.getBarcodeColumnCount();w++){let v=s[x][w+1].getValue(),I=x*r.getBarcodeColumnCount()+w;v.length===0?o.push(I):v.length===1?c[I]=v[0]:(d.push(I),u.push(v))}let h=new Array(u.length);for(let x=0;x<h.length;x++)h[x]=u[x];return He.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),c,ke.toIntArray(o),ke.toIntArray(d),h)}static createDecoderResultFromAmbiguousValues(r,s,o,c,u){let d=new Int32Array(c.length),h=100;for(;h-- >0;){for(let x=0;x<d.length;x++)s[c[x]]=u[x][d[x]];try{return He.decodeCodewords(s,r,o)}catch(x){if(!(x instanceof M))throw x}if(d.length===0)throw M.getChecksumInstance();for(let x=0;x<d.length;x++)if(d[x]<u[x].length-1){d[x]++;break}else if(d[x]=0,x===d.length-1)throw M.getChecksumInstance()}throw M.getChecksumInstance()}static createBarcodeMatrix(r){let s=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let c=0;c<s.length;c++)for(let u=0;u<s[c].length;u++)s[c][u]=new yo;let o=0;for(let c of r.getDetectionResultColumns()){if(c!=null){for(let u of c.getCodewords())if(u!=null){let d=u.getRowNumber();if(d>=0){if(d>=s.length)continue;s[d][o].setValue(u.getValue())}}}o++}return s}static isValidBarcodeColumn(r,s){return s>=0&&s<=r.getBarcodeColumnCount()+1}static getStartColumn(r,s,o,c){let u=c?1:-1,d=null;if(He.isValidBarcodeColumn(r,s-u)&&(d=r.getDetectionResultColumn(s-u).getCodeword(o)),d!=null)return c?d.getEndX():d.getStartX();if(d=r.getDetectionResultColumn(s).getCodewordNearby(o),d!=null)return c?d.getStartX():d.getEndX();if(He.isValidBarcodeColumn(r,s-u)&&(d=r.getDetectionResultColumn(s-u).getCodewordNearby(o)),d!=null)return c?d.getEndX():d.getStartX();let h=0;for(;He.isValidBarcodeColumn(r,s-u);){s-=u;for(let x of r.getDetectionResultColumn(s).getCodewords())if(x!=null)return(c?x.getEndX():x.getStartX())+u*h*(x.getEndX()-x.getStartX());h++}return c?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,s,o,c,u,d,h,x){u=He.adjustCodewordStartColumn(r,s,o,c,u,d);let w=He.getModuleBitCount(r,s,o,c,u,d);if(w==null)return null;let v,I=Fe.sum(w);if(c)v=u+I;else{for(let z=0;z<w.length/2;z++){let H=w[z];w[z]=w[w.length-1-z],w[w.length-1-z]=H}v=u,u=v-I}if(!He.checkCodewordSkew(I,h,x))return null;let D=En.getDecodedValue(w),L=ke.getCodeword(D);return L===-1?null:new Co(u,v,He.getCodewordBucketNumber(D),L)}static getModuleBitCount(r,s,o,c,u,d){let h=u,x=new Int32Array(8),w=0,v=c?1:-1,I=c;for(;(c?h<o:h>=s)&&w<x.length;)r.get(h,d)===I?(x[w]++,h+=v):(w++,I=!I);return w===x.length||h===(c?o:s)&&w===x.length-1?x:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,s,o,c,u,d){let h=u,x=c?-1:1;for(let w=0;w<2;w++){for(;(c?h>=s:h<o)&&c===r.get(h,d);){if(Math.abs(u-h)>He.CODEWORD_SKEW_SIZE)return u;h+=x}x=-x,c=!c}return h}static checkCodewordSkew(r,s,o){return s-He.CODEWORD_SKEW_SIZE<=r&&r<=o+He.CODEWORD_SKEW_SIZE}static decodeCodewords(r,s,o){if(r.length===0)throw U.getFormatInstance();let c=1<<s+1,u=He.correctErrors(r,o,c);He.verifyCodewordCount(r,c);let d=Z.decode(r,""+s);return d.setErrorsCorrected(u),d.setErasures(o.length),d}static correctErrors(r,s,o){if(s!=null&&s.length>o/2+He.MAX_ERRORS||o<0||o>He.MAX_EC_CODEWORDS)throw M.getChecksumInstance();return He.errorCorrection.decode(r,o,s)}static verifyCodewordCount(r,s){if(r.length<4)throw U.getFormatInstance();let o=r[0];if(o>r.length)throw U.getFormatInstance();if(o===0)if(s<r.length)r[0]=r.length-s;else throw U.getFormatInstance()}static getBitCountForCodeword(r){let s=new Int32Array(8),o=0,c=s.length-1;for(;!((r&1)!==o&&(o=r&1,c--,c<0));)s[c]++,r>>=1;return s}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return He.getCodewordBucketNumber(He.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let s=new mo;for(let o=0;o<r.length;o++){s.format("Row %2d: ",o);for(let c=0;c<r[o].length;c++){let u=r[o][c];u.getValue().length===0?s.format("        ",null):s.format("%4d(%2d)",u.getValue()[0],u.getConfidence(u.getValue()[0]))}s.format("%n")}return s.toString()}}He.CODEWORD_SKEW_SIZE=2,He.MAX_ERRORS=3,He.MAX_EC_CODEWORDS=512,He.errorCorrection=new m0;class qt{decode(r,s=null){let o=qt.decode(r,s,!1);if(o==null||o.length===0||o[0]==null)throw j.getNotFoundInstance();return o[0]}decodeMultiple(r,s=null){try{return qt.decode(r,s,!0)}catch(o){throw o instanceof U||o instanceof M?j.getNotFoundInstance():o}}static decode(r,s,o){const c=new Array,u=We.detectMultiple(r,s,o);for(const d of u.getPoints()){const h=He.decode(u.getBits(),d[4],d[5],d[6],d[7],qt.getMinCodewordWidth(d),qt.getMaxCodewordWidth(d)),x=new Ze(h.getText(),h.getRawBytes(),void 0,d,ge.PDF_417);x.putMetadata(ct.ERROR_CORRECTION_LEVEL,h.getECLevel());const w=h.getOther();w!=null&&x.putMetadata(ct.PDF417_EXTRA_METADATA,w),c.push(x)}return c.map(d=>d)}static getMaxWidth(r,s){return r==null||s==null?0:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMinWidth(r,s){return r==null||s==null?S.MAX_VALUE:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(qt.getMaxWidth(r[0],r[4]),qt.getMaxWidth(r[6],r[2])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN),Math.max(qt.getMaxWidth(r[1],r[5]),qt.getMaxWidth(r[7],r[3])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(qt.getMinWidth(r[0],r[4]),qt.getMinWidth(r[6],r[2])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN),Math.min(qt.getMinWidth(r[1],r[5]),qt.getMinWidth(r[7],r[3])*ke.MODULES_IN_CODEWORD/ke.MODULES_IN_STOP_PATTERN)))}reset(){}}class Wa extends m{}Wa.kind="ReaderException";class v0{constructor(r,s){this.verbose=r===!0,s&&this.setHints(s)}decode(r,s){return s&&this.setHints(s),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const s=!i(r)&&r.get(W.TRY_HARDER)===!0,o=i(r)?null:r.get(W.POSSIBLE_FORMATS),c=new Array;if(!i(o)){const u=o.some(d=>d===ge.UPC_A||d===ge.UPC_E||d===ge.EAN_13||d===ge.EAN_8||d===ge.CODABAR||d===ge.CODE_39||d===ge.CODE_93||d===ge.CODE_128||d===ge.ITF||d===ge.RSS_14||d===ge.RSS_EXPANDED);u&&!s&&c.push(new ds(r,this.verbose)),o.includes(ge.QR_CODE)&&c.push(new ri),o.includes(ge.DATA_MATRIX)&&c.push(new ni),o.includes(ge.AZTEC)&&c.push(new J),o.includes(ge.PDF_417)&&c.push(new qt),u&&s&&c.push(new ds(r,this.verbose))}c.length===0&&(s||c.push(new ds(r,this.verbose)),c.push(new ri),c.push(new ni),c.push(new J),c.push(new qt),s&&c.push(new ds(r,this.verbose))),this.readers=c}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new Wa("No readers where selected, nothing can be read.");for(const s of this.readers)try{return s.decode(r,this.hints)}catch(o){if(o instanceof Wa)continue}throw new j("No MultiFormat Readers were able to detect the code.")}}class Cw extends st{constructor(r=null,s=500){const o=new v0;o.setHints(r),super(o,s)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class Ew extends st{constructor(r=500){super(new qt,r)}}class vw extends st{constructor(r=500){super(new ri,r)}}var ru;(function(T){T[T.ERROR_CORRECTION=0]="ERROR_CORRECTION",T[T.CHARACTER_SET=1]="CHARACTER_SET",T[T.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",T[T.MIN_SIZE=3]="MIN_SIZE",T[T.MAX_SIZE=4]="MAX_SIZE",T[T.MARGIN=5]="MARGIN",T[T.PDF417_COMPACT=6]="PDF417_COMPACT",T[T.PDF417_COMPACTION=7]="PDF417_COMPACTION",T[T.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",T[T.AZTEC_LAYERS=9]="AZTEC_LAYERS",T[T.QR_VERSION=10]="QR_VERSION"})(ru||(ru={}));var zt=ru;class iu{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new Ae(r,Int32Array.from([1])))}buildGenerator(r){const s=this.cachedGenerators;if(r>=s.length){let o=s[s.length-1];const c=this.field;for(let u=s.length;u<=r;u++){const d=o.multiply(new Ae(c,Int32Array.from([1,c.exp(u-1+c.getGeneratorBase())])));s.push(d),o=d}}return s[r]}encode(r,s){if(s===0)throw new E("No error correction bytes");const o=r.length-s;if(o<=0)throw new E("No data bytes provided");const c=this.buildGenerator(s),u=new Int32Array(o);k.arraycopy(r,0,u,0,o);let d=new Ae(this.field,u);d=d.multiplyByMonomial(s,1);const x=d.divide(c)[1].getCoefficients(),w=s-x.length;for(let v=0;v<w;v++)r[o+v]=0;k.arraycopy(x,0,r,o+w,x.length)}}class Mt{constructor(){}static applyMaskPenaltyRule1(r){return Mt.applyMaskPenaltyRule1Internal(r,!0)+Mt.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let s=0;const o=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let d=0;d<u-1;d++){const h=o[d];for(let x=0;x<c-1;x++){const w=h[x];w===h[x+1]&&w===o[d+1][x]&&w===o[d+1][x+1]&&s++}}return Mt.N2*s}static applyMaskPenaltyRule3(r){let s=0;const o=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let d=0;d<u;d++)for(let h=0;h<c;h++){const x=o[d];h+6<c&&x[h]===1&&x[h+1]===0&&x[h+2]===1&&x[h+3]===1&&x[h+4]===1&&x[h+5]===0&&x[h+6]===1&&(Mt.isWhiteHorizontal(x,h-4,h)||Mt.isWhiteHorizontal(x,h+7,h+11))&&s++,d+6<u&&o[d][h]===1&&o[d+1][h]===0&&o[d+2][h]===1&&o[d+3][h]===1&&o[d+4][h]===1&&o[d+5][h]===0&&o[d+6][h]===1&&(Mt.isWhiteVertical(o,h,d-4,d)||Mt.isWhiteVertical(o,h,d+7,d+11))&&s++}return s*Mt.N3}static isWhiteHorizontal(r,s,o){s=Math.max(s,0),o=Math.min(o,r.length);for(let c=s;c<o;c++)if(r[c]===1)return!1;return!0}static isWhiteVertical(r,s,o,c){o=Math.max(o,0),c=Math.min(c,r.length);for(let u=o;u<c;u++)if(r[u][s]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let s=0;const o=r.getArray(),c=r.getWidth(),u=r.getHeight();for(let x=0;x<u;x++){const w=o[x];for(let v=0;v<c;v++)w[v]===1&&s++}const d=r.getHeight()*r.getWidth();return Math.floor(Math.abs(s*2-d)*10/d)*Mt.N4}static getDataMaskBit(r,s,o){let c,u;switch(r){case 0:c=o+s&1;break;case 1:c=o&1;break;case 2:c=s%3;break;case 3:c=(o+s)%3;break;case 4:c=Math.floor(o/2)+Math.floor(s/3)&1;break;case 5:u=o*s,c=(u&1)+u%3;break;case 6:u=o*s,c=(u&1)+u%3&1;break;case 7:u=o*s,c=u%3+(o+s&1)&1;break;default:throw new E("Invalid mask pattern: "+r)}return c===0}static applyMaskPenaltyRule1Internal(r,s){let o=0;const c=s?r.getHeight():r.getWidth(),u=s?r.getWidth():r.getHeight(),d=r.getArray();for(let h=0;h<c;h++){let x=0,w=-1;for(let v=0;v<u;v++){const I=s?d[h][v]:d[v][h];I===w?x++:(x>=5&&(o+=Mt.N1+(x-5)),x=1,w=I)}x>=5&&(o+=Mt.N1+(x-5))}return o}}Mt.N1=3,Mt.N2=3,Mt.N3=40,Mt.N4=10;class Ha{constructor(r,s){this.width=r,this.height=s;const o=new Array(s);for(let c=0;c!==s;c++)o[c]=new Uint8Array(r);this.bytes=o}getHeight(){return this.height}getWidth(){return this.width}get(r,s){return this.bytes[s][r]}getArray(){return this.bytes}setNumber(r,s,o){this.bytes[s][r]=o}setBoolean(r,s,o){this.bytes[s][r]=o?1:0}clear(r){for(const s of this.bytes)b.fill(s,r)}equals(r){if(!(r instanceof Ha))return!1;const s=r;if(this.width!==s.width||this.height!==s.height)return!1;for(let o=0,c=this.height;o<c;++o){const u=this.bytes[o],d=s.bytes[o];for(let h=0,x=this.width;h<x;++h)if(u[h]!==d[h])return!1}return!0}toString(){const r=new de;for(let s=0,o=this.height;s<o;++s){const c=this.bytes[s];for(let u=0,d=this.width;u<d;++u)switch(c[u]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class Ui{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new de;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<Ui.NUM_MASK_PATTERNS}}Ui.NUM_MASK_PATTERNS=8;class dt extends m{}dt.kind="WriterException";class _e{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,s,o,c,u){_e.clearMatrix(u),_e.embedBasicPatterns(o,u),_e.embedTypeInfo(s,c,u),_e.maybeEmbedVersionInfo(o,u),_e.embedDataBits(r,c,u)}static embedBasicPatterns(r,s){_e.embedPositionDetectionPatternsAndSeparators(s),_e.embedDarkDotAtLeftBottomCorner(s),_e.maybeEmbedPositionAdjustmentPatterns(r,s),_e.embedTimingPatterns(s)}static embedTypeInfo(r,s,o){const c=new O;_e.makeTypeInfoBits(r,s,c);for(let u=0,d=c.getSize();u<d;++u){const h=c.get(c.getSize()-1-u),x=_e.TYPE_INFO_COORDINATES[u],w=x[0],v=x[1];if(o.setBoolean(w,v,h),u<8){const I=o.getWidth()-u-1,D=8;o.setBoolean(I,D,h)}else{const D=o.getHeight()-7+(u-8);o.setBoolean(8,D,h)}}}static maybeEmbedVersionInfo(r,s){if(r.getVersionNumber()<7)return;const o=new O;_e.makeVersionInfoBits(r,o);let c=6*3-1;for(let u=0;u<6;++u)for(let d=0;d<3;++d){const h=o.get(c);c--,s.setBoolean(u,s.getHeight()-11+d,h),s.setBoolean(s.getHeight()-11+d,u,h)}}static embedDataBits(r,s,o){let c=0,u=-1,d=o.getWidth()-1,h=o.getHeight()-1;for(;d>0;){for(d===6&&(d-=1);h>=0&&h<o.getHeight();){for(let x=0;x<2;++x){const w=d-x;if(!_e.isEmpty(o.get(w,h)))continue;let v;c<r.getSize()?(v=r.get(c),++c):v=!1,s!==255&&Mt.getDataMaskBit(s,w,h)&&(v=!v),o.setBoolean(w,h,v)}h+=u}u=-u,h+=u,d-=2}if(c!==r.getSize())throw new dt("Not all bits consumed: "+c+"/"+r.getSize())}static findMSBSet(r){return 32-S.numberOfLeadingZeros(r)}static calculateBCHCode(r,s){if(s===0)throw new E("0 polynomial");const o=_e.findMSBSet(s);for(r<<=o-1;_e.findMSBSet(r)>=o;)r^=s<<_e.findMSBSet(r)-o;return r}static makeTypeInfoBits(r,s,o){if(!Ui.isValidMaskPattern(s))throw new dt("Invalid mask pattern");const c=r.getBits()<<3|s;o.appendBits(c,5);const u=_e.calculateBCHCode(c,_e.TYPE_INFO_POLY);o.appendBits(u,10);const d=new O;if(d.appendBits(_e.TYPE_INFO_MASK_PATTERN,15),o.xor(d),o.getSize()!==15)throw new dt("should not happen but we got: "+o.getSize())}static makeVersionInfoBits(r,s){s.appendBits(r.getVersionNumber(),6);const o=_e.calculateBCHCode(r.getVersionNumber(),_e.VERSION_INFO_POLY);if(s.appendBits(o,12),s.getSize()!==18)throw new dt("should not happen but we got: "+s.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let s=8;s<r.getWidth()-8;++s){const o=(s+1)%2;_e.isEmpty(r.get(s,6))&&r.setNumber(s,6,o),_e.isEmpty(r.get(6,s))&&r.setNumber(6,s,o)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new dt;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,s,o){for(let c=0;c<8;++c){if(!_e.isEmpty(o.get(r+c,s)))throw new dt;o.setNumber(r+c,s,0)}}static embedVerticalSeparationPattern(r,s,o){for(let c=0;c<7;++c){if(!_e.isEmpty(o.get(r,s+c)))throw new dt;o.setNumber(r,s+c,0)}}static embedPositionAdjustmentPattern(r,s,o){for(let c=0;c<5;++c){const u=_e.POSITION_ADJUSTMENT_PATTERN[c];for(let d=0;d<5;++d)o.setNumber(r+d,s+c,u[d])}}static embedPositionDetectionPattern(r,s,o){for(let c=0;c<7;++c){const u=_e.POSITION_DETECTION_PATTERN[c];for(let d=0;d<7;++d)o.setNumber(r+d,s+c,u[d])}}static embedPositionDetectionPatternsAndSeparators(r){const s=_e.POSITION_DETECTION_PATTERN[0].length;_e.embedPositionDetectionPattern(0,0,r),_e.embedPositionDetectionPattern(r.getWidth()-s,0,r),_e.embedPositionDetectionPattern(0,r.getWidth()-s,r);const o=8;_e.embedHorizontalSeparationPattern(0,o-1,r),_e.embedHorizontalSeparationPattern(r.getWidth()-o,o-1,r),_e.embedHorizontalSeparationPattern(0,r.getWidth()-o,r);const c=7;_e.embedVerticalSeparationPattern(c,0,r),_e.embedVerticalSeparationPattern(r.getHeight()-c-1,0,r),_e.embedVerticalSeparationPattern(c,r.getHeight()-c,r)}static maybeEmbedPositionAdjustmentPatterns(r,s){if(r.getVersionNumber()<2)return;const o=r.getVersionNumber()-1,c=_e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[o];for(let u=0,d=c.length;u!==d;u++){const h=c[u];if(h>=0)for(let x=0;x!==d;x++){const w=c[x];w>=0&&_e.isEmpty(s.get(w,h))&&_e.embedPositionAdjustmentPattern(w-2,h-2,s)}}}}_e.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),_e.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),_e.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),_e.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),_e.VERSION_INFO_POLY=7973,_e.TYPE_INFO_POLY=1335,_e.TYPE_INFO_MASK_PATTERN=21522;class Sw{constructor(r,s){this.dataBytes=r,this.errorCorrectionBytes=s}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class pt{constructor(){}static calculateMaskPenalty(r){return Mt.applyMaskPenaltyRule1(r)+Mt.applyMaskPenaltyRule2(r)+Mt.applyMaskPenaltyRule3(r)+Mt.applyMaskPenaltyRule4(r)}static encode(r,s,o=null){let c=pt.DEFAULT_BYTE_MODE_ENCODING;const u=o!==null&&o.get(zt.CHARACTER_SET)!==void 0;u&&(c=o.get(zt.CHARACTER_SET).toString());const d=this.chooseMode(r,c),h=new O;if(d===Me.BYTE&&(u||pt.DEFAULT_BYTE_MODE_ENCODING!==c)){const ue=G.getCharacterSetECIByName(c);ue!==void 0&&this.appendECI(ue,h)}this.appendModeInfo(d,h);const x=new O;this.appendBytes(r,d,x,c);let w;if(o!==null&&o.get(zt.QR_VERSION)!==void 0){const ue=Number.parseInt(o.get(zt.QR_VERSION).toString(),10);w=Ne.getVersionForNumber(ue);const se=this.calculateBitsNeeded(d,h,x,w);if(!this.willFit(se,w,s))throw new dt("Data too big for requested version")}else w=this.recommendVersion(s,d,h,x);const v=new O;v.appendBitArray(h);const I=d===Me.BYTE?x.getSizeInBytes():r.length;this.appendLengthInfo(I,w,d,v),v.appendBitArray(x);const D=w.getECBlocksForLevel(s),L=w.getTotalCodewords()-D.getTotalECCodewords();this.terminateBits(L,v);const z=this.interleaveWithECBytes(v,w.getTotalCodewords(),L,D.getNumBlocks()),H=new Ui;H.setECLevel(s),H.setMode(d),H.setVersion(w);const Y=w.getDimensionForVersion(),$=new Ha(Y,Y),ce=this.chooseMaskPattern(z,s,w,$);return H.setMaskPattern(ce),_e.buildMatrix(z,s,w,ce,$),H.setMatrix($),H}static recommendVersion(r,s,o,c){const u=this.calculateBitsNeeded(s,o,c,Ne.getVersionForNumber(1)),d=this.chooseVersion(u,r),h=this.calculateBitsNeeded(s,o,c,d);return this.chooseVersion(h,r)}static calculateBitsNeeded(r,s,o,c){return s.getSize()+r.getCharacterCountBits(c)+o.getSize()}static getAlphanumericCode(r){return r<pt.ALPHANUMERIC_TABLE.length?pt.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,s=null){if(G.SJIS.getName()===s&&this.isOnlyDoubleByteKanji(r))return Me.KANJI;let o=!1,c=!1;for(let u=0,d=r.length;u<d;++u){const h=r.charAt(u);if(pt.isDigit(h))o=!0;else if(this.getAlphanumericCode(h.charCodeAt(0))!==-1)c=!0;else return Me.BYTE}return c?Me.ALPHANUMERIC:o?Me.NUMERIC:Me.BYTE}static isOnlyDoubleByteKanji(r){let s;try{s=me.encode(r,G.SJIS)}catch{return!1}const o=s.length;if(o%2!==0)return!1;for(let c=0;c<o;c+=2){const u=s[c]&255;if((u<129||u>159)&&(u<224||u>235))return!1}return!0}static chooseMaskPattern(r,s,o,c){let u=Number.MAX_SAFE_INTEGER,d=-1;for(let h=0;h<Ui.NUM_MASK_PATTERNS;h++){_e.buildMatrix(r,s,o,h,c);let x=this.calculateMaskPenalty(c);x<u&&(u=x,d=h)}return d}static chooseVersion(r,s){for(let o=1;o<=40;o++){const c=Ne.getVersionForNumber(o);if(pt.willFit(r,c,s))return c}throw new dt("Data too big")}static willFit(r,s,o){const c=s.getTotalCodewords(),d=s.getECBlocksForLevel(o).getTotalECCodewords(),h=c-d,x=(r+7)/8;return h>=x}static terminateBits(r,s){const o=r*8;if(s.getSize()>o)throw new dt("data bits cannot fit in the QR Code"+s.getSize()+" > "+o);for(let d=0;d<4&&s.getSize()<o;++d)s.appendBit(!1);const c=s.getSize()&7;if(c>0)for(let d=c;d<8;d++)s.appendBit(!1);const u=r-s.getSizeInBytes();for(let d=0;d<u;++d)s.appendBits(d&1?17:236,8);if(s.getSize()!==o)throw new dt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,s,o,c,u,d){if(c>=o)throw new dt("Block ID too large");const h=r%o,x=o-h,w=Math.floor(r/o),v=w+1,I=Math.floor(s/o),D=I+1,L=w-I,z=v-D;if(L!==z)throw new dt("EC bytes mismatch");if(o!==x+h)throw new dt("RS blocks mismatch");if(r!==(I+L)*x+(D+z)*h)throw new dt("Total bytes mismatch");c<x?(u[0]=I,d[0]=L):(u[0]=D,d[0]=z)}static interleaveWithECBytes(r,s,o,c){if(r.getSizeInBytes()!==o)throw new dt("Number of bits and data bytes does not match");let u=0,d=0,h=0;const x=new Array;for(let v=0;v<c;++v){const I=new Int32Array(1),D=new Int32Array(1);pt.getNumDataBytesAndNumECBytesForBlockID(s,o,c,v,I,D);const L=I[0],z=new Uint8Array(L);r.toBytes(8*u,z,0,L);const H=pt.generateECBytes(z,D[0]);x.push(new Sw(z,H)),d=Math.max(d,L),h=Math.max(h,H.length),u+=I[0]}if(o!==u)throw new dt("Data bytes does not match offset");const w=new O;for(let v=0;v<d;++v)for(const I of x){const D=I.getDataBytes();v<D.length&&w.appendBits(D[v],8)}for(let v=0;v<h;++v)for(const I of x){const D=I.getErrorCorrectionBytes();v<D.length&&w.appendBits(D[v],8)}if(s!==w.getSizeInBytes())throw new dt("Interleaving error: "+s+" and "+w.getSizeInBytes()+" differ.");return w}static generateECBytes(r,s){const o=r.length,c=new Int32Array(o+s);for(let d=0;d<o;d++)c[d]=r[d]&255;new iu(K.QR_CODE_FIELD_256).encode(c,s);const u=new Uint8Array(s);for(let d=0;d<s;d++)u[d]=c[o+d];return u}static appendModeInfo(r,s){s.appendBits(r.getBits(),4)}static appendLengthInfo(r,s,o,c){const u=o.getCharacterCountBits(s);if(r>=1<<u)throw new dt(r+" is bigger than "+((1<<u)-1));c.appendBits(r,u)}static appendBytes(r,s,o,c){switch(s){case Me.NUMERIC:pt.appendNumericBytes(r,o);break;case Me.ALPHANUMERIC:pt.appendAlphanumericBytes(r,o);break;case Me.BYTE:pt.append8BitBytes(r,o,c);break;case Me.KANJI:pt.appendKanjiBytes(r,o);break;default:throw new dt("Invalid mode: "+s)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const s=pt.getDigit(r);return s>=0&&s<=9}static appendNumericBytes(r,s){const o=r.length;let c=0;for(;c<o;){const u=pt.getDigit(r.charAt(c));if(c+2<o){const d=pt.getDigit(r.charAt(c+1)),h=pt.getDigit(r.charAt(c+2));s.appendBits(u*100+d*10+h,10),c+=3}else if(c+1<o){const d=pt.getDigit(r.charAt(c+1));s.appendBits(u*10+d,7),c+=2}else s.appendBits(u,4),c++}}static appendAlphanumericBytes(r,s){const o=r.length;let c=0;for(;c<o;){const u=pt.getAlphanumericCode(r.charCodeAt(c));if(u===-1)throw new dt;if(c+1<o){const d=pt.getAlphanumericCode(r.charCodeAt(c+1));if(d===-1)throw new dt;s.appendBits(u*45+d,11),c+=2}else s.appendBits(u,6),c++}}static append8BitBytes(r,s,o){let c;try{c=me.encode(r,o)}catch(u){throw new dt(u)}for(let u=0,d=c.length;u!==d;u++){const h=c[u];s.appendBits(h,8)}}static appendKanjiBytes(r,s){let o;try{o=me.encode(r,G.SJIS)}catch(u){throw new dt(u)}const c=o.length;for(let u=0;u<c;u+=2){const d=o[u]&255,h=o[u+1]&255,x=d<<8&4294967295|h;let w=-1;if(x>=33088&&x<=40956?w=x-33088:x>=57408&&x<=60351&&(w=x-49472),w===-1)throw new dt("Invalid byte sequence");const v=(w>>8)*192+(w&255);s.appendBits(v,13)}}static appendECI(r,s){s.appendBits(Me.ECI.getBits(),4),s.appendBits(r.getValue(),8)}}pt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),pt.DEFAULT_BYTE_MODE_ENCODING=G.UTF8.getName();class Vi{write(r,s,o,c=null){if(r.length===0)throw new E("Found empty contents");if(s<0||o<0)throw new E("Requested dimensions are too small: "+s+"x"+o);let u=ht.L,d=Vi.QUIET_ZONE_SIZE;c!==null&&(c.get(zt.ERROR_CORRECTION)!==void 0&&(u=ht.fromString(c.get(zt.ERROR_CORRECTION).toString())),c.get(zt.MARGIN)!==void 0&&(d=Number.parseInt(c.get(zt.MARGIN).toString(),10)));const h=pt.encode(r,u,c);return this.renderResult(h,s,o,d)}writeToDom(r,s,o,c,u=null){typeof r=="string"&&(r=document.querySelector(r));const d=this.write(s,o,c,u);r&&r.appendChild(d)}renderResult(r,s,o,c){const u=r.getMatrix();if(u===null)throw new je;const d=u.getWidth(),h=u.getHeight(),x=d+c*2,w=h+c*2,v=Math.max(s,x),I=Math.max(o,w),D=Math.min(Math.floor(v/x),Math.floor(I/w)),L=Math.floor((v-d*D)/2),z=Math.floor((I-h*D)/2),H=this.createSVGElement(v,I);for(let Y=0,$=z;Y<h;Y++,$+=D)for(let ce=0,ue=L;ce<d;ce++,ue+=D)if(u.get(ce,Y)===1){const se=this.createSvgRectElement(ue,$,D,D);H.appendChild(se)}return H}createSVGElement(r,s){const o=document.createElementNS(Vi.SVG_NS,"svg");return o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",s.toString()),o}createSvgRectElement(r,s,o,c){const u=document.createElementNS(Vi.SVG_NS,"rect");return u.setAttributeNS(null,"x",r.toString()),u.setAttributeNS(null,"y",s.toString()),u.setAttributeNS(null,"height",o.toString()),u.setAttributeNS(null,"width",c.toString()),u.setAttributeNS(null,"fill","#000000"),u}}Vi.QUIET_ZONE_SIZE=4,Vi.SVG_NS="http://www.w3.org/2000/svg";class hs{encode(r,s,o,c,u){if(r.length===0)throw new E("Found empty contents");if(s!==ge.QR_CODE)throw new E("Can only encode QR_CODE, but got "+s);if(o<0||c<0)throw new E(`Requested dimensions are too small: ${o}x${c}`);let d=ht.L,h=hs.QUIET_ZONE_SIZE;u!==null&&(u.get(zt.ERROR_CORRECTION)!==void 0&&(d=ht.fromString(u.get(zt.ERROR_CORRECTION).toString())),u.get(zt.MARGIN)!==void 0&&(h=Number.parseInt(u.get(zt.MARGIN).toString(),10)));const x=pt.encode(r,d,u);return hs.renderResult(x,o,c,h)}static renderResult(r,s,o,c){const u=r.getMatrix();if(u===null)throw new je;const d=u.getWidth(),h=u.getHeight(),x=d+c*2,w=h+c*2,v=Math.max(s,x),I=Math.max(o,w),D=Math.min(Math.floor(v/x),Math.floor(I/w)),L=Math.floor((v-d*D)/2),z=Math.floor((I-h*D)/2),H=new pe(v,I);for(let Y=0,$=z;Y<h;Y++,$+=D)for(let ce=0,ue=L;ce<d;ce++,ue+=D)u.get(ce,Y)===1&&H.setRegion(ue,$,D,D);return H}}hs.QUIET_ZONE_SIZE=4;class Aw{encode(r,s,o,c,u){let d;switch(s){case ge.QR_CODE:d=new hs;break;default:throw new E("No encoder available for format "+s)}return d.encode(r,s,o,c,u)}}class wr extends X{constructor(r,s,o,c,u,d,h,x){if(super(d,h),this.yuvData=r,this.dataWidth=s,this.dataHeight=o,this.left=c,this.top=u,c+d>s||u+h>o)throw new E("Crop rectangle does not fit within image data.");x&&this.reverseHorizontal(d,h)}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const c=(r+this.top)*this.dataWidth+this.left;return k.arraycopy(this.yuvData,c,s,0,o),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.yuvData;const o=r*s,c=new Uint8ClampedArray(o);let u=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return k.arraycopy(this.yuvData,u,c,0,o),c;for(let d=0;d<s;d++){const h=d*r;k.arraycopy(this.yuvData,u,c,h,r),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(r,s,o,c){return new wr(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+s,o,c,!1)}renderThumbnail(){const r=this.getWidth()/wr.THUMBNAIL_SCALE_FACTOR,s=this.getHeight()/wr.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(r*s),c=this.yuvData;let u=this.top*this.dataWidth+this.left;for(let d=0;d<s;d++){const h=d*r;for(let x=0;x<r;x++){const w=c[u+x*wr.THUMBNAIL_SCALE_FACTOR]&255;o[h+x]=4278190080|w*65793}u+=this.dataWidth*wr.THUMBNAIL_SCALE_FACTOR}return o}getThumbnailWidth(){return this.getWidth()/wr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/wr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,s){const o=this.yuvData;for(let c=0,u=this.top*this.dataWidth+this.left;c<s;c++,u+=this.dataWidth){const d=u+r/2;for(let h=u,x=u+r-1;h<d;h++,x--){const w=o[h];o[h]=o[x],o[x]=w}}}invert(){return new fe(this)}}wr.THUMBNAIL_SCALE_FACTOR=2;class su extends X{constructor(r,s,o,c,u,d,h){if(super(s,o),this.dataWidth=c,this.dataHeight=u,this.left=d,this.top=h,r.BYTES_PER_ELEMENT===4){const x=s*o,w=new Uint8ClampedArray(x);for(let v=0;v<x;v++){const I=r[v],D=I>>16&255,L=I>>7&510,z=I&255;w[v]=(D+L+z)/4&255}this.luminances=w}else this.luminances=r;if(c===void 0&&(this.dataWidth=s),u===void 0&&(this.dataHeight=o),d===void 0&&(this.left=0),h===void 0&&(this.top=0),this.left+s>this.dataWidth||this.top+o>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(r,s){if(r<0||r>=this.getHeight())throw new E("Requested row is outside the image: "+r);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const c=(r+this.top)*this.dataWidth+this.left;return k.arraycopy(this.luminances,c,s,0,o),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.luminances;const o=r*s,c=new Uint8ClampedArray(o);let u=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return k.arraycopy(this.luminances,u,c,0,o),c;for(let d=0;d<s;d++){const h=d*r;k.arraycopy(this.luminances,u,c,h,r),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(r,s,o,c){return new su(this.luminances,o,c,this.dataWidth,this.dataHeight,this.left+r,this.top+s)}invert(){return new fe(this)}}class S0 extends G{static forName(r){return this.getCharacterSetECIByName(r)}}class ou{}ou.ISO_8859_1=G.ISO8859_1;class A0{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class T0{static singletonList(r){return[r]}static min(r,s){return r.sort(s)[0]}}class Tw{constructor(r){this.previous=r}getPrevious(){return this.previous}}class gs extends Tw{constructor(r,s,o){super(r),this.value=s,this.bitCount=o}appendTo(r,s){r.appendBits(this.value,this.bitCount)}add(r,s){return new gs(this,r,s)}addBinaryShift(r,s){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new gs(this,r,s)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+S.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class au extends gs{constructor(r,s,o){super(r,0,0),this.binaryShiftStart=s,this.binaryShiftByteCount=o}appendTo(r,s){for(let o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):o===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(s[this.binaryShiftStart+o],8)}addBinaryShift(r,s){return new au(this,r,s)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function bw(T,r,s){return new au(T,r,s)}function Eo(T,r,s){return new gs(T,r,s)}const Iw=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],si=0,Ga=1,Yn=2,b0=3,Cr=4,Nw=new gs(null,0,0),lu=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function Rw(T){for(let r of T)b.fill(r,-1);return T[si][Cr]=0,T[Ga][Cr]=0,T[Ga][si]=28,T[b0][Cr]=0,T[Yn][Cr]=0,T[Yn][si]=15,T}const I0=Rw(b.createInt32Array(6,6));class Er{constructor(r,s,o,c){this.token=r,this.mode=s,this.binaryShiftByteCount=o,this.bitCount=c}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,s){let o=this.bitCount,c=this.token;if(r!==this.mode){let d=lu[this.mode][r];c=Eo(c,d&65535,d>>16),o+=d>>16}let u=r===Yn?4:5;return c=Eo(c,s,u),new Er(c,r,0,o+u)}shiftAndAppend(r,s){let o=this.token,c=this.mode===Yn?4:5;return o=Eo(o,I0[this.mode][r],c),o=Eo(o,s,5),new Er(o,this.mode,0,this.bitCount+c+5)}addBinaryShiftChar(r){let s=this.token,o=this.mode,c=this.bitCount;if(this.mode===Cr||this.mode===Yn){let h=lu[o][si];s=Eo(s,h&65535,h>>16),c+=h>>16,o=si}let u=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,d=new Er(s,o,this.binaryShiftByteCount+1,c+u);return d.binaryShiftByteCount===2047+31&&(d=d.endBinaryShift(r+1)),d}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let s=this.token;return s=bw(s,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new Er(s,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let s=this.bitCount+(lu[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?s+=Er.calculateBinaryShiftCost(r)-Er.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(s+=10),s<=r.bitCount}toBitArray(r){let s=[];for(let c=this.endBinaryShift(r.length).token;c!==null;c=c.getPrevious())s.unshift(c);let o=new O;for(const c of s)c.appendTo(o,r);return o}toString(){return he.format("%s bits=%d bytes=%d",Iw[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}Er.INITIAL_STATE=new Er(Nw,si,0,0);function Mw(T){const r=he.getCharCode(" "),s=he.getCharCode("."),o=he.getCharCode(",");T[si][r]=1;const c=he.getCharCode("Z"),u=he.getCharCode("A");for(let D=u;D<=c;D++)T[si][D]=D-u+2;T[Ga][r]=1;const d=he.getCharCode("z"),h=he.getCharCode("a");for(let D=h;D<=d;D++)T[Ga][D]=D-h+2;T[Yn][r]=1;const x=he.getCharCode("9"),w=he.getCharCode("0");for(let D=w;D<=x;D++)T[Yn][D]=D-w+2;T[Yn][o]=12,T[Yn][s]=13;const v=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let D=0;D<v.length;D++)T[b0][he.getCharCode(v[D])]=D;const I=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let D=0;D<I.length;D++)he.getCharCode(I[D])>0&&(T[Cr][he.getCharCode(I[D])]=D);return T}const cu=Mw(b.createInt32Array(5,256));class vo{constructor(r){this.text=r}encode(){const r=he.getCharCode(" "),s=he.getCharCode(`
`);let o=T0.singletonList(Er.INITIAL_STATE);for(let u=0;u<this.text.length;u++){let d,h=u+1<this.text.length?this.text[u+1]:0;switch(this.text[u]){case he.getCharCode("\r"):d=h===s?2:0;break;case he.getCharCode("."):d=h===r?3:0;break;case he.getCharCode(","):d=h===r?4:0;break;case he.getCharCode(":"):d=h===r?5:0;break;default:d=0}d>0?(o=vo.updateStateListForPair(o,u,d),u++):o=this.updateStateListForChar(o,u)}return T0.min(o,(u,d)=>u.getBitCount()-d.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,s){const o=[];for(let c of r)this.updateStateForChar(c,s,o);return vo.simplifyStates(o)}updateStateForChar(r,s,o){let c=this.text[s]&255,u=cu[r.getMode()][c]>0,d=null;for(let h=0;h<=Cr;h++){let x=cu[h][c];if(x>0){if(d==null&&(d=r.endBinaryShift(s)),!u||h===r.getMode()||h===Yn){const w=d.latchAndAppend(h,x);o.push(w)}if(!u&&I0[r.getMode()][h]>=0){const w=d.shiftAndAppend(h,x);o.push(w)}}}if(r.getBinaryShiftByteCount()>0||cu[r.getMode()][c]===0){let h=r.addBinaryShiftChar(s);o.push(h)}}static updateStateListForPair(r,s,o){const c=[];for(let u of r)this.updateStateForPair(u,s,o,c);return this.simplifyStates(c)}static updateStateForPair(r,s,o,c){let u=r.endBinaryShift(s);if(c.push(u.latchAndAppend(Cr,o)),r.getMode()!==Cr&&c.push(u.shiftAndAppend(Cr,o)),o===3||o===4){let d=u.latchAndAppend(Yn,16-o).latchAndAppend(Yn,1);c.push(d)}if(r.getBinaryShiftByteCount()>0){let d=r.addBinaryShiftChar(s).addBinaryShiftChar(s+1);c.push(d)}}static simplifyStates(r){let s=[];for(const o of r){let c=!0;for(const u of s){if(u.isBetterThanOrEqualTo(o)){c=!1;break}o.isBetterThanOrEqualTo(u)&&(s=s.filter(d=>d!==u))}c&&s.push(o)}return s}}class qe{constructor(){}static encodeBytes(r){return qe.encode(r,qe.DEFAULT_EC_PERCENT,qe.DEFAULT_AZTEC_LAYERS)}static encode(r,s,o){let c=new vo(r).encode(),u=S.truncDivision(c.getSize()*s,100)+11,d=c.getSize()+u,h,x,w,v,I;if(o!==qe.DEFAULT_AZTEC_LAYERS){if(h=o<0,x=Math.abs(o),x>(h?qe.MAX_NB_BITS_COMPACT:qe.MAX_NB_BITS))throw new E(he.format("Illegal value %s for layers",o));w=qe.totalBitsInLayer(x,h),v=qe.WORD_SIZE[x];let se=w-w%v;if(I=qe.stuffBits(c,v),I.getSize()+u>se)throw new E("Data to large for user specified layer");if(h&&I.getSize()>v*64)throw new E("Data to large for user specified layer")}else{v=0,I=null;for(let se=0;;se++){if(se>qe.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(h=se<=3,x=h?se+1:se,w=qe.totalBitsInLayer(x,h),d>w)continue;(I==null||v!==qe.WORD_SIZE[x])&&(v=qe.WORD_SIZE[x],I=qe.stuffBits(c,v));let Qe=w-w%v;if(!(h&&I.getSize()>v*64)&&I.getSize()+u<=Qe)break}}let D=qe.generateCheckWords(I,w,v),L=I.getSize()/v,z=qe.generateModeMessage(h,x,L),H=(h?11:14)+x*4,Y=new Int32Array(H),$;if(h){$=H;for(let se=0;se<Y.length;se++)Y[se]=se}else{$=H+1+2*S.truncDivision(S.truncDivision(H,2)-1,15);let se=S.truncDivision(H,2),Qe=S.truncDivision($,2);for(let ze=0;ze<se;ze++){let vn=ze+S.truncDivision(ze,15);Y[se-ze-1]=Qe-vn-1,Y[se+ze]=Qe+vn+1}}let ce=new pe($);for(let se=0,Qe=0;se<x;se++){let ze=(x-se)*4+(h?9:12);for(let vn=0;vn<ze;vn++){let rr=vn*2;for(let Sn=0;Sn<2;Sn++)D.get(Qe+rr+Sn)&&ce.set(Y[se*2+Sn],Y[se*2+vn]),D.get(Qe+ze*2+rr+Sn)&&ce.set(Y[se*2+vn],Y[H-1-se*2-Sn]),D.get(Qe+ze*4+rr+Sn)&&ce.set(Y[H-1-se*2-Sn],Y[H-1-se*2-vn]),D.get(Qe+ze*6+rr+Sn)&&ce.set(Y[H-1-se*2-vn],Y[se*2+Sn])}Qe+=ze*8}if(qe.drawModeMessage(ce,h,$,z),h)qe.drawBullsEye(ce,S.truncDivision($,2),5);else{qe.drawBullsEye(ce,S.truncDivision($,2),7);for(let se=0,Qe=0;se<S.truncDivision(H,2)-1;se+=15,Qe+=16)for(let ze=S.truncDivision($,2)&1;ze<$;ze+=2)ce.set(S.truncDivision($,2)-Qe,ze),ce.set(S.truncDivision($,2)+Qe,ze),ce.set(ze,S.truncDivision($,2)-Qe),ce.set(ze,S.truncDivision($,2)+Qe)}let ue=new A0;return ue.setCompact(h),ue.setSize($),ue.setLayers(x),ue.setCodeWords(L),ue.setMatrix(ce),ue}static drawBullsEye(r,s,o){for(let c=0;c<o;c+=2)for(let u=s-c;u<=s+c;u++)r.set(u,s-c),r.set(u,s+c),r.set(s-c,u),r.set(s+c,u);r.set(s-o,s-o),r.set(s-o+1,s-o),r.set(s-o,s-o+1),r.set(s+o,s-o),r.set(s+o,s-o+1),r.set(s+o,s+o-1)}static generateModeMessage(r,s,o){let c=new O;return r?(c.appendBits(s-1,2),c.appendBits(o-1,6),c=qe.generateCheckWords(c,28,4)):(c.appendBits(s-1,5),c.appendBits(o-1,11),c=qe.generateCheckWords(c,40,4)),c}static drawModeMessage(r,s,o,c){let u=S.truncDivision(o,2);if(s)for(let d=0;d<7;d++){let h=u-3+d;c.get(d)&&r.set(h,u-5),c.get(d+7)&&r.set(u+5,h),c.get(20-d)&&r.set(h,u+5),c.get(27-d)&&r.set(u-5,h)}else for(let d=0;d<10;d++){let h=u-5+d+S.truncDivision(d,5);c.get(d)&&r.set(h,u-7),c.get(d+10)&&r.set(u+7,h),c.get(29-d)&&r.set(h,u+7),c.get(39-d)&&r.set(u-7,h)}}static generateCheckWords(r,s,o){let c=r.getSize()/o,u=new iu(qe.getGF(o)),d=S.truncDivision(s,o),h=qe.bitsToWords(r,o,d);u.encode(h,d-c);let x=s%o,w=new O;w.appendBits(0,x);for(const v of Array.from(h))w.appendBits(v,o);return w}static bitsToWords(r,s,o){let c=new Int32Array(o),u,d;for(u=0,d=r.getSize()/s;u<d;u++){let h=0;for(let x=0;x<s;x++)h|=r.get(u*s+x)?1<<s-x-1:0;c[u]=h}return c}static getGF(r){switch(r){case 4:return K.AZTEC_PARAM;case 6:return K.AZTEC_DATA_6;case 8:return K.AZTEC_DATA_8;case 10:return K.AZTEC_DATA_10;case 12:return K.AZTEC_DATA_12;default:throw new E("Unsupported word size "+r)}}static stuffBits(r,s){let o=new O,c=r.getSize(),u=(1<<s)-2;for(let d=0;d<c;d+=s){let h=0;for(let x=0;x<s;x++)(d+x>=c||r.get(d+x))&&(h|=1<<s-1-x);(h&u)===u?(o.appendBits(h&u,s),d--):h&u?o.appendBits(h,s):(o.appendBits(h|1,s),d--)}return o}static totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}qe.DEFAULT_EC_PERCENT=33,qe.DEFAULT_AZTEC_LAYERS=0,qe.MAX_NB_BITS=32,qe.MAX_NB_BITS_COMPACT=4,qe.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ya{encode(r,s,o,c){return this.encodeWithHints(r,s,o,c,null)}encodeWithHints(r,s,o,c,u){let d=ou.ISO_8859_1,h=qe.DEFAULT_EC_PERCENT,x=qe.DEFAULT_AZTEC_LAYERS;return u!=null&&(u.has(zt.CHARACTER_SET)&&(d=S0.forName(u.get(zt.CHARACTER_SET).toString())),u.has(zt.ERROR_CORRECTION)&&(h=S.parseInt(u.get(zt.ERROR_CORRECTION).toString())),u.has(zt.AZTEC_LAYERS)&&(x=S.parseInt(u.get(zt.AZTEC_LAYERS).toString()))),Ya.encodeLayers(r,s,o,c,d,h,x)}static encodeLayers(r,s,o,c,u,d,h){if(s!==ge.AZTEC)throw new E("Can only encode AZTEC, but got "+s);let x=qe.encode(he.getBytes(r,u),d,h);return Ya.renderResult(x,o,c)}static renderResult(r,s,o){let c=r.getMatrix();if(c==null)throw new je;let u=c.getWidth(),d=c.getHeight(),h=Math.max(s,u),x=Math.max(o,d),w=Math.min(h/u,x/d),v=(h-u*w)/2,I=(x-d*w)/2,D=new pe(h,x);for(let L=0,z=I;L<d;L++,z+=w)for(let H=0,Y=v;H<u;H++,Y+=w)c.get(H,L)&&D.setRegion(Y,z,w,w);return D}}n.AbstractExpandedDecoder=Qc,n.ArgumentException=C,n.ArithmeticException=Ge,n.AztecCode=A0,n.AztecCodeReader=J,n.AztecCodeWriter=Ya,n.AztecDecoder=Le,n.AztecDetector=$r,n.AztecDetectorResult=ki,n.AztecEncoder=qe,n.AztecHighLevelEncoder=vo,n.AztecPoint=ot,n.BarcodeFormat=ge,n.Binarizer=_,n.BinaryBitmap=A,n.BitArray=O,n.BitMatrix=pe,n.BitSource=qc,n.BrowserAztecCodeReader=ae,n.BrowserBarcodeReader=aw,n.BrowserCodeReader=st,n.BrowserDatamatrixCodeReader=cw,n.BrowserMultiFormatReader=Cw,n.BrowserPDF417Reader=Ew,n.BrowserQRCodeReader=vw,n.BrowserQRCodeSvgWriter=Vi,n.CharacterSetECI=G,n.ChecksumException=M,n.Code128Reader=ee,n.Code39Reader=be,n.DataMatrixDecodedBitStreamParser=ti,n.DataMatrixReader=ni,n.DecodeHintType=W,n.DecoderResult=Ut,n.DefaultGridSampler=et,n.DetectorResult=Zt,n.EAN13Reader=pr,n.EncodeHintType=zt,n.Exception=m,n.FormatException=U,n.GenericGF=K,n.GenericGFPoly=Ae,n.GlobalHistogramBinarizer=q,n.GridSampler=De,n.GridSamplerInstance=tt,n.HTMLCanvasElementLuminanceSource=oe,n.HybridBinarizer=re,n.ITFReader=Ie,n.IllegalArgumentException=E,n.IllegalStateException=je,n.InvertedLuminanceSource=fe,n.LuminanceSource=X,n.MathUtils=Fe,n.MultiFormatOneDReader=ds,n.MultiFormatReader=v0,n.MultiFormatWriter=Aw,n.NotFoundException=j,n.OneDReader=ye,n.PDF417DecodedBitStreamParser=Z,n.PDF417DecoderErrorCorrection=m0,n.PDF417Reader=qt,n.PDF417ResultMetadata=y0,n.PerspectiveTransform=Ve,n.PlanarYUVLuminanceSource=wr,n.QRCodeByteMatrix=Ha,n.QRCodeDataMask=Hn,n.QRCodeDecodedBitStreamParser=vt,n.QRCodeDecoderErrorCorrectionLevel=ht,n.QRCodeDecoderFormatInformation=sn,n.QRCodeEncoder=pt,n.QRCodeEncoderQRCode=Ui,n.QRCodeMaskUtil=Mt,n.QRCodeMatrixUtil=_e,n.QRCodeMode=Me,n.QRCodeReader=ri,n.QRCodeVersion=Ne,n.QRCodeWriter=hs,n.RGBLuminanceSource=su,n.RSS14Reader=Rt,n.RSSExpandedReader=ne,n.ReaderException=Wa,n.ReedSolomonDecoder=Oe,n.ReedSolomonEncoder=iu,n.ReedSolomonException=Be,n.Result=Ze,n.ResultMetadataType=ct,n.ResultPoint=xe,n.StringUtils=he,n.UnsupportedOperationException=te,n.VideoInputDevice=ve,n.WhiteRectangleDetector=ie,n.WriterException=dt,n.ZXingArrays=b,n.ZXingCharset=S0,n.ZXingInteger=S,n.ZXingStandardCharsets=ou,n.ZXingStringBuilder=de,n.ZXingStringEncoding=me,n.ZXingSystem=k,n.createAbstractExpandedDecoder=g0,Object.defineProperty(n,"__esModule",{value:!0})})})(vf,vf.exports);var xt=vf.exports;const Tb=Ap(xt),bb=Ow({__proto__:null,default:Tb},[xt]);var dp=function(){function e(t,n,i){if(this.formatMap=new Map([[Ce.QR_CODE,xt.BarcodeFormat.QR_CODE],[Ce.AZTEC,xt.BarcodeFormat.AZTEC],[Ce.CODABAR,xt.BarcodeFormat.CODABAR],[Ce.CODE_39,xt.BarcodeFormat.CODE_39],[Ce.CODE_93,xt.BarcodeFormat.CODE_93],[Ce.CODE_128,xt.BarcodeFormat.CODE_128],[Ce.DATA_MATRIX,xt.BarcodeFormat.DATA_MATRIX],[Ce.MAXICODE,xt.BarcodeFormat.MAXICODE],[Ce.ITF,xt.BarcodeFormat.ITF],[Ce.EAN_13,xt.BarcodeFormat.EAN_13],[Ce.EAN_8,xt.BarcodeFormat.EAN_8],[Ce.PDF_417,xt.BarcodeFormat.PDF_417],[Ce.RSS_14,xt.BarcodeFormat.RSS_14],[Ce.RSS_EXPANDED,xt.BarcodeFormat.RSS_EXPANDED],[Ce.UPC_A,xt.BarcodeFormat.UPC_A],[Ce.UPC_E,xt.BarcodeFormat.UPC_E],[Ce.UPC_EAN_EXTENSION,xt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!bb)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=i;var a=this.createZXingFormats(t),l=new Map;l.set(xt.DecodeHintType.POSSIBLE_FORMATS,a),l.set(xt.DecodeHintType.TRY_HARDER,!1),this.hints=l}return e.prototype.decodeAsync=function(t){var n=this;return new Promise(function(i,a){try{i(n.decode(t))}catch(l){a(l)}})},e.prototype.decode=function(t){var n=new xt.MultiFormatReader(this.verbose,this.hints),i=new xt.HTMLCanvasElementLuminanceSource(t),a=new xt.BinaryBitmap(new xt.HybridBinarizer(i)),l=n.decode(a);return{text:l.text,format:Gy.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,i,a){t.set(n,i)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var n=[],i=0,a=t;i<a.length;i++){var l=a[i];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return n},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),Ib=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},Nb=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},fp=function(){function e(t,n,i){if(this.formatMap=new Map([[Ce.QR_CODE,"qr_code"],[Ce.AZTEC,"aztec"],[Ce.CODABAR,"codabar"],[Ce.CODE_39,"code_39"],[Ce.CODE_93,"code_93"],[Ce.CODE_128,"code_128"],[Ce.DATA_MATRIX,"data_matrix"],[Ce.ITF,"itf"],[Ce.EAN_13,"ean_13"],[Ce.EAN_8,"ean_8"],[Ce.PDF_417,"pdf417"],[Ce.UPC_A,"upc_a"],[Ce.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=i;var a=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return Ib(this,void 0,void 0,function(){var n,i;return Nb(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(t)];case 1:if(n=a.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(n),[2,{text:i.rawValue,format:Gy.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var n=null,i=0,a=0,l=t;a<l.length;a++){var f=l[a],g=f.boundingBox.width*f.boundingBox.height;g>i&&(i=g,n=f)}if(!n)throw"No largest barcode found";return n},e.prototype.createBarcodeDetectorFormats=function(t){for(var n=[],i=0,a=t;i<a.length;i++){var l=a[i];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(n,i,a){t.set(n,i)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),hp=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},gp=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Rb=function(){function e(t,n,i,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,n&&fp.isSupported()?(this.primaryDecoder=new fp(t,i,a),this.secondaryDecoder=new dp(t,i,a)):this.primaryDecoder=new dp(t,i,a)}return e.prototype.decodeAsync=function(t){return hp(this,void 0,void 0,function(){var n;return gp(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return hp(this,void 0,void 0,function(){var n,i;return gp(this,function(a){switch(a.label){case 0:n=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,a.sent()];case 3:if(i=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw i;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var n=performance.now()-t;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,n=0,i=this.executionResults;n<i.length;n++){var a=i[n];t+=a}var l=t/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),f0=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),pc=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},mc=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Ky=function(){function e(t,n){this.name=t,this.track=n}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var n={};n[this.name]=t;var i={advanced:[n]};return this.track.applyConstraints(i)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var n=t[this.name];return n}return null},e}(),Mb=function(e){f0(t,e);function t(n,i){return e.call(this,n,i)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(n){var i={};i[this.name]=n;var a={advanced:[i]};return this.track.applyConstraints(a)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),i=n[this.name];return{min:i.min,max:i.max,step:i.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(Ky),Db=function(e){f0(t,e);function t(n){return e.call(this,"zoom",n)||this}return t}(Mb),_b=function(e){f0(t,e);function t(n){return e.call(this,"torch",n)||this}return t}(Ky),Ob=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new Db(this.track)},e.prototype.torchFeature=function(){return new _b(this.track)},e}(),kb=function(){function e(t,n,i){this.isClosed=!1,this.parentElement=t,this.mediaStream=n,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var n=document.createElement("video");return n.style.width="".concat(t,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var i=t.surface.clientWidth,a=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(i,a),t.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,n,i,a){return pc(this,void 0,void 0,function(){var l,f;return mc(this,function(g){switch(g.label){case 0:return l=new e(t,n,a),i.aspectRatio?(f={aspectRatio:i.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(f)]):[3,2];case 1:g.sent(),g.label=2;case 2:return l.setupSurface(),[2,l]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var n=this,i=function(){setTimeout(t,200),n.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return pc(this,void 0,void 0,function(){return mc(this,function(n){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(n,i){var a=t.mediaStream.getVideoTracks(),l=a.length,f=0;t.mediaStream.getVideoTracks().forEach(function(g){t.mediaStream.removeTrack(g),g.stop(),++f,f>=l&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),n())})})},e.prototype.getCapabilities=function(){return new Ob(this.getFirstTrackOrFail())},e}(),Pb=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,n,i){return pc(this,void 0,void 0,function(){return mc(this,function(a){return[2,kb.create(t,this.mediaStream,n,i)]})})},e.create=function(t){return pc(this,void 0,void 0,function(){var n,i;return mc(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return i=a.sent(),[2,new e(i)]}})})},e}(),pp=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},mp=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Lb=function(){function e(){}return e.failIfNotSupported=function(){return pp(this,void 0,void 0,function(){return mp(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return pp(this,void 0,void 0,function(){return mp(this,function(n){return[2,Pb.create(t)]})})},e}(),Bb=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},jb=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Fb=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Ls.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Ls.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return Bb(this,void 0,void 0,function(){var t,n,i,a,l,f,g;return jb(this,function(p){switch(p.label){case 0:return t=function(m){for(var C=m.getVideoTracks(),E=0,A=C;E<A.length;E++){var M=A[E];M.enabled=!1,M.stop(),m.removeTrack(M)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=p.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=p.sent(),a=[],l=0,f=i;l<f.length;l++)g=f[l],g.kind==="videoinput"&&a.push({id:g.deviceId,label:g.label});return t(n),[2,a]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,n){var i=function(l){for(var f=[],g=0,p=l;g<p.length;g++){var m=p[g];m.kind==="video"&&f.push({id:m.id,label:m.label})}t(f)},a=MediaStreamTrack;a.getSources(i)})},e}(),Dt;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Dt||(Dt={}));var Ub=function(){function e(){this.state=Dt.NOT_STARTED,this.onGoingTransactionNewState=Dt.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Dt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Dt.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Dt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Dt.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Dt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case Dt.UNKNOWN:throw"Transition from unknown is not allowed";case Dt.NOT_STARTED:this.failIfNewStateIs(t,[Dt.PAUSED]);break;case Dt.SCANNING:break;case Dt.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,n){for(var i=0,a=n;i<a.length;i++){var l=a[i];if(t===l)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),Vb=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Dt.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Dt.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Dt.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Dt.PAUSED},e}(),zb=function(){function e(){}return e.create=function(){return new Vb(new Ub)},e}(),Wb=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},e(t,n)};return function(t,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),On=function(e){Wb(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(lr),Hb=function(){function e(t,n){this.logger=n,this.fps=On.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=On.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Qy.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Ar(this.qrbox)},e.create=function(t,n){return new e(t,n)},e}(),xp=function(){function e(t,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var i;typeof n=="boolean"?this.verbose=n===!0:n&&(i=n,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new Xy(this.verbose),this.qrcode=new Rb(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=zb.create()}return e.prototype.start=function(t,n,i,a){var l=this;if(!t)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var f;a?f=a:f=this.verbose?this.logger.log:function(){};var g=Hb.create(n,this.logger);this.clearElement();var p=!1;g.videoConstraints&&(g.isMediaStreamConstraintsValid()?p=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=p,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:On.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var E=this,A=this.stateManagerProxy.startTransition(Dt.SCANNING);return new Promise(function(M,_){var k=m?g.videoConstraints:E.createVideoConstraints(t);if(!k){A.cancel(),_("videoConstraints should be defined");return}var V={};(!m||g.aspectRatio)&&(V.aspectRatio=g.aspectRatio);var N={onRenderSurfaceReady:function(b,S){E.setupUi(b,S,g),E.isScanning=!0,E.foreverScan(g,i,f)}};Lb.failIfNotSupported().then(function(b){b.create(k).then(function(S){return S.render(l.element,V,N).then(function(O){E.renderedCamera=O,A.execute(),M(null)}).catch(function(O){A.cancel(),_(O)})}).catch(function(S){A.cancel(),_(Ls.errorGettingUserMedia(S))})}).catch(function(b){A.cancel(),_(Ls.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Dt.PAUSED),this.showPausedState(),(Ar(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,n=function(){t.stateManagerProxy.directTransition(Dt.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Dt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(t.element){var l=document.getElementById(On.SHADED_REGION_ELEMENT_ID);l&&t.element.removeChild(l)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),i(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),n.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,n){return this.scanFileV2(t,n).then(function(i){return i.decodedText})},e.prototype.scanFileV2=function(t,n){var i=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Ar(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,l){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(t);var f=new Image;f.onload=function(){var g=f.width,p=f.height,m=document.getElementById(i.elementId),C=m.clientWidth?m.clientWidth:On.DEFAULT_WIDTH,E=Math.max(m.clientHeight?m.clientHeight:p,On.FILE_SCAN_MIN_HEIGHT),A=i.computeCanvasDrawConfig(g,p,C,E);if(n){var M=i.createCanvasElement(C,E,"qr-canvas-visible");M.style.display="inline-block",m.appendChild(M);var _=M.getContext("2d");if(!_)throw"Unable to get 2d context from canvas";_.canvas.width=C,_.canvas.height=E,_.drawImage(f,0,0,g,p,A.x,A.y,A.width,A.height)}var k=On.FILE_SCAN_HIDDEN_CANVAS_PADDING,V=Math.max(f.width,A.width),N=Math.max(f.height,A.height),b=V+2*k,S=N+2*k,O=i.createCanvasElement(b,S);m.appendChild(O);var F=O.getContext("2d");if(!F)throw"Unable to get 2d context from canvas";F.canvas.width=b,F.canvas.height=S,F.drawImage(f,0,0,g,p,k,k,V,N);try{i.qrcode.decodeRobustlyAsync(O).then(function(W){a(cp.createFromQrcodeResult(W))}).catch(l)}catch(W){l("QR code parse error, error = ".concat(W))}},f.onerror=l,f.onabort=l,f.onstalled=l,f.onsuspend=l,f.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return Fb.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!Qy.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var n=[Ce.QR_CODE,Ce.AZTEC,Ce.CODABAR,Ce.CODE_39,Ce.CODE_93,Ce.CODE_128,Ce.DATA_MATRIX,Ce.MAXICODE,Ce.ITF,Ce.EAN_13,Ce.EAN_8,Ce.PDF_417,Ce.RSS_14,Ce.RSS_EXPANDED,Ce.UPC_A,Ce.UPC_E,Ce.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return n;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],a=0,l=t.formatsToSupport;a<l.length;a++){var f=l[a];Sb(f)?i.push(f):this.logger.warn("Invalid format: ".concat(f," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(Ar(t))return!0;if(!Ar(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(Ar(t.experimentalFeatures))return!0;var n=t.experimentalFeatures;return Ar(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,n,i){var a=this,l=i.qrbox;this.validateQrboxConfig(l);var f=this.toQrdimensions(t,n,l),g=function(m){if(m<On.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(On.MIN_QR_BOX_SIZE,"px.")},p=function(m){return m>t&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=t),m};g(f.width),g(f.height),f.width=p(f.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,n,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(t,n)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return i},e.prototype.setupUi=function(t,n,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(t,n,i);var a=Ar(i.qrbox)?{width:t,height:n}:i.qrbox;this.validateQrboxConfig(a);var l=this.toQrdimensions(t,n,a);l.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var f=i.isShadedBoxEnabled()&&l.height<=n,g={x:0,y:0,width:t,height:n},p=f?this.getShadedRegionBounds(t,n,l):g,m=this.createCanvasElement(p.width,p.height),C={willReadFrequently:!0},E=m.getContext("2d",C);E.canvas.width=p.width,E.canvas.height=p.height,this.element.append(m),f&&this.possiblyInsertShadingElement(this.element,t,n,l),this.createScannerPausedUiElement(this.element),this.qrRegion=p,this.context=E,this.canvasElement=m},e.prototype.createScannerPausedUiElement=function(t){var n=document.createElement("div");n.innerText=Ls.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",t.appendChild(n),this.scannerPausedUiElement=n},e.prototype.scanContext=function(t,n){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return t(a.text,cp.createFromQrcodeResult(a)),i.possiblyUpdateShaders(!0),!0}).catch(function(a){i.possiblyUpdateShaders(!1);var l=Ls.codeParseError(a);return n(l,Yy.createFrom(l)),!1})},e.prototype.foreverScan=function(t,n,i){var a=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),f=l.videoWidth/l.clientWidth,g=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var p=this.qrRegion.width*f,m=this.qrRegion.height*g,C=this.qrRegion.x*f,E=this.qrRegion.y*g;this.context.drawImage(l,C,E,p,m,0,0,this.qrRegion.width,this.qrRegion.height);var A=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(t,n,i)},a.getTimeoutFps(t.fps))};this.scanContext(n,i).then(function(M){!M&&t.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(n,i).finally(function(){A()})):A()}).catch(function(M){a.logger.logError("Error happend while scanning context",M),A()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var n="facingMode",i="deviceId",a={user:!0,environment:!0},l="exact",f=function(_){if(_ in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(_,"'")},g=Object.keys(t);if(g.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(g.length," keys");var p=Object.keys(t)[0];if(p!==n&&p!==i)throw"Only '".concat(n,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(p===n){var m=t.facingMode;if(typeof m=="string"){if(f(m))return{facingMode:m}}else if(typeof m=="object")if(l in m){if(f(m["".concat(l)]))return{facingMode:{exact:m["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var C=typeof m;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var E=t.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(l in E)return{deviceId:{exact:E["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var A=typeof E;throw"Invalid type of 'deviceId' = ".concat(A)}}}var M=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(M)},e.prototype.computeCanvasDrawConfig=function(t,n,i,a){if(t<=i&&n<=a){var l=(i-t)/2,f=(a-n)/2;return{x:l,y:f,width:t,height:n}}else{var g=t,p=n;return t>i&&(n=i/t*n,t=i),n>a&&(t=a/n*t,n=a),this.logger.log("Image downsampled from "+"".concat(g,"X").concat(p)+" to ".concat(t,"X").concat(n,".")),this.computeCanvasDrawConfig(t,n,i,a)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=t?On.BORDER_SHADER_MATCH_COLOR:On.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,n,i){var a=t,l=n,f=document.createElement("canvas");return f.style.width="".concat(a,"px"),f.style.height="".concat(l,"px"),f.style.display="none",f.id=Ar(i)?"qr-canvas":i,f},e.prototype.getShadedRegionBounds=function(t,n,i){if(i.width>t||i.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-i.width)/2,y:(n-i.height)/2,width:i.width,height:i.height}},e.prototype.possiblyInsertShadingElement=function(t,n,i,a){if(!(n-a.width<1||i-a.height<1)){var l=document.createElement("div");l.style.position="absolute";var f=(n-a.width)/2,g=(i-a.height)/2;if(l.style.borderLeft="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(On.SHADED_REGION_ELEMENT_ID),n-a.width<11||i-a.height<11)this.hasBorderShaders=!1;else{var p=5,m=40;this.insertShaderBorders(l,m,p,-p,null,0,!0),this.insertShaderBorders(l,m,p,-p,null,0,!1),this.insertShaderBorders(l,m,p,null,-p,0,!0),this.insertShaderBorders(l,m,p,null,-p,0,!1),this.insertShaderBorders(l,p,m+p,-p,null,-p,!0),this.insertShaderBorders(l,p,m+p,null,-p,-p,!0),this.insertShaderBorders(l,p,m+p,-p,null,-p,!1),this.insertShaderBorders(l,p,m+p,null,-p,-p,!1),this.hasBorderShaders=!0}t.append(l)}},e.prototype.insertShaderBorders=function(t,n,i,a,l,f,g){var p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor=On.BORDER_SHADER_DEFAULT_COLOR,p.style.width="".concat(n,"px"),p.style.height="".concat(i,"px"),a!==null&&(p.style.top="".concat(a,"px")),l!==null&&(p.style.bottom="".concat(l,"px")),g?p.style.left="".concat(f,"px"):p.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(p),t.appendChild(p)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),h0="data:image/svg+xml;base64,",Gb=h0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",Yb=h0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",yp=h0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",Xb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",wp=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),Qb=function(){function e(){this.data=wp.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(t){this.data.hasPermission=t,this.flush()},e.prototype.setLastUsedCameraId=function(t){this.data.lastUsedCameraId=t,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=wp.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),Kb=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(t){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=up.poweredBy();var n=document.createElement("a");n.innerText="ScanApp",n.href="https://scanapp.org",n.target="new",n.style.color="white",this.infoDiv.appendChild(n);var i=document.createElement("br"),a=document.createElement("br");this.infoDiv.appendChild(i),this.infoDiv.appendChild(a);var l=document.createElement("a");l.innerText=up.reportIssues(),l.href="https://github.com/mebjas/html5-qrcode/issues",l.target="new",l.style.color="white",this.infoDiv.appendChild(l),t.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),Zb=function(){function e(t,n){this.isShowingInfoIcon=!0,this.onTapIn=t,this.onTapOut=n,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(t){var n=this;this.infoIcon.alt="Info icon",this.infoIcon.src=yp,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(i){return n.onHoverIn()},this.infoIcon.onmouseout=function(i){return n.onHoverOut()},this.infoIcon.onclick=function(i){return n.onClick()},t.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=Xb,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=yp,this.infoIcon.style.opacity="0.6")},e}(),$b=function(){function e(){var t=this;this.infoDiv=new Kb,this.infoIcon=new Zb(function(){t.infoDiv.show()},function(){t.infoDiv.hide()})}return e.prototype.renderInto=function(t){this.infoDiv.renderInto(t),this.infoIcon.renderInto(t)},e}(),qb=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},Jb=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Cp=function(){function e(){}return e.hasPermissions=function(){return qb(this,void 0,void 0,function(){var t,n,i,a;return Jb(this,function(l){switch(l.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(t=l.sent(),n=0,i=t;n<i.length;n++)if(a=i[n],a.kind==="videoinput"&&a.label)return[2,!0];return[2,!1]}})})},e}(),ai=function(){function e(t){this.supportedScanTypes=this.validateAndReturnScanTypes(t)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,n=this.supportedScanTypes;t<n.length;t++){var i=n[t];if(e.isCameraScanType(i))return!0}return!1},e.isCameraScanType=function(t){return t===Qr.SCAN_TYPE_CAMERA},e.isFileScanType=function(t){return t===Qr.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(t){if(!t||t.length===0)return lr.DEFAULT_SUPPORTED_SCAN_TYPE;var n=lr.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(t.length>n)throw"Max ".concat(n," values expected for ")+"supportedScanTypes";for(var i=0,a=t;i<a.length;i++){var l=a[i];if(!lr.DEFAULT_SUPPORTED_SCAN_TYPE.includes(l))throw"Unsupported scan type ".concat(l)}return t},e}(),Ln=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),jr=function(){function e(){}return e.createElement=function(t,n){var i=document.createElement(t);return i.id=n,i.classList.add(Ln.ALL_ELEMENT_CLASS),t==="button"&&i.setAttribute("type","button"),i},e}(),Zy=globalThis&&globalThis.__awaiter||function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function g(C){try{m(i.next(C))}catch(E){f(E)}}function p(C){try{m(i.throw(C))}catch(E){f(E)}}function m(C){C.done?l(C.value):a(C.value).then(g,p)}m((i=i.apply(e,t||[])).next())})},$y=globalThis&&globalThis.__generator||function(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(C){return p([m,C])}}function p(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Ep=function(){function e(t,n,i){this.isTorchOn=!1,this.torchCapability=t,this.buttonController=n,this.onTorchActionFailureCallback=i}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return Zy(this,void 0,void 0,function(){var t,n;return $y(this,function(i){switch(i.label){case 0:this.buttonController.disable(),t=!this.isTorchOn,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.torchCapability.apply(t)];case 2:return i.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),t),[3,4];case 3:return n=i.sent(),this.propagateFailure(t,n),this.buttonController.enable(),[3,4];case 4:return[2]}})})},e.prototype.updateUiBasedOnLatestSettings=function(t,n){t===n?(this.buttonController.setText(n?at.torchOffButton():at.torchOnButton()),this.isTorchOn=n):this.propagateFailure(n),this.buttonController.enable()},e.prototype.propagateFailure=function(t,n){var i=t?at.torchOnFailedMessage():at.torchOffFailedMessage();n&&(i+="; Error = "+n),this.onTorchActionFailureCallback(i)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),eI=function(){function e(t,n){this.onTorchActionFailureCallback=n,this.torchButton=jr.createElement("button",Ln.TORCH_BUTTON_ID),this.torchController=new Ep(t,this,n)}return e.prototype.render=function(t,n){var i=this;this.torchButton.innerText=at.torchOnButton(),this.torchButton.style.display=n.display,this.torchButton.style.marginLeft=n.marginLeft;var a=this;this.torchButton.addEventListener("click",function(l){return Zy(i,void 0,void 0,function(){return $y(this,function(f){switch(f.label){case 0:return[4,a.torchController.flipState()];case 1:return f.sent(),a.torchController.isTorchEnabled()?(a.torchButton.classList.remove(Ln.TORCH_BUTTON_CLASS_TORCH_OFF),a.torchButton.classList.add(Ln.TORCH_BUTTON_CLASS_TORCH_ON)):(a.torchButton.classList.remove(Ln.TORCH_BUTTON_CLASS_TORCH_ON),a.torchButton.classList.add(Ln.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),t.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(t){this.torchController=new Ep(t,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(t){this.torchButton.innerText=t},e.prototype.reset=function(){this.torchButton.innerText=at.torchOnButton(),this.torchController.reset()},e.create=function(t,n,i,a){var l=new e(n,a);return l.render(t,i),l},e}(),tI=function(){function e(t,n,i){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=n?"block":"none",t.appendChild(this.fileBasedScanRegion);var a=document.createElement("label");a.setAttribute("for",this.getFileScanInputId()),a.style.display="inline-block",this.fileBasedScanRegion.appendChild(a),this.fileSelectionButton=jr.createElement("button",Ln.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(g){a.click()}),a.append(this.fileSelectionButton),this.fileScanInput=jr.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",a.appendChild(this.fileScanInput);var l=this;this.fileScanInput.addEventListener("change",function(g){if(!(g==null||g.target==null)){var p=g.target;if(!(p.files&&p.files.length===0)){var m=p.files,C=m[0],E=C.name;l.setImageNameToButton(E),i(C)}}});var f=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(f),this.fileBasedScanRegion.addEventListener("dragenter",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(g){l.fileBasedScanRegion.style.border=l.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(g){g.stopPropagation(),g.preventDefault(),l.fileBasedScanRegion.style.border=l.fileBasedScanRegionDefaultBorder();var p=g.dataTransfer;if(p){var m=p.files;if(!m||m.length===0)return;for(var C=!1,E=0;E<m.length;++E){var A=m.item(E);if(A){var M=/image.*/;if(A.type.match(M)){C=!0;var _=A.name;l.setImageNameToButton(_),i(A),f.innerText=at.dragAndDropMessage();break}}}C||(f.innerText=at.dragAndDropMessageOnlyImages())}})}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var t=document.createElement("div");return t.style.textAlign="center",t.style.margin="auto",t.style.width="80%",t.style.maxWidth="600px",t.style.border=this.fileBasedScanRegionDefaultBorder(),t.style.padding="10px",t.style.marginBottom="10px",t},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var t=document.createElement("div");return t.innerText=at.dragAndDropMessage(),t.style.fontWeight="400",t},e.prototype.setImageNameToButton=function(t){var n=20;if(t.length>n){var i=t.substring(0,8),a=t.length,l=t.substring(a-8,a);t="".concat(i,"....").concat(l)}var f=at.fileSelectionChooseAnother()+" - "+t;this.fileSelectionButton.innerText=f},e.prototype.setInitialValueToButton=function(){var t=at.fileSelectionChooseImage()+" - "+at.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=t},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,n,i){var a=new e(t,n,i);return a},e}(),nI=function(){function e(t){this.selectElement=jr.createElement("select",Ln.CAMERA_SELECTION_SELECT_ID),this.cameras=t,this.options=[]}return e.prototype.render=function(t){var n=document.createElement("span");n.style.marginRight="10px";var i=this.cameras.length;if(i===0)throw new Error("No cameras found");if(i===1)n.style.display="none";else{var a=at.selectCamera();n.innerText="".concat(a," (").concat(this.cameras.length,")  ")}for(var l=1,f=0,g=this.cameras;f<g.length;f++){var p=g[f],m=p.id,C=p.label==null?m:p.label;(!C||C==="")&&(C=[at.anonymousCameraPrefix(),l++].join(" "));var E=document.createElement("option");E.value=m,E.innerText=C,this.options.push(E),this.selectElement.appendChild(E)}n.appendChild(this.selectElement),t.appendChild(n)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return this.selectElement.disabled===!0},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(t){for(var n=0,i=this.options;n<i.length;n++){var a=i[n];if(a.value===t)return!0}return!1},e.prototype.setValue=function(t){if(!this.hasValue(t))throw new Error("".concat(t," is not present in the camera list."));this.selectElement.value=t},e.prototype.hasSingleItem=function(){return this.cameras.length===1},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,n){var i=new e(n);return i.render(t),i},e}(),rI=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=jr.createElement("input",Ln.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(t,n){this.zoomElementContainer.style.display=n?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",t.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var i=at.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(i),this.rangeText.style.marginRight="10px";var a=this;this.rangeInput.addEventListener("input",function(){return a.onValueChange()}),this.rangeInput.addEventListener("change",function(){return a.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var t=at.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(t),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(t,n,i,a){this.rangeInput.min=t.toString(),this.rangeInput.max=n.toString(),this.rangeInput.step=a.toString(),this.rangeInput.value=i.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(t){this.onChangeCallback=t},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,n){var i=new e;return i.render(t,n),i},e}(),kn;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(kn||(kn={}));function iI(e){return{fps:e.fps,qrbox:e.qrbox,aspectRatio:e.aspectRatio,disableFlip:e.disableFlip,videoConstraints:e.videoConstraints}}function sI(e,t){return{formatsToSupport:e.formatsToSupport,useBarCodeDetectorIfSupported:e.useBarCodeDetectorIfSupported,experimentalFeatures:e.experimentalFeatures,verbose:t}}var oI=function(){function e(t,n,i){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=t,this.config=this.createConfig(n),this.verbose=i===!0,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.scanTypeSelector=new ai(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new Xy(this.verbose),this.persistedDataManager=new Qb,n.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return e.prototype.render=function(t,n){var i=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(l,f){if(t)t(l,f);else{if(i.lastMatchFound===l)return;i.lastMatchFound=l,i.setHeaderMessage(at.lastMatch(l),kn.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(l,f){n&&n(l,f)};var a=document.getElementById(this.elementId);if(!a)throw"HTML Element with id=".concat(this.elementId," not found");a.innerHTML="",this.createBasicLayout(a),this.html5Qrcode=new xp(this.getScanRegionId(),sI(this.config,this.verbose))},e.prototype.pause=function(t){(Ar(t)||t!==!0)&&(t=!1),this.getHtml5QrcodeOrFail().pause(t)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var t=this,n=function(){var i=document.getElementById(t.elementId);i&&(i.innerHTML="",t.resetBasicLayout(i))};return this.html5Qrcode?new Promise(function(i,a){if(!t.html5Qrcode){i();return}t.html5Qrcode.isScanning?t.html5Qrcode.stop().then(function(l){if(!t.html5Qrcode){i();return}t.html5Qrcode.clear(),n(),i()}).catch(function(l){t.verbose&&t.logger.logError("Unable to stop qrcode scanner",l),a(l)}):(t.html5Qrcode.clear(),n(),i())}):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(t){return this.getHtml5QrcodeOrFail().applyVideoConstraints(t)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(t){return t?(t.fps||(t.fps=lr.SCAN_DEFAULT_FPS),t.rememberLastUsedCamera!==!lr.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(t.rememberLastUsedCamera=lr.DEFAULT_REMEMBER_LAST_CAMERA_USED),t.supportedScanTypes||(t.supportedScanTypes=lr.DEFAULT_SUPPORTED_SCAN_TYPE),t):{fps:lr.SCAN_DEFAULT_FPS,rememberLastUsedCamera:lr.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:lr.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(t){t.style.position="relative",t.style.padding="0px",t.style.border="1px solid silver",this.createHeader(t);var n=document.createElement("div"),i=this.getScanRegionId();n.id=i,n.style.width="100%",n.style.minHeight="100px",n.style.textAlign="center",t.appendChild(n),ai.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var a=document.createElement("div"),l=this.getDashboardId();a.id=l,a.style.width="100%",t.appendChild(a),this.setupInitialDashboard(a)},e.prototype.resetBasicLayout=function(t){t.style.border="none"},e.prototype.setupInitialDashboard=function(t){this.createSection(t),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(t){var n=document.createElement("div");n.style.textAlign="left",n.style.margin="0px",t.appendChild(n);var i=new $b;i.renderInto(n);var a=document.createElement("div");a.id=this.getHeaderMessageContainerId(),a.style.display="none",a.style.textAlign="center",a.style.fontSize="14px",a.style.padding="2px 10px",a.style.margin="4px",a.style.borderTop="1px solid #f6f6f6",n.appendChild(a)},e.prototype.createSection=function(t){var n=document.createElement("div");n.id=this.getDashboardSectionId(),n.style.width="100%",n.style.padding="10px 0px 10px 0px",n.style.textAlign="left",t.appendChild(n)},e.prototype.createCameraListUi=function(t,n,i){var a=this;a.showHideScanTypeSwapLink(!1),a.setHeaderMessage(at.cameraPermissionRequesting());var l=function(){i||a.createPermissionButton(t,n)};xp.getCameras().then(function(f){a.persistedDataManager.setHasPermission(!0),a.showHideScanTypeSwapLink(!0),a.resetHeaderMessage(),f&&f.length>0?(t.removeChild(n),a.renderCameraSelection(f)):(a.setHeaderMessage(at.noCameraFound(),kn.STATUS_WARNING),l())}).catch(function(f){a.persistedDataManager.setHasPermission(!1),i?i.disabled=!1:l(),a.setHeaderMessage(f,kn.STATUS_WARNING),a.showHideScanTypeSwapLink(!0)})},e.prototype.createPermissionButton=function(t,n){var i=this,a=jr.createElement("button",this.getCameraPermissionButtonId());a.innerText=at.cameraPermissionTitle(),a.addEventListener("click",function(){a.disabled=!0,i.createCameraListUi(t,n,a)}),n.appendChild(a)},e.prototype.createPermissionsUi=function(t,n){var i=this;if(ai.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){Cp.hasPermissions().then(function(a){a?i.createCameraListUi(t,n):(i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(t,n))}).catch(function(a){i.persistedDataManager.setHasPermission(!1),i.createPermissionButton(t,n)});return}this.createPermissionButton(t,n)},e.prototype.createSectionControlPanel=function(){var t=document.getElementById(this.getDashboardSectionId()),n=document.createElement("div");t.appendChild(n);var i=document.createElement("div");i.id=this.getDashboardSectionCameraScanRegionId(),i.style.display=ai.isCameraScanType(this.currentScanType)?"block":"none",n.appendChild(i);var a=document.createElement("div");a.style.textAlign="center",i.appendChild(a),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(i,a),this.renderFileScanUi(n)},e.prototype.renderFileScanUi=function(t){var n=ai.isFileScanType(this.currentScanType),i=this,a=function(l){if(!i.html5Qrcode)throw"html5Qrcode not defined";ai.isFileScanType(i.currentScanType)&&(i.setHeaderMessage(at.loadingImage()),i.html5Qrcode.scanFileV2(l,!0).then(function(f){i.resetHeaderMessage(),i.qrCodeSuccessCallback(f.decodedText,f)}).catch(function(f){i.setHeaderMessage(f,kn.STATUS_WARNING),i.qrCodeErrorCallback(f,Yy.createFrom(f))}))};this.fileSelectionUi=tI.create(t,n,a)},e.prototype.renderCameraSelection=function(t){var n=this,i=this,a=document.getElementById(this.getDashboardSectionCameraScanRegionId());a.style.textAlign="center";var l=rI.create(a,!1),f=function(k){var V=k.zoomFeature();if(V.isSupported()){l.setOnCameraZoomValueChangeCallback(function(b){V.apply(b)});var N=1;n.config.defaultZoomValueIfSupported&&(N=n.config.defaultZoomValueIfSupported),N=Ab(N,V.min(),V.max()),l.setValues(V.min(),V.max(),N,V.step()),l.show()}},g=nI.create(a,t),p=document.createElement("span"),m=jr.createElement("button",Ln.CAMERA_START_BUTTON_ID);m.innerText=at.scanButtonStartScanningText(),p.appendChild(m);var C=jr.createElement("button",Ln.CAMERA_STOP_BUTTON_ID);C.innerText=at.scanButtonStopScanningText(),C.style.display="none",C.disabled=!0,p.appendChild(C);var E,A=function(k){if(!k.torchFeature().isSupported()){E&&E.hide();return}E?E.updateTorchCapability(k.torchFeature()):E=eI.create(p,k.torchFeature(),{display:"none",marginLeft:"5px"},function(V){i.setHeaderMessage(V,kn.STATUS_WARNING)}),E.show()};a.appendChild(p);var M=function(k){k||(m.style.display="none"),m.innerText=at.scanButtonStartScanningText(),m.style.opacity="1",m.disabled=!1,k&&(m.style.display="inline-block")};if(m.addEventListener("click",function(k){m.innerText=at.scanButtonScanningStarting(),g.disable(),m.disabled=!0,m.style.opacity="0.5",n.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!1),i.resetHeaderMessage();var V=g.getValue();i.persistedDataManager.setLastUsedCameraId(V),i.html5Qrcode.start(V,iI(i.config),i.qrCodeSuccessCallback,i.qrCodeErrorCallback).then(function(N){C.disabled=!1,C.style.display="inline-block",M(!1);var b=i.html5Qrcode.getRunningTrackCameraCapabilities();n.config.showTorchButtonIfSupported===!0&&A(b),n.config.showZoomSliderIfSupported===!0&&f(b)}).catch(function(N){i.showHideScanTypeSwapLink(!0),g.enable(),M(!0),i.setHeaderMessage(N,kn.STATUS_WARNING)})}),g.hasSingleItem()&&m.click(),C.addEventListener("click",function(k){if(!i.html5Qrcode)throw"html5Qrcode not defined";C.disabled=!0,i.html5Qrcode.stop().then(function(V){n.scanTypeSelector.hasMoreThanOneScanType()&&i.showHideScanTypeSwapLink(!0),g.enable(),m.disabled=!1,C.style.display="none",m.style.display="inline-block",E&&(E.reset(),E.hide()),l.removeOnCameraZoomValueChangeCallback(),l.hide(),i.insertCameraScanImageToScanRegion()}).catch(function(V){C.disabled=!1,i.setHeaderMessage(V,kn.STATUS_WARNING)})}),i.persistedDataManager.getLastUsedCameraId()){var _=i.persistedDataManager.getLastUsedCameraId();g.hasValue(_)?(g.setValue(_),m.click()):i.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var t=this,n=at.textIfCameraScanSelected(),i=at.textIfFileScanSelected(),a=document.getElementById(this.getDashboardSectionId()),l=document.createElement("div");l.style.textAlign="center";var f=jr.createElement("span",this.getDashboardSectionSwapLinkId());f.style.textDecoration="underline",f.style.cursor="pointer",f.innerText=ai.isCameraScanType(this.currentScanType)?n:i,f.addEventListener("click",function(){if(!t.sectionSwapAllowed){t.verbose&&t.logger.logError("Section swap called when not allowed");return}t.resetHeaderMessage(),t.fileSelectionUi.resetValue(),t.sectionSwapAllowed=!1,ai.isCameraScanType(t.currentScanType)?(t.clearScanRegion(),t.getCameraScanRegion().style.display="none",t.fileSelectionUi.show(),f.innerText=i,t.currentScanType=Qr.SCAN_TYPE_FILE,t.insertFileScanImageToScanRegion()):(t.clearScanRegion(),t.getCameraScanRegion().style.display="block",t.fileSelectionUi.hide(),f.innerText=n,t.currentScanType=Qr.SCAN_TYPE_CAMERA,t.insertCameraScanImageToScanRegion(),t.startCameraScanIfPermissionExistsOnSwap()),t.sectionSwapAllowed=!0}),l.appendChild(f),a.appendChild(l)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var t=this,n=this;if(this.persistedDataManager.hasCameraPermissions()){Cp.hasPermissions().then(function(i){if(i){var a=document.getElementById(n.getCameraPermissionButtonId());if(!a)throw t.logger.logError("Permission button not found, fail;"),"Permission button not found";a.click()}else n.persistedDataManager.setHasPermission(!1)}).catch(function(i){n.persistedDataManager.setHasPermission(!1)});return}},e.prototype.resetHeaderMessage=function(){var t=document.getElementById(this.getHeaderMessageContainerId());t.style.display="none"},e.prototype.setHeaderMessage=function(t,n){n||(n=kn.STATUS_DEFAULT);var i=this.getHeaderMessageDiv();switch(i.innerText=t,i.style.display="block",n){case kn.STATUS_SUCCESS:i.style.background="rgba(106, 175, 80, 0.26)",i.style.color="#477735";break;case kn.STATUS_WARNING:i.style.background="rgba(203, 36, 49, 0.14)",i.style.color="#cb2431";break;case kn.STATUS_DEFAULT:default:i.style.background="rgba(0, 0, 0, 0)",i.style.color="rgb(17, 17, 17)";break}},e.prototype.showHideScanTypeSwapLink=function(t){this.scanTypeSelector.hasMoreThanOneScanType()&&(t!==!0&&(t=!1),this.sectionSwapAllowed=t,this.getDashboardSectionSwapLink().style.display=t?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){n.innerHTML="<br>",n.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(i){n.innerHTML="<br>",n.appendChild(t.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=Gb,this.cameraScanImage.alt=at.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var t=this,n=document.getElementById(this.getScanRegionId());if(this.fileScanImage){n.innerHTML="<br>",n.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(i){n.innerHTML="<br>",n.appendChild(t.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=Yb,this.fileScanImage.alt=at.fileScanAltText()},e.prototype.clearScanRegion=function(){var t=document.getElementById(this.getScanRegionId());t.innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return Ln.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return Ln.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();function aI(){var xe,Zt,ki;const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState(!1),[A,M]=R.useState([]),[_,k]=R.useState(""),[V,N]=R.useState(""),[b,S]=R.useState(!1),[O,F]=R.useState([]),[W,U]=R.useState(new Date().toISOString().split("T")[0]);R.useState(!1);const[B,G]=R.useState(!1),[te,me]=R.useState(!1),[he,de]=R.useState(0),[pe,j]=R.useState(window.innerWidth<=768),[q,re]=R.useState(window.innerWidth>window.innerHeight),[X,fe]=R.useState(!1),[oe,ve]=R.useState(null);R.useEffect(()=>{const ie=()=>{j(window.innerWidth<=768),re(window.innerWidth>window.innerHeight)};return window.addEventListener("resize",ie),()=>window.removeEventListener("resize",ie)},[]),R.useEffect(()=>{Ft(),ge()},[]),R.useEffect(()=>()=>{oe&&oe.clear().catch(console.error)},[oe]);const Te=async(ie,De,Ve=3)=>{G(!0),me(!1);for(let et=1;et<=Ve;et++)try{const tt=await fetch(ie,{...De,timeout:1e4});if(!tt.ok)throw new Error(`HTTP ${tt.status}: ${tt.statusText}`);const ot=await tt.json();return G(!1),de(0),{success:!0,data:ot}}catch(tt){if(console.error(`API call attempt ${et}:`,tt),et===Ve)return G(!1),me(!0),de(et),{success:!1,error:tt.message,isNetworkError:tt.name==="TypeError"||tt.message.includes("fetch")};await new Promise(ot=>setTimeout(ot,Math.pow(2,et)*1e3))}},st=async(ie,De,Ve,et)=>{var ot;const tt=await Te("/api/gun-borrowing-record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userQRCode:ie,gunQRCode:De,realname:Ve,action:et})});return tt.success?(console.log(`Auto-saved ${et} record:`,tt.data),ge(),l(`✅ ${et==="borrow"?"เบิก":"คืน"}อาวุธและบันทึกข้อมูลสำเร็จ`),!0):(console.error("Auto-save failed:",tt.error),(ot=tt.data)!=null&&ot.conflictType?Ze(tt.data):l(`❌ ไม่สามารถบันทึกข้อมูลได้: ${tt.error}`),!1)},Ze=ie=>{switch(ie.conflictType){case"duplicate_borrow":l("⚠️ เบิกปืนนี้ไปแล้ววันนี้");break;case"user_has_other_gun":l(`⚠️ คุณเบิกปืน ${ie.existingRecord.gunQRCode} ไว้แล้ว`);break;case"gun_borrowed_by_other":l(`⚠️ ปืนนี้ถูก ${ie.existingRecord.realname} เบิกไว้แล้ว`);break;default:l("⚠️ ข้อมูลซ้ำซ้อน")}},Ft=async()=>{try{const De=await(await fetch("/api/public-gun")).json();M(De)}catch{N("ไม่สามารถโหลดข้อมูลปืนสาธารณะ")}},ge=async()=>{try{const De=await(await fetch(`/api/gun-borrowing-record?date=${W}`)).json();De.success&&F(De.data)}catch(ie){console.error("Failed to fetch records:",ie)}},Re=async ie=>{try{const Ve=await(await fetch(`/api/gun-borrowing-record?date=${ie}`)).json();Ve.success&&(F(Ve.data),U(ie))}catch(De){console.error("Failed to load records:",De)}},ct=async ie=>{if(window.confirm(`ต้องการลบข้อมูลนี้หรือไม่?

⚠️ การลบจะไม่สามารถกู้คืนได้`))try{(await(await fetch("/api/gun-borrowing-record",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({recordId:ie})})).json()).success?(l("✅ ลบข้อมูลสำเร็จ"),Re(W)):l("❌ ลบข้อมูลไม่สำเร็จ")}catch(De){console.error("Failed to delete record:",De),l("❌ เกิดข้อผิดพลาดในการลบข้อมูล")}},Ut=async()=>{const ie=`ต้องการลบข้อมูลทั้งหมดในวันที่ ${W} หรือไม่?

จำนวนข้อมูลที่จะถูกลบ: ${O.all.length} รายการ

<<<<<<<< HEAD:dist/assets/index-1eab1cfd.js
⚠️ การลบจะไม่สามารถกู้คืนได้`;if(window.confirm(re))try{const Ve=await(await fetch("/api/gun-borrowing-record",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:H})})).json();Ve.success?(l(`✅ ลบข้อมูลทั้งหมดในวันที่ ${H} สำเร็จ (${Ve.deletedCount||0} รายการ)`),be(H)):l("❌ ลบข้อมูลไม่สำเร็จ")}catch(De){console.error("Failed to delete all records:",De),l("❌ เกิดข้อผิดพลาดในการลบข้อมูล")}},Ee=async re=>{if(re.preventDefault(),!!_)try{(await fetch("/api/public-gun",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gunQRCode:_})})).ok?(k(""),N("เพิ่มปืนสำเร็จ"),Ft()):N("เพิ่มปืนไม่สำเร็จ")}catch{N("เกิดข้อผิดพลาด")}},ve=async re=>{if(window.confirm(`ลบปืน ${re} ?`))try{(await fetch("/api/public-gun",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({gunQRCode:re})})).ok?(N("ลบปืนสำเร็จ"),Ft()):N("ลบปืนไม่สำเร็จ")}catch{N("เกิดข้อผิดพลาด")}},Ge=re=>{re.preventDefault(),f&&p?(t(f),i(p),l("กรอกข้อมูล QR Code สำเร็จ"),g(""),m("")):l("กรุณากรอกข้อมูลให้ครบ")},Q=async re=>{console.log("Scanned QR Code:",re);const De=await Be(re);if(console.log("Detection result - Is User QR:",De),console.log(`🎯 Detected: ${re} = ${De?"User":"Gun"} QR`),De&&!e)t(re),l(`✅ ตรวจจับ User QR: ${re}`);else if(!De&&!n){const et=re.replace(/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i,"");i(et),l(`✅ ตรวจจับ Gun QR: ${re} (บันทึกเป็น: ${et})`)}else if(De&&e)e===re?l(`⚠️ User QR [${re}] สแกนไปแล้ว`):(l(`⚠️ เปลี่ยน User QR: ${e} → ${re}`),t(re));else if(!De&&n){const et=re.replace(/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i,"");n===et?l(`⚠️ Gun QR [${re}] สแกนไปแล้ว`):(l(`⚠️ เปลี่ยน Gun QR: ${n} → ${et}`),i(et))}},Be=async re=>{console.log("Checking QR Code from database:",re);try{const Ve=await(await fetch(`/api/check-user-qr?qr=${encodeURIComponent(re)}`)).json();return Ve.success?Ve.isUser?(console.log("Detected as User QR from database:",Ve.userInfo),!0):(console.log("QR not found in user database, checking patterns"),je(re)):(console.log("Database check failed, using pattern matching"),je(re))}catch(De){return console.error("Error checking QR code:",De),console.log("Database unavailable, using pattern matching"),je(re)}},je=re=>(console.log("Checking pattern for QR:",re),/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i.test(re)?(console.log("Pattern: Detected as Gun QR - has gun prefix"),!1):/^[0-9]{1,3}[-_][0-9]+$/.test(re)||/^[A-Z][0-9]{3,6}$/.test(re)?(console.log("Pattern: Detected as Gun QR - serial number format"),!1):/^\d+$/.test(re)?re.length>=3?(console.log("Pattern: Detected as User QR - numeric user ID"),!0):(console.log("Pattern: Detected as Gun QR - too short for user ID"),!1):/^[A-Za-z][0-9]+$/.test(re)?(console.log("Pattern: Detected as User QR - alphanumeric user ID"),!0):/[^A-Za-z0-9]/.test(re)&&!/^[A-Za-z0-9]+$/.test(re)?(console.log("Pattern: Detected as Gun QR - contains special characters"),!1):re.length<=2?(console.log("Pattern: Detected as Gun QR - very short"),!1):(console.log("Pattern: Detected as User QR - default case"),!0)),Oe=async()=>{if($&&ce){Ue();return}const re="qr-reader";if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){l("เบราว์เซอร์ไม่รองรับการใช้กล้อง");return}try{await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})}catch(et){console.error("Camera permission error:",et),l("ไม่สามารถเข้าถึงกล้องได้ กรุณาอนุญาตการใช้กล้อง");return}const De={fps:Se?5:10,qrbox:Se?{width:Math.min(300,window.innerWidth-40),height:Math.min(300,window.innerWidth-40)}:{width:250,height:250},aspectRatio:1,supportedScanTypes:[Qr.SCAN_TYPE_CAMERA],videoConstraints:{facingMode:"environment",width:Se?{ideal:640}:{ideal:1280},height:Se?{ideal:480}:{ideal:720}}},Ve=new ob(re,De);Ne(Ve),he(!0),Ve.render(et=>{navigator.vibrate&&Se&&navigator.vibrate(200),Q(et)},et=>{console.log("Scan failed:",et),et.includes("NotAllowedError")?l("ไม่ได้รับอนุญาตให้ใช้กล้อง"):et.includes("NotFoundError")?l("ไม่พบกล้อง"):et.includes("NotReadableError")&&l("กล้องถูกใช้งานโดยแอปอื่น")})},Ue=()=>{ce&&(ce.clear().catch(console.error),Ne(null),he(!1))};M.useEffect(()=>{e&&n&&Le()},[e,n]);const Le=async()=>{try{l("🔍 กำลังตรวจสอบข้อมูลกับ Database...");const De=await(await fetch(`/api/get-user-details?userQRCode=${e}`)).json();if(!De.success){l(`❌ ไม่พบข้อมูล User: ${e} ในระบบ`);return}const Ve=new Date().toISOString().split("T")[0],tt=await(await fetch(`/api/gun-borrowing-record?date=${Ve}&userQRCode=${e}&gunQRCode=${n}`)).json();if(tt.success&&tt.data.length>0){tt.data[0].status==="borrowed"?await st(e,n,De.realname,"return")&&(l(`✅ คืนปืนสำเร็จ: ${De.realname} คืนปืน ${n}`),Fe()):l(`⚠️ ${De.realname} คืนปืน ${n} ไปแล้ววันนี้`);return}const ot=De.gunNumber;ot&&ot===n?(l(`✅ ตรวจสอบสำเร็จ: ${De.realname} | ปืน: ${n}`),await st(e,n,De.realname,"borrow")&&Fe()):ot?(l(`⚠️ ปืนไม่ตรงกัน! ${De.realname} ควรใช้ปืน: ${ot} แต่สแกน: ${n}`),setTimeout(async()=>{await st(e,n,De.realname,"borrow")&&Fe()},2e3)):(l(`⚠️ ${De.realname} ไม่มีปืนที่กำหนดในระบบ แต่สแกนปืน: ${n}`),await st(e,n,De.realname,"borrow")&&Fe())}catch(re){console.error("Check user-gun match error:",re),l("❌ เกิดข้อผิดพลาดในการตรวจสอบข้อมูล")}},Fe=()=>{setTimeout(()=>{t(""),i(""),l("🔄 พร้อมสแกนคู่ต่อไป")},3e3)},kt=()=>{Ue(),t(""),i(""),l("🔄 รีเซ็ตเรียบร้อย - พร้อมสแกนใหม่"),setTimeout(()=>{l("")},2e3)};return y.jsx("div",{className:"gun-borrowing-bg",children:y.jsxs("div",{className:"gun-borrowing-container",children:[y.jsx("h1",{className:"gun-borrowing-title",children:"ระบบยืม-คืนปืน"}),y.jsxs("div",{className:"gun-borrowing-card",children:[y.jsxs("div",{className:"qr-section",children:[y.jsx("label",{className:"qr-label",children:"สแกน QR Code (User หรือ Gun)"}),y.jsx("div",{id:"qr-reader",className:"qr-reader"}),y.jsx("button",{onClick:()=>Oe(),className:"qr-scan-btn",disabled:B,style:{background:B?"#f3f4f6":$?"#dc2626":"#3b82f6",color:B?"#9ca3af":"white",border:"1px solid #d1d5db",borderRadius:"8px",padding:"12px 24px",cursor:B?"not-allowed":"pointer",fontSize:"16px",fontWeight:"500",width:"100%",margin:"8px 0"},children:B?"🔄 กำลังเปิดกล้อง...":$?"🛑 หยุดสแกน QR Code":"📷 เปิดกล้องสแกน QR Code"}),y.jsxs("div",{className:"qr-help-text",children:["💡 ",Se?$?"📱 กล้องเปิดแล้ว - สแกน User QR หรือ Gun QR ได้ทันที":"หมุนโทรศัพท์เป็นแนวตั้ง สแกน User QR หรือ Gun QR ได้ทันที":$?"🎥 กล้องเปิดแล้ว - สแกน QR Code ใดก็ได้ (User หรือ Gun) ระบบจะแยกแยะให้อัตโนมัติ":"สแกน QR Code ใดก็ได้ (User หรือ Gun) ระบบจะแยกแยะให้อัตโนมัติ"]}),y.jsxs("div",{style:{display:"flex",gap:"16px",marginTop:"12px",flexDirection:Se?"column":"row"},children:[y.jsxs("div",{className:"qr-result",style:{flex:1},children:[y.jsx("b",{children:"👤 User:"})," ",e?y.jsxs("span",{className:"qr-result-value",style:{color:"#059669"},children:["✅ ",e]}):y.jsx("span",{className:"qr-result-none",style:{color:"#6b7280"},children:"ยังไม่ได้สแกน"})]}),y.jsxs("div",{className:"qr-result",style:{flex:1},children:[y.jsx("b",{children:"🔫 Gun:"})," ",n?y.jsxs("span",{className:"qr-result-value",style:{color:"#dc2626"},children:["✅ ",n]}):y.jsx("span",{className:"qr-result-none",style:{color:"#6b7280"},children:"ยังไม่ได้สแกน"})]})]}),(e||n)&&y.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:e&&n?"#dcfce7":"#fef3c7",border:`1px solid ${e&&n?"#16a34a":"#f59e0b"}`,borderRadius:"6px",fontSize:"14px",color:e&&n?"#166534":"#92400e"},children:e&&n?"✅ สแกนครบแล้ว! กำลังตรวจสอบข้อมูล...":`⏳ สแกนแล้ว ${(e?1:0)+(n?1:0)}/2 รายการ - ${e?"ต้องการ Gun QR":"ต้องการ User QR"}`}),$&&y.jsx("div",{style:{marginTop:"8px",padding:"6px 10px",background:"#e0f2fe",border:"1px solid #0284c7",borderRadius:"6px",fontSize:"12px",color:"#0369a1",textAlign:"center"},children:"🎥 กล้องเปิดอยู่ - พร้อมสแกน QR Code"}),(e||n)&&y.jsxs("div",{style:{marginTop:"8px",padding:"6px 10px",background:"#f1f5f9",border:"1px solid #cbd5e1",borderRadius:"6px",fontSize:"11px",color:"#475569"},children:["🔍 Debug: ",e?`User(${e})`:"User(-)"," | ",n?`Gun(${n})`:"Gun(-)"]})]}),y.jsx("button",{onClick:kt,className:"btn-reset",style:{background:"#f59e0b",color:"white",border:"1px solid #d97706",borderRadius:"8px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500",width:"100%",marginTop:"12px"},children:"🔄 เริ่มสแกนใหม่"}),y.jsx("button",{type:"button",className:"gun-borrowing-print-btn btn-toggle-form",onClick:()=>E(re=>!re),children:C?"❌ ปิดฟอร์มกรอกข้อมูล":"⌨️ กรอกข้อมูลด้วยตนเอง"}),C&&y.jsxs("form",{onSubmit:Ge,className:"manual-form",children:[y.jsx("div",{className:"manual-form-title",children:"⌨️ กรอกข้อมูล QR Code ด้วยตนเอง"}),y.jsx("input",{type:"text",placeholder:"รหัสผู้ใช้ (User ID)",value:f,onChange:re=>g(re.target.value),className:"manual-input"}),y.jsx("input",{type:"text",placeholder:"หมายเลขปืน (Gun Number)",value:p,onChange:re=>m(re.target.value),className:"manual-input"}),y.jsx("button",{type:"submit",className:"gun-borrowing-print-btn manual-submit",disabled:B,children:B?"🔄 กำลังประมวลผล...":"✅ ยืนยันข้อมูล"})]}),y.jsx("div",{style:{marginTop:"12px"},children:y.jsxs("details",{style:{marginBottom:"8px"},children:[y.jsx("summary",{style:{cursor:"pointer",fontSize:"12px",color:"#6b7280",marginBottom:"8px"},children:"🧪 ทดสอบการตรวจจับ QR Code"}),y.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[y.jsx("button",{onClick:()=>Q("1234567890"),style:{fontSize:"10px",padding:"4px 8px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px"},children:"Test: 1234567890"}),y.jsx("button",{onClick:()=>Q("A123"),style:{fontSize:"10px",padding:"4px 8px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px"},children:"Test: A123"}),y.jsx("button",{onClick:()=>Q("GUN-001"),style:{fontSize:"10px",padding:"4px 8px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px"},children:"Test: GUN-001"}),y.jsx("button",{onClick:()=>Q("WEAPON-123"),style:{fontSize:"10px",padding:"4px 8px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px"},children:"Test: WEAPON-123"}),y.jsx("button",{onClick:()=>Q("ABC123DEF"),style:{fontSize:"10px",padding:"4px 8px",background:"#6b7280",color:"white",border:"none",borderRadius:"4px"},children:"Test: ABC123DEF"})]})]})}),a&&y.jsx("div",{className:`gun-borrowing-status ${a.includes("Successful")||a.includes("✅")?"success":"error"}`,children:a}),B&&y.jsx("div",{className:"loading-message",children:y.jsx("div",{className:"loading-text",children:"🔄 กำลังประมวลผล..."})}),ne&&y.jsxs("div",{className:"network-error",children:[y.jsx("div",{className:"network-error-title",children:"❌ ไม่สามารถเชื่อมต่อได้"}),y.jsxs("div",{className:"network-error-text",children:["ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต (ลองใหม่ ",fe," ครั้ง)"]}),y.jsx("button",{onClick:()=>{pe(!1),de()},className:"retry-btn",children:"ลองใหม่"})]})]}),y.jsxs("div",{className:"public-gun-section",children:[y.jsx("h2",{className:"public-gun-title",children:"ปืนสาธารณะ (Public Gun)"}),y.jsx("button",{type:"button",className:"gun-borrowing-print-btn",style:{width:"100%",marginBottom:b?0:16},onClick:()=>A(re=>!re),children:b?"ปิดฟอร์มเพิ่มปืน":"เพิ่มปืนสาธารณะ"}),b&&y.jsxs("form",{onSubmit:Ee,className:"public-gun-form",children:[y.jsx("input",{type:"text",placeholder:"Gun QR Code",value:_,onChange:re=>k(re.target.value),className:"public-gun-input"}),y.jsx("button",{type:"submit",className:"gun-borrowing-print-btn public-gun-add-btn",children:"เพิ่ม"})]}),V&&y.jsx("div",{className:"public-gun-status",children:V}),y.jsx("div",{style:{maxHeight:120,overflowY:"auto"},children:y.jsxs("table",{style:{width:"100%",fontSize:"1rem"},children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{style:{width:"70%"},children:"Gun QR Code"}),y.jsx("th",{style:{width:"30%"},children:"ลบ"})]})}),y.jsx("tbody",{children:S.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:2,style:{color:"#888",textAlign:"center"},children:"ไม่มีข้อมูล"})}):S.map(re=>y.jsxs("tr",{children:[y.jsx("td",{children:re.gunQRCode}),y.jsx("td",{children:y.jsx("button",{type:"button",style:{background:"#e53935",color:"#fff",border:"none",borderRadius:6,padding:"4px 12px",cursor:"pointer"},onClick:()=>ve(re.gunQRCode),children:"ลบ"})})]},re.gunQRCode))})]})})]}),y.jsxs("div",{style:{background:O.all&&O.all.length>0?"#e8f5e8":"#f0f4f8",borderRadius:10,padding:16,margin:"16px auto",maxWidth:1200,border:O.all&&O.all.length>0?"2px solid #4caf50":"2px solid #e0e0e0"},children:[y.jsxs("h3",{style:{color:"#2e7d32",marginBottom:12},children:["📊 ข้อมูลที่บันทึกแล้วในวันที่ ",H]}),y.jsxs("div",{style:{display:"flex",gap:"24px",marginBottom:12},children:[y.jsxs("div",{style:{color:"#1976d2"},children:[y.jsx("strong",{children:"เบิกทั้งหมด:"})," ",((ge=O.summary)==null?void 0:ge.totalBorrowed)||0," คน"]}),y.jsxs("div",{style:{color:"#388e3c"},children:[y.jsx("strong",{children:"คืนแล้ว:"})," ",((Zt=O.summary)==null?void 0:Zt.totalReturned)||0," คน"]}),y.jsxs("div",{style:{color:"#f57c00"},children:[y.jsx("strong",{children:"ยังไม่คืน:"})," ",((ki=O.summary)==null?void 0:ki.notReturned)||0," คน"]})]}),y.jsxs("div",{style:{marginTop:16},children:[y.jsx("h4",{style:{color:"#1976d2",marginBottom:8},children:"รายละเอียดจาก Database:"}),y.jsx("div",{style:{maxHeight:200,overflowY:"auto",background:"white",borderRadius:6,padding:8},children:!O.all||O.all.length===0?y.jsx("div",{style:{textAlign:"center",color:"#666",padding:16},children:"ไม่มีข้อมูลในวันนี้"}):y.jsxs("table",{style:{width:"100%",fontSize:"0.9rem"},children:[y.jsx("thead",{children:y.jsxs("tr",{style:{background:"#f5f5f5"},children:[y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ชื่อ"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ปืน"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"เวลาเบิก"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"เวลาคืน"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"สถานะ"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ลบ"})]})}),y.jsx("tbody",{children:O.all.map((re,De)=>y.jsxs("tr",{children:[y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:re.realname}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:re.gunQRCode}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:new Date(re.borrowTime).toLocaleString("th-TH")}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:re.returnTime?new Date(re.returnTime).toLocaleString("th-TH"):"-"}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd",color:re.status==="returned"?"#388e3c":"#f57c00",fontWeight:"bold"},children:re.status==="borrowed"?"🔴 ยังไม่คืน":"✅ คืนแล้ว"}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd",textAlign:"center"},children:y.jsx("button",{onClick:()=>ct(re.id),style:{background:"#e53935",color:"#fff",border:"none",borderRadius:4,padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"🗑️ ลบ"})})]},De))})]})})]}),y.jsxs("div",{style:{fontSize:"0.9rem",color:"#666",marginTop:8},children:["💡 ข้อมูลนี้ดึงมาจาก Database",O.all&&O.all.length>0?` (มี ${O.all.length} รายการ)`:" (ยังไม่มีข้อมูลบันทึก)"]})]}),y.jsxs("div",{style:{background:"#f0f4f8",borderRadius:10,padding:16,margin:"16px auto",maxWidth:1200,textAlign:"center"},children:[y.jsx("h3",{style:{color:"#1976d2",marginBottom:12},children:"📅 ดูข้อมูลจาก Database"}),y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:16},children:[y.jsx("label",{style:{fontWeight:"500"},children:"เลือกวันที่:"}),y.jsx("input",{type:"date",value:H,onChange:re=>be(re.target.value),style:{padding:"8px 12px",borderRadius:6,border:"1px solid #d1d9e6",fontSize:"1rem"}})]}),O.all&&O.all.length>0&&y.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:16},children:[y.jsxs("button",{onClick:Ut,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:["🗑️ ลบข้อมูลทั้งวันที่ ",H]}),y.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginTop:8},children:"⚠️ การลบจะไม่สามารถกู้คืนได้"})]})]})]})})}var qy={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},vp=mi.createContext&&mi.createContext(qy),lb=["attr","size","title"];function cb(e,t){if(e==null)return{};var n=ub(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function ub(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function xc(){return xc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xc.apply(this,arguments)}function Sp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function yc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sp(Object(n),!0).forEach(function(i){db(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sp(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function db(e,t,n){return t=fb(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fb(e){var t=hb(e,"string");return typeof t=="symbol"?t:t+""}function hb(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jy(e){return e&&e.map((t,n)=>mi.createElement(t.tag,yc({key:n},t.attr),Jy(t.child)))}function Gc(e){return t=>mi.createElement(gb,xc({attr:yc({},e.attr)},t),Jy(e.child))}function gb(e){var t=n=>{var{attr:i,size:a,title:l}=e,f=cb(e,lb),g=a||n.size||"1em",p;return n.className&&(p=n.className),e.className&&(p=(p?p+" ":"")+e.className),mi.createElement("svg",xc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,f,{className:p,style:yc(yc({color:e.color||n.color},n.style),e.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),l&&mi.createElement("title",null,l),e.children)};return vp!==void 0?mi.createElement(vp.Consumer,null,n=>t(n)):t(qy)}function pb(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M16 7.992C16 3.58 12.416 0 8 0S0 3.58 0 7.992c0 2.43 1.104 4.62 2.832 6.09.016.016.032.016.032.032.144.112.288.224.448.336.08.048.144.111.224.175A7.98 7.98 0 0 0 8.016 16a7.98 7.98 0 0 0 4.48-1.375c.08-.048.144-.111.224-.16.144-.111.304-.223.448-.335.016-.016.032-.016.032-.032 1.696-1.487 2.8-3.676 2.8-6.106zm-8 7.001c-1.504 0-2.88-.48-4.016-1.279.016-.128.048-.255.08-.383a4.17 4.17 0 0 1 .416-.991c.176-.304.384-.576.64-.816.24-.24.528-.463.816-.639.304-.176.624-.304.976-.4A4.15 4.15 0 0 1 8 10.342a4.185 4.185 0 0 1 2.928 1.166c.368.368.656.8.864 1.295.112.288.192.592.24.911A7.03 7.03 0 0 1 8 14.993zm-2.448-7.4a2.49 2.49 0 0 1-.208-1.024c0-.351.064-.703.208-1.023.144-.32.336-.607.576-.847.24-.24.528-.431.848-.575.32-.144.672-.208 1.024-.208.368 0 .704.064 1.024.208.32.144.608.336.848.575.24.24.432.528.576.847.144.32.208.672.208 1.023 0 .368-.064.704-.208 1.023a2.84 2.84 0 0 1-.576.848 2.84 2.84 0 0 1-.848.575 2.715 2.715 0 0 1-2.064 0 2.84 2.84 0 0 1-.848-.575 2.526 2.526 0 0 1-.56-.848zm7.424 5.306c0-.032-.016-.048-.016-.08a5.22 5.22 0 0 0-.688-1.406 4.883 4.883 0 0 0-1.088-1.135 5.207 5.207 0 0 0-1.04-.608 2.82 2.82 0 0 0 .464-.383 4.2 4.2 0 0 0 .624-.784 3.624 3.624 0 0 0 .528-1.934 3.71 3.71 0 0 0-.288-1.47 3.799 3.799 0 0 0-.816-1.199 3.845 3.845 0 0 0-1.2-.8 3.72 3.72 0 0 0-1.472-.287 3.72 3.72 0 0 0-1.472.288 3.631 3.631 0 0 0-1.2.815 3.84 3.84 0 0 0-.8 1.199 3.71 3.71 0 0 0-.288 1.47c0 .352.048.688.144 1.007.096.336.224.64.4.927.16.288.384.544.624.784.144.144.304.271.48.383a5.12 5.12 0 0 0-1.04.624c-.416.32-.784.703-1.088 1.119a4.999 4.999 0 0 0-.688 1.406c-.016.032-.016.064-.016.08C1.776 11.636.992 9.91.992 7.992.992 4.14 4.144.991 8 .991s7.008 3.149 7.008 7.001a6.96 6.96 0 0 1-2.032 4.907z"},child:[]}]})(e)}function mb(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8 8.707l3.646 3.647.708-.707L8.707 8l3.647-3.646-.707-.708L8 7.293 4.354 3.646l-.707.708L7.293 8l-3.646 3.646.707.708L8 8.707z"},child:[]}]})(e)}function xb(e){return Gc({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15.25 0a8.25 8.25 0 0 0-6.18 13.72L1 22.88l1.12 1 8.05-9.12A8.251 8.251 0 1 0 15.25.01V0zm0 15a6.75 6.75 0 1 1 0-13.5 6.75 6.75 0 0 1 0 13.5z"},child:[]}]})(e)}function yb(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M14 5H2V3h12v2zm0 4H2V7h12v2zM2 13h12v-2H2v2z"},child:[]}]})(e)}function wb(){const[e,t]=M.useState(!1),[n,i]=M.useState(""),[a,l]=M.useState([]),[f,g]=M.useState(!1),[p,m]=M.useState(!1),[C,E]=M.useState(!1),S=M.useRef(null),R=M.useRef(null),_="";M.useEffect(()=>{const B=()=>{E(window.innerWidth<=768)};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),M.useEffect(()=>{function B(G){S.current&&!S.current.contains(G.target)&&(t(!1),m(!1),i(""))}return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[]),M.useEffect(()=>{e&&R.current&&setTimeout(()=>{R.current.focus()},200)},[e]);const k=async B=>{if(!B.trim()){l([]),m(!1);return}g(!0);try{const ne=await(await fetch(`${_}/api/search-users?q=${encodeURIComponent(B.trim())}`)).json();ne.status?(l(ne.data),m(!0)):(l([]),m(!1))}catch(G){console.error("Search error:",G),l([]),m(!1)}finally{g(!1)}};M.useEffect(()=>{const B=setTimeout(()=>{n&&e&&k(n)},300);return()=>clearTimeout(B)},[n,e]);const V=()=>{t(!e),e||(m(!1),i(""),l([]))},N=B=>{i(B.target.value)},b=B=>{console.log("Selected user:",B),m(!1),i(""),t(!1)},A=B=>B?typeof B=="string"?`data:image/png;base64,${B}`:B.data?`data:image/png;base64,${btoa(new Uint8Array(B.data).reduce((ne,pe)=>ne+String.fromCharCode(pe),""))}`:"":"",O={ME:"วิศวกรรมเครื่องกล",EE:"วิศวกรรมไฟฟ้าสื่อสาร",CYBER:"ความมั่นคงปลอดภัยทางไซเบอร์",SCIEN:"วิทยาศาสตร์และเทคโนโลยี (EN)",CE:"วิศวกรรมโยธา",GEO:"วิศวกรรมแผนที่",IE:"วิศวกรรมอุตสาหการ",SCI:"วิทยาศาสตร์และเทคโนโลยี",SOC:"สังคมศาสตร์เพื่อการพัฒนา"},F={student:"นักเรียนนายสิบ",teacher:"อาจารย์",officer:"นายทหาร",admin:"ผู้ดูแลระบบ"},H=B=>{switch(B){case"admin":return"role-badge admin";case"officer":return"role-badge officer";case"teacher":return"role-badge teacher";case"student":default:return"role-badge student"}},U=B=>{const G=[];return B.battalion&&G.push(`กองพัน ${B.battalion}`),B.company&&G.push(`ร้อย ${B.company}`),B.platoon&&G.push(`หมู่ ${B.platoon}`),B.squad&&G.push(`หมวด ${B.squad}`),G.length>0?G.join(" "):""};return y.jsxs("div",{ref:S,className:"user-search-container",children:[y.jsxs(ts.div,{className:`user-search ${e?"expanded":""}`,initial:!1,animate:{width:e?window.innerWidth<=480?"220px":window.innerWidth<=360?"200px":"280px":"40px"},transition:{duration:.3,ease:"easeInOut"},children:[y.jsx("div",{className:"search-icon-container",onClick:V,children:e?y.jsx(mb,{size:20,className:"search-icon"}):y.jsx(xb,{size:20,className:"search-icon"})}),y.jsx($s,{children:e&&y.jsx(ts.input,{ref:R,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},type:"text",placeholder:"ค้นหาผู้ใช้...",value:n,onChange:N,className:"search-input"})})]}),y.jsx($s,{children:p&&a.length>0&&y.jsxs(ts.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"search-results",children:[f&&y.jsx("div",{className:"search-loading",children:"กำลังค้นหา..."}),!f&&a.map(B=>y.jsxs("div",{className:"search-result-item",onClick:()=>b(B),children:[y.jsx("div",{className:"user-avatar",children:B.profileImage&&B.profileImage.data?y.jsx("img",{src:A(B.profileImage),alt:"Profile",className:"userlist-avatar"}):y.jsx("div",{className:"no-avatar",children:B.realname?B.realname.charAt(0).toUpperCase():"?"})}),y.jsxs("div",{className:"user-info",children:[y.jsxs("div",{className:"user-name-row",children:[y.jsx("div",{className:"user-name",children:B.realname||"ไม่ระบุชื่อ"}),y.jsxs("div",{className:"badges",children:[B.role&&y.jsx("div",{className:H(B.role),children:F[B.role]||B.role}),B.admin&&y.jsx("div",{className:"admin-badge",children:"Admin"})]})]}),y.jsxs("div",{className:"user-details",children:[y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"ID:"}),y.jsx("span",{className:"value",children:B.userid})]}),B.year&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"ชั้นปี:"}),y.jsx("span",{className:"value",children:B.year})]}),B.major&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"กองวิชา:"}),y.jsx("span",{className:"value major-text",children:O[B.major]||B.major})]}),U(B)&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"สังกัด:"}),y.jsx("span",{className:"value",children:U(B)})]}),y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"Username:"}),y.jsxs("span",{className:"value username",children:["@",B.username]})]})]})]})]},B.id)),!f&&a.length===0&&n&&y.jsx("div",{className:"no-results",children:"ไม่พบผู้ใช้ที่ค้นหา"})]})})]})}const bn={STUDENT:"student",TEACHER:"teacher",OFFICER:"officer",ADMIN:"admin"},rt={VIEW_USER_DATA:"view_user_data",EDIT_OWN_PROFILE:"edit_own_profile",EDIT_OTHER_PROFILES:"edit_other_profiles",DEDUCT_POINTS:"deduct_points",VIEW_WEAPON_STORAGE:"view_weapon_storage",EDIT_WEAPON_STORAGE:"edit_weapon_storage",ADD_SUMMARY:"add_summary",VIEW_SUMMARY:"view_summary",EDIT_SUMMARY:"edit_summary",DELETE_SUMMARY:"delete_summary",MANAGE_USERS:"manage_users",MANAGE_ROLES:"manage_roles",VIEW_ALL_DATA:"view_all_data"},Cb={[bn.STUDENT]:[rt.EDIT_OWN_PROFILE,rt.ADD_SUMMARY,rt.VIEW_SUMMARY],[bn.TEACHER]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.DEDUCT_POINTS,rt.VIEW_SUMMARY],[bn.OFFICER]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.DEDUCT_POINTS,rt.VIEW_WEAPON_STORAGE,rt.VIEW_SUMMARY],[bn.ADMIN]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.EDIT_OWN_PROFILE,rt.EDIT_OTHER_PROFILES,rt.DEDUCT_POINTS,rt.VIEW_WEAPON_STORAGE,rt.EDIT_WEAPON_STORAGE,rt.ADD_SUMMARY,rt.VIEW_SUMMARY,rt.EDIT_SUMMARY,rt.DELETE_SUMMARY,rt.MANAGE_USERS,rt.MANAGE_ROLES]},ys=(e,t)=>!e||!e.role?!1:e.admin||e.role===bn.ADMIN?!0:(Cb[e.role]||[]).includes(t),Eb=(e,t)=>{if(!e)return!1;switch(t){case"role-manager":return ys(e,rt.MANAGE_ROLES);case"deduct-point":return ys(e,rt.DEDUCT_POINTS);case"gun-borrowing":return ys(e,rt.VIEW_WEAPON_STORAGE);case"summary":return ys(e,rt.VIEW_SUMMARY);case"behavior-point":case"home":case"profile":return ys(e,rt.VIEW_USER_DATA)||e.role===bn.STUDENT;default:return!0}},ew=(e,t)=>`${{[bn.STUDENT]:"นนร.",[bn.TEACHER]:"อาจารย์",[bn.OFFICER]:"นายทหาร",[bn.ADMIN]:"แอดมิน"}[e]||"ผู้ใช้"} ไม่มีสิทธิ์ในการ${t}`,vb=e=>{if(!e)return[];const n=[...[{path:"/",label:"หน้าหลัก",icon:"🏠"},{path:"/profile",label:"ข้อมูลส่วนตัว",icon:"👤"}]];return e.role===bn.STUDENT&&n.push({path:"/summary",label:"ลงยอด",icon:"📊"},{path:"/behavior-point",label:"คะแนนความประพฤติ",icon:"⭐"}),e.role===bn.TEACHER&&n.push({path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/summary",label:"ดูสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"ดูคะแนนนักเรียน",icon:"⭐"}),e.role===bn.OFFICER&&n.push({path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/gun-borrowing",label:"คลังอาวุธ",icon:"🔫"},{path:"/summary",label:"ดูสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"ดูคะแนนนักเรียน",icon:"⭐"}),(e.role===bn.ADMIN||e.admin)&&n.push({path:"/role-manager",label:"จัดการสิทธิ์ผู้ใช้",icon:"👥"},{path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/gun-borrowing",label:"คลังอาวุธ",icon:"🔫"},{path:"/summary",label:"จัดการสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"จัดการคะแนน",icon:"⭐"}),n};function tw(){var Se;const[e,t]=M.useState(""),[n,i]=M.useState(""),[a,l]=M.useState(""),[f,g]=M.useState(""),[p,m]=M.useState(""),[C,E]=M.useState(!1),[S,R]=M.useState(null),[_,k]=M.useState(!1),[V,N]=M.useState(!1),b=Zr(),A=_r(),O=M.useRef(null),F=M.useRef(null),H=vb(S),U=[{value:"ME",label:"วิศวกรรมเครื่องกล"},{value:"EE",label:"วิศวกรรมไฟฟ้าสื่อสาร"},{value:"CYBER",label:"ความมั่นคงปลอดภัยทางไซเบอร์"},{value:"SCIEN",label:"วิทยาศาสตร์และเทคโนโลยี (EN)"},{value:"CE",label:"วิศวกรรมโยธา"},{value:"GEO",label:"วิศวกรรมแผนที่"},{value:"IE",label:"วิศวกรรมอุตสาหการ"},{value:"SCI",label:"วิทยาศาสตร์และเทคโนโลยี"},{value:"SOC",label:"สังคมศาสตร์เพื่อการพัฒนา"}];M.useEffect(()=>{const j=localStorage.getItem("token");!j&&A.pathname!=="/login"&&A.pathname!=="/register"?b("/login"):j&&fetch(`/api/user/${j}`).then(J=>J.json()).then(J=>{J.data&&(t(J.data.realname),i(J.data.userid),l(J.data.blood),g(J.data.major),E(J.data.admin||!1),R({id:J.data.id,realname:J.data.realname,userid:J.data.userid,username:J.data.username,role:J.data.role||"student",admin:J.data.admin||!1,...J.data}),J.data.profileImage?m(`data:image/jpeg;base64,${J.data.profileImage}`):m(""))})},[b,A]);const B=()=>{k(j=>(j||N(!1),!j))},G=()=>{N(j=>(j||k(!1),!j))},ne=()=>{localStorage.removeItem("token"),k(!1),b("/login")},pe=()=>{b("/")},fe=()=>{k(!1),b("/edit-profile")},Ce=()=>{k(!1),b("/view-profile")};return M.useEffect(()=>{function j(J){O.current&&!O.current.contains(J.target)&&F.current&&!F.current.contains(J.target)&&(k(!1),N(!1))}return document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[]),y.jsxs("nav",{className:"navbar bg-white text-black shadow-md border-b border-gray-300 flex items-center justify-between px-4 py-2",children:[y.jsx("div",{className:"flex items-center",children:y.jsxs("span",{className:"btn btn-ghost normal-case text-xl text-black flex items-center cursor-pointer",onClick:pe,children:[y.jsx("img",{src:Ny,alt:"Logo",className:"logo-img"}),y.jsx("span",{className:"ml-2",children:"CRMA"})]})}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(wb,{}),y.jsxs("div",{ref:F,className:"relative",children:[y.jsx("button",{className:"btn btn-ghost",onClick:G,children:y.jsx(yb,{size:28})}),y.jsx($s,{children:V&&y.jsxs(ts.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.18},className:"absolute right-0 mt-2 w-56 bg-white border border-gray-300 rounded shadow-md z-50 dropdown-content show",children:[H.filter(j=>j.path!=="/"&&j.path!=="/profile").map((j,J)=>y.jsxs("p",{className:`block px-4 py-2 text-black cursor-pointer hover:bg-gray-200 ${j.path==="/role-manager"?"font-semibold border-t border-gray-200":""}`,onClick:()=>{N(!1),b(j.path)},children:[j.icon&&y.jsx("span",{className:"mr-2",children:j.icon}),j.label]},j.path)),H.filter(j=>j.path!=="/"&&j.path!=="/profile").length===0&&y.jsx("p",{className:"block px-4 py-2 text-gray-500 text-center",children:"ไม่มีเมนูเพิ่มเติม"})]})})]}),y.jsxs("div",{ref:O,className:"relative",children:[y.jsx("button",{className:"btn btn-ghost",onClick:B,children:y.jsx(pb,{size:28})}),y.jsx($s,{children:_&&y.jsxs(ts.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.18},className:"dropdown-content show absolute right-0 mt-2 w-52 bg-white border border-gray-300 rounded shadow-md z-50 p-4",children:[p?y.jsx("img",{src:p,alt:"Profile",className:"dropdown-profile-img mb-2 rounded-full w-16 h-16 object-cover mx-auto"}):y.jsx("div",{className:"dropdown-profile-img mb-2 rounded-full w-16 h-16 bg-gray-300 mx-auto flex items-center justify-center text-gray-600",children:"No Image"}),y.jsxs("p",{children:[y.jsx("strong",{children:"ชื่อ:"})," ",e]}),y.jsxs("p",{children:[y.jsx("strong",{children:"User ID:"})," ",n]}),y.jsxs("p",{children:[y.jsx("strong",{children:"สาขา:"})," ",((Se=U.find(j=>j.value===f))==null?void 0:Se.label)||f]}),y.jsxs("div",{className:"mt-3 space-y-1",children:[y.jsx("p",{className:"btn btn-ghost text-left w-full edit-profile-item",onClick:fe,children:"Edit Profile"}),y.jsx("p",{className:"btn btn-ghost text-left w-full view-profile-item",onClick:Ce,children:"View Profile"}),y.jsx("p",{className:"btn btn-ghost text-left w-full logout-item",onClick:ne,children:"Logout"})]})]})})]})]})]})}function Sb(){const[e,t]=M.useState([]),[n,i]=M.useState(!1),[a,l]=M.useState([]),[f,g]=M.useState(null),[p,m]=M.useState(""),[C,E]=M.useState([]),[S,R]=M.useState(""),[_,k]=M.useState(""),[V,N]=M.useState(""),[b,A]=M.useState(""),[O,F]=M.useState(""),[H,U]=M.useState(""),[B,G]=M.useState({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),[ne,pe]=M.useState([{key:"",value:"",names:[""],counted:!0}]),[fe,Ce]=M.useState({}),[Se,j]=M.useState({}),[J,oe]=M.useState(null),[$,he]=M.useState({}),[ce,Ne]=M.useState(!1),[Re,st]=M.useState(null),[Ze,Ft]=M.useState(null),[de,be]=M.useState(!1),[ct,Ut]=M.useState(""),[Ee,ve]=M.useState("success"),Ge="",Q=(q,se="success")=>{Ut(q),ve(se),be(!0)},Be=()=>{be(!1)};M.useEffect(()=>{console.log("API URL:",Ge);const q=localStorage.getItem("token");fetch("/api/summary",{headers:{Authorization:`Bearer ${q}`}}).then(se=>se.json()).then(se=>{se.success||se.status!==!1?t(se.data||[]):(console.error("Failed to fetch summaries:",se.message),Q(se.message||"ไม่สามารถดึงข้อมูลสรุปยอดได้","error"))}).catch(se=>{console.error("Error fetching summaries:",se),Q("เกิดข้อผิดพลาดในการดึงข้อมูล","error")})},[]),M.useEffect(()=>{if(console.log("User สังกัด:",{userBattalion:V,userCompany:b}),console.log("Summaries:",e),V&&b&&e.length>0){const q=e.filter(se=>(console.log("Comparing:",{summaryBattalion:se.battalion,userBattalion:V,summaryCompany:se.company,userCompany:b,match:Number(se.battalion)===Number(V)&&Number(se.company)===Number(b)}),Number(se.battalion)===Number(V)&&Number(se.company)===Number(b)));console.log("Filtered summaries:",q),E(q)}else E(e)},[V,b,e]),M.useEffect(()=>{const q=localStorage.getItem("token");fetch("/api/user/me",{headers:{Authorization:`Bearer ${q}`}}).then(se=>se.json()).then(se=>{if(se.data&&(R(se.data.realname||""),k(se.data.year||""),N(se.data.battalion||""),A(se.data.company||""),F(se.data.platoon||""),U(se.data.squad||"")),se.data&&se.data.other)try{const me=typeof se.data.other=="string"?JSON.parse(se.data.other):se.data.other;l(Array.isArray(me)?me.map(Ae=>({...Ae,value:Number(Ae.value)||1})):[]);const ee={};(Array.isArray(me)?me:[]).forEach((Ae,Te)=>{ee[Te]=!0}),g(ee)}catch{l([]),g({})}})},[]);const je=q=>{g(q)},Oe=q=>{m(q.target.value)},Ue=async()=>{var pr,go;if(!p){Q("กรุณาเลือกใบยอดที่ต้องการลงยอด","error");return}if(f==null){Q("กรุณาเลือกรายการจำหน่ายอย่างน้อย 1 รายการ","error");return}const q=C.find(nr=>String(nr.id)===String(p));if(!q){Q("ไม่พบใบยอดที่เลือก กรุณาลองใหม่อีกครั้ง","error");return}let se={};try{se=q.other?JSON.parse(q.other):{}}catch{Q("เกิดข้อผิดพลาดในการอ่านข้อมูลใบยอด","error");return}const me={...se},ee=S&&_?`${S}(${_})`:S||"";if(!ee){Q("ไม่พบข้อมูลชื่อผู้ใช้ กรุณาตรวจสอบโปรไฟล์ของคุณ","error");return}let Ae=!1;if(Object.values(se).forEach(nr=>{Array.isArray(nr.names)&&nr.names.includes(ee)&&(Ae=!0)}),Ae){Q("คุณได้ส่งยอดจำหน่ายในใบนี้ไปแล้ว","error");return}const Te=a[f];if(!Te||!Te.key){Q("ไม่พบรายการจำหน่ายที่เลือก กรุณาลองใหม่อีกครั้ง","error");return}const Ye=Number((pr=se[Te.key])==null?void 0:pr.count)||0,Gt=Number(Te.value)||1,qr=Array.isArray((go=se[Te.key])==null?void 0:go.names)?se[Te.key].names:[],ja=ee?[ee]:[],$e=Array.from(new Set([...qr,...ja].filter(Boolean)));me[Te.key]={count:Ye+Gt,names:$e};try{const nr=localStorage.getItem("token"),yn=await fetch(`/api/summary?id=${q.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${nr}`},body:JSON.stringify({...q,other:me})});if(yn.ok){Q("ส่งยอดจำหน่ายสำเร็จ! 🎉","success"),m(""),g(null);const Pi=localStorage.getItem("token");fetch("/api/summary",{headers:{Authorization:`Bearer ${Pi}`}}).then(Nt=>Nt.json()).then(Nt=>{if(t(Nt.data||[]),V&&b){const Jr=(Nt.data||[]).filter(Li=>Number(Li.battalion)===Number(V)&&Number(Li.company)===Number(b));E(Jr)}else E(Nt.data||[])}),i(!1)}else{const Pi=await yn.json();Q("เกิดข้อผิดพลาดในการส่งยอด: "+(Pi.message||"กรุณาลองใหม่อีกครั้ง"),"error")}}catch(nr){console.error("Error:",nr),Q("เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต","error")}},Le=q=>G({...B,[q.target.name]:q.target.value}),Fe=Number(B.total)||0,kt=ne.reduce((q,se)=>se.counted!==!1?q+(Number(se.value)||0):q,0),ge=Fe-kt,Zt=["5","4","3","2","1"].reduce((q,se)=>(q[se]=Number(B[`total_year_${se}`])||0,q),{});Object.values(Zt).reduce((q,se)=>q+se,0);const ki=q=>{G({date:q.date,time:q.time,battalion:String(q.battalion),company:String(q.company),total:String(q.total),note:q.note||"",other:"",total_year_5:q.total_year_5||"",total_year_4:q.total_year_4||"",total_year_3:q.total_year_3||"",total_year_2:q.total_year_2||"",total_year_1:q.total_year_1||""});try{const se=JSON.parse(q.other);pe(Object.entries(se).map(([me,ee])=>({key:me,value:ee.count,names:ee.names&&Array.isArray(ee.names)?ee.names:[""],counted:ee.counted!==!1})))}catch{pe([{key:"",value:"",names:[""],counted:!0}])}oe(q.id),window.scrollTo({top:0,behavior:"smooth"})},re=async q=>{if(window.confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่?")){const se=localStorage.getItem("token");await fetch(`/api/summary?id=${q}`,{method:"DELETE",headers:{Authorization:`Bearer ${se}`}}),t(me=>me.filter(ee=>ee.id!==q))}},De=async q=>{if(q.preventDefault(),!B.date){Q("กรุณาเลือกวันที่","error");return}if(!B.time){Q("กรุณากรอกเวลา","error");return}if(!B.battalion){Q("กรุณาเลือกกองพัน","error");return}if(!B.company){Q("กรุณาเลือกกองร้อย","error");return}if(!B.total||Number(B.total)<=0){Q("กรุณากรอกจำนวนคนทั้งหมดที่ถูกต้อง","error");return}if(!B.note){Q("กรุณากรอกชื่อตัวแทนชั้น","error");return}const se={};ne.forEach(Te=>{Te.key&&(se[Te.key]={count:Te.value,names:Te.names.filter(Ye=>Ye),counted:Te.counted!==!1})});const me=J?"PUT":"POST",ee=J?`/api/summary?id=${J}`:"/api/summary",Ae={...B,battalion:Number(B.battalion),company:Number(B.company),total:Number(B.total),other:se,total_year_5:B.total_year_5,total_year_4:B.total_year_4,total_year_3:B.total_year_3,total_year_2:B.total_year_2,total_year_1:B.total_year_1};try{const Te=localStorage.getItem("token"),Gt=await(await fetch(ee,{method:me,headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te}`},body:JSON.stringify(Ae)})).json();Gt.success?(J?(t(e.map(qr=>qr.id===J?Gt.data:qr)),oe(null),Q("แก้ไขข้อมูลสำเร็จ! ✅","success")):(t([Gt.data,...e]),Q("บันทึกใบยอดสำเร็จ! 🎉","success")),G({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),pe([{key:"",value:"",names:[""],counted:!0}])):Q("เกิดข้อผิดพลาด: "+(Gt.message||"ไม่สามารถบันทึกข้อมูลได้"),"error")}catch(Te){console.error("Error:",Te),Q("เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่อีกครั้ง","error")}},Ve={};e.forEach(q=>{Ve[q.battalion]||(Ve[q.battalion]={}),Ve[q.battalion][q.company]||(Ve[q.battalion][q.company]=[]),Ve[q.battalion][q.company].push(q)});const et=q=>{Ce(se=>({...se,[q]:!se[q]}))},tt=(q,se)=>{j(me=>({...me,[`${q}-${se}`]:!me[`${q}-${se}`]}))},ot=(q,se)=>{st(q),Ft(se),Ne(!0)},$r=async(q,se,me)=>{const ee=e.find(Ye=>Ye.id===q);if(!ee)return;let Ae={};try{Ae=ee.other?JSON.parse(ee.other):{}}catch{}if(!Ae[se]||!Array.isArray(Ae[se].names))return;Ae[se].names=Ae[se].names.filter(Ye=>Ye!==me),Ae[se].names.length===0&&delete Ae[se];const Te=localStorage.getItem("token");await fetch(`/api/summary?id=${q}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te}`},body:JSON.stringify({...ee,other:Ae})}),t(Ye=>Ye.map(Gt=>Gt.id===q?{...Gt,other:JSON.stringify(Ae)}:Gt)),Object.keys(Ae).length===0?Ne(!1):st(Ae)};return y.jsx("div",{className:"summary-bg",children:y.jsxs("div",{className:"summary-container",children:[y.jsx("h1",{className:"summary-title",children:"ระบบสรุปยอดจำหน่าย"}),y.jsxs("div",{className:"summary-card",children:[y.jsx("h4",{className:"summary-section-title",children:"สถานะการส่งยอดจำหน่ายของคุณ"}),V&&b?y.jsxs("p",{style:{color:"#666",fontSize:"0.9rem",marginBottom:"12px"},children:["📍 แสดงเฉพาะใบยอดของ กองพัน ",V," กองร้อย ",b]}):y.jsx("p",{style:{color:"#ff9800",fontSize:"0.9rem",marginBottom:"12px"},children:"⚠️ กรุณากรอกข้อมูลสังกัด (กองพัน/กองร้อย) เพื่อแสดงใบยอดที่เกี่ยวข้อง"}),y.jsx("div",{className:"table-wrapper",children:y.jsxs("table",{className:"summary-table",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"วันที่"}),y.jsx("th",{children:"เวลา"}),y.jsx("th",{children:"สถานะ"}),y.jsx("th",{children:"รายการที่ส่ง"})]})}),y.jsx("tbody",{children:C.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:4,style:{textAlign:"center",color:"#666",padding:"20px"},children:V&&b?`ไม่มีใบยอดสำหรับ กองพัน ${V} กองร้อย ${b}`:"ไม่มีข้อมูลใบยอด กรุณากรอกข้อมูลสังกัดด้านล่าง"})}):C.map(q=>{let se=!1,me=[];try{const ee=q.other?JSON.parse(q.other):{},Ae=S&&_?`${S}(${_})`:S||"";Object.entries(ee).forEach(([Te,Ye])=>{Array.isArray(Ye.names)&&Ye.names.includes(Ae)&&(se=!0,me.push(Te))})}catch{}return y.jsxs("tr",{children:[y.jsx("td",{children:q.date}),y.jsx("td",{children:q.time}),y.jsx("td",{children:se?y.jsx("span",{className:"status-sent",children:"ส่งจำหน่ายแล้ว"}):y.jsx("span",{className:"status-not-sent",children:"ยังไม่ได้ส่ง"})}),y.jsx("td",{children:me.length>0?me.map((ee,Ae)=>y.jsxs("span",{children:[ee,Ae<me.length-1?", ":""]},ee)):"-"})]},q.id)})})]})})]}),y.jsxs("div",{style:{marginBottom:32,border:"2px solid #007bff",borderRadius:8,padding:16,background:"#f8faff"},children:[y.jsx("h3",{style:{color:"#007bff"},children:"ส่งยอดจำหน่าย (สำหรับผู้ใช้ทั่วไป)"}),n?y.jsxs(y.Fragment,{children:[y.jsxs("div",{style:{marginBottom:8},children:[y.jsx("b",{children:"เลือกใบยอดที่ต้องการลงยอด:"}),y.jsxs("select",{value:p,onChange:Oe,style:{marginLeft:8},children:[y.jsx("option",{value:"",children:"-- เลือกใบยอด --"}),C.map(q=>y.jsxs("option",{value:q.id,children:[q.date," | ",q.time]},q.id))]})]}),y.jsxs("div",{style:{marginBottom:8},children:[y.jsx("b",{children:"รายการจำหน่ายของคุณ:"}),a.length===0&&y.jsx("div",{style:{color:"#888"},children:"ไม่มีรายการจำหน่าย"}),a.map((q,se)=>{let me=!1;if(p){const ee=C.find(Ae=>String(Ae.id)===String(p));if(ee)try{const Ae=ee.other?JSON.parse(ee.other):{},Te=S&&_?`${S}(${_})`:S||"";Ae[q.key]&&Array.isArray(Ae[q.key].names)&&Ae[q.key].names.includes(Te)&&(me=!0)}catch{}}return y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:4,alignItems:"center"},children:[y.jsx("input",{type:"checkbox",checked:f===se,onChange:()=>je(se),style:{marginRight:4},disabled:me}),y.jsxs("span",{style:{flex:2},children:[q.key,me&&y.jsx("span",{style:{color:"#1976d2",fontWeight:500,marginLeft:8},children:"(คุณส่งยอดนี้แล้ว)✅"})]}),y.jsxs("span",{style:{flex:1},children:["จำนวน ",q.value]})]},se)})]}),y.jsxs("div",{style:{display:"flex",gap:8},children:[y.jsx("button",{className:"btn btn-primary",style:{marginBottom:0},onClick:Ue,children:"ส่งยอดจำหน่าย"}),y.jsx("button",{type:"button",className:"btn",style:{marginBottom:0,background:"#eee",color:"#333"},onClick:()=>{m(""),g(null),i(!1)},children:"ยกเลิก"})]})]}):y.jsx("button",{className:"btn btn-primary",onClick:()=>i(!0),style:{marginBottom:0},children:"+ เพิ่มส่งยอดจำหน่าย"})]}),y.jsx("h2",{children:"สร้างใบยอด(สำหรับตัวแทนชั้น)"}),y.jsxs("form",{className:"summary-form",onSubmit:De,style:{marginBottom:32},children:[y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[y.jsxs("select",{name:"battalion",value:B.battalion,onChange:Le,required:!0,children:[y.jsx("option",{value:"",children:"เลือกกองพัน"}),y.jsx("option",{value:"1",children:"กองพัน 1"}),y.jsx("option",{value:"2",children:"กองพัน 2"}),y.jsx("option",{value:"3",children:"กองพัน 3"}),y.jsx("option",{value:"4",children:"กองพัน 4"})]}),y.jsxs("select",{name:"company",value:B.company,onChange:Le,required:!0,children:[y.jsx("option",{value:"",children:"เลือกกองร้อย"}),y.jsx("option",{value:"1",children:"กองร้อย 1"}),y.jsx("option",{value:"2",children:"กองร้อย 2"}),y.jsx("option",{value:"3",children:"กองร้อย 3"})]})]}),y.jsx("div",{style:{display:"flex",gap:8,marginBottom:8},children:y.jsxs("div",{style:{flex:1},children:[y.jsx("b",{children:"วันที่ :"}),y.jsxs("div",{style:{position:"relative",display:"inline-block",width:"100%"},children:[y.jsx("input",{name:"date",type:"date",value:B.date,onChange:Le,required:!0,style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",background:"white",cursor:"pointer",colorScheme:"light"},onFocus:q=>q.target.showPicker&&q.target.showPicker()}),!B.date&&y.jsx("div",{style:{position:"absolute",top:"50%",left:"12px",transform:"translateY(-50%)",color:"#999",pointerEvents:"none",fontSize:"14px"},children:"เลือกวันที่"})]})]})}),y.jsxs("div",{style:{flex:1},children:[y.jsx("b",{children:"เวลา :"}),y.jsx("input",{name:"time",type:"text",placeholder:"เช่น 0530, 0700, 0800, 1800, 2100",value:B.time,onChange:Le,required:!0,style:{width:"100%"}})]}),y.jsxs("div",{style:{margin:"16px 0",padding:12,border:"1px solid #eee",borderRadius:8,background:"#f9f9f9"},children:[y.jsx("b",{children:"จำนวนคนทั้งหมด (แยกชั้นปี):"}),y.jsx("div",{className:"summary-year-row",children:["5","4","3","2","1"].map(q=>y.jsxs("div",{className:"summary-year-col",children:[y.jsxs("label",{children:["ชั้น ",q,":"]}),y.jsx("input",{type:"number",min:"0",value:B[`total_year_${q}`]||"",onChange:se=>G(me=>({...me,[`total_year_${q}`]:se.target.value})),placeholder:`ชั้น ${q}`})]},q))}),y.jsxs("div",{style:{marginTop:8},children:[y.jsx("b",{children:"รวมทั้งหมด:"})," ",["5","4","3","2","1"].reduce((q,se)=>q+(Number(B[`total_year_${se}`])||0),0)]})]}),y.jsx("input",{name:"total",type:"number",placeholder:"จำนวนคนทั้งหมด",value:B.total,onChange:Le,required:!0,style:{marginBottom:8,width:"100%"}}),y.jsx("div",{style:{marginBottom:8},children:y.jsxs("div",{className:`remain ${ge<0?"negative":"positive"}`,children:[y.jsx("b",{children:"ยอดที่เหลือ:"})," ",ge]})}),y.jsx("input",{name:"note",placeholder:"ชื่อตัวแทนชั้น (ชั้นปี)",value:B.note,onChange:Le,style:{marginBottom:8,width:"100%"}}),y.jsx("button",{type:"submit",children:J?"บันทึกการแก้ไข":"บันทึกยอด"}),J&&y.jsx("button",{type:"button",onClick:()=>{oe(null),G({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),pe([{key:"",value:"",names:[""],counted:!0}])},children:"ยกเลิก"})]}),y.jsx("h3",{children:"ผลลัพธ์ยอด (แยกตามกองพัน/กองร้อย)"}),Object.keys(Ve).sort().map(q=>y.jsxs("div",{style:{marginBottom:24},children:[y.jsxs("button",{type:"button",className:"summary-accordion-btn",onClick:()=>et(q),children:[fe[q]?"▼":"►"," กองพัน ",q]}),fe[q]&&y.jsx("div",{children:Object.keys(Ve[q]).sort().map(se=>y.jsxs("div",{style:{marginBottom:12,marginLeft:24},children:[y.jsxs("button",{type:"button",className:"summary-company-btn",onClick:()=>tt(q,se),children:[Se[`${q}-${se}`]?"▼":"►"," กองร้อย ",se]}),Se[`${q}-${se}`]&&y.jsx("div",{className:"table-wrapper",children:y.jsxs("table",{className:"summary-table",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"วันที่"}),y.jsx("th",{children:"เวลา"}),y.jsx("th",{children:"ทั้งหมด"}),y.jsx("th",{children:"จำหน่าย"}),y.jsx("th",{children:"ยอดที่เหลือ"}),y.jsx("th",{children:"ตัวแทนชั้น"}),y.jsx("th",{children:"แก้ไข"})]})}),y.jsx("tbody",{children:Ve[q][se].map(me=>{let ee=Number(me.total)||0,Ae={};try{Ae=JSON.parse(me.other),ee-=Object.entries(Ae).reduce((Te,[Ye,Gt])=>$[me.id]&&$[me.id][Ye]?Te:Te+(Number(Gt.count)||0),0)}catch{}return y.jsxs("tr",{children:[y.jsx("td",{"data-label":"วันที่",children:me.date}),y.jsx("td",{"data-label":"แถวกี่โมง",children:me.time}),y.jsx("td",{"data-label":"ทั้งหมด",children:me.total}),y.jsx("td",{"data-label":"จำหน่าย",className:"summary-sale-cell",children:Ae&&Object.entries(Ae).length>0?y.jsx("button",{type:"button",className:"summary-view-btn",onClick:()=>ot(Ae,me.id),children:"ดูรายการจำหน่าย"}):y.jsx("span",{className:"summary-no-data",children:"-"})}),y.jsx("td",{"data-label":"ยอดที่เหลือ",children:y.jsx("span",{className:ee<0?"summary-remain-negative":"summary-remain-positive",children:ee})}),y.jsx("td",{"data-label":"ตัวแทนชั้น",children:me.note}),y.jsxs("td",{"data-label":"แก้ไข",children:[y.jsx("button",{type:"button",className:"summary-edit-btn",onClick:()=>ki(me),children:"แก้ไข"}),y.jsx("button",{type:"button",className:"summary-delete-btn",onClick:()=>re(me.id),title:"ลบ",children:"ลบ"})]})]},me.id)})})]})})]},se))})]},q)),ce&&y.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>Ne(!1),children:y.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:24,minWidth:260,maxWidth:350,boxShadow:"0 2px 16px rgba(0,0,0,0.18)",position:"relative"},onClick:q=>q.stopPropagation(),children:[y.jsx("h4",{style:{marginTop:0},children:"รายการจำหน่าย"}),y.jsx("div",{children:Re&&Object.keys(Re).length>0?Object.entries(Re).map(([q,se])=>y.jsxs("div",{style:{marginBottom:12},children:[y.jsxs("div",{style:{fontWeight:600,marginBottom:2},children:[q," : ",se.count]}),y.jsx("ul",{style:{paddingLeft:18,margin:0},children:Array.isArray(se.names)&&se.names.length>0?se.names.map((me,ee)=>y.jsxs("li",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[y.jsx("span",{style:{flex:1},children:me}),y.jsx("button",{style:{marginLeft:8,background:"#e53935",color:"#fff",border:"none",borderRadius:4,padding:"2px 10px",fontSize:"0.92em",cursor:"pointer"},onClick:()=>$r(Ze,q,me),children:"ลบ"})]},me)):y.jsx("li",{style:{color:"#888"},children:"ไม่มีชื่อผู้ใช้"})})]},q)):y.jsx("div",{style:{color:"#888"},children:"ไม่มีรายการ"})}),y.jsx("button",{style:{marginTop:16,background:"#1976d2",color:"#fff",border:"none",borderRadius:4,padding:"4px 16px",cursor:"pointer"},onClick:()=>Ne(!1),children:"ปิด"})]})}),de&&y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},children:y.jsxs("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"15px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",textAlign:"center",maxWidth:"400px",margin:"20px",border:`3px solid ${Ee==="success"?"#4CAF50":"#f44336"}`},children:[y.jsx("div",{style:{fontSize:"3rem",marginBottom:"15px"},children:Ee==="success"?"✅":"❌"}),y.jsx("h3",{style:{margin:"0 0 15px 0",color:Ee==="success"?"#4CAF50":"#f44336",fontSize:"1.3rem"},children:Ee==="success"?"สำเร็จ!":"เกิดข้อผิดพลาด!"}),y.jsx("p",{style:{margin:"0 0 25px 0",color:"#666",fontSize:"1.1rem",lineHeight:"1.5"},children:ct}),y.jsx("button",{onClick:Be,style:{backgroundColor:Ee==="success"?"#4CAF50":"#f44336",color:"white",border:"none",padding:"12px 30px",borderRadius:"8px",fontSize:"1.1rem",fontWeight:"500",cursor:"pointer",minWidth:"100px",transition:"all 0.3s ease"},onMouseOver:q=>q.target.style.opacity="0.9",onMouseOut:q=>q.target.style.opacity="1",children:"ตกลง"})]})})]})})}const nw=()=>{const[e,t]=M.useState(null),[n,i]=M.useState(null),[a,l]=M.useState(!0),[f,g]=M.useState(null);M.useEffect(()=>{(()=>{try{const _=localStorage.getItem("token"),k=localStorage.getItem("userInfo");if(_&&i(_),k){const V=JSON.parse(k);t(V),console.log("⚡ Fast loaded user info:",V)}}catch(_){console.error("❌ Error loading basic user data:",_),localStorage.removeItem("token"),localStorage.removeItem("userInfo")}finally{l(!1)}})()},[]);const p=async()=>{if(!(!n||f))try{const _=await(await fetch(`/api/user/profile?token=${encodeURIComponent(n)}&includeImage=true`)).json();if(_.status&&_.data.profileImage){const k=`data:image/jpeg;base64,${_.data.profileImage}`;g(k),console.log("🖼️ Profile image loaded")}}catch(R){console.error("Error loading profile image:",R)}},m=async()=>{if(n)try{const _=await(await fetch(`/api/user/profile?token=${encodeURIComponent(n)}`)).json();if(_.status)return t(_.data),localStorage.setItem("userInfo",JSON.stringify(_.data)),console.log("🔄 User data refreshed:",_.data),_.data}catch(R){console.error("Error refreshing user data:",R)}},C=()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),i(null),t(null),g(null)},E=R=>{t(R),localStorage.setItem("userInfo",JSON.stringify(R))};return{user:e,token:n,isLoading:a,isLoggedIn:!!n&&!!e,isAdmin:(()=>(e==null?void 0:e.admin)===!0||(e==null?void 0:e.role)==="admin")(),profileImage:f,logout:C,updateUser:E,loadProfileImage:p,refreshUserData:m,hasProfileImage:!!f}},Yc=(e,t,n={})=>{const{redirectTo:i="/login",showMessage:a=!0,fallbackComponent:l=null}=n;return function(g){const{user:p,isLoading:m}=nw();return m?y.jsx("div",{className:"permission-loading",children:y.jsxs("div",{className:"loading",children:[y.jsx("div",{className:"spinner"}),"กำลังตรวจสอบสิทธิ์..."]})}):p?Eb(p,t)?y.jsx(e,{...g,user:p}):l?y.jsx(l,{user:p,requiredPage:t}):a?y.jsx("div",{className:"permission-denied",children:y.jsxs("div",{className:"permission-denied-container",children:[y.jsx("div",{className:"permission-denied-icon",children:"🚫"}),y.jsx("h2",{children:"ไม่มีสิทธิ์เข้าถึง"}),y.jsx("p",{children:ew(p.role,"เข้าถึงหน้านี้")}),y.jsxs("div",{className:"permission-actions",children:[y.jsx("button",{onClick:()=>window.history.back(),className:"btn-back",children:"กลับหน้าก่อนหน้า"}),y.jsx("button",{onClick:()=>window.location.href="/",className:"btn-home",children:"กลับหน้าหลัก"})]})]})}):y.jsx(ac,{to:"/",replace:!0}):y.jsx(ac,{to:i,replace:!0})}},Ab=({user:e,requiredPage:t,onBack:n,onHome:i})=>y.jsx("div",{className:"permission-denied",children:y.jsxs("div",{className:"permission-denied-container",children:[y.jsx("div",{className:"permission-denied-icon",children:"🚫"}),y.jsx("h2",{children:"ไม่มีสิทธิ์เข้าถึง"}),y.jsx("p",{children:ew(e==null?void 0:e.role,"เข้าถึงหน้านี้")}),y.jsxs("div",{className:"permission-denied-info",children:[y.jsx("p",{children:"หน้านี้เฉพาะสำหรับผู้ที่มีสิทธิ์เท่านั้น"}),y.jsx("p",{children:"หากคุณเชื่อว่านี่เป็นข้อผิดพลาด กรุณาติดต่อผู้ดูแลระบบ"})]}),y.jsxs("div",{className:"permission-actions",children:[y.jsx("button",{onClick:n||(()=>window.history.back()),className:"btn-back",children:"กลับหน้าก่อนหน้า"}),y.jsx("button",{onClick:i||(()=>window.location.href="/"),className:"btn-home",children:"กลับหน้าหลัก"})]})]})});const Tb=()=>{const{user:e,isLoading:t}=nw(),[n,i]=M.useState([]),[a,l]=M.useState(""),[f,g]=M.useState(!1),[p,m]=M.useState(null),[C,E]=M.useState(""),[S,R]=M.useState("");console.log("RoleManager - User data:",e),console.log("RoleManager - Loading:",t),console.log("RoleManager - User admin status:",e==null?void 0:e.admin);const _=async()=>{g(!0),E("");try{const A=localStorage.getItem("token"),O=await fetch("/api/search-users?q=",{headers:{Authorization:`Bearer ${A}`}});if(!O.ok)throw new Error("Failed to load users");const F=await O.json();F.status?i(F.data||[]):E(F.message||"Failed to load users")}catch(A){console.error("Error loading users:",A),E("เกิดข้อผิดพลาดในการโหลดข้อมูลผู้ใช้")}finally{g(!1)}},k=async A=>{if(!A.trim()){_();return}g(!0),E("");try{const O=localStorage.getItem("token"),F=await fetch(`/api/search-users?q=${encodeURIComponent(A)}`,{headers:{Authorization:`Bearer ${O}`}});if(!F.ok)throw new Error("Failed to search users");const H=await F.json();H.status?i(H.data||[]):E(H.message||"Failed to search users")}catch(O){console.error("Error searching users:",O),E("เกิดข้อผิดพลาดในการค้นหาผู้ใช้")}finally{g(!1)}},V=async(A,O)=>{m(A),E(""),R("");try{const F=localStorage.getItem("token"),H=await fetch("/api/user/role",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({userId:A,role:O})});if(!H.ok)throw new Error("Failed to update role");const U=await H.json();U.status?(R(`อัปเดต role เป็น ${N(O)} สำเร็จ`),i(B=>B.map(G=>G.id===A?{...G,role:O,admin:O==="admin"}:G)),setTimeout(()=>R(""),3e3)):E(U.message||"Failed to update role")}catch(F){console.error("Error updating role:",F),E("เกิดข้อผิดพลาดในการอัปเดต role")}finally{m(null)}},N=A=>({student:"นักเรียน",teacher:"อาจารย์",officer:"นายทหาร",admin:"แอดมิน"})[A]||A,b=A=>({student:"role-student",teacher:"role-teacher",officer:"role-officer",admin:"role-admin"})[A]||"";return M.useEffect(()=>{e&&e.admin&&_()},[e]),M.useEffect(()=>{const A=setTimeout(()=>{e&&e.admin&&k(a)},500);return()=>clearTimeout(A)},[a,e]),t?y.jsx("div",{className:"role-manager",children:y.jsxs("div",{className:"loading",children:[y.jsx("div",{className:"spinner"}),"กำลังโหลด..."]})}):e?ys(e,rt.MANAGE_ROLES)?y.jsxs("div",{className:"role-manager",children:[y.jsx(tw,{}),y.jsxs("div",{className:"role-manager-container",children:[y.jsx("div",{className:"role-manager-header",children:y.jsxs("div",{className:"header-content",children:[y.jsxs("div",{className:"title-section",children:[y.jsx("h1",{children:"การจัดการสิทธิ์ผู้ใช้"}),y.jsx("p",{className:"subtitle",children:"จัดการ Role และสิทธิ์การเข้าถึงของผู้ใช้ในระบบ"})]}),y.jsx("div",{className:"stats-section",children:y.jsxs("div",{className:"stats-card",children:[y.jsx("span",{className:"stats-number",children:n.length}),y.jsx("span",{className:"stats-label",children:"ผู้ใช้ทั้งหมด"})]})})]})}),y.jsx("div",{className:"search-section",children:y.jsxs("div",{className:"search-container",children:[y.jsx("div",{className:"search-icon",children:"🔍"}),y.jsx("input",{type:"text",placeholder:"ค้นหาผู้ใช้ (ชื่อ, รหัสประจำตัว, username)",value:a,onChange:A=>l(A.target.value),className:"search-input"}),a&&y.jsx("button",{onClick:()=>l(""),className:"clear-search","aria-label":"ล้างการค้นหา",children:"✕"})]})}),C&&y.jsx("div",{className:"alert alert-error",children:C}),S&&y.jsx("div",{className:"alert alert-success",children:S}),y.jsx("div",{className:"users-section",children:f?y.jsxs("div",{className:"loading-users",children:[y.jsx("div",{className:"spinner"}),y.jsx("span",{children:"กำลังโหลดข้อมูลผู้ใช้..."})]}):y.jsx("div",{className:"users-grid",children:n.length===0?y.jsx("div",{className:"no-users",children:"ไม่พบผู้ใช้"}):n.map(A=>{var O;return y.jsxs("div",{className:"user-card",children:[y.jsxs("div",{className:"user-card-header",children:[y.jsx("div",{className:"user-avatar",children:((O=A.realname)==null?void 0:O.charAt(0))||"?"}),y.jsxs("div",{className:"user-basic-info",children:[y.jsx("div",{className:"user-name",children:y.jsx("strong",{children:A.realname})}),y.jsxs("div",{className:"user-username",children:["@",A.username]})]}),y.jsx("div",{className:"current-role-badge",children:y.jsx("span",{className:`role-badge ${b(A.role)}`,children:N(A.role)})})]}),y.jsx("div",{className:"user-card-body",children:y.jsxs("div",{className:"user-details-grid",children:[y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"รหัสประจำตัว:"}),y.jsx("span",{className:"detail-value",children:A.userid})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"หน่วย:"}),y.jsxs("span",{className:"detail-value",children:[A.battalion,"-",A.company,"-",A.platoon,"-",A.squad]})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"ชั้นปี:"}),y.jsx("span",{className:"detail-value",children:A.year})]})]})}),y.jsx("div",{className:"user-card-footer",children:y.jsxs("div",{className:"role-controls",children:[y.jsx("label",{children:"เปลี่ยนสิทธิ์:"}),y.jsxs("div",{className:"role-select-container",children:[y.jsxs("select",{value:A.role,onChange:F=>V(A.id,F.target.value),disabled:p===A.id,className:"role-select",children:[y.jsx("option",{value:"student",children:"นักเรียน"}),y.jsx("option",{value:"teacher",children:"อาจารย์"}),y.jsx("option",{value:"officer",children:"นายทหาร"}),y.jsx("option",{value:"admin",children:"แอดมิน"})]}),p===A.id&&y.jsxs("div",{className:"updating-indicator",children:[y.jsx("div",{className:"small-spinner"}),y.jsx("span",{children:"อัปเดต..."})]})]})]})})]},A.id)})})})]})]}):y.jsx("div",{className:"role-manager",children:y.jsx(Ab,{user:e,requiredPage:"role-manager"})}):(console.log("No user found, redirecting to login"),y.jsx(ac,{to:"/login",replace:!0}))},Ib=Yc(OT,"deduct-point"),bb=Yc(ab,"gun-borrowing"),Nb=Yc(Tb,"role-manager"),Rb=Yc(Sb,"summary");function Mb(){const e=_r(),t=e.pathname==="/login"||e.pathname==="/register";return y.jsxs(y.Fragment,{children:[!t&&y.jsx(tw,{}),y.jsxs(lv,{children:[y.jsx(_n,{path:"/",element:y.jsx(pl,{children:y.jsx(NT,{})})}),y.jsx(_n,{path:"/users",element:y.jsx(pl,{children:y.jsx(DT,{})})}),y.jsx(_n,{path:"/login",element:y.jsx(RT,{})}),y.jsx(_n,{path:"/register",element:y.jsx(MT,{})}),y.jsx(_n,{path:"/behavior-point",element:y.jsx(_T,{})}),y.jsx(_n,{path:"/DeductPoint",element:y.jsx(Ib,{})}),y.jsx(_n,{path:"/edit-profile",element:y.jsx(pl,{children:y.jsx(kT,{})})}),y.jsx(_n,{path:"/view-profile",element:y.jsx(pl,{children:y.jsx(vI,{})})}),y.jsx(_n,{path:"/gun-borrowing",element:y.jsx(bb,{})}),y.jsx(_n,{path:"/summary",element:y.jsx(Rb,{})}),y.jsx(_n,{path:"/role-manager",element:y.jsx(Nb,{})}),y.jsx(_n,{path:"*",element:y.jsx("h1",{children:"404 Not Found"})})]})]})}const Db=()=>y.jsx(Ov,{children:y.jsx(Mb,{})});Bx(document.getElementById("root")).render(y.jsx(mi.StrictMode,{children:y.jsx(Db,{})}));
========
⚠️ การลบจะไม่สามารถกู้คืนได้`;if(window.confirm(ie))try{const Ve=await(await fetch("/api/gun-borrowing-record",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:W})})).json();Ve.success?(l(`✅ ลบข้อมูลทั้งหมดในวันที่ ${W} สำเร็จ (${Ve.deletedCount||0} รายการ)`),Re(W)):l("❌ ลบข้อมูลไม่สำเร็จ")}catch(De){console.error("Failed to delete all records:",De),l("❌ เกิดข้อผิดพลาดในการลบข้อมูล")}},Se=async ie=>{if(ie.preventDefault(),!!_)try{(await fetch("/api/public-gun",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gunQRCode:_})})).ok?(k(""),N("เพิ่มปืนสำเร็จ"),Ft()):N("เพิ่มปืนไม่สำเร็จ")}catch{N("เกิดข้อผิดพลาด")}},Ae=async ie=>{if(window.confirm(`ลบปืน ${ie} ?`))try{(await fetch("/api/public-gun",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({gunQRCode:ie})})).ok?(N("ลบปืนสำเร็จ"),Ft()):N("ลบปืนไม่สำเร็จ")}catch{N("เกิดข้อผิดพลาด")}},Ge=ie=>{ie.preventDefault(),f&&p?(t(f),i(p),l("กรอกข้อมูล QR Code สำเร็จ"),g(""),m("")):l("กรุณากรอกข้อมูลให้ครบ")},K=async ie=>{console.log("Scanned QR Code:",ie);const De=await Be(ie);if(console.log("Detection result - Is User QR:",De),console.log(`🎯 Detected: ${ie} = ${De?"User":"Gun"} QR`),De&&!e)t(ie),l(`✅ ตรวจจับ User QR: ${ie}`);else if(!De&&!n){const et=ie.replace(/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i,"");i(et),l(`✅ ตรวจจับ Gun QR: ${ie} (บันทึกเป็น: ${et})`)}else if(De&&e)e===ie?l(`⚠️ User QR [${ie}] สแกนไปแล้ว`):(l(`⚠️ เปลี่ยน User QR: ${e} → ${ie}`),t(ie));else if(!De&&n){const et=ie.replace(/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i,"");n===et?l(`⚠️ Gun QR [${ie}] สแกนไปแล้ว`):(l(`⚠️ เปลี่ยน Gun QR: ${n} → ${et}`),i(et))}},Be=async ie=>{console.log("Checking QR Code from database:",ie);try{const Ve=await(await fetch(`/api/check-user-qr?qr=${encodeURIComponent(ie)}`)).json();return Ve.success?Ve.isUser?(console.log("Detected as User QR from database:",Ve.userInfo),!0):(console.log("QR not found in user database, checking patterns"),je(ie)):(console.log("Database check failed, using pattern matching"),je(ie))}catch(De){return console.error("Error checking QR code:",De),console.log("Database unavailable, using pattern matching"),je(ie)}},je=ie=>(console.log("Checking pattern for QR:",ie),/^(GUN-|WEAPON-|W-|G-|gun-|Gun-|RIFLE-|rifle-)/i.test(ie)?(console.log("Pattern: Detected as Gun QR - has gun prefix"),!1):/^[0-9]{1,3}[-_][0-9]+$/.test(ie)||/^[A-Z][0-9]{3,6}$/.test(ie)?(console.log("Pattern: Detected as Gun QR - serial number format"),!1):/^\d+$/.test(ie)?ie.length>=3?(console.log("Pattern: Detected as User QR - numeric user ID"),!0):(console.log("Pattern: Detected as Gun QR - too short for user ID"),!1):/^[A-Za-z][0-9]+$/.test(ie)?(console.log("Pattern: Detected as User QR - alphanumeric user ID"),!0):/[^A-Za-z0-9]/.test(ie)&&!/^[A-Za-z0-9]+$/.test(ie)?(console.log("Pattern: Detected as Gun QR - contains special characters"),!1):ie.length<=2?(console.log("Pattern: Detected as Gun QR - very short"),!1):(console.log("Pattern: Detected as User QR - default case"),!0)),Oe=async()=>{if(X&&oe){Ue();return}const ie="qr-reader";if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){l("เบราว์เซอร์ไม่รองรับการใช้กล้อง");return}try{await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}})}catch(et){console.error("Camera permission error:",et),l("ไม่สามารถเข้าถึงกล้องได้ กรุณาอนุญาตการใช้กล้อง");return}const De={fps:pe?5:10,qrbox:pe?{width:Math.min(300,window.innerWidth-40),height:Math.min(300,window.innerWidth-40)}:{width:250,height:250},aspectRatio:1,supportedScanTypes:[Qr.SCAN_TYPE_CAMERA],videoConstraints:{facingMode:"environment",width:pe?{ideal:640}:{ideal:1280},height:pe?{ideal:480}:{ideal:720}}},Ve=new oI(ie,De);ve(Ve),fe(!0),Ve.render(et=>{navigator.vibrate&&pe&&navigator.vibrate(200),K(et)},et=>{console.log("Scan failed:",et),et.includes("NotAllowedError")?l("ไม่ได้รับอนุญาตให้ใช้กล้อง"):et.includes("NotFoundError")?l("ไม่พบกล้อง"):et.includes("NotReadableError")&&l("กล้องถูกใช้งานโดยแอปอื่น")})},Ue=()=>{oe&&(oe.clear().catch(console.error),ve(null),fe(!1))};R.useEffect(()=>{e&&n&&Le()},[e,n]);const Le=async()=>{try{l("🔍 กำลังตรวจสอบข้อมูลกับ Database...");const De=await(await fetch(`/api/get-user-details?userQRCode=${e}`)).json();if(!De.success){l(`❌ ไม่พบข้อมูล User: ${e} ในระบบ`);return}const Ve=new Date().toISOString().split("T")[0],tt=await(await fetch(`/api/gun-borrowing-record?date=${Ve}&userQRCode=${e}&gunQRCode=${n}`)).json();if(tt.success&&tt.data.length>0){tt.data[0].status==="borrowed"?await st(e,n,De.realname,"return")&&(l(`✅ คืนปืนสำเร็จ: ${De.realname} คืนปืน ${n}`),Fe()):l(`⚠️ ${De.realname} คืนปืน ${n} ไปแล้ววันนี้`);return}const ot=De.gunNumber;ot&&ot===n?(l(`✅ ตรวจสอบสำเร็จ: ${De.realname} | ปืน: ${n}`),await st(e,n,De.realname,"borrow")&&Fe()):ot?(l(`⚠️ ปืนไม่ตรงกัน! ${De.realname} ควรใช้ปืน: ${ot} แต่สแกน: ${n}`),setTimeout(async()=>{await st(e,n,De.realname,"borrow")&&Fe()},2e3)):(l(`⚠️ ${De.realname} ไม่มีปืนที่กำหนดในระบบ แต่สแกนปืน: ${n}`),await st(e,n,De.realname,"borrow")&&Fe())}catch(ie){console.error("Check user-gun match error:",ie),l("❌ เกิดข้อผิดพลาดในการตรวจสอบข้อมูล")}},Fe=()=>{setTimeout(()=>{t(""),i(""),l("🔄 พร้อมสแกนคู่ต่อไป")},3e3)},kt=()=>{Ue(),t(""),i(""),l("🔄 รีเซ็ตเรียบร้อย - พร้อมสแกนใหม่"),setTimeout(()=>{l("")},2e3)};return y.jsx("div",{className:"gun-borrowing-bg",children:y.jsxs("div",{className:"gun-borrowing-container",children:[y.jsx("h1",{className:"gun-borrowing-title",children:"ระบบยืม-คืนปืน"}),y.jsxs("div",{className:"gun-borrowing-card",children:[y.jsxs("div",{className:"qr-section",children:[y.jsx("label",{className:"qr-label",children:"สแกน QR Code (User หรือ Gun)"}),y.jsx("div",{id:"qr-reader",className:"qr-reader"}),y.jsx("button",{onClick:()=>Oe(),className:"qr-scan-btn",disabled:B,style:{background:B?"#f3f4f6":X?"#dc2626":"#3b82f6",color:B?"#9ca3af":"white",border:"1px solid #d1d5db",borderRadius:"8px",padding:"12px 24px",cursor:B?"not-allowed":"pointer",fontSize:"16px",fontWeight:"500",width:"100%",margin:"8px 0"},children:B?"🔄 กำลังเปิดกล้อง...":X?"🛑 หยุดสแกน QR Code":"📷 เปิดกล้องสแกน QR Code"}),y.jsxs("div",{className:"qr-help-text",children:["💡 ",pe?X?"📱 กล้องเปิดแล้ว - สแกน User QR หรือ Gun QR ได้ทันที":"หมุนโทรศัพท์เป็นแนวตั้ง สแกน User QR หรือ Gun QR ได้ทันที":X?"🎥 กล้องเปิดแล้ว - สแกน QR Code ใดก็ได้ (User หรือ Gun) ระบบจะแยกแยะให้อัตโนมัติ":"สแกน QR Code ใดก็ได้ (User หรือ Gun) ระบบจะแยกแยะให้อัตโนมัติ"]}),y.jsxs("div",{style:{display:"flex",gap:"16px",marginTop:"12px",flexDirection:pe?"column":"row"},children:[y.jsxs("div",{className:"qr-result",style:{flex:1},children:[y.jsx("b",{children:"👤 User:"})," ",e?y.jsxs("span",{className:"qr-result-value",style:{color:"#059669"},children:["✅ ",e]}):y.jsx("span",{className:"qr-result-none",style:{color:"#6b7280"},children:"ยังไม่ได้สแกน"})]}),y.jsxs("div",{className:"qr-result",style:{flex:1},children:[y.jsx("b",{children:"🔫 Gun:"})," ",n?y.jsxs("span",{className:"qr-result-value",style:{color:"#dc2626"},children:["✅ ",n]}):y.jsx("span",{className:"qr-result-none",style:{color:"#6b7280"},children:"ยังไม่ได้สแกน"})]})]}),(e||n)&&y.jsx("div",{style:{marginTop:"12px",padding:"8px 12px",background:e&&n?"#dcfce7":"#fef3c7",border:`1px solid ${e&&n?"#16a34a":"#f59e0b"}`,borderRadius:"6px",fontSize:"14px",color:e&&n?"#166534":"#92400e"},children:e&&n?"✅ สแกนครบแล้ว! กำลังตรวจสอบข้อมูล...":`⏳ สแกนแล้ว ${(e?1:0)+(n?1:0)}/2 รายการ - ${e?"ต้องการ Gun QR":"ต้องการ User QR"}`}),X&&y.jsx("div",{style:{marginTop:"8px",padding:"6px 10px",background:"#e0f2fe",border:"1px solid #0284c7",borderRadius:"6px",fontSize:"12px",color:"#0369a1",textAlign:"center"},children:"🎥 กล้องเปิดอยู่ - พร้อมสแกน QR Code"}),(e||n)&&y.jsxs("div",{style:{marginTop:"8px",padding:"6px 10px",background:"#f1f5f9",border:"1px solid #cbd5e1",borderRadius:"6px",fontSize:"11px",color:"#475569"},children:["🔍 Debug: ",e?`User(${e})`:"User(-)"," | ",n?`Gun(${n})`:"Gun(-)"]})]}),y.jsx("button",{onClick:kt,className:"btn-reset",style:{background:"#f59e0b",color:"white",border:"1px solid #d97706",borderRadius:"8px",padding:"10px 20px",cursor:"pointer",fontSize:"14px",fontWeight:"500",width:"100%",marginTop:"12px"},children:"🔄 เริ่มสแกนใหม่"}),y.jsx("button",{type:"button",className:"gun-borrowing-print-btn btn-toggle-form",onClick:()=>E(ie=>!ie),children:C?"❌ ปิดฟอร์มกรอกข้อมูล":"⌨️ กรอกข้อมูลด้วยตนเอง"}),C&&y.jsxs("form",{onSubmit:Ge,className:"manual-form",children:[y.jsx("div",{className:"manual-form-title",children:"⌨️ กรอกข้อมูล QR Code ด้วยตนเอง"}),y.jsx("input",{type:"text",placeholder:"รหัสผู้ใช้ (User ID)",value:f,onChange:ie=>g(ie.target.value),className:"manual-input"}),y.jsx("input",{type:"text",placeholder:"หมายเลขปืน (Gun Number)",value:p,onChange:ie=>m(ie.target.value),className:"manual-input"}),y.jsx("button",{type:"submit",className:"gun-borrowing-print-btn manual-submit",disabled:B,children:B?"🔄 กำลังประมวลผล...":"✅ ยืนยันข้อมูล"})]}),y.jsx("div",{style:{marginTop:"12px"},children:y.jsxs("details",{style:{marginBottom:"8px"},children:[y.jsx("summary",{style:{cursor:"pointer",fontSize:"12px",color:"#6b7280",marginBottom:"8px"},children:"🧪 ทดสอบการตรวจจับ QR Code"}),y.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px"},children:[y.jsx("button",{onClick:()=>K("1234567890"),style:{fontSize:"10px",padding:"4px 8px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px"},children:"Test: 1234567890"}),y.jsx("button",{onClick:()=>K("A123"),style:{fontSize:"10px",padding:"4px 8px",background:"#3b82f6",color:"white",border:"none",borderRadius:"4px"},children:"Test: A123"}),y.jsx("button",{onClick:()=>K("GUN-001"),style:{fontSize:"10px",padding:"4px 8px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px"},children:"Test: GUN-001"}),y.jsx("button",{onClick:()=>K("WEAPON-123"),style:{fontSize:"10px",padding:"4px 8px",background:"#ef4444",color:"white",border:"none",borderRadius:"4px"},children:"Test: WEAPON-123"}),y.jsx("button",{onClick:()=>K("ABC123DEF"),style:{fontSize:"10px",padding:"4px 8px",background:"#6b7280",color:"white",border:"none",borderRadius:"4px"},children:"Test: ABC123DEF"})]})]})}),a&&y.jsx("div",{className:`gun-borrowing-status ${a.includes("Successful")||a.includes("✅")?"success":"error"}`,children:a}),B&&y.jsx("div",{className:"loading-message",children:y.jsx("div",{className:"loading-text",children:"🔄 กำลังประมวลผล..."})}),te&&y.jsxs("div",{className:"network-error",children:[y.jsx("div",{className:"network-error-title",children:"❌ ไม่สามารถเชื่อมต่อได้"}),y.jsxs("div",{className:"network-error-text",children:["ตรวจสอบการเชื่อมต่ออินเทอร์เน็ต (ลองใหม่ ",he," ครั้ง)"]}),y.jsx("button",{onClick:()=>{me(!1),ge()},className:"retry-btn",children:"ลองใหม่"})]})]}),y.jsxs("div",{className:"public-gun-section",children:[y.jsx("h2",{className:"public-gun-title",children:"ปืนสาธารณะ (Public Gun)"}),y.jsx("button",{type:"button",className:"gun-borrowing-print-btn",style:{width:"100%",marginBottom:b?0:16},onClick:()=>S(ie=>!ie),children:b?"ปิดฟอร์มเพิ่มปืน":"เพิ่มปืนสาธารณะ"}),b&&y.jsxs("form",{onSubmit:Se,className:"public-gun-form",children:[y.jsx("input",{type:"text",placeholder:"Gun QR Code",value:_,onChange:ie=>k(ie.target.value),className:"public-gun-input"}),y.jsx("button",{type:"submit",className:"gun-borrowing-print-btn public-gun-add-btn",children:"เพิ่ม"})]}),V&&y.jsx("div",{className:"public-gun-status",children:V}),y.jsx("div",{style:{maxHeight:120,overflowY:"auto"},children:y.jsxs("table",{style:{width:"100%",fontSize:"1rem"},children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{style:{width:"70%"},children:"Gun QR Code"}),y.jsx("th",{style:{width:"30%"},children:"ลบ"})]})}),y.jsx("tbody",{children:A.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:2,style:{color:"#888",textAlign:"center"},children:"ไม่มีข้อมูล"})}):A.map(ie=>y.jsxs("tr",{children:[y.jsx("td",{children:ie.gunId}),y.jsx("td",{children:y.jsx("button",{type:"button",style:{background:"#e53935",color:"#fff",border:"none",borderRadius:6,padding:"4px 12px",cursor:"pointer"},onClick:()=>Ae(ie.gunId),children:"ลบ"})})]},ie.gunId))})]})})]}),y.jsxs("div",{style:{background:O.all&&O.all.length>0?"#e8f5e8":"#f0f4f8",borderRadius:10,padding:16,margin:"16px auto",maxWidth:1200,border:O.all&&O.all.length>0?"2px solid #4caf50":"2px solid #e0e0e0"},children:[y.jsxs("h3",{style:{color:"#2e7d32",marginBottom:12},children:["📊 ข้อมูลที่บันทึกแล้วในวันที่ ",W]}),y.jsxs("div",{style:{display:"flex",gap:"24px",marginBottom:12},children:[y.jsxs("div",{style:{color:"#1976d2"},children:[y.jsx("strong",{children:"เบิกทั้งหมด:"})," ",((xe=O.summary)==null?void 0:xe.totalBorrowed)||0," คน"]}),y.jsxs("div",{style:{color:"#388e3c"},children:[y.jsx("strong",{children:"คืนแล้ว:"})," ",((Zt=O.summary)==null?void 0:Zt.totalReturned)||0," คน"]}),y.jsxs("div",{style:{color:"#f57c00"},children:[y.jsx("strong",{children:"ยังไม่คืน:"})," ",((ki=O.summary)==null?void 0:ki.notReturned)||0," คน"]})]}),y.jsxs("div",{style:{marginTop:16},children:[y.jsx("h4",{style:{color:"#1976d2",marginBottom:8},children:"รายละเอียดจาก Database:"}),y.jsx("div",{style:{maxHeight:200,overflowY:"auto",background:"white",borderRadius:6,padding:8},children:!O.all||O.all.length===0?y.jsx("div",{style:{textAlign:"center",color:"#666",padding:16},children:"ไม่มีข้อมูลในวันนี้"}):y.jsxs("table",{style:{width:"100%",fontSize:"0.9rem"},children:[y.jsx("thead",{children:y.jsxs("tr",{style:{background:"#f5f5f5"},children:[y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ชื่อ"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ปืน"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"เวลาเบิก"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"เวลาคืน"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"สถานะ"}),y.jsx("th",{style:{padding:8,border:"1px solid #ddd"},children:"ลบ"})]})}),y.jsx("tbody",{children:O.all.map((ie,De)=>y.jsxs("tr",{children:[y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:ie.realname}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:ie.gunQRCode}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:new Date(ie.borrowTime).toLocaleString("th-TH")}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd"},children:ie.returnTime?new Date(ie.returnTime).toLocaleString("th-TH"):"-"}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd",color:ie.status==="returned"?"#388e3c":"#f57c00",fontWeight:"bold"},children:ie.status==="borrowed"?"🔴 ยังไม่คืน":"✅ คืนแล้ว"}),y.jsx("td",{style:{padding:8,border:"1px solid #ddd",textAlign:"center"},children:y.jsx("button",{onClick:()=>ct(ie.id),style:{background:"#e53935",color:"#fff",border:"none",borderRadius:4,padding:"4px 8px",cursor:"pointer",fontSize:"0.8rem"},children:"🗑️ ลบ"})})]},De))})]})})]}),y.jsxs("div",{style:{fontSize:"0.9rem",color:"#666",marginTop:8},children:["💡 ข้อมูลนี้ดึงมาจาก Database",O.all&&O.all.length>0?` (มี ${O.all.length} รายการ)`:" (ยังไม่มีข้อมูลบันทึก)"]})]}),y.jsxs("div",{style:{background:"#f0f4f8",borderRadius:10,padding:16,margin:"16px auto",maxWidth:1200,textAlign:"center"},children:[y.jsx("h3",{style:{color:"#1976d2",marginBottom:12},children:"📅 ดูข้อมูลจาก Database"}),y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",marginBottom:16},children:[y.jsx("label",{style:{fontWeight:"500"},children:"เลือกวันที่:"}),y.jsx("input",{type:"date",value:W,onChange:ie=>Re(ie.target.value),style:{padding:"8px 12px",borderRadius:6,border:"1px solid #d1d9e6",fontSize:"1rem"}})]}),O.all&&O.all.length>0&&y.jsxs("div",{style:{borderTop:"1px solid #e0e0e0",paddingTop:16},children:[y.jsxs("button",{onClick:Ut,style:{background:"#d32f2f",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",cursor:"pointer",fontSize:"1rem",fontWeight:"500"},children:["🗑️ ลบข้อมูลทั้งวันที่ ",W]}),y.jsx("div",{style:{fontSize:"0.85rem",color:"#666",marginTop:8},children:"⚠️ การลบจะไม่สามารถกู้คืนได้"})]})]})]})})}var qy={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},vp=mi.createContext&&mi.createContext(qy),lI=["attr","size","title"];function cI(e,t){if(e==null)return{};var n=uI(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function uI(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function xc(){return xc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xc.apply(this,arguments)}function Sp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function yc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sp(Object(n),!0).forEach(function(i){dI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sp(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function dI(e,t,n){return t=fI(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fI(e){var t=hI(e,"string");return typeof t=="symbol"?t:t+""}function hI(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jy(e){return e&&e.map((t,n)=>mi.createElement(t.tag,yc({key:n},t.attr),Jy(t.child)))}function Gc(e){return t=>mi.createElement(gI,xc({attr:yc({},e.attr)},t),Jy(e.child))}function gI(e){var t=n=>{var{attr:i,size:a,title:l}=e,f=cI(e,lI),g=a||n.size||"1em",p;return n.className&&(p=n.className),e.className&&(p=(p?p+" ":"")+e.className),mi.createElement("svg",xc({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,f,{className:p,style:yc(yc({color:e.color||n.color},n.style),e.style),height:g,width:g,xmlns:"http://www.w3.org/2000/svg"}),l&&mi.createElement("title",null,l),e.children)};return vp!==void 0?mi.createElement(vp.Consumer,null,n=>t(n)):t(qy)}function pI(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M16 7.992C16 3.58 12.416 0 8 0S0 3.58 0 7.992c0 2.43 1.104 4.62 2.832 6.09.016.016.032.016.032.032.144.112.288.224.448.336.08.048.144.111.224.175A7.98 7.98 0 0 0 8.016 16a7.98 7.98 0 0 0 4.48-1.375c.08-.048.144-.111.224-.16.144-.111.304-.223.448-.335.016-.016.032-.016.032-.032 1.696-1.487 2.8-3.676 2.8-6.106zm-8 7.001c-1.504 0-2.88-.48-4.016-1.279.016-.128.048-.255.08-.383a4.17 4.17 0 0 1 .416-.991c.176-.304.384-.576.64-.816.24-.24.528-.463.816-.639.304-.176.624-.304.976-.4A4.15 4.15 0 0 1 8 10.342a4.185 4.185 0 0 1 2.928 1.166c.368.368.656.8.864 1.295.112.288.192.592.24.911A7.03 7.03 0 0 1 8 14.993zm-2.448-7.4a2.49 2.49 0 0 1-.208-1.024c0-.351.064-.703.208-1.023.144-.32.336-.607.576-.847.24-.24.528-.431.848-.575.32-.144.672-.208 1.024-.208.368 0 .704.064 1.024.208.32.144.608.336.848.575.24.24.432.528.576.847.144.32.208.672.208 1.023 0 .368-.064.704-.208 1.023a2.84 2.84 0 0 1-.576.848 2.84 2.84 0 0 1-.848.575 2.715 2.715 0 0 1-2.064 0 2.84 2.84 0 0 1-.848-.575 2.526 2.526 0 0 1-.56-.848zm7.424 5.306c0-.032-.016-.048-.016-.08a5.22 5.22 0 0 0-.688-1.406 4.883 4.883 0 0 0-1.088-1.135 5.207 5.207 0 0 0-1.04-.608 2.82 2.82 0 0 0 .464-.383 4.2 4.2 0 0 0 .624-.784 3.624 3.624 0 0 0 .528-1.934 3.71 3.71 0 0 0-.288-1.47 3.799 3.799 0 0 0-.816-1.199 3.845 3.845 0 0 0-1.2-.8 3.72 3.72 0 0 0-1.472-.287 3.72 3.72 0 0 0-1.472.288 3.631 3.631 0 0 0-1.2.815 3.84 3.84 0 0 0-.8 1.199 3.71 3.71 0 0 0-.288 1.47c0 .352.048.688.144 1.007.096.336.224.64.4.927.16.288.384.544.624.784.144.144.304.271.48.383a5.12 5.12 0 0 0-1.04.624c-.416.32-.784.703-1.088 1.119a4.999 4.999 0 0 0-.688 1.406c-.016.032-.016.064-.016.08C1.776 11.636.992 9.91.992 7.992.992 4.14 4.144.991 8 .991s7.008 3.149 7.008 7.001a6.96 6.96 0 0 1-2.032 4.907z"},child:[]}]})(e)}function mI(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8 8.707l3.646 3.647.708-.707L8.707 8l3.647-3.646-.707-.708L8 7.293 4.354 3.646l-.707.708L7.293 8l-3.646 3.646.707.708L8 8.707z"},child:[]}]})(e)}function xI(e){return Gc({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15.25 0a8.25 8.25 0 0 0-6.18 13.72L1 22.88l1.12 1 8.05-9.12A8.251 8.251 0 1 0 15.25.01V0zm0 15a6.75 6.75 0 1 1 0-13.5 6.75 6.75 0 0 1 0 13.5z"},child:[]}]})(e)}function yI(e){return Gc({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M14 5H2V3h12v2zm0 4H2V7h12v2zM2 13h12v-2H2v2z"},child:[]}]})(e)}function wI(){const[e,t]=R.useState(!1),[n,i]=R.useState(""),[a,l]=R.useState([]),[f,g]=R.useState(!1),[p,m]=R.useState(!1),[C,E]=R.useState(!1),A=R.useRef(null),M=R.useRef(null),_="";R.useEffect(()=>{const B=()=>{E(window.innerWidth<=768)};return B(),window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),R.useEffect(()=>{function B(G){A.current&&!A.current.contains(G.target)&&(t(!1),m(!1),i(""))}return document.addEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[]),R.useEffect(()=>{e&&M.current&&setTimeout(()=>{M.current.focus()},200)},[e]);const k=async B=>{if(!B.trim()){l([]),m(!1);return}g(!0);try{const te=await(await fetch(`${_}/api/search-users?q=${encodeURIComponent(B.trim())}`)).json();te.status?(l(te.data),m(!0)):(l([]),m(!1))}catch(G){console.error("Search error:",G),l([]),m(!1)}finally{g(!1)}};R.useEffect(()=>{const B=setTimeout(()=>{n&&e&&k(n)},300);return()=>clearTimeout(B)},[n,e]);const V=()=>{t(!e),e||(m(!1),i(""),l([]))},N=B=>{i(B.target.value)},b=B=>{console.log("Selected user:",B),m(!1),i(""),t(!1)},S=B=>B?typeof B=="string"?`data:image/png;base64,${B}`:B.data?`data:image/png;base64,${btoa(new Uint8Array(B.data).reduce((te,me)=>te+String.fromCharCode(me),""))}`:"":"",O={ME:"วิศวกรรมเครื่องกล",EE:"วิศวกรรมไฟฟ้าสื่อสาร",CYBER:"ความมั่นคงปลอดภัยทางไซเบอร์",SCIEN:"วิทยาศาสตร์และเทคโนโลยี (EN)",CE:"วิศวกรรมโยธา",GEO:"วิศวกรรมแผนที่",IE:"วิศวกรรมอุตสาหการ",SCI:"วิทยาศาสตร์และเทคโนโลยี",SOC:"สังคมศาสตร์เพื่อการพัฒนา"},F={student:"นักเรียนนายสิบ",teacher:"อาจารย์",officer:"นายทหาร",admin:"ผู้ดูแลระบบ"},W=B=>{switch(B){case"admin":return"role-badge admin";case"officer":return"role-badge officer";case"teacher":return"role-badge teacher";case"student":default:return"role-badge student"}},U=B=>{const G=[];return B.battalion&&G.push(`กองพัน ${B.battalion}`),B.company&&G.push(`ร้อย ${B.company}`),B.platoon&&G.push(`หมู่ ${B.platoon}`),B.squad&&G.push(`หมวด ${B.squad}`),G.length>0?G.join(" "):""};return y.jsxs("div",{ref:A,className:"user-search-container",children:[y.jsxs(ts.div,{className:`user-search ${e?"expanded":""}`,initial:!1,animate:{width:e?window.innerWidth<=480?"220px":window.innerWidth<=360?"200px":"280px":"40px"},transition:{duration:.3,ease:"easeInOut"},children:[y.jsx("div",{className:"search-icon-container",onClick:V,children:e?y.jsx(mI,{size:20,className:"search-icon"}):y.jsx(xI,{size:20,className:"search-icon"})}),y.jsx($s,{children:e&&y.jsx(ts.input,{ref:M,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},type:"text",placeholder:"ค้นหาผู้ใช้...",value:n,onChange:N,className:"search-input"})})]}),y.jsx($s,{children:p&&a.length>0&&y.jsxs(ts.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"search-results",children:[f&&y.jsx("div",{className:"search-loading",children:"กำลังค้นหา..."}),!f&&a.map(B=>y.jsxs("div",{className:"search-result-item",onClick:()=>b(B),children:[y.jsx("div",{className:"user-avatar",children:B.profileImage&&B.profileImage.data?y.jsx("img",{src:S(B.profileImage),alt:"Profile",className:"userlist-avatar"}):y.jsx("div",{className:"no-avatar",children:B.realname?B.realname.charAt(0).toUpperCase():"?"})}),y.jsxs("div",{className:"user-info",children:[y.jsxs("div",{className:"user-name-row",children:[y.jsx("div",{className:"user-name",children:B.realname||"ไม่ระบุชื่อ"}),y.jsxs("div",{className:"badges",children:[B.role&&y.jsx("div",{className:W(B.role),children:F[B.role]||B.role}),B.admin&&y.jsx("div",{className:"admin-badge",children:"Admin"})]})]}),y.jsxs("div",{className:"user-details",children:[y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"ID:"}),y.jsx("span",{className:"value",children:B.userid})]}),B.year&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"ชั้นปี:"}),y.jsx("span",{className:"value",children:B.year})]}),B.major&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"กองวิชา:"}),y.jsx("span",{className:"value major-text",children:O[B.major]||B.major})]}),U(B)&&y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"สังกัด:"}),y.jsx("span",{className:"value",children:U(B)})]}),y.jsxs("div",{className:"detail-row",children:[y.jsx("span",{className:"label",children:"Username:"}),y.jsxs("span",{className:"value username",children:["@",B.username]})]})]})]})]},B.id)),!f&&a.length===0&&n&&y.jsx("div",{className:"no-results",children:"ไม่พบผู้ใช้ที่ค้นหา"})]})})]})}const Nn={STUDENT:"student",TEACHER:"teacher",OFFICER:"officer",ADMIN:"admin"},rt={VIEW_USER_DATA:"view_user_data",EDIT_OWN_PROFILE:"edit_own_profile",EDIT_OTHER_PROFILES:"edit_other_profiles",DEDUCT_POINTS:"deduct_points",VIEW_WEAPON_STORAGE:"view_weapon_storage",EDIT_WEAPON_STORAGE:"edit_weapon_storage",ADD_SUMMARY:"add_summary",VIEW_SUMMARY:"view_summary",EDIT_SUMMARY:"edit_summary",DELETE_SUMMARY:"delete_summary",MANAGE_USERS:"manage_users",MANAGE_ROLES:"manage_roles",VIEW_ALL_DATA:"view_all_data"},CI={[Nn.STUDENT]:[rt.EDIT_OWN_PROFILE,rt.ADD_SUMMARY,rt.VIEW_SUMMARY],[Nn.TEACHER]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.DEDUCT_POINTS,rt.VIEW_SUMMARY],[Nn.OFFICER]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.DEDUCT_POINTS,rt.VIEW_WEAPON_STORAGE,rt.VIEW_SUMMARY],[Nn.ADMIN]:[rt.VIEW_USER_DATA,rt.VIEW_ALL_DATA,rt.EDIT_OWN_PROFILE,rt.EDIT_OTHER_PROFILES,rt.DEDUCT_POINTS,rt.VIEW_WEAPON_STORAGE,rt.EDIT_WEAPON_STORAGE,rt.ADD_SUMMARY,rt.VIEW_SUMMARY,rt.EDIT_SUMMARY,rt.DELETE_SUMMARY,rt.MANAGE_USERS,rt.MANAGE_ROLES]},ys=(e,t)=>!e||!e.role?!1:e.admin||e.role===Nn.ADMIN?!0:(CI[e.role]||[]).includes(t),EI=(e,t)=>{if(!e)return!1;switch(t){case"role-manager":return ys(e,rt.MANAGE_ROLES);case"deduct-point":return ys(e,rt.DEDUCT_POINTS);case"gun-borrowing":return ys(e,rt.VIEW_WEAPON_STORAGE);case"summary":return ys(e,rt.VIEW_SUMMARY);case"behavior-point":case"home":case"profile":return ys(e,rt.VIEW_USER_DATA)||e.role===Nn.STUDENT;default:return!0}},ew=(e,t)=>`${{[Nn.STUDENT]:"นนร.",[Nn.TEACHER]:"อาจารย์",[Nn.OFFICER]:"นายทหาร",[Nn.ADMIN]:"แอดมิน"}[e]||"ผู้ใช้"} ไม่มีสิทธิ์ในการ${t}`,vI=e=>{if(!e)return[];const n=[...[{path:"/",label:"หน้าหลัก",icon:"🏠"},{path:"/profile",label:"ข้อมูลส่วนตัว",icon:"👤"}]];return e.role===Nn.STUDENT&&n.push({path:"/summary",label:"ลงยอด",icon:"📊"},{path:"/behavior-point",label:"คะแนนความประพฤติ",icon:"⭐"}),e.role===Nn.TEACHER&&n.push({path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/summary",label:"ดูสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"ดูคะแนนนักเรียน",icon:"⭐"}),e.role===Nn.OFFICER&&n.push({path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/gun-borrowing",label:"คลังอาวุธ",icon:"🔫"},{path:"/summary",label:"ดูสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"ดูคะแนนนักเรียน",icon:"⭐"}),(e.role===Nn.ADMIN||e.admin)&&n.push({path:"/role-manager",label:"จัดการสิทธิ์ผู้ใช้",icon:"👥"},{path:"/deduct-point",label:"ตัดคะแนน",icon:"➖"},{path:"/gun-borrowing",label:"คลังอาวุธ",icon:"🔫"},{path:"/summary",label:"จัดการสรุปยอด",icon:"📊"},{path:"/behavior-point",label:"จัดการคะแนน",icon:"⭐"}),n};function tw(){var pe;const[e,t]=R.useState(""),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState(!1),[A,M]=R.useState(null),[_,k]=R.useState(!1),[V,N]=R.useState(!1),b=Zr(),S=_r(),O=R.useRef(null),F=R.useRef(null),W=vI(A),U=[{value:"ME",label:"วิศวกรรมเครื่องกล"},{value:"EE",label:"วิศวกรรมไฟฟ้าสื่อสาร"},{value:"CYBER",label:"ความมั่นคงปลอดภัยทางไซเบอร์"},{value:"SCIEN",label:"วิทยาศาสตร์และเทคโนโลยี (EN)"},{value:"CE",label:"วิศวกรรมโยธา"},{value:"GEO",label:"วิศวกรรมแผนที่"},{value:"IE",label:"วิศวกรรมอุตสาหการ"},{value:"SCI",label:"วิทยาศาสตร์และเทคโนโลยี"},{value:"SOC",label:"สังคมศาสตร์เพื่อการพัฒนา"}];R.useEffect(()=>{const j=localStorage.getItem("token");!j&&S.pathname!=="/login"&&S.pathname!=="/register"?b("/login"):j&&fetch(`/api/user/${j}`).then(q=>q.json()).then(q=>{q.data&&(t(q.data.realname),i(q.data.userid),l(q.data.blood),g(q.data.major),E(q.data.admin||!1),M({id:q.data.id,realname:q.data.realname,userid:q.data.userid,username:q.data.username,role:q.data.role||"student",admin:q.data.admin||!1,...q.data}),q.data.profileImage?m(`data:image/jpeg;base64,${q.data.profileImage}`):m(""))})},[b,S]);const B=()=>{k(j=>(j||N(!1),!j))},G=()=>{N(j=>(j||k(!1),!j))},te=()=>{localStorage.removeItem("token"),k(!1),b("/login")},me=()=>{b("/")},he=()=>{k(!1),b("/edit-profile")},de=()=>{k(!1),b("/view-profile")};return R.useEffect(()=>{function j(q){O.current&&!O.current.contains(q.target)&&F.current&&!F.current.contains(q.target)&&(k(!1),N(!1))}return document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[]),y.jsxs("nav",{className:"navbar bg-white text-black shadow-md border-b border-gray-300 flex items-center justify-between px-4 py-2",children:[y.jsxs("div",{className:"flex items-center",children:[y.jsxs("span",{className:"btn btn-ghost normal-case text-xl text-black flex items-center cursor-pointer",onClick:me,children:[y.jsx("img",{src:Ny,alt:"Logo",className:"logo-img"}),y.jsx("span",{className:"ml-2",children:"CRMA"})]}),y.jsx("button",{className:"btn btn-ghost ml-3 text-sm",onClick:()=>b("/dashboard"),children:"Dashboard"})]}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(wI,{}),y.jsxs("div",{ref:F,className:"relative",children:[y.jsx("button",{className:"btn btn-ghost",onClick:G,children:y.jsx(yI,{size:28})}),y.jsx($s,{children:V&&y.jsxs(ts.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.18},className:"dropdown-content show",children:[W.filter(j=>j.path!=="/"&&j.path!=="/profile").map((j,q)=>y.jsxs("p",{className:`block px-4 py-2 text-black cursor-pointer hover:bg-gray-200 ${j.path==="/role-manager"?"font-semibold border-t border-gray-200":""}`,onClick:()=>{N(!1),b(j.path)},children:[j.icon&&y.jsx("span",{className:"mr-2",children:j.icon}),j.label]},j.path)),W.filter(j=>j.path!=="/"&&j.path!=="/profile").length===0&&y.jsx("p",{className:"block px-4 py-2 text-gray-500 text-center",children:"ไม่มีเมนูเพิ่มเติม"})]})})]}),y.jsxs("div",{ref:O,className:"relative",children:[y.jsx("button",{className:"btn btn-ghost",onClick:B,children:y.jsx(pI,{size:28})}),y.jsx($s,{children:_&&y.jsxs(ts.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.18},className:"dropdown-content show",children:[p?y.jsx("img",{src:p,alt:"Profile",className:"dropdown-profile-img mb-2 rounded-full w-16 h-16 object-cover mx-auto"}):y.jsx("div",{className:"dropdown-profile-img mb-2 rounded-full w-16 h-16 bg-gray-300 mx-auto flex items-center justify-center text-gray-600",children:"No Image"}),y.jsxs("p",{children:[y.jsx("strong",{children:"ชื่อ:"})," ",e]}),y.jsxs("p",{children:[y.jsx("strong",{children:"User ID:"})," ",n]}),y.jsxs("p",{children:[y.jsx("strong",{children:"สาขา:"})," ",((pe=U.find(j=>j.value===f))==null?void 0:pe.label)||f]}),y.jsxs("div",{className:"mt-3 space-y-1",children:[y.jsx("p",{className:"btn btn-ghost text-left w-full edit-profile-item",onClick:he,children:"Edit Profile"}),y.jsx("p",{className:"btn btn-ghost text-left w-full view-profile-item",onClick:de,children:"View Profile"}),y.jsx("p",{className:"btn btn-ghost text-left w-full logout-item",onClick:te,children:"Logout"})]})]})})]})]})]})}function SI(){const[e,t]=R.useState([]),[n,i]=R.useState(!1),[a,l]=R.useState([]),[f,g]=R.useState(null),[p,m]=R.useState(""),[C,E]=R.useState([]),[A,M]=R.useState(""),[_,k]=R.useState(""),[V,N]=R.useState(""),[b,S]=R.useState(""),[O,F]=R.useState(""),[W,U]=R.useState(""),[B,G]=R.useState({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),[te,me]=R.useState([{key:"",value:"",names:[""],counted:!0}]),[he,de]=R.useState({}),[pe,j]=R.useState({}),[q,re]=R.useState(null),[X,fe]=R.useState({}),[oe,ve]=R.useState(!1),[Te,st]=R.useState(null),[Ze,Ft]=R.useState(null),[ge,Re]=R.useState(!1),[ct,Ut]=R.useState(""),[Se,Ae]=R.useState("success"),Ge="",K=(J,ae="success")=>{Ut(J),Ae(ae),Re(!0)},Be=()=>{Re(!1)};R.useEffect(()=>{console.log("API URL:",Ge);const J=localStorage.getItem("token");fetch("/api/summary",{headers:{Authorization:`Bearer ${J}`}}).then(ae=>ae.json()).then(ae=>{ae.success||ae.status!==!1?t(ae.data||[]):(console.error("Failed to fetch summaries:",ae.message),K(ae.message||"ไม่สามารถดึงข้อมูลสรุปยอดได้","error"))}).catch(ae=>{console.error("Error fetching summaries:",ae),K("เกิดข้อผิดพลาดในการดึงข้อมูล","error")})},[]),R.useEffect(()=>{if(console.log("User สังกัด:",{userBattalion:V,userCompany:b}),console.log("Summaries:",e),V&&b&&e.length>0){const J=e.filter(ae=>(console.log("Comparing:",{summaryBattalion:ae.battalion,userBattalion:V,summaryCompany:ae.company,userCompany:b,match:Number(ae.battalion)===Number(V)&&Number(ae.company)===Number(b)}),Number(ae.battalion)===Number(V)&&Number(ae.company)===Number(b)));console.log("Filtered summaries:",J),E(J)}else E(e)},[V,b,e]),R.useEffect(()=>{const J=localStorage.getItem("token");fetch("/api/user/me",{headers:{Authorization:`Bearer ${J}`}}).then(ae=>ae.json()).then(ae=>{if(ae.data&&(M(ae.data.realname||""),k(ae.data.year||""),N(ae.data.battalion||""),S(ae.data.company||""),F(ae.data.platoon||""),U(ae.data.squad||"")),ae.data&&ae.data.other)try{const ye=typeof ae.data.other=="string"?JSON.parse(ae.data.other):ae.data.other;l(Array.isArray(ye)?ye.map(be=>({...be,value:Number(be.value)||1})):[]);const ee={};(Array.isArray(ye)?ye:[]).forEach((be,Ie)=>{ee[Ie]=!0}),g(ee)}catch{l([]),g({})}})},[]);const je=J=>{g(J)},Oe=J=>{m(J.target.value)},Ue=async()=>{var pr,go;if(!p){K("กรุณาเลือกใบยอดที่ต้องการลงยอด","error");return}if(f==null){K("กรุณาเลือกรายการจำหน่ายอย่างน้อย 1 รายการ","error");return}const J=C.find(nr=>String(nr.id)===String(p));if(!J){K("ไม่พบใบยอดที่เลือก กรุณาลองใหม่อีกครั้ง","error");return}let ae={};try{ae=J.other?JSON.parse(J.other):{}}catch{K("เกิดข้อผิดพลาดในการอ่านข้อมูลใบยอด","error");return}const ye={...ae},ee=A&&_?`${A}(${_})`:A||"";if(!ee){K("ไม่พบข้อมูลชื่อผู้ใช้ กรุณาตรวจสอบโปรไฟล์ของคุณ","error");return}let be=!1;if(Object.values(ae).forEach(nr=>{Array.isArray(nr.names)&&nr.names.includes(ee)&&(be=!0)}),be){K("คุณได้ส่งยอดจำหน่ายในใบนี้ไปแล้ว","error");return}const Ie=a[f];if(!Ie||!Ie.key){K("ไม่พบรายการจำหน่ายที่เลือก กรุณาลองใหม่อีกครั้ง","error");return}const Ye=Number((pr=ae[Ie.key])==null?void 0:pr.count)||0,Gt=Number(Ie.value)||1,qr=Array.isArray((go=ae[Ie.key])==null?void 0:go.names)?ae[Ie.key].names:[],ja=ee?[ee]:[],$e=Array.from(new Set([...qr,...ja].filter(Boolean)));ye[Ie.key]={count:Ye+Gt,names:$e};try{const nr=localStorage.getItem("token"),yn=await fetch(`/api/summary?id=${J.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${nr}`},body:JSON.stringify({...J,other:ye})});if(yn.ok){K("ส่งยอดจำหน่ายสำเร็จ! 🎉","success"),m(""),g(null);const Pi=localStorage.getItem("token");fetch("/api/summary",{headers:{Authorization:`Bearer ${Pi}`}}).then(Nt=>Nt.json()).then(Nt=>{if(t(Nt.data||[]),V&&b){const Jr=(Nt.data||[]).filter(Li=>Number(Li.battalion)===Number(V)&&Number(Li.company)===Number(b));E(Jr)}else E(Nt.data||[])}),i(!1)}else{const Pi=await yn.json();K("เกิดข้อผิดพลาดในการส่งยอด: "+(Pi.message||"กรุณาลองใหม่อีกครั้ง"),"error")}}catch(nr){console.error("Error:",nr),K("เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต","error")}},Le=J=>G({...B,[J.target.name]:J.target.value}),Fe=Number(B.total)||0,kt=te.reduce((J,ae)=>ae.counted!==!1?J+(Number(ae.value)||0):J,0),xe=Fe-kt,Zt=["5","4","3","2","1"].reduce((J,ae)=>(J[ae]=Number(B[`total_year_${ae}`])||0,J),{});Object.values(Zt).reduce((J,ae)=>J+ae,0);const ki=J=>{G({date:J.date,time:J.time,battalion:String(J.battalion),company:String(J.company),total:String(J.total),note:J.note||"",other:"",total_year_5:J.total_year_5||"",total_year_4:J.total_year_4||"",total_year_3:J.total_year_3||"",total_year_2:J.total_year_2||"",total_year_1:J.total_year_1||""});try{const ae=JSON.parse(J.other);me(Object.entries(ae).map(([ye,ee])=>({key:ye,value:ee.count,names:ee.names&&Array.isArray(ee.names)?ee.names:[""],counted:ee.counted!==!1})))}catch{me([{key:"",value:"",names:[""],counted:!0}])}re(J.id),window.scrollTo({top:0,behavior:"smooth"})},ie=async J=>{if(window.confirm("ต้องการลบข้อมูลนี้ใช่หรือไม่?")){const ae=localStorage.getItem("token");await fetch(`/api/summary?id=${J}`,{method:"DELETE",headers:{Authorization:`Bearer ${ae}`}}),t(ye=>ye.filter(ee=>ee.id!==J))}},De=async J=>{if(J.preventDefault(),!B.date){K("กรุณาเลือกวันที่","error");return}if(!B.time){K("กรุณากรอกเวลา","error");return}if(!B.battalion){K("กรุณาเลือกกองพัน","error");return}if(!B.company){K("กรุณาเลือกกองร้อย","error");return}if(!B.total||Number(B.total)<=0){K("กรุณากรอกจำนวนคนทั้งหมดที่ถูกต้อง","error");return}if(!B.note){K("กรุณากรอกชื่อตัวแทนชั้น","error");return}const ae={};te.forEach(Ie=>{Ie.key&&(ae[Ie.key]={count:Ie.value,names:Ie.names.filter(Ye=>Ye),counted:Ie.counted!==!1})});const ye=q?"PUT":"POST",ee=q?`/api/summary?id=${q}`:"/api/summary",be={...B,battalion:Number(B.battalion),company:Number(B.company),total:Number(B.total),other:ae,total_year_5:B.total_year_5,total_year_4:B.total_year_4,total_year_3:B.total_year_3,total_year_2:B.total_year_2,total_year_1:B.total_year_1};try{const Ie=localStorage.getItem("token"),Gt=await(await fetch(ee,{method:ye,headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ie}`},body:JSON.stringify(be)})).json();Gt.success?(q?(t(e.map(qr=>qr.id===q?Gt.data:qr)),re(null),K("แก้ไขข้อมูลสำเร็จ! ✅","success")):(t([Gt.data,...e]),K("บันทึกใบยอดสำเร็จ! 🎉","success")),G({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),me([{key:"",value:"",names:[""],counted:!0}])):K("เกิดข้อผิดพลาด: "+(Gt.message||"ไม่สามารถบันทึกข้อมูลได้"),"error")}catch(Ie){console.error("Error:",Ie),K("เกิดข้อผิดพลาดในการเชื่อมต่อ กรุณาลองใหม่อีกครั้ง","error")}},Ve={};e.forEach(J=>{Ve[J.battalion]||(Ve[J.battalion]={}),Ve[J.battalion][J.company]||(Ve[J.battalion][J.company]=[]),Ve[J.battalion][J.company].push(J)});const et=J=>{de(ae=>({...ae,[J]:!ae[J]}))},tt=(J,ae)=>{j(ye=>({...ye,[`${J}-${ae}`]:!ye[`${J}-${ae}`]}))},ot=(J,ae)=>{st(J),Ft(ae),ve(!0)},$r=async(J,ae,ye)=>{const ee=e.find(Ye=>Ye.id===J);if(!ee)return;let be={};try{be=ee.other?JSON.parse(ee.other):{}}catch{}if(!be[ae]||!Array.isArray(be[ae].names))return;be[ae].names=be[ae].names.filter(Ye=>Ye!==ye),be[ae].names.length===0&&delete be[ae];const Ie=localStorage.getItem("token");await fetch(`/api/summary?id=${J}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ie}`},body:JSON.stringify({...ee,other:be})}),t(Ye=>Ye.map(Gt=>Gt.id===J?{...Gt,other:JSON.stringify(be)}:Gt)),Object.keys(be).length===0?ve(!1):st(be)};return y.jsx("div",{className:"summary-bg",children:y.jsxs("div",{className:"summary-container",children:[y.jsx("h1",{className:"summary-title",children:"ระบบสรุปยอดจำหน่าย"}),y.jsxs("div",{className:"summary-card",children:[y.jsx("h4",{className:"summary-section-title",children:"สถานะการส่งยอดจำหน่ายของคุณ"}),V&&b?y.jsxs("p",{style:{color:"#666",fontSize:"0.9rem",marginBottom:"12px"},children:["📍 แสดงเฉพาะใบยอดของ กองพัน ",V," กองร้อย ",b]}):y.jsx("p",{style:{color:"#ff9800",fontSize:"0.9rem",marginBottom:"12px"},children:"⚠️ กรุณากรอกข้อมูลสังกัด (กองพัน/กองร้อย) เพื่อแสดงใบยอดที่เกี่ยวข้อง"}),y.jsx("div",{className:"table-wrapper",children:y.jsxs("table",{className:"summary-table",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"วันที่"}),y.jsx("th",{children:"เวลา"}),y.jsx("th",{children:"สถานะ"}),y.jsx("th",{children:"รายการที่ส่ง"})]})}),y.jsx("tbody",{children:C.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:4,style:{textAlign:"center",color:"#666",padding:"20px"},children:V&&b?`ไม่มีใบยอดสำหรับ กองพัน ${V} กองร้อย ${b}`:"ไม่มีข้อมูลใบยอด กรุณากรอกข้อมูลสังกัดด้านล่าง"})}):C.map(J=>{let ae=!1,ye=[];try{const ee=J.other?JSON.parse(J.other):{},be=A&&_?`${A}(${_})`:A||"";Object.entries(ee).forEach(([Ie,Ye])=>{Array.isArray(Ye.names)&&Ye.names.includes(be)&&(ae=!0,ye.push(Ie))})}catch{}return y.jsxs("tr",{children:[y.jsx("td",{children:J.date}),y.jsx("td",{children:J.time}),y.jsx("td",{children:ae?y.jsx("span",{className:"status-sent",children:"ส่งจำหน่ายแล้ว"}):y.jsx("span",{className:"status-not-sent",children:"ยังไม่ได้ส่ง"})}),y.jsx("td",{children:ye.length>0?ye.map((ee,be)=>y.jsxs("span",{children:[ee,be<ye.length-1?", ":""]},ee)):"-"})]},J.id)})})]})})]}),y.jsxs("div",{style:{marginBottom:32,border:"2px solid #007bff",borderRadius:8,padding:16,background:"#f8faff"},children:[y.jsx("h3",{style:{color:"#007bff"},children:"ส่งยอดจำหน่าย (สำหรับผู้ใช้ทั่วไป)"}),n?y.jsxs(y.Fragment,{children:[y.jsxs("div",{style:{marginBottom:8},children:[y.jsx("b",{children:"เลือกใบยอดที่ต้องการลงยอด:"}),y.jsxs("select",{value:p,onChange:Oe,style:{marginLeft:8},children:[y.jsx("option",{value:"",children:"-- เลือกใบยอด --"}),C.map(J=>y.jsxs("option",{value:J.id,children:[J.date," | ",J.time]},J.id))]})]}),y.jsxs("div",{style:{marginBottom:8},children:[y.jsx("b",{children:"รายการจำหน่ายของคุณ:"}),a.length===0&&y.jsx("div",{style:{color:"#888"},children:"ไม่มีรายการจำหน่าย"}),a.map((J,ae)=>{let ye=!1;if(p){const ee=C.find(be=>String(be.id)===String(p));if(ee)try{const be=ee.other?JSON.parse(ee.other):{},Ie=A&&_?`${A}(${_})`:A||"";be[J.key]&&Array.isArray(be[J.key].names)&&be[J.key].names.includes(Ie)&&(ye=!0)}catch{}}return y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:4,alignItems:"center"},children:[y.jsx("input",{type:"checkbox",checked:f===ae,onChange:()=>je(ae),style:{marginRight:4},disabled:ye}),y.jsxs("span",{style:{flex:2},children:[J.key,ye&&y.jsx("span",{style:{color:"#1976d2",fontWeight:500,marginLeft:8},children:"(คุณส่งยอดนี้แล้ว)✅"})]}),y.jsxs("span",{style:{flex:1},children:["จำนวน ",J.value]})]},ae)})]}),y.jsxs("div",{style:{display:"flex",gap:8},children:[y.jsx("button",{className:"btn btn-primary",style:{marginBottom:0},onClick:Ue,children:"ส่งยอดจำหน่าย"}),y.jsx("button",{type:"button",className:"btn",style:{marginBottom:0,background:"#eee",color:"#333"},onClick:()=>{m(""),g(null),i(!1)},children:"ยกเลิก"})]})]}):y.jsx("button",{className:"btn btn-primary",onClick:()=>i(!0),style:{marginBottom:0},children:"+ เพิ่มส่งยอดจำหน่าย"})]}),y.jsx("h2",{children:"สร้างใบยอด(สำหรับตัวแทนชั้น)"}),y.jsxs("form",{className:"summary-form",onSubmit:De,style:{marginBottom:32},children:[y.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[y.jsxs("select",{name:"battalion",value:B.battalion,onChange:Le,required:!0,children:[y.jsx("option",{value:"",children:"เลือกกองพัน"}),y.jsx("option",{value:"1",children:"กองพัน 1"}),y.jsx("option",{value:"2",children:"กองพัน 2"}),y.jsx("option",{value:"3",children:"กองพัน 3"}),y.jsx("option",{value:"4",children:"กองพัน 4"})]}),y.jsxs("select",{name:"company",value:B.company,onChange:Le,required:!0,children:[y.jsx("option",{value:"",children:"เลือกกองร้อย"}),y.jsx("option",{value:"1",children:"กองร้อย 1"}),y.jsx("option",{value:"2",children:"กองร้อย 2"}),y.jsx("option",{value:"3",children:"กองร้อย 3"})]})]}),y.jsx("div",{style:{display:"flex",gap:8,marginBottom:8},children:y.jsxs("div",{style:{flex:1},children:[y.jsx("b",{children:"วันที่ :"}),y.jsxs("div",{style:{position:"relative",display:"inline-block",width:"100%"},children:[y.jsx("input",{name:"date",type:"date",value:B.date,onChange:Le,required:!0,style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"4px",fontSize:"14px",background:"white",cursor:"pointer",colorScheme:"light"},onFocus:J=>J.target.showPicker&&J.target.showPicker()}),!B.date&&y.jsx("div",{style:{position:"absolute",top:"50%",left:"12px",transform:"translateY(-50%)",color:"#999",pointerEvents:"none",fontSize:"14px"},children:"เลือกวันที่"})]})]})}),y.jsxs("div",{style:{flex:1},children:[y.jsx("b",{children:"เวลา :"}),y.jsx("input",{name:"time",type:"text",placeholder:"เช่น 0530, 0700, 0800, 1800, 2100",value:B.time,onChange:Le,required:!0,style:{width:"100%"}})]}),y.jsxs("div",{style:{margin:"16px 0",padding:12,border:"1px solid #eee",borderRadius:8,background:"#f9f9f9"},children:[y.jsx("b",{children:"จำนวนคนทั้งหมด (แยกชั้นปี):"}),y.jsx("div",{className:"summary-year-row",children:["5","4","3","2","1"].map(J=>y.jsxs("div",{className:"summary-year-col",children:[y.jsxs("label",{children:["ชั้น ",J,":"]}),y.jsx("input",{type:"number",min:"0",value:B[`total_year_${J}`]||"",onChange:ae=>G(ye=>({...ye,[`total_year_${J}`]:ae.target.value})),placeholder:`ชั้น ${J}`})]},J))}),y.jsxs("div",{style:{marginTop:8},children:[y.jsx("b",{children:"รวมทั้งหมด:"})," ",["5","4","3","2","1"].reduce((J,ae)=>J+(Number(B[`total_year_${ae}`])||0),0)]})]}),y.jsx("input",{name:"total",type:"number",placeholder:"จำนวนคนทั้งหมด",value:B.total,onChange:Le,required:!0,style:{marginBottom:8,width:"100%"}}),y.jsx("div",{style:{marginBottom:8},children:y.jsxs("div",{className:`remain ${xe<0?"negative":"positive"}`,children:[y.jsx("b",{children:"ยอดที่เหลือ:"})," ",xe]})}),y.jsx("input",{name:"note",placeholder:"ชื่อตัวแทนชั้น (ชั้นปี)",value:B.note,onChange:Le,style:{marginBottom:8,width:"100%"}}),y.jsx("button",{type:"submit",children:q?"บันทึกการแก้ไข":"บันทึกยอด"}),q&&y.jsx("button",{type:"button",onClick:()=>{re(null),G({date:"",time:"",battalion:"",company:"",total:"",other:"",note:"",total_year_5:"",total_year_4:"",total_year_3:"",total_year_2:"",total_year_1:""}),me([{key:"",value:"",names:[""],counted:!0}])},children:"ยกเลิก"})]}),y.jsx("h3",{children:"ผลลัพธ์ยอด (แยกตามกองพัน/กองร้อย)"}),Object.keys(Ve).sort().map(J=>y.jsxs("div",{style:{marginBottom:24},children:[y.jsxs("button",{type:"button",className:"summary-accordion-btn",onClick:()=>et(J),children:[he[J]?"▼":"►"," กองพัน ",J]}),he[J]&&y.jsx("div",{children:Object.keys(Ve[J]).sort().map(ae=>y.jsxs("div",{style:{marginBottom:12,marginLeft:24},children:[y.jsxs("button",{type:"button",className:"summary-company-btn",onClick:()=>tt(J,ae),children:[pe[`${J}-${ae}`]?"▼":"►"," กองร้อย ",ae]}),pe[`${J}-${ae}`]&&y.jsx("div",{className:"table-wrapper",children:y.jsxs("table",{className:"summary-table",children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"วันที่"}),y.jsx("th",{children:"เวลา"}),y.jsx("th",{children:"ทั้งหมด"}),y.jsx("th",{children:"จำหน่าย"}),y.jsx("th",{children:"ยอดที่เหลือ"}),y.jsx("th",{children:"ตัวแทนชั้น"}),y.jsx("th",{children:"แก้ไข"})]})}),y.jsx("tbody",{children:Ve[J][ae].map(ye=>{let ee=Number(ye.total)||0,be={};try{be=JSON.parse(ye.other),ee-=Object.entries(be).reduce((Ie,[Ye,Gt])=>X[ye.id]&&X[ye.id][Ye]?Ie:Ie+(Number(Gt.count)||0),0)}catch{}return y.jsxs("tr",{children:[y.jsx("td",{"data-label":"วันที่",children:ye.date}),y.jsx("td",{"data-label":"แถวกี่โมง",children:ye.time}),y.jsx("td",{"data-label":"ทั้งหมด",children:ye.total}),y.jsx("td",{"data-label":"จำหน่าย",className:"summary-sale-cell",children:be&&Object.entries(be).length>0?y.jsx("button",{type:"button",className:"summary-view-btn",onClick:()=>ot(be,ye.id),children:"ดูรายการจำหน่าย"}):y.jsx("span",{className:"summary-no-data",children:"-"})}),y.jsx("td",{"data-label":"ยอดที่เหลือ",children:y.jsx("span",{className:ee<0?"summary-remain-negative":"summary-remain-positive",children:ee})}),y.jsx("td",{"data-label":"ตัวแทนชั้น",children:ye.note}),y.jsxs("td",{"data-label":"แก้ไข",children:[y.jsx("button",{type:"button",className:"summary-edit-btn",onClick:()=>ki(ye),children:"แก้ไข"}),y.jsx("button",{type:"button",className:"summary-delete-btn",onClick:()=>ie(ye.id),title:"ลบ",children:"ลบ"})]})]},ye.id)})})]})})]},ae))})]},J)),oe&&y.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>ve(!1),children:y.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:24,minWidth:260,maxWidth:350,boxShadow:"0 2px 16px rgba(0,0,0,0.18)",position:"relative"},onClick:J=>J.stopPropagation(),children:[y.jsx("h4",{style:{marginTop:0},children:"รายการจำหน่าย"}),y.jsx("div",{children:Te&&Object.keys(Te).length>0?Object.entries(Te).map(([J,ae])=>y.jsxs("div",{style:{marginBottom:12},children:[y.jsxs("div",{style:{fontWeight:600,marginBottom:2},children:[J," : ",ae.count]}),y.jsx("ul",{style:{paddingLeft:18,margin:0},children:Array.isArray(ae.names)&&ae.names.length>0?ae.names.map((ye,ee)=>y.jsxs("li",{style:{display:"flex",alignItems:"center",marginBottom:2},children:[y.jsx("span",{style:{flex:1},children:ye}),y.jsx("button",{style:{marginLeft:8,background:"#e53935",color:"#fff",border:"none",borderRadius:4,padding:"2px 10px",fontSize:"0.92em",cursor:"pointer"},onClick:()=>$r(Ze,J,ye),children:"ลบ"})]},ye)):y.jsx("li",{style:{color:"#888"},children:"ไม่มีชื่อผู้ใช้"})})]},J)):y.jsx("div",{style:{color:"#888"},children:"ไม่มีรายการ"})}),y.jsx("button",{style:{marginTop:16,background:"#1976d2",color:"#fff",border:"none",borderRadius:4,padding:"4px 16px",cursor:"pointer"},onClick:()=>ve(!1),children:"ปิด"})]})}),ge&&y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4},children:y.jsxs("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"15px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.3)",textAlign:"center",maxWidth:"400px",margin:"20px",border:`3px solid ${Se==="success"?"#4CAF50":"#f44336"}`},children:[y.jsx("div",{style:{fontSize:"3rem",marginBottom:"15px"},children:Se==="success"?"✅":"❌"}),y.jsx("h3",{style:{margin:"0 0 15px 0",color:Se==="success"?"#4CAF50":"#f44336",fontSize:"1.3rem"},children:Se==="success"?"สำเร็จ!":"เกิดข้อผิดพลาด!"}),y.jsx("p",{style:{margin:"0 0 25px 0",color:"#666",fontSize:"1.1rem",lineHeight:"1.5"},children:ct}),y.jsx("button",{onClick:Be,style:{backgroundColor:Se==="success"?"#4CAF50":"#f44336",color:"white",border:"none",padding:"12px 30px",borderRadius:"8px",fontSize:"1.1rem",fontWeight:"500",cursor:"pointer",minWidth:"100px",transition:"all 0.3s ease"},onMouseOver:J=>J.target.style.opacity="0.9",onMouseOut:J=>J.target.style.opacity="1",children:"ตกลง"})]})})]})})}const nw=()=>{const[e,t]=R.useState(null),[n,i]=R.useState(null),[a,l]=R.useState(!0),[f,g]=R.useState(null);R.useEffect(()=>{(()=>{try{const _=localStorage.getItem("token"),k=localStorage.getItem("userInfo");if(_&&i(_),k){const V=JSON.parse(k);t(V),console.log("⚡ Fast loaded user info:",V)}}catch(_){console.error("❌ Error loading basic user data:",_),localStorage.removeItem("token"),localStorage.removeItem("userInfo")}finally{l(!1)}})()},[]);const p=async()=>{if(!(!n||f))try{const _=await(await fetch(`/api/user/profile?token=${encodeURIComponent(n)}&includeImage=true`)).json();if(_.status&&_.data.profileImage){const k=`data:image/jpeg;base64,${_.data.profileImage}`;g(k),console.log("🖼️ Profile image loaded")}}catch(M){console.error("Error loading profile image:",M)}},m=async()=>{if(n)try{const _=await(await fetch(`/api/user/profile?token=${encodeURIComponent(n)}`)).json();if(_.status)return t(_.data),localStorage.setItem("userInfo",JSON.stringify(_.data)),console.log("🔄 User data refreshed:",_.data),_.data}catch(M){console.error("Error refreshing user data:",M)}},C=()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),i(null),t(null),g(null)},E=M=>{t(M),localStorage.setItem("userInfo",JSON.stringify(M))};return{user:e,token:n,isLoading:a,isLoggedIn:!!n&&!!e,isAdmin:(()=>(e==null?void 0:e.admin)===!0||(e==null?void 0:e.role)==="admin")(),profileImage:f,logout:C,updateUser:E,loadProfileImage:p,refreshUserData:m,hasProfileImage:!!f}},Yc=(e,t,n={})=>{const{redirectTo:i="/login",showMessage:a=!0,fallbackComponent:l=null}=n;return function(g){const{user:p,isLoading:m}=nw();return m?y.jsx("div",{className:"permission-loading",children:y.jsxs("div",{className:"loading",children:[y.jsx("div",{className:"spinner"}),"กำลังตรวจสอบสิทธิ์..."]})}):p?EI(p,t)?y.jsx(e,{...g,user:p}):l?y.jsx(l,{user:p,requiredPage:t}):a?y.jsx("div",{className:"permission-denied",children:y.jsxs("div",{className:"permission-denied-container",children:[y.jsx("div",{className:"permission-denied-icon",children:"🚫"}),y.jsx("h2",{children:"ไม่มีสิทธิ์เข้าถึง"}),y.jsx("p",{children:ew(p.role,"เข้าถึงหน้านี้")}),y.jsxs("div",{className:"permission-actions",children:[y.jsx("button",{onClick:()=>window.history.back(),className:"btn-back",children:"กลับหน้าก่อนหน้า"}),y.jsx("button",{onClick:()=>window.location.href="/",className:"btn-home",children:"กลับหน้าหลัก"})]})]})}):y.jsx(ac,{to:"/",replace:!0}):y.jsx(ac,{to:i,replace:!0})}},AI=({user:e,requiredPage:t,onBack:n,onHome:i})=>y.jsx("div",{className:"permission-denied",children:y.jsxs("div",{className:"permission-denied-container",children:[y.jsx("div",{className:"permission-denied-icon",children:"🚫"}),y.jsx("h2",{children:"ไม่มีสิทธิ์เข้าถึง"}),y.jsx("p",{children:ew(e==null?void 0:e.role,"เข้าถึงหน้านี้")}),y.jsxs("div",{className:"permission-denied-info",children:[y.jsx("p",{children:"หน้านี้เฉพาะสำหรับผู้ที่มีสิทธิ์เท่านั้น"}),y.jsx("p",{children:"หากคุณเชื่อว่านี่เป็นข้อผิดพลาด กรุณาติดต่อผู้ดูแลระบบ"})]}),y.jsxs("div",{className:"permission-actions",children:[y.jsx("button",{onClick:n||(()=>window.history.back()),className:"btn-back",children:"กลับหน้าก่อนหน้า"}),y.jsx("button",{onClick:i||(()=>window.location.href="/"),className:"btn-home",children:"กลับหน้าหลัก"})]})]})});const TI=()=>{const{user:e,isLoading:t}=nw(),[n,i]=R.useState([]),[a,l]=R.useState(""),[f,g]=R.useState(!1),[p,m]=R.useState(null),[C,E]=R.useState(""),[A,M]=R.useState("");console.log("RoleManager - User data:",e),console.log("RoleManager - Loading:",t),console.log("RoleManager - User admin status:",e==null?void 0:e.admin);const _=async()=>{g(!0),E("");try{const S=localStorage.getItem("token"),O=await fetch("/api/search-users?q=",{headers:{Authorization:`Bearer ${S}`}});if(!O.ok)throw new Error("Failed to load users");const F=await O.json();F.status?i(F.data||[]):E(F.message||"Failed to load users")}catch(S){console.error("Error loading users:",S),E("เกิดข้อผิดพลาดในการโหลดข้อมูลผู้ใช้")}finally{g(!1)}},k=async S=>{if(!S.trim()){_();return}g(!0),E("");try{const O=localStorage.getItem("token"),F=await fetch(`/api/search-users?q=${encodeURIComponent(S)}`,{headers:{Authorization:`Bearer ${O}`}});if(!F.ok)throw new Error("Failed to search users");const W=await F.json();W.status?i(W.data||[]):E(W.message||"Failed to search users")}catch(O){console.error("Error searching users:",O),E("เกิดข้อผิดพลาดในการค้นหาผู้ใช้")}finally{g(!1)}},V=async(S,O)=>{m(S),E(""),M("");try{const F=localStorage.getItem("token"),W=await fetch("/api/user/role",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({userId:S,role:O})});if(!W.ok)throw new Error("Failed to update role");const U=await W.json();U.status?(M(`อัปเดต role เป็น ${N(O)} สำเร็จ`),i(B=>B.map(G=>G.id===S?{...G,role:O,admin:O==="admin"}:G)),setTimeout(()=>M(""),3e3)):E(U.message||"Failed to update role")}catch(F){console.error("Error updating role:",F),E("เกิดข้อผิดพลาดในการอัปเดต role")}finally{m(null)}},N=S=>({student:"นักเรียน",teacher:"อาจารย์",officer:"นายทหาร",admin:"แอดมิน"})[S]||S,b=S=>({student:"role-student",teacher:"role-teacher",officer:"role-officer",admin:"role-admin"})[S]||"";return R.useEffect(()=>{e&&e.admin&&_()},[e]),R.useEffect(()=>{const S=setTimeout(()=>{e&&e.admin&&k(a)},500);return()=>clearTimeout(S)},[a,e]),t?y.jsx("div",{className:"role-manager",children:y.jsxs("div",{className:"loading",children:[y.jsx("div",{className:"spinner"}),"กำลังโหลด..."]})}):e?ys(e,rt.MANAGE_ROLES)?y.jsxs("div",{className:"role-manager",children:[y.jsx(tw,{}),y.jsxs("div",{className:"role-manager-container",children:[y.jsx("div",{className:"role-manager-header",children:y.jsxs("div",{className:"header-content",children:[y.jsxs("div",{className:"title-section",children:[y.jsx("h1",{children:"การจัดการสิทธิ์ผู้ใช้"}),y.jsx("p",{className:"subtitle",children:"จัดการ Role และสิทธิ์การเข้าถึงของผู้ใช้ในระบบ"})]}),y.jsx("div",{className:"stats-section",children:y.jsxs("div",{className:"stats-card",children:[y.jsx("span",{className:"stats-number",children:n.length}),y.jsx("span",{className:"stats-label",children:"ผู้ใช้ทั้งหมด"})]})})]})}),y.jsx("div",{className:"search-section",children:y.jsxs("div",{className:"search-container",children:[y.jsx("div",{className:"search-icon",children:"🔍"}),y.jsx("input",{type:"text",placeholder:"ค้นหาผู้ใช้ (ชื่อ, รหัสประจำตัว, username)",value:a,onChange:S=>l(S.target.value),className:"search-input"}),a&&y.jsx("button",{onClick:()=>l(""),className:"clear-search","aria-label":"ล้างการค้นหา",children:"✕"})]})}),C&&y.jsx("div",{className:"alert alert-error",children:C}),A&&y.jsx("div",{className:"alert alert-success",children:A}),y.jsx("div",{className:"users-section",children:f?y.jsxs("div",{className:"loading-users",children:[y.jsx("div",{className:"spinner"}),y.jsx("span",{children:"กำลังโหลดข้อมูลผู้ใช้..."})]}):y.jsx("div",{className:"users-grid",children:n.length===0?y.jsx("div",{className:"no-users",children:"ไม่พบผู้ใช้"}):n.map(S=>{var O;return y.jsxs("div",{className:"user-card",children:[y.jsxs("div",{className:"user-card-header",children:[y.jsx("div",{className:"user-avatar",children:((O=S.realname)==null?void 0:O.charAt(0))||"?"}),y.jsxs("div",{className:"user-basic-info",children:[y.jsx("div",{className:"user-name",children:y.jsx("strong",{children:S.realname})}),y.jsxs("div",{className:"user-username",children:["@",S.username]})]}),y.jsx("div",{className:"current-role-badge",children:y.jsx("span",{className:`role-badge ${b(S.role)}`,children:N(S.role)})})]}),y.jsx("div",{className:"user-card-body",children:y.jsxs("div",{className:"user-details-grid",children:[y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"รหัสประจำตัว:"}),y.jsx("span",{className:"detail-value",children:S.userid})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"หน่วย:"}),y.jsxs("span",{className:"detail-value",children:[S.battalion,"-",S.company,"-",S.platoon,"-",S.squad]})]}),y.jsxs("div",{className:"detail-item",children:[y.jsx("span",{className:"detail-label",children:"ชั้นปี:"}),y.jsx("span",{className:"detail-value",children:S.year})]})]})}),y.jsx("div",{className:"user-card-footer",children:y.jsxs("div",{className:"role-controls",children:[y.jsx("label",{children:"เปลี่ยนสิทธิ์:"}),y.jsxs("div",{className:"role-select-container",children:[y.jsxs("select",{value:S.role,onChange:F=>V(S.id,F.target.value),disabled:p===S.id,className:"role-select",children:[y.jsx("option",{value:"student",children:"นักเรียน"}),y.jsx("option",{value:"teacher",children:"อาจารย์"}),y.jsx("option",{value:"officer",children:"นายทหาร"}),y.jsx("option",{value:"admin",children:"แอดมิน"})]}),p===S.id&&y.jsxs("div",{className:"updating-indicator",children:[y.jsx("div",{className:"small-spinner"}),y.jsx("span",{children:"อัปเดต..."})]})]})]})})]},S.id)})})})]})]}):y.jsx("div",{className:"role-manager",children:y.jsx(AI,{user:e,requiredPage:"role-manager"})}):(console.log("No user found, redirecting to login"),y.jsx(ac,{to:"/login",replace:!0}))};function bI(){const[e,t]=R.useState([]),[n,i]=R.useState(""),[a,l]=R.useState(""),[f,g]=R.useState(""),[p,m]=R.useState(""),[C,E]=R.useState(""),[A,M]=R.useState(!1),[_,k]=R.useState(!0),[V,N]=R.useState(""),[b,S]=R.useState(""),[O,F]=R.useState(!1),[W,U]=R.useState([]),[B,G]=R.useState(""),te=async()=>{const de=localStorage.getItem("token");if(de)try{const j=await(await fetch("/api/dashboard-confirm",{headers:{Authorization:`Bearer ${de}`}})).json();j.success&&Array.isArray(j.confirmedIds)&&U(j.confirmedIds)}catch{}},me=async()=>{k(!0),N("");try{const de=localStorage.getItem("token"),j=await(await fetch("/api/dashboard",{headers:{Authorization:de?`Bearer ${de}`:""},cache:"no-store"})).json();t(j.data||[])}catch{t([]),N("โหลดข้อมูลไม่สำเร็จ")}finally{k(!1)}},he=async de=>{de.preventDefault(),M(!0),N(""),S("");try{const pe=localStorage.getItem("token"),j=JSON.parse(localStorage.getItem("user")||"{}"),q=p?p.slice(0,10):new Date().toISOString().slice(0,10),re=j.company||"",X=j.realname||j.username||"",fe=a,oe=f||j.battalion||"",ve=await fetch("/api/dashboard",{method:"POST",headers:{"Content-Type":"application/json",Authorization:pe?`Bearer ${pe}`:""},body:JSON.stringify({title:n,date:q,battalion:oe,company:re,sender:X,note:fe,endDateTime:C})}),Te=await ve.json();ve.ok?(S("สร้างข้อมูลสำเร็จ"),i(""),l(""),g(""),m(""),E(""),F(!1),me()):N(Te.message||"เกิดข้อผิดพลาด")}catch{N("เกิดข้อผิดพลาด")}finally{M(!1)}};return R.useEffect(()=>{const de=localStorage.getItem("token");de&&((async()=>{try{const j=await(await fetch(`/api/user/${de}`)).json();j.status&&j.data&&G(j.data.battalion||"")}catch{}})(),te()),me()},[]),y.jsxs("div",{className:"dashboard-page",style:{maxWidth:900,margin:"0 auto",padding:"32px 8px"},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24,flexWrap:"wrap",gap:16},children:[y.jsxs("div",{style:{minWidth:200},children:[y.jsx("h1",{style:{color:"#2563eb",fontWeight:700,fontSize:"2.2rem",margin:0},children:"Dashboard"}),y.jsx("div",{style:{color:"#666",fontSize:"1.1rem"},children:"สร้างและดูรายการ Dashboard ของคุณได้ที่นี่"})]}),y.jsx("button",{onClick:me,className:"btn-primary",style:{minWidth:120,height:40,fontWeight:600,fontSize:16,boxShadow:"0 2px 8px #2563eb22",borderRadius:8,width:"100%",maxWidth:220},children:"รีโหลดข้อมูล"})]}),y.jsx("div",{className:"card",style:{marginBottom:32,padding:"28px 24px"},children:O?y.jsxs("form",{onSubmit:he,style:{display:"flex",flexWrap:"wrap",gap:16,alignItems:"flex-end",rowGap:24},children:[y.jsxs("div",{style:{flex:"1 1 180px",minWidth:140,width:"100%"},children:[y.jsx("label",{style:{fontSize:13,color:"#444"},children:"หัวข้อ"}),y.jsx("input",{value:n,onChange:de=>i(de.target.value),placeholder:"Title",required:!0,className:"input",style:{width:"100%"}})]}),y.jsxs("div",{style:{flex:"2 1 260px",minWidth:140,width:"100%"},children:[y.jsx("label",{style:{fontSize:13,color:"#444"},children:"รายละเอียด"}),y.jsx("input",{value:a,onChange:de=>l(de.target.value),placeholder:"Content",className:"input",style:{width:"100%"}})]}),y.jsxs("div",{style:{flex:"1 1 180px",minWidth:140,width:"100%"},children:[y.jsx("label",{style:{fontSize:13,color:"#444"},children:"กองพัน"}),y.jsxs("select",{value:f,onChange:de=>g(de.target.value),required:!0,className:"input",style:{width:"100%"},children:[y.jsx("option",{value:"",children:"เลือกกองพัน"}),y.jsx("option",{value:"1",children:"1"}),y.jsx("option",{value:"2",children:"2"}),y.jsx("option",{value:"3",children:"3"}),y.jsx("option",{value:"4",children:"4"})]})]}),y.jsxs("div",{style:{flex:"1 1 180px",minWidth:140,width:"100%"},children:[y.jsx("label",{style:{fontSize:13,color:"#444"},children:"เวลาเริ่ม (วัน+เวลา)"}),y.jsx("input",{type:"datetime-local",value:p,onChange:de=>m(de.target.value),required:!0,className:"input",style:{width:"100%"}})]}),y.jsxs("div",{style:{flex:"1 1 180px",minWidth:140,width:"100%"},children:[y.jsx("label",{style:{fontSize:13,color:"#444"},children:"เวลาสิ้นสุด (วัน+เวลา)"}),y.jsx("input",{type:"datetime-local",value:C,onChange:de=>E(de.target.value),required:!0,className:"input",style:{width:"100%"}})]}),y.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,minWidth:120,width:"100%"},children:[y.jsx("button",{type:"submit",disabled:A,className:"btn-primary",style:{width:"100%",fontWeight:600,fontSize:16,boxShadow:"0 2px 8px #2563eb22",borderRadius:8,padding:"10px 0"},children:A?"กำลังบันทึก...":"บันทึกข้อมูล"}),y.jsx("button",{type:"button",className:"btn-secondary",style:{width:"100%",marginTop:8,fontWeight:500,fontSize:15,borderRadius:8,padding:"8px 0"},onClick:()=>{F(!1),N(""),S("")},children:"ยกเลิก"})]}),V&&!b&&y.jsx("div",{style:{marginTop:16},children:y.jsx("span",{style:{color:"#e11d48",fontWeight:500,marginRight:16},children:V})}),b&&!V&&y.jsx("div",{style:{marginTop:16},children:y.jsx("span",{style:{color:"#059669",fontWeight:500},children:b})})]}):y.jsx("button",{className:"btn-primary",style:{width:"100%",fontWeight:600,fontSize:16,boxShadow:"0 2px 8px #2563eb22",borderRadius:8,padding:"12px 0"},onClick:()=>{F(!0),N(""),S("")},children:"สร้างรายการใหม่"})}),y.jsxs("div",{className:"card",style:{marginBottom:32,padding:"24px 20px"},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,flexWrap:"wrap",gap:8},children:[y.jsx("div",{style:{fontWeight:600,fontSize:"1.1rem",color:"#222"},children:"Timeline"}),y.jsxs("span",{style:{color:"#2563eb",fontWeight:500,fontSize:15},children:[e.length," รายการ"]})]}),_?y.jsx("div",{style:{color:"#888",margin:"24px 0",textAlign:"center"},children:"Loading..."}):e.length===0?y.jsx("div",{style:{color:"#888",margin:"24px 0",textAlign:"center"},children:"ไม่พบข้อมูล"}):(()=>{const de=e.filter(q=>!B||String(q.battalion)===String(B)),pe={};de.forEach(q=>{const re=q.date||"-";pe[re]||(pe[re]=[]),pe[re].push(q)});const j=Object.keys(pe).sort((q,re)=>new Date(re)-new Date(q));return y.jsx("div",{children:j.map(q=>{let re="-";try{const X=new Date(q);if(!isNaN(X)){const fe=X.getDate(),ve=["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."][X.getMonth()],Te=X.getFullYear()>2500?X.getFullYear()-2500:X.getFullYear()-2e3;re=`${fe} ${ve} ${Te}`}}catch{}return y.jsxs("div",{style:{marginBottom:32,border:"1px solid #e5e7eb",borderRadius:12,background:"#fafbff"},children:[y.jsx("div",{style:{fontWeight:700,fontSize:"1.2rem",color:"#2563eb",padding:"12px 0 0 18px"},children:re}),y.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:pe[q].map(X=>{const fe=W.includes(X.id),oe=JSON.parse(localStorage.getItem("user")||"{}");return X.endDateTime||console.log("Dashboard entry missing endDateTime:",X),y.jsxs("li",{className:"card",style:{margin:"16px 0",padding:"18px 16px",border:"none",boxShadow:"none",background:"transparent"},children:[y.jsx("div",{style:{fontWeight:"bold",fontSize:"1.18rem",color:"#222",marginBottom:2},children:X.title||"ไม่มี"}),y.jsx("div",{style:{color:"#555",fontSize:"1rem",marginBottom:2},children:X.note||"หัวข้อ"}),y.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:2},children:y.jsxs("span",{children:["กองพัน: ",X.battalion?String(X.battalion):"-"]})}),y.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:2},children:y.jsxs("span",{children:["วันเวลาเริ่ม: ",X.startDateTime?new Date(X.startDateTime).toLocaleString("th-TH"):X.date?new Date(X.date).toLocaleDateString("th-TH"):"-"]})}),y.jsx("div",{style:{fontSize:13,color:"#666",marginBottom:2},children:y.jsxs("span",{children:["วันเวลาสิ้นสุด: ",X.endDateTime?new Date(X.endDateTime).toLocaleString("th-TH"):"-"]})}),y.jsxs("div",{style:{display:"flex",gap:20,marginTop:12,alignItems:"center"},children:[String(B)===String(X.battalion)&&!fe&&y.jsx("button",{className:"btn-primary",style:{fontWeight:600,fontSize:16,borderRadius:8,padding:"10px 24px",minWidth:120,height:44},onClick:async()=>{const ve=localStorage.getItem("token");if(ve)try{await fetch("/api/dashboard-confirm",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`},body:JSON.stringify({entryId:X.id})}),te()}catch{}},children:"Finish Attempt"}),oe&&(oe.realname===X.sender||oe.username===X.sender)&&y.jsx("button",{className:"btn-secondary",style:{fontWeight:500,fontSize:14,borderRadius:8,padding:"6px 14px",minWidth:0,background:"#e11d48",color:"#fff",height:36},onClick:async()=>{if(!window.confirm("คุณต้องการลบข้อมูลนี้ใช่หรือไม่?"))return;const ve=localStorage.getItem("token");if(ve)try{(await fetch(`/api/dashboard/${X.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${ve}`}})).ok?me():alert("ลบข้อมูลไม่สำเร็จ")}catch{alert("เกิดข้อผิดพลาดในการลบข้อมูล")}},children:"ลบข้อมูลนี้"}),String(B)===String(X.battalion)&&fe&&y.jsx("span",{style:{color:"#059669",fontWeight:500,fontSize:14},children:"✅ Finished"})]})]},X.id)})})]},q)})})})()]})]})}const II=Yc(OT,"deduct-point"),NI=Yc(aI,"gun-borrowing"),RI=Yc(TI,"role-manager"),MI=Yc(SI,"summary");function DI(){const e=_r(),t=e.pathname==="/login"||e.pathname==="/register";return R.useEffect(()=>{const n=document.body,i=document.getElementById("root");return t?(n.classList.remove("has-navbar"),i.classList.remove("has-navbar")):(n.classList.add("has-navbar"),i.classList.add("has-navbar")),()=>{n.classList.remove("has-navbar"),i.classList.remove("has-navbar")}},[t]),y.jsxs(y.Fragment,{children:[!t&&y.jsx(tw,{}),y.jsxs(lv,{children:[y.jsx(An,{path:"/",element:y.jsx(pl,{children:y.jsx(NT,{})})}),y.jsx(An,{path:"/users",element:y.jsx(pl,{children:y.jsx(DT,{})})}),y.jsx(An,{path:"/login",element:y.jsx(RT,{})}),y.jsx(An,{path:"/register",element:y.jsx(MT,{})}),y.jsx(An,{path:"/behavior-point",element:y.jsx(_T,{})}),y.jsx(An,{path:"/DeductPoint",element:y.jsx(II,{})}),y.jsx(An,{path:"/edit-profile",element:y.jsx(pl,{children:y.jsx(kT,{})})}),y.jsx(An,{path:"/view-profile",element:y.jsx(pl,{children:y.jsx(vb,{})})}),y.jsx(An,{path:"/gun-borrowing",element:y.jsx(NI,{})}),y.jsx(An,{path:"/summary",element:y.jsx(MI,{})}),y.jsx(An,{path:"/role-manager",element:y.jsx(RI,{})}),y.jsx(An,{path:"/dashboard",element:y.jsx(bI,{})}),y.jsx(An,{path:"*",element:y.jsx("h1",{children:"404 Not Found"})})]})]})}const _I=()=>y.jsx(Ov,{children:y.jsx(DI,{})});Bx(document.getElementById("root")).render(y.jsx(mi.StrictMode,{children:y.jsx(_I,{})}));
>>>>>>>> 55258ba (25/9):dist/assets/index-848b75bd.js
